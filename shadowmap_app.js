!function(){"use strict";var e,t,i,s,n,o,r,a={50047:function(e,t,i){i.d(t,{QC:function(){return p},oD:function(){return u},u:function(){return m}});var s=i(2873),n=i(70846),o=i(86723),r=i(40221),a=i(97160),l=i(81449),d=i(93684),h=i.n(d),c=i(42629);let u=n.memo(({content:e,offsetY:t,placement:i,hideAfterTimeout:n,className:o})=>(0,s.jsx)(m,{content:e,offsetY:t,placement:i,hideAfterTimeout:n,children:(0,s.jsx)(c.sz,{className:h()("w-4 h-4 tooltip-icon flex-shrink-0",o),onClick:e=>e.stopPropagation()})})),p=n.memo(({content:e,offsetY:t,placement:i,hideAfterTimeout:n,className:o})=>(0,s.jsx)(m,{content:e,offsetY:t,placement:i,hideAfterTimeout:n,children:(0,s.jsx)(l.Z,{className:h()("w-4 h-4 flex-shrink-0",o),onClick:e=>e.stopPropagation()})})),m=n.memo(({children:e,content:t,offsetY:i=-8,placement:l,hideAfterTimeout:d=!1,mouseOnly:h=!1})=>{let[c,u]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{if(d&&c&&(0,a.tq)()){let e=setTimeout(()=>{u(!1)},1500);return()=>clearTimeout(e)}},[c]),(0,s.jsx)(o.ZP,{theme:{token:{fontFamily:"Soleil, sans-serif"}},children:(0,s.jsx)(r.Z,{rootClassName:"bg-grey-700/90 backdrop-blur-[2px] border rounded border-white/50 text-white text-xs px-[10px] py-[5px] leading-normal",overlayInnerStyle:{backgroundColor:"transparent",border:"none",padding:0,minHeight:0,minWidth:0,boxShadow:"none"},placement:l,title:t,arrow:!1,onOpenChange:e=>{h&&(0,a.tq)()||u(e)},trigger:["hover"],open:c,align:{offset:[0,i]},children:e})})})},42589:function(e,t,i){i.d(t,{g:function(){return n}});var s,n,o=i(2873),r=i(70846),a=i(76386),l=i(94829),d=i(46366),h=i(47831);(s=n||(n={}))[s.Generic=0]="Generic",s[s.TimeUpgrade=1]="TimeUpgrade",s[s.AnalyticsUpgrade=2]="AnalyticsUpgrade";let c=()=>(0,o.jsxs)("svg",{width:"150",height:"84",viewBox:"0 0 150 84",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,o.jsxs)("g",{clipPath:"url(#clip0_5038_22524)",children:[(0,o.jsx)("path",{d:"M77.5 14.002V5.00195L72.5 5.00195V14.002L77.5 14.002Z",fill:"black"}),(0,o.jsx)("path",{d:"M77.5 45.002V36.002H72.5V45.002H77.5Z",fill:"black"}),(0,o.jsx)("path",{d:"M77.5 14.002V5.00195L72.5 5.00195V14.002L77.5 14.002Z",fill:"black"}),(0,o.jsx)("path",{d:"M72.2588 5.05216L70.9648 0.222656L66.1353 1.51666L67.4293 6.34616L72.2588 5.05216Z",fill:"black"}),(0,o.jsx)("path",{d:"M83.8624 48.4818L82.5684 43.6523L77.7389 44.9463L79.0329 49.7758L83.8624 48.4818Z",fill:"black"}),(0,o.jsx)("path",{d:"M77.5 45.002V36.002H72.5V45.002H77.5Z",fill:"black"}),(0,o.jsx)("path",{d:"M71.6445 14.2354L67.1445 6.44141L62.8145 8.94141L67.3145 16.7354L71.6445 14.2354Z",fill:"black"}),(0,o.jsx)("path",{d:"M87.1865 41.0577L82.6865 33.2637L78.3565 35.7637L82.8565 43.5577L87.1865 41.0577Z",fill:"black"}),(0,o.jsx)("path",{d:"M66.7422 17.3477L58.9482 12.8477L56.4482 17.1777L64.2422 21.6777L66.7422 17.3477Z",fill:"black"}),(0,o.jsx)("path",{d:"M93.5479 32.8242L85.7539 28.3242L83.2539 32.6542L91.0479 37.1542L93.5479 32.8242Z",fill:"black"}),(0,o.jsx)("path",{d:"M64 22.502H55V27.502H64V22.502Z",fill:"black"}),(0,o.jsx)("path",{d:"M95 22.502H86V27.502H95V22.502Z",fill:"black"}),(0,o.jsx)("path",{d:"M64.2422 28.3242L56.4482 32.8242L58.9482 37.1542L66.7422 32.6542L64.2422 28.3242Z",fill:"black"}),(0,o.jsx)("path",{d:"M91.0479 12.8477L83.2539 17.3477L85.7539 21.6777L93.5479 17.1777L91.0479 12.8477Z",fill:"black"}),(0,o.jsx)("path",{d:"M67.3135 33.2685L62.8135 41.0625L67.1435 43.5625L71.6435 35.7685L67.3135 33.2685Z",fill:"black"}),(0,o.jsx)("path",{d:"M82.8545 6.44428L78.3545 14.2383L82.6845 16.7383L87.1845 8.94428L82.8545 6.44428Z",fill:"black"}),(0,o.jsx)("path",{d:"M62.6253 9.10581L59.0898 5.57031L55.5543 9.10581L59.0898 12.6413L62.6253 9.10581Z",fill:"black"}),(0,o.jsx)("path",{d:"M94.4447 40.8968L90.9092 37.3613L87.3737 40.8968L90.9092 44.4323L94.4447 40.8968Z",fill:"black"}),(0,o.jsx)("path",{d:"M56.3051 17.4268L51.4756 16.1328L50.1816 20.9623L55.0111 22.2563L56.3051 17.4268Z",fill:"black"}),(0,o.jsx)("path",{d:"M99.8149 29.0362L94.9854 27.7422L93.6914 32.5717L98.5209 33.8657L99.8149 29.0362Z",fill:"black"}),(0,o.jsx)("path",{d:"M55.0102 27.7451L50.1807 29.0391L51.4747 33.8686L56.3042 32.5746L55.0102 27.7451Z",fill:"black"}),(0,o.jsx)("path",{d:"M98.5199 16.1357L93.6904 17.4297L94.9844 22.2592L99.8139 20.9652L98.5199 16.1357Z",fill:"black"}),(0,o.jsx)("path",{d:"M55.0102 27.7451L50.1807 29.0391L51.4747 33.8686L56.3042 32.5746L55.0102 27.7451Z",fill:"black"}),(0,o.jsx)("path",{d:"M98.5199 16.1357L93.6904 17.4297L94.9844 22.2592L99.8139 20.9652L98.5199 16.1357Z",fill:"black"}),(0,o.jsx)("path",{d:"M55.0102 27.7451L50.1807 29.0391L51.4747 33.8686L56.3042 32.5746L55.0102 27.7451Z",fill:"black"}),(0,o.jsx)("path",{d:"M98.5199 16.1357L93.6904 17.4297L94.9844 22.2592L99.8139 20.9652L98.5199 16.1357Z",fill:"black"}),(0,o.jsx)("path",{d:"M59.0892 37.361L55.5537 40.8965L59.0892 44.432L62.6247 40.8965L59.0892 37.361Z",fill:"black"}),(0,o.jsx)("path",{d:"M90.9085 5.56997L87.373 9.10547L90.9085 12.641L94.444 9.10547L90.9085 5.56997Z",fill:"black"}),(0,o.jsx)("path",{d:"M67.4288 43.6549L66.1348 48.4844L70.9643 49.7784L72.2583 44.9489L67.4288 43.6549Z",fill:"black"}),(0,o.jsx)("path",{d:"M79.0313 0.227141L77.7373 5.05664L82.5668 6.35064L83.8608 1.52114L79.0313 0.227141Z",fill:"black"}),(0,o.jsx)("path",{d:"M0 74.8L2.6 73.45C3.2 74.65 4.2 75.3 5.7 75.3C7.15 75.3 7.75 74.8 7.75 74.05C7.75 71.6 0.55 72.9 0.55 68.2C0.55 65.65 2.75 64.25 5.55 64.25C7.65 64.25 9.5 65.15 10.55 66.9L7.95 68.25C7.45 67.3 6.55 66.8 5.4 66.8C4.2 66.8 3.6 67.25 3.6 68C3.6 70.3 10.8 68.95 10.8 73.85C10.8 76.3 8.8 77.8 5.65 77.8C2.95 77.8 1 76.95 0 74.8Z",fill:"black"}),(0,o.jsx)("path",{d:"M13.0996 59H16.0496V66.35C16.9496 64.85 18.4496 64.25 20.0996 64.25C23.0496 64.25 25.1996 66.1 25.1996 69.35V77.55H22.1996V70.35C22.1996 68.25 21.0996 67.05 19.2996 67.05C17.5996 67.05 16.1496 68.1 16.1496 70.4V77.5H13.0996V59Z",fill:"black"}),(0,o.jsx)("path",{d:"M27.4004 71.1C27.4004 67.05 30.6504 64.25 33.8004 64.25C35.9504 64.25 37.3004 65 38.1504 66.4V64.5H41.1004V77.55H38.0504V75.85C37.1504 77.05 35.8004 77.8 33.7504 77.8C30.7004 77.8 27.4004 75.15 27.4004 71.1ZM38.3004 71.05C38.3004 68.8 36.5004 67.05 34.3004 67.05C32.1004 67.05 30.3004 68.85 30.3004 71.05C30.3004 73.15 32.1004 74.95 34.3004 74.95C36.5004 75 38.3004 73.2 38.3004 71.05Z",fill:"black"}),(0,o.jsx)("path",{d:"M43.4004 71.15C43.4004 67.4 46.3004 64.3 50.1004 64.3C51.4504 64.3 53.3504 64.75 54.3004 66.35V59H57.2504V77.55H54.3004V76.1C53.2504 77.1 51.8004 77.8 50.2004 77.8C46.3504 77.8 43.4004 74.75 43.4004 71.15ZM54.2504 71.15C54.2504 68.8 52.4504 67.1 50.2504 67.1C48.0004 67.1 46.2504 69 46.2504 71.15C46.2504 73.15 48.0004 75 50.2504 75C52.5004 75 54.2504 73.35 54.2504 71.15Z",fill:"black"}),(0,o.jsx)("path",{d:"M59.5 71C59.5 67.3 62.55 64.25 66.4 64.25C70.25 64.25 73.35 67.3 73.35 71C73.35 74.7 70.25 77.8 66.4 77.8C62.55 77.8 59.5 74.75 59.5 71ZM70.4 71C70.4 68.95 68.65 67.05 66.4 67.05C64.15 67.05 62.4 68.9 62.4 71C62.4 73.1 64.2 74.95 66.4 74.95C68.6 75 70.4 73.15 70.4 71Z",fill:"black"}),(0,o.jsx)("path",{d:"M73.5498 64.5H76.8498L79.7998 73.7L83.0998 64.5H85.7498L88.9998 73.7L91.9998 64.5H95.2998L90.5498 77.55H87.5998L84.3998 68.6L81.2998 77.55H78.1998L73.5498 64.5Z",fill:"black"}),(0,o.jsx)("path",{d:"M96.9004 64.5H99.8504V66.35C100.8 64.8 102.2 64.25 103.7 64.25C105.7 64.25 107.1 65.1 107.85 66.5C109 64.65 110.75 64.25 112.3 64.25C115.4 64.25 117.1 66.3 117.1 69.3V77.6H114.1V70.4C114.1 68.3 113.15 67.1 111.4 67.1C109.65 67.1 108.55 68.3 108.55 70.45V77.55H105.55V70.35C105.55 68.25 104.6 67.05 102.8 67.05C100.95 67.05 100 68.4 100 70.5V77.5H96.9504V64.5H96.9004Z",fill:"black"}),(0,o.jsx)("path",{d:"M119.3 71.1C119.3 67.05 122.55 64.25 125.7 64.25C127.85 64.25 129.2 65 130.05 66.4V64.5H133V77.55H129.95V75.85C129.05 77.05 127.7 77.8 125.65 77.8C122.6 77.8 119.3 75.15 119.3 71.1ZM130.2 71.05C130.2 68.8 128.4 67.05 126.2 67.05C124 67.05 122.2 68.85 122.2 71.05C122.2 73.15 124 74.95 126.2 74.95C128.4 75 130.2 73.2 130.2 71.05Z",fill:"black"}),(0,o.jsx)("path",{d:"M136.15 64.5H139.1V66.25C140.05 64.75 141.95 64.25 143.25 64.25C147.05 64.25 150 67.4 150 71.1C150 74.75 147 77.8 143.2 77.8C141.3 77.8 140.1 77.1 139.1 76.05V83.6H136.15V64.5ZM147.1 71.15C147.1 69 145.35 67.1 143.15 67.1C140.9 67.1 139.15 68.8 139.15 71.15C139.15 73.4 140.9 75 143.15 75C145.35 75 147.1 73.15 147.1 71.15Z",fill:"black"})]}),(0,o.jsx)("defs",{children:(0,o.jsx)("clipPath",{id:"clip0_5038_22524",children:(0,o.jsx)("rect",{width:"150",height:"84",fill:"white"})})})]});t.Z=({isOpen:e,onClose:t,trigger:i})=>{let s,u,p=(0,r.useRef)(null),{t:m}=(0,l.$G)(),g=(0,h.Z)(d.Gn);if(g&&g.startsWith("lystio")){let s,r;switch(i){case n.TimeUpgrade:s=m("couponCodeModalLystio.timeTitle"),r=m("couponCodeModalLystio.timeText");break;case n.AnalyticsUpgrade:s=m("couponCodeModalLystio.analyticsTitle"),r=m("couponCodeModalLystio.analyticsText");break;default:s=m("couponCodeModalLystio.genericTitle")}return(0,o.jsx)(a.Z,{open:e,hideClose:!1,onClose:t,initialFocus:p,sunBackground:!0,style:{maxWidth:380,padding:"36px 24px 28px 24px"},children:(0,o.jsxs)("div",{className:"flex flex-col items-center text-center",ref:p,children:[(0,o.jsx)("div",{className:"mb-8",children:(0,o.jsx)(c,{})}),(0,o.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,o.jsx)("div",{className:"text-[22px] font-bold text-black leading-snug",children:s}),r&&(0,o.jsx)("div",{className:"text-m text-grey-800",children:r}),(0,o.jsx)("div",{className:"text-m text-grey-800 font-bold",children:(0,o.jsx)(l.cC,{i18nKey:"couponCodeModalLystio.discount",components:{b:(0,o.jsx)("strong",{})}})})]}),(0,o.jsx)("div",{className:"mt-8 w-full px-4",children:(0,o.jsx)("a",{className:"flex items-center justify-center px-5 h-10 w-full btn-sun",href:"https://app.shadowmap.org/?discount=lystio10",target:"_blank",children:(0,o.jsx)("span",{className:"text-[14px] font-bold",children:m("couponCodeModalLystio.buttonText")})})})]})})}if("masterkey"===g)return(0,o.jsx)(a.Z,{open:e,hideClose:!1,onClose:t,initialFocus:p,sunBackground:!1,style:{maxWidth:380,padding:24,backgroundColor:"#F5F0EC",borderRadius:16},children:(0,o.jsxs)("div",{className:"flex flex-col items-center text-center",ref:p,children:[(0,o.jsx)("div",{className:"mb-8",children:(0,o.jsx)(c,{})}),(0,o.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,o.jsx)("div",{className:"text-[22px] font-bold text-black leading-snug",children:m("couponCodeModalMasterkey.title")}),(0,o.jsx)("div",{className:"text-m text-[#211F20]",children:(0,o.jsx)(l.cC,{i18nKey:"couponCodeModalMasterkey.text",components:{b:(0,o.jsx)("strong",{})}})})]}),(0,o.jsx)("div",{className:"mt-8 w-full px-4",children:(0,o.jsx)("a",{className:"flex items-center justify-center px-5 h-10 w-full btn-sun",href:"https://app.shadowmap.org/?discount=masterkey10",target:"_blank",children:(0,o.jsx)("span",{className:"text-[14px] font-bold",children:m("couponCodeModalMasterkey.buttonText")})})})]})});switch(i){case n.TimeUpgrade:s=m("couponCodeModalWillhaben.timeTitle"),u=m("couponCodeModalWillhaben.timeText");break;case n.AnalyticsUpgrade:s=m("couponCodeModalWillhaben.analyticsTitle"),u=m("couponCodeModalWillhaben.analyticsText");break;default:s=m("couponCodeModalWillhaben.genericTitle")}return(0,o.jsx)(a.Z,{open:e,hideClose:!1,onClose:t,initialFocus:p,sunBackground:!0,style:{maxWidth:380,padding:"36px 24px 28px 24px"},children:(0,o.jsxs)("div",{className:"flex flex-col items-center text-center",ref:p,children:[(0,o.jsx)("div",{className:"mb-8",children:(0,o.jsx)(c,{})}),(0,o.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,o.jsx)("div",{className:"text-[22px] font-bold text-black leading-snug",children:s}),u&&(0,o.jsx)("div",{className:"text-m text-grey-800",children:u}),(0,o.jsx)("div",{className:"text-m text-grey-800",children:(0,o.jsx)(l.cC,{i18nKey:"couponCodeModalWillhaben.discount",components:{b:(0,o.jsx)("strong",{})}})})]}),(0,o.jsx)("div",{className:"mt-8 w-full px-4",children:(0,o.jsx)("a",{className:"flex items-center justify-center px-5 h-10 w-full btn-sun",href:"https://app.shadowmap.org/?discount=willhaben10",target:"_blank",children:(0,o.jsx)("span",{className:"text-[14px] font-bold",children:m("couponCodeModalWillhaben.buttonText")})})})]})})}},53277:function(e,t,i){i.d(t,{a9:function(){return S},e3:function(){return C}});var s=i(2873),n=i(70846),o=i(94829),r=i(42629),a=i(32750),l=i(68171),d=i(55426),h=i(93684),c=i.n(h),u=i(50047),p=i(47831),m=i(76644),g=i(53205),f=i(46366),x=i(48383),w=i(950),b=i(412),v=i(56009);let y=({progress:e})=>(0,s.jsx)("div",{className:"w-full rounded-full border border-white border-1 h-4 relative",style:{background:"linear-gradient(90deg, #83C88B 0%, #FFDC01 25%, #F0B056 50%, #E85454 75%, #C14E86 100%)"},children:(0,s.jsx)("div",{className:"bg-grey-800 border-l border-1 border-white h-[24px] w-[3px] absolute",style:{transform:"translateY(calc(-50% + 7px))",left:`${100*e}%`}})}),C=e=>e<3?"#83C88B":e<6?"#FFDC01":e<8?"#F0B056":e<11?"#E85454":"#C14E86",M=["US","AS","GU","MP","PR","VI","FM","MH","PW","KY","LR"],S=(e,t)=>{if(M.includes((t||"AT").toUpperCase())){let t=Math.round(1.8*e+32);return`${t}\xb0F`}return`${Math.round(e)}\xb0`};t.ZP=({isOpen:e,onClose:t,parentElement:i})=>{let{t:h}=(0,o.$G)(),C=(0,p.Z)(x.nl),M=(0,p.Z)(g.R9),L=(0,f.MG)(e=>e.capabilities.unlockEverything),T=(0,p.Z)(x.tY),j=(0,p.Z)(g.$l.pipe((0,v.U)(e=>{var t;return null==(t=null==e?void 0:e.country)?void 0:t.code}))),P=(null==M?void 0:M.isAllowedToUseHome())||L;if(!C)return null;let E=()=>{(0,w.si)({roles:M,subscription:b.K.PRO_AND_HIGHER,trigger:"weather_forecast"})},A=e=>{var i;return(0,s.jsxs)("div",{className:c()("min-h-[244px] rounded-2xl  backdrop-filter-map text-xs text-grey-800",{"flex justify-center items-center":!C.data},e?"w-[355px] max-w-[calc(100vw-24px)]":"sm:w-[355px] w-[calc(100vw-24px)] max-w-[calc(100vw-24px)]"),style:{padding:"17px 16px 18px 16px",background:"rgba(255, 255, 255, 0.85)",boxShadow:"0px 2px 2px 0px rgba(0, 0, 0, 0.10)"},children:[!C.data&&(0,s.jsx)("div",{children:"No data"}),C.data&&(0,s.jsxs)("div",{className:"leading-none",children:[(0,s.jsxs)("div",{className:c()({"opacity-30":T}),children:[(0,s.jsxs)("div",{className:"flex flex-row justify-between mb-[32px] mr-[42px] gap-2",children:[(0,s.jsxs)("div",{className:"flex flex-row gap-2 min-w-0 flex-grow",children:[(0,s.jsxs)("div",{className:"flex-shrink-0 relative",children:[(0,s.jsx)("div",{className:"w-[48px] h-[48px] ",style:{backgroundImage:`url(${C.data.weatherIcon})`,backgroundSize:"100%"}}),"now"!==C.data.era&&(0,s.jsx)("div",{className:"absolute bottom-[-8px] w-full uppercase font-bold text-[8px] text-center bg-grey-600 text-white rounded-[4px] py-1",children:"past"===C.data.era?h("weatherWidget.history"):h("weatherWidget.forecast")})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-[5px] min-w-0",children:[(0,s.jsx)("div",{className:"font-bold text-[16px] h-[19px] whitespace-nowrap overflow-ellipsis overflow-hidden",children:C.data.locationName}),(0,s.jsx)("div",{children:C.data.weatherDescription}),(0,s.jsxs)("div",{children:[h("weatherWidget.rainChance")," ",C.data.chanceOfRain,"%"]})]})]}),(0,s.jsxs)("div",{className:"text-right mt-[-3px] flex-shrink-0",children:[(0,s.jsx)("div",{className:"text-[36px]",children:S(C.data.temperature,j)}),(0,s.jsxs)("div",{className:"mr-1 mt-2",children:[h("weatherWidget.highTemperature")," ",S(C.data.temperatureMaxToday,j)," ",h("weatherWidget.lowTemperature")," ",S(C.data.temperatureMinToday,j)]})]})]}),(0,s.jsxs)("div",{className:"flex flex-row items-center justify-center w-full text-[14px] gap-2 px-1.5 mb-[34px]",children:[(0,s.jsxs)("div",{className:"flex-shrink-0 font-bold",children:["UV ",C.data.uvIndex]}),(0,s.jsx)("div",{className:"flex-shrink-0 text-[12px] mt-[2px]",children:(i=C.data.uvIndex)<3?h("weatherWidget.uvIndex.low"):i<6?h("weatherWidget.uvIndex.moderate"):i<8?h("weatherWidget.uvIndex.high"):i<11?h("weatherWidget.uvIndex.veryHigh"):h("weatherWidget.uvIndex.extreme")}),(0,s.jsx)("div",{className:"w-full flex-shrink",children:(0,s.jsx)(y,{progress:Math.max(Math.min(C.data.uvIndex/10,1),0)})}),(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)(u.u,{children:(0,s.jsx)(r.aI,{className:"w-4 h-4 cursor-pointer"}),content:h("weatherWidget.uvTooltip")})})]}),(0,s.jsx)("div",{className:"flex flex-row justify-between w-full px-3",children:C.data.forecast.map((e,t)=>(0,s.jsxs)("div",{className:c()("flex flex-col items-center gap-[6px]",0===t?"font-bold":""),children:[(0,s.jsx)("div",{children:e.time}),(0,s.jsx)("div",{className:"w-[32px] h-[32px]",style:{backgroundImage:`url(${e.weatherIcon})`,backgroundSize:"100%"}}),(0,s.jsx)("div",{children:S(e.temperature,j)})]},JSON.stringify(e)))})]}),!P&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{className:"flex flex-row justify-center items-center font-bold text-[14px] font-grey-800 gap-2 w-[calc(100%-16px)] h-[38px] bg-shadowmap-green hover:bg-[#39dc7a] transition-colors rounded-full mt-4 mx-2",onClick:E,children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"10",height:"10",viewBox:"0 0 10 10",fill:"none",children:(0,s.jsx)("g",{children:(0,s.jsx)("path",{d:"M3.22916 4.06254V2.91671C3.22916 1.9387 4.02199 1.14587 4.99999 1.14587C5.67672 1.14587 6.2648 1.52548 6.56289 2.08337M2.81249 8.85421H7.18749C7.64773 8.85421 8.02082 8.48111 8.02082 8.02087V4.89587C8.02082 4.43564 7.64773 4.06254 7.18749 4.06254H2.81249C2.35225 4.06254 1.97916 4.43564 1.97916 4.89587V8.02087C1.97916 8.48111 2.35225 8.85421 2.81249 8.85421Z",stroke:"black",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,s.jsx)("span",{children:h("weatherWidget.unlockFullWeather")})]}),(0,s.jsx)("div",{className:"text-center text-grey-500 text-[12px] mt-[7px] leading-normal",children:h("weatherWidget.unlockDescription")})]})]}),(0,s.jsxs)("button",{type:"button",className:"absolute top-[16px] right-[16px] rounded-md text-grey-800 hover:text-grey-600 focus:outline-none",onClick:()=>t(),children:[(0,s.jsx)("span",{className:"sr-only",children:"Close"}),(0,s.jsx)(a.Z,{className:"h-6 w-6","aria-hidden":"true"})]})]})};return window.innerHeight<650?(0,s.jsx)(l.u.Root,{appear:!0,show:e,as:n.Fragment,children:(0,s.jsx)(d.V,{as:"div",className:"relative",onClose:t,children:(0,s.jsx)(l.u.Child,{as:n.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,s.jsx)("div",{className:"fixed inset-0 overflow-y-auto bg-grey-800 bg-opacity-70 backdrop-filter-map",children:(0,s.jsx)("div",{className:"flex min-h-full items-center justify-center text-center p-0",onClick:e=>{e.target===e.currentTarget&&t()},children:A(!0)})})})})}):i?(0,m.createPortal)((0,s.jsx)(l.u,{show:e,enter:"transition-opacity duration-75",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-150",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:A(!1)}),i):null}},42629:function(e,t,i){i.d(t,{$N:function(){return D},$_:function(){return N},BB:function(){return M},Bl:function(){return S},Bq:function(){return C},GG:function(){return l},Hv:function(){return W},J6:function(){return q},LQ:function(){return H},M5:function(){return eo},OX:function(){return a},PM:function(){return ei},Pv:function(){return f},RO:function(){return c},Td:function(){return O},Ub:function(){return G},Uv:function(){return ee},Wg:function(){return _},XH:function(){return u},Xl:function(){return m},YC:function(){return b},Zb:function(){return L},_8:function(){return F},_9:function(){return d},aI:function(){return j},bo:function(){return es},dT:function(){return P},dl:function(){return z},dt:function(){return U},ew:function(){return w},gL:function(){return o},gw:function(){return B},hT:function(){return A},hp:function(){return et},hz:function(){return $},i6:function(){return el},jL:function(){return E},lH:function(){return h},mB:function(){return R},mf:function(){return J},oD:function(){return er},os:function(){return X},pO:function(){return x},qN:function(){return en},qw:function(){return Z},r0:function(){return T},sj:function(){return v},so:function(){return Q},sz:function(){return g},t6:function(){return ed},tE:function(){return p},vZ:function(){return r},wf:function(){return k},wl:function(){return I},wr:function(){return ea},wy:function(){return K},xI:function(){return y},xc:function(){return Y},zW:function(){return n},zm:function(){return V}});var s=i(2873);i(70846);let n=e=>(0,s.jsx)("svg",Object.assign({},e,{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M9.79166 16.0417H16.875C17.7955 16.0417 18.5417 15.2955 18.5417 14.375V7.29167C18.5417 6.37119 17.7955 5.625 16.875 5.625H11.7253C11.168 5.625 10.6477 5.3465 10.3385 4.88283L9.66143 3.86717C9.35232 3.4035 8.83194 3.125 8.27468 3.125H4.79166C3.87118 3.125 3.12499 3.87119 3.12499 4.79167V9.375M4.79166 11.875V14.375M4.79166 14.375V16.875M4.79166 14.375H2.29166M4.79166 14.375H7.29166",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})),o=e=>(0,s.jsx)("svg",Object.assign({},e,{width:"24",height:"25",viewBox:"0 0 24 25",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M13.25 6.74994L16.0858 3.91416C16.8668 3.13311 18.1332 3.13311 18.9142 3.91415L20.5858 5.58573C21.3668 6.36678 21.3668 7.63311 20.5858 8.41416L17.75 11.2499M13.25 6.74994L3.33579 16.6642C2.96071 17.0392 2.75 17.5479 2.75 18.0784V21.7499H6.42157C6.95201 21.7499 7.46071 21.5392 7.83579 21.1642L17.75 11.2499M13.25 6.74994L17.75 11.2499",stroke:"white",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})),r=e=>(0,s.jsx)("svg",Object.assign({},e,{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M11.0417 5.20833L13.4048 2.84518C14.0557 2.1943 15.111 2.1943 15.7618 2.84518L17.1548 4.23815C17.8057 4.88903 17.8057 5.9443 17.1548 6.59518L14.7917 8.95833M11.0417 5.20833L2.77982 13.4702C2.46726 13.7827 2.29167 14.2067 2.29167 14.6487V17.7083H5.35131C5.79334 17.7083 6.21726 17.5327 6.52982 17.2202L14.7917 8.95833M11.0417 5.20833L14.7917 8.95833",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})),a=e=>(0,s.jsxs)("svg",Object.assign({},e,{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("path",{d:"M12.7162 6.41921L8.20489 8.69966M8.20489 8.69966L3.69356 6.41921M8.20489 8.69966V13.2606M13.4103 8.69966V6.5307C13.4103 6.03257 13.1434 5.57264 12.7109 5.3255L8.89358 3.1442C8.46683 2.90034 7.94294 2.90034 7.5162 3.1442L3.69892 5.3255C3.26642 5.57264 2.99951 6.03258 2.99951 6.5307V10.8686C2.99951 11.3667 3.26642 11.8267 3.69892 12.0738L7.5162 14.2551C7.94294 14.499 8.46683 14.499 8.89358 14.2551L10.8022 13.1645",stroke:"currentColor",strokeWidth:"1.4",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M17.0681 19.3023C14.4246 19.3023 12.9469 17.9466 12.3548 16.9872C12.1958 16.7297 12.223 16.4092 12.3714 16.1454L17.0681 7.79565L21.7393 16.0999C21.902 16.3893 21.9153 16.7436 21.7237 17.0147C21.0964 17.9023 19.6295 19.3023 17.0681 19.3023Z",stroke:"currentColor",strokeWidth:"1.4"}),(0,s.jsx)("path",{d:"M18.394 19V21.3333C18.2829 21.5111 17.8274 22 16.894 22C15.9607 22 15.5052 21.5556 15.394 21.3333V19",stroke:"currentColor",strokeWidth:"1.4"})]})),l=e=>(0,s.jsx)("svg",Object.assign({},e,{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M9.1654 4.42071C8.76876 4.5401 8.544 4.95841 8.66339 5.35505C8.78277 5.75169 9.20109 5.97645 9.59772 5.85706L9.38156 5.13889L9.1654 4.42071ZM21.529 11.1176L22.1806 10.7462V10.7462L21.529 11.1176ZM19.1413 14.9666C18.8678 15.2776 18.8982 15.7515 19.2093 16.0251C19.5203 16.2986 19.9942 16.2682 20.2677 15.9571L19.7045 15.4619L19.1413 14.9666ZM21.5298 12.8811L20.8782 12.5098V12.5098L21.5298 12.8811ZM3.28033 2.21967C2.98744 1.92678 2.51256 1.92678 2.21967 2.21967C1.92678 2.51256 1.92678 2.98744 2.21967 3.28033L2.75 2.75L3.28033 2.21967ZM2.4702 11.1188L3.12183 11.4901H3.12183L2.4702 11.1188ZM20.7197 21.7803C21.0126 22.0732 21.4874 22.0732 21.7803 21.7803C22.0732 21.4874 22.0732 21.0126 21.7803 20.7197L21.25 21.25L20.7197 21.7803ZM2.47128 12.8829L1.8197 13.2543H1.8197L2.47128 12.8829ZM10.2322 10.2322C10.5251 9.93934 10.5251 9.46447 10.2322 9.17157C9.93934 8.87868 9.46447 8.87868 9.17157 9.17157L9.7019 9.7019L10.2322 10.2322ZM14.8284 14.8284C15.1213 14.5355 15.1213 14.0607 14.8284 13.7678C14.5355 13.4749 14.0607 13.4749 13.7678 13.7678L14.2981 14.2981L14.8284 14.8284ZM9.38156 5.13889L9.59772 5.85706C13.5394 4.67067 17.9939 6.42962 20.8774 11.489L21.529 11.1176L22.1806 10.7462C19.0295 5.21732 13.9174 2.99041 9.1654 4.42071L9.38156 5.13889ZM19.7045 15.4619L20.2677 15.9571C20.9622 15.1674 21.6043 14.2652 22.1814 13.2524L21.5298 12.8811L20.8782 12.5098C20.3482 13.4398 19.7645 14.258 19.1413 14.9666L19.7045 15.4619ZM21.529 11.1176L20.8774 11.489C21.0579 11.8057 21.058 12.1942 20.8782 12.5098L21.5298 12.8811L22.1814 13.2524C22.6242 12.4754 22.6229 11.5222 22.1806 10.7462L21.529 11.1176ZM2.75 2.75L2.21967 3.28033L5.99937 7.06003L6.5297 6.5297L7.06003 5.99937L3.28033 2.21967L2.75 2.75ZM2.4702 11.1188L3.12183 11.4901C4.21379 9.57384 5.53391 8.13258 6.95699 7.14609L6.5297 6.5297L6.10242 5.91332C4.47305 7.04281 3.00753 8.66097 1.81857 10.7475L2.4702 11.1188ZM6.5297 6.5297L5.99937 7.06003L16.9399 18.0006L17.4703 17.4703L18.0006 16.9399L7.06003 5.99937L6.5297 6.5297ZM17.4703 17.4703L16.9399 18.0006L20.7197 21.7803L21.25 21.25L21.7803 20.7197L18.0006 16.9399L17.4703 17.4703ZM2.47128 12.8829L1.8197 13.2543C3.74768 16.6368 6.40546 18.7894 9.29533 19.6173C12.1918 20.4471 15.2481 19.9232 17.8975 18.0866L17.4703 17.4703L17.043 16.8539C14.7435 18.4479 12.1496 18.8747 9.70844 18.1753C7.26069 17.4741 4.89344 15.6178 3.12287 12.5115L2.47128 12.8829ZM2.4702 11.1188L1.81857 10.7475C1.37561 11.5249 1.37756 12.4786 1.8197 13.2543L2.47128 12.8829L3.12287 12.5115C2.94222 12.1946 2.94213 11.8055 3.12183 11.4901L2.4702 11.1188ZM12 15.25V14.5C10.6193 14.5 9.5 13.3807 9.5 12H8.75H8C8 14.2091 9.79086 16 12 16V15.25ZM8.75 12H9.5C9.5 11.3094 9.779 10.6855 10.2322 10.2322L9.7019 9.7019L9.17157 9.17157C8.44854 9.89461 8 10.8956 8 12H8.75ZM14.2981 14.2981L13.7678 13.7678C13.3145 14.221 12.6906 14.5 12 14.5V15.25V16C13.1044 16 14.1054 15.5515 14.8284 14.8284L14.2981 14.2981Z",fill:"currentColor"})})),d=e=>(0,s.jsx)("svg",Object.assign({},e,{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M3.16663 3.16667L12.8333 12.8333M12.8333 3.16667L3.16663 12.8333",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})})),h=e=>(0,s.jsx)("svg",Object.assign({},e,{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M12 19.25V11.75M12 11.75L14.5 14.25M12 11.75L9.5 14.25M15 19.25H18.125C20.4032 19.25 22.25 17.4032 22.25 15.125C22.25 12.8468 20.4032 11 18.125 11C18.0814 11 18.038 11.0007 17.9948 11.002C17.9983 10.9184 18 10.8344 18 10.75C18 7.43629 15.3137 4.75 12 4.75C9.3716 4.75 7.13793 6.44009 6.32647 8.7928C3.74507 9.12339 1.75 11.3287 1.75 14C1.75 16.8995 4.10051 19.25 7 19.25H9",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})),c=e=>(0,s.jsx)("svg",Object.assign({},e,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:(0,s.jsx)("path",{d:"M3 17V7C3 6.46957 3.21071 5.96086 3.58579 5.58579C3.96086 5.21071 4.46957 5 5 5H11L13 7H19C19.5304 7 20.0391 7.21071 20.4142 7.58579C20.7893 7.96086 21 8.46957 21 9V17C21 17.5304 20.7893 18.0391 20.4142 18.4142C20.0391 18.7893 19.5304 19 19 19H5C4.46957 19 3.96086 18.7893 3.58579 18.4142C3.21071 18.0391 3 17.5304 3 17Z",stroke:"white",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})),u=e=>(0,s.jsx)("svg",Object.assign({},e,{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:(0,s.jsx)("path",{d:"M4.69102 16.149L5.43947 16.1007L4.69102 16.149ZM15.3089 16.149L14.5605 16.1007L14.5605 16.1007L15.3089 16.149ZM2.29163 4.04167C1.87741 4.04167 1.54163 4.37745 1.54163 4.79167C1.54163 5.20588 1.87741 5.54167 2.29163 5.54167V4.04167ZM17.7083 5.54167C18.1225 5.54167 18.4583 5.20588 18.4583 4.79167C18.4583 4.37745 18.1225 4.04167 17.7083 4.04167V5.54167ZM8.87496 8.95833C8.87496 8.54412 8.53917 8.20833 8.12496 8.20833C7.71075 8.20833 7.37496 8.54412 7.37496 8.95833H8.87496ZM7.37496 13.5417C7.37496 13.9559 7.71075 14.2917 8.12496 14.2917C8.53917 14.2917 8.87496 13.9559 8.87496 13.5417H7.37496ZM12.625 8.95833C12.625 8.54412 12.2892 8.20833 11.875 8.20833C11.4607 8.20833 11.125 8.54412 11.125 8.95833H12.625ZM11.125 13.5417C11.125 13.9559 11.4607 14.2917 11.875 14.2917C12.2892 14.2917 12.625 13.9559 12.625 13.5417H11.125ZM12.502 4.97861C12.6052 5.37975 13.0141 5.62124 13.4152 5.518C13.8164 5.41475 14.0579 5.00586 13.9546 4.60472L12.502 4.97861ZM3.20985 4.83995L3.94258 16.1973L5.43947 16.1007L4.70674 4.74338L3.20985 4.83995ZM6.35423 18.4583H13.6457V16.9583H6.35423V18.4583ZM16.0573 16.1973L16.7901 4.83995L15.2932 4.74338L14.5605 16.1007L16.0573 16.1973ZM16.0416 4.04167H3.95829V5.54167H16.0416V4.04167ZM2.29163 5.54167H3.95829V4.04167H2.29163V5.54167ZM16.0416 5.54167H17.7083V4.04167H16.0416V5.54167ZM13.6457 18.4583C14.92 18.4583 15.9753 17.4689 16.0573 16.1973L14.5605 16.1007C14.5293 16.583 14.129 16.9583 13.6457 16.9583V18.4583ZM3.94258 16.1973C4.02462 17.4689 5.07995 18.4583 6.35423 18.4583V16.9583C5.87088 16.9583 5.47059 16.583 5.43947 16.1007L3.94258 16.1973ZM7.37496 8.95833V13.5417H8.87496V8.95833H7.37496ZM11.125 8.95833V13.5417H12.625V8.95833H11.125ZM9.99998 3.04167C11.2027 3.04167 12.2151 3.86424 12.502 4.97861L13.9546 4.60472C13.5014 2.84372 11.9037 1.54167 9.99998 1.54167V3.04167ZM7.49799 4.97861C7.7848 3.86424 8.79727 3.04167 9.99998 3.04167V1.54167C8.09628 1.54167 6.49858 2.84372 6.04533 4.60472L7.49799 4.97861Z",fill:"currentColor"})})),p=e=>(0,s.jsx)("svg",Object.assign({},e,{viewBox:"0 0 24 24",fill:"none",stroke:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M2.47032 11.1187L1.81869 10.7474H1.81869L2.47032 11.1187ZM21.5298 11.1188L22.1814 10.7475L22.1814 10.7475L21.5298 11.1188ZM2.47032 12.8811L1.81869 13.2524H1.81869L2.47032 12.8811ZM21.5298 12.8812L22.1814 13.2526L21.5298 12.8812ZM3.12194 11.49C5.43733 7.42677 8.76885 5.49998 12 5.5C15.2312 5.50002 18.5627 7.42687 20.8781 11.4901L22.1814 10.7475C19.6579 6.31907 15.8792 4.00003 12 4C8.12093 3.99997 4.34216 6.31895 1.81869 10.7474L3.12194 11.49ZM1.81869 13.2524C4.34216 17.6809 8.12092 19.9999 12 19.9999C15.8791 20 19.6579 17.681 22.1814 13.2526L20.8781 12.5099C18.5627 16.5732 15.2312 18.4999 12 18.4999C8.76886 18.4999 5.43733 16.5731 3.12194 12.5098L1.81869 13.2524ZM1.81869 10.7474C1.37619 11.5239 1.37619 12.4759 1.81869 13.2524L3.12194 12.5098C2.94177 12.1936 2.94177 11.8062 3.12194 11.49L1.81869 10.7474ZM20.8781 11.4901C21.0583 11.8063 21.0583 12.1937 20.8781 12.5099L22.1814 13.2526C22.6239 12.476 22.6239 11.524 22.1814 10.7475L20.8781 11.4901ZM14.5 12C14.5 13.3807 13.3807 14.5 12 14.5V16C14.2092 16 16 14.2091 16 12H14.5ZM12 14.5C10.6193 14.5 9.50004 13.3807 9.50004 12H8.00004C8.00004 14.2091 9.7909 16 12 16V14.5ZM9.50004 12C9.50004 10.6193 10.6193 9.5 12 9.5V8C9.7909 8 8.00004 9.79086 8.00004 12H9.50004ZM12 9.5C13.3807 9.5 14.5 10.6193 14.5 12H16C16 9.79086 14.2092 8 12 8V9.5Z",fill:"currentColor"})})),m=e=>(0,s.jsx)("svg",Object.assign({},e,{viewBox:"0 0 24 24",fill:"none",stroke:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M9.16548 4.42071C8.76885 4.5401 8.54409 4.95841 8.66347 5.35505C8.78285 5.75169 9.20117 5.97645 9.59781 5.85706L9.16548 4.42071ZM21.5291 11.1176L22.1807 10.7462V10.7462L21.5291 11.1176ZM19.1414 14.9666C18.8679 15.2776 18.8983 15.7515 19.2093 16.0251C19.5204 16.2986 19.9943 16.2682 20.2678 15.9571L19.1414 14.9666ZM21.5299 12.8811L20.8782 12.5098V12.5098L21.5299 12.8811ZM3.28041 2.21967C2.98752 1.92678 2.51265 1.92678 2.21975 2.21967C1.92686 2.51256 1.92686 2.98744 2.21975 3.28033L3.28041 2.21967ZM2.47028 11.1188L3.12192 11.4901H3.12192L2.47028 11.1188ZM20.7198 21.7803C21.0126 22.0732 21.4875 22.0732 21.7804 21.7803C22.0733 21.4874 22.0733 21.0126 21.7804 20.7197L20.7198 21.7803ZM2.47137 12.8829L1.81978 13.2543H1.81978L2.47137 12.8829ZM10.2323 10.2322C10.5252 9.93934 10.5252 9.46447 10.2323 9.17157C9.93942 8.87868 9.46455 8.87868 9.17166 9.17157L10.2323 10.2322ZM14.8285 14.8284C15.1214 14.5355 15.1214 14.0607 14.8285 13.7678C14.5356 13.4749 14.0607 13.4749 13.7679 13.7678L14.8285 14.8284ZM9.59781 5.85706C13.5395 4.67067 17.994 6.42962 20.8775 11.489L22.1807 10.7462C19.0296 5.21732 13.9175 2.99041 9.16548 4.42071L9.59781 5.85706ZM20.2678 15.9571C20.9623 15.1674 21.6044 14.2652 22.1815 13.2524L20.8782 12.5098C20.3483 13.4398 19.7645 14.258 19.1414 14.9666L20.2678 15.9571ZM20.8775 11.489C21.058 11.8057 21.0581 12.1942 20.8782 12.5098L22.1815 13.2524C22.6243 12.4754 22.623 11.5222 22.1807 10.7462L20.8775 11.489ZM2.21975 3.28033L5.99946 7.06003L7.06012 5.99937L3.28041 2.21967L2.21975 3.28033ZM3.12192 11.4901C4.21388 9.57384 5.53399 8.13258 6.95707 7.14609L6.1025 5.91332C4.47314 7.04281 3.00762 8.66097 1.81865 10.7475L3.12192 11.4901ZM5.99946 7.06003L16.94 18.0006L18.0007 16.9399L7.06012 5.99937L5.99946 7.06003ZM16.94 18.0006L20.7198 21.7803L21.7804 20.7197L18.0007 16.9399L16.94 18.0006ZM1.81978 13.2543C3.74776 16.6368 6.40554 18.7894 9.29542 19.6173C12.1919 20.4471 15.2482 19.9232 17.8976 18.0866L17.0431 16.8539C14.7436 18.4479 12.1497 18.8747 9.70852 18.1753C7.26078 17.4741 4.89352 15.6178 3.12295 12.5115L1.81978 13.2543ZM1.81865 10.7475C1.37569 11.5249 1.37764 12.4786 1.81978 13.2543L3.12295 12.5115C2.9423 12.1946 2.94222 11.8055 3.12192 11.4901L1.81865 10.7475ZM12.0001 14.5C10.6194 14.5 9.50008 13.3807 9.50008 12H8.00008C8.00008 14.2091 9.79094 16 12.0001 16V14.5ZM9.50008 12C9.50008 11.3094 9.77909 10.6855 10.2323 10.2322L9.17166 9.17157C8.44862 9.89461 8.00008 10.8956 8.00008 12H9.50008ZM13.7679 13.7678C13.3146 14.221 12.6906 14.5 12.0001 14.5V16C13.1044 16 14.1055 15.5515 14.8285 14.8284L13.7679 13.7678Z",fill:"currentColor"})})),g=e=>(0,s.jsxs)("svg",Object.assign({},e,{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("path",{d:"M10.75 11H12L12 16.25M21.25 12C21.25 17.1086 17.1086 21.25 12 21.25C6.89137 21.25 2.75 17.1086 2.75 12C2.75 6.89137 6.89137 2.75 12 2.75C17.1086 2.75 21.25 6.89137 21.25 12Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M12 7.375C11.6548 7.375 11.375 7.65482 11.375 8C11.375 8.34518 11.6548 8.625 12 8.625C12.3452 8.625 12.625 8.34518 12.625 8C12.625 7.65482 12.3452 7.375 12 7.375Z",fill:"currentColor",stroke:"currentColor",strokeWidth:"0.25"})]})),f=e=>(0,s.jsxs)("svg",Object.assign({},e,{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("path",{d:"M7.16665 7.33331H7.99998L7.99998 10.8333M14.1666 7.99998C14.1666 11.4057 11.4057 14.1666 7.99998 14.1666C4.59422 14.1666 1.83331 11.4057 1.83331 7.99998C1.83331 4.59422 4.59422 1.83331 7.99998 1.83331C11.4057 1.83331 14.1666 4.59422 14.1666 7.99998Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M7.99969 4.875C8.25272 4.875 8.4585 5.08003 8.45868 5.33301C8.45868 5.58614 8.25283 5.79199 7.99969 5.79199C7.74671 5.79182 7.54169 5.58603 7.54169 5.33301C7.54186 5.08014 7.74682 4.87518 7.99969 4.875Z",fill:"currentColor",stroke:"currentColor",strokeWidth:"0.25"})]})),x=e=>(0,s.jsx)("svg",Object.assign({},e,{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M12 6.75V12M12 12V17.25M12 12H6.75M12 12H17.25",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})),w=e=>(0,s.jsxs)("svg",Object.assign({},e,{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("path",{d:"M7.878 5.21415L7.17474 5.05186C6.58003 4.91462 5.95657 5.09343 5.525 5.525C5.09343 5.95657 4.91462 6.58003 5.05186 7.17474L5.21415 7.878C5.40122 8.6886 5.06696 9.53036 4.37477 9.99182L3.51965 10.5619C3.03881 10.8825 2.75 11.4221 2.75 12C2.75 12.5779 3.03881 13.1175 3.51965 13.4381L4.37477 14.0082C5.06696 14.4696 5.40122 15.3114 5.21415 16.122L5.05186 16.8253C4.91462 17.42 5.09343 18.0434 5.525 18.475C5.95657 18.9066 6.58003 19.0854 7.17474 18.9481L7.878 18.7858C8.6886 18.5988 9.53036 18.933 9.99182 19.6252L10.5619 20.4804C10.8825 20.9612 11.4221 21.25 12 21.25C12.5779 21.25 13.1175 20.9612 13.4381 20.4804L14.0082 19.6252C14.4696 18.933 15.3114 18.5988 16.122 18.7858L16.8253 18.9481C17.42 19.0854 18.0434 18.9066 18.475 18.475C18.9066 18.0434 19.0854 17.42 18.9481 16.8253L18.7858 16.122C18.5988 15.3114 18.933 14.4696 19.6252 14.0082L20.4804 13.4381C20.9612 13.1175 21.25 12.5779 21.25 12C21.25 11.4221 20.9612 10.8825 20.4804 10.5619L19.6252 9.99182C18.933 9.53036 18.5988 8.6886 18.7858 7.878L18.9481 7.17473C19.0854 6.58003 18.9066 5.95657 18.475 5.525C18.0434 5.09343 17.42 4.91462 16.8253 5.05186L16.122 5.21415C15.3114 5.40122 14.4696 5.06696 14.0082 4.37477L13.4381 3.51965C13.1175 3.03881 12.5779 2.75 12 2.75C11.4221 2.75 10.8825 3.03881 10.5619 3.51965L9.99182 4.37477C9.53036 5.06696 8.6886 5.40122 7.878 5.21415Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M14.75 12C14.75 13.5188 13.5188 14.75 12 14.75C10.4812 14.75 9.25 13.5188 9.25 12C9.25 10.4812 10.4812 9.25 12 9.25C13.5188 9.25 14.75 10.4812 14.75 12Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round"})]})),b=e=>(0,s.jsx)("svg",Object.assign({},e,{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:(0,s.jsx)("path",{d:"M9.99992 16.0417V9.79168M9.99992 9.79168L12.0833 11.875M9.99992 9.79168L7.91658 11.875M12.4999 16.0417H15.1041C17.0026 16.0417 18.5416 14.5027 18.5416 12.6042C18.5416 10.7057 17.0026 9.16668 15.1041 9.16668C15.0678 9.16668 15.0316 9.16724 14.9956 9.16836C14.9985 9.09871 14.9999 9.0287 14.9999 8.95834C14.9999 6.19692 12.7613 3.95834 9.99992 3.95834C7.80958 3.95834 5.94819 5.36675 5.27197 7.32735C3.12081 7.60284 1.45825 9.4406 1.45825 11.6667C1.45825 14.0829 3.41701 16.0417 5.83325 16.0417H7.49992",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})),v=e=>(0,s.jsxs)("svg",Object.assign({},e,{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("path",{d:"M10.5969 5.34936L6.83742 7.24974M6.83742 7.24974L3.07798 5.34936M6.83742 7.24974V11.0505M11.1752 7.24974V5.44227C11.1752 5.02717 10.9528 4.64388 10.5924 4.43793L7.41133 2.62018C7.0557 2.41697 6.61913 2.41697 6.26351 2.62018L3.08245 4.43793C2.72203 4.64388 2.4996 5.02717 2.4996 5.44227V9.0572C2.4996 9.47231 2.72203 9.85559 3.08244 10.0615L6.26351 11.8793C6.61913 12.0825 7.0557 12.0825 7.41133 11.8793L9.00186 10.9704",stroke:"currentColor",strokeWidth:"1.4",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M14.2234 16.0852C12.0818 16.0852 10.8584 15.0175 10.3386 14.2235C10.1728 13.9703 10.2002 13.6487 10.3486 13.3849L14.2234 6.49634L18.0727 13.3395C18.2354 13.6288 18.2487 13.9841 18.051 14.2508C17.5015 14.9917 16.29 16.0852 14.2234 16.0852Z",stroke:"currentColor",strokeWidth:"1.4"}),(0,s.jsx)("path",{d:"M15.3284 15.8334V17.7778C15.2358 17.926 14.8561 18.3334 14.0784 18.3334C13.3006 18.3334 12.921 17.963 12.8284 17.7778V15.8334",stroke:"currentColor",strokeWidth:"1.4"})]})),y=e=>(0,s.jsx)("svg",Object.assign({},e,{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:(0,s.jsx)("path",{d:"M7.60171 3.56423C7.20508 3.68361 6.98032 4.10193 7.0997 4.49857C7.21908 4.8952 7.6374 5.11996 8.03404 5.00058L7.60171 3.56423ZM17.9408 9.26467L18.5924 8.8933L18.5924 8.8933L17.9408 9.26467ZM15.8572 12.3896C15.5836 12.7006 15.614 13.1745 15.9251 13.4481C16.2361 13.7216 16.71 13.6912 16.9836 13.3802L15.8572 12.3896ZM17.9414 10.7343L17.2898 10.363L17.2898 10.363L17.9414 10.7343ZM2.8219 1.76133C2.52901 1.46844 2.05414 1.46844 1.76124 1.76133C1.46835 2.05423 1.46835 2.5291 1.76124 2.82199L2.8219 1.76133ZM2.05841 9.26568L2.71004 9.637L2.71004 9.637L2.05841 9.26568ZM17.1779 18.2387C17.4708 18.5316 17.9457 18.5316 18.2386 18.2387C18.5315 17.9458 18.5315 17.4709 18.2386 17.178L17.1779 18.2387ZM2.05931 10.7357L1.40773 11.1071L1.40773 11.1071L2.05931 10.7357ZM8.61516 8.61525C8.90805 8.32235 8.90805 7.84748 8.61516 7.55459C8.32226 7.26169 7.84739 7.26169 7.5545 7.55459L8.61516 8.61525ZM12.4453 12.4454C12.7382 12.1525 12.7382 11.6776 12.4453 11.3847C12.1524 11.0919 11.6776 11.0919 11.3847 11.3847L12.4453 12.4454ZM8.03404 5.00058C11.2512 4.03225 14.9085 5.45904 17.2892 9.63605L18.5924 8.8933C15.9441 4.24674 11.6293 2.35199 7.60171 3.56423L8.03404 5.00058ZM16.9836 13.3802C17.5682 12.7153 18.1082 11.9565 18.593 11.1056L17.2898 10.363C16.8521 11.131 16.3705 11.8059 15.8572 12.3896L16.9836 13.3802ZM17.2892 9.63605C17.4178 9.86169 17.4177 10.1384 17.2898 10.363L18.593 11.1056C18.984 10.4196 18.9827 9.57821 18.5924 8.8933L17.2892 9.63605ZM1.76124 2.82199L4.911 5.97175L5.97166 4.91109L2.8219 1.76133L1.76124 2.82199ZM2.71004 9.637C3.61192 8.05427 4.6999 6.86796 5.86861 6.0578L5.01404 4.82503C3.63905 5.7782 2.40566 7.1414 1.40678 8.89437L2.71004 9.637ZM4.911 5.97175L14.0281 15.0889L15.0888 14.0282L5.97166 4.91109L4.911 5.97175ZM14.0281 15.0889L17.1779 18.2387L18.2386 17.178L15.0888 14.0282L14.0281 15.0889ZM1.40773 11.1071C3.02749 13.9489 5.26652 15.7675 7.71159 16.4679C10.1632 17.1703 12.7487 16.7256 14.9857 15.1749L14.1312 13.9422C12.2441 15.2503 10.1211 15.5979 8.1247 15.0259C6.12175 14.4521 4.17325 12.9299 2.7109 10.3643L1.40773 11.1071ZM1.40678 8.89437C1.01571 9.58067 1.01748 10.4225 1.40773 11.1071L2.7109 10.3643C2.58215 10.1385 2.58223 9.8613 2.71004 9.637L1.40678 8.89437ZM9.99991 11.9583C8.91835 11.9583 8.04157 11.0816 8.04157 10H6.54157C6.54157 11.91 8.08992 13.4583 9.99991 13.4583V11.9583ZM8.04157 10C8.04157 9.45901 8.25995 8.97046 8.61516 8.61525L7.5545 7.55459C6.92948 8.1796 6.54157 9.04521 6.54157 10H8.04157ZM11.3847 11.3847C11.0294 11.74 10.5409 11.9583 9.99991 11.9583V13.4583C10.9547 13.4583 11.8203 13.0704 12.4453 12.4454L11.3847 11.3847Z",fill:"currentColor"})})),C=e=>(0,s.jsx)("svg",Object.assign({},e,{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M9.99999 13.125H15.3528C15.7442 13.125 16.0997 13.3534 16.2624 13.7095L17.0617 15.4595C17.3643 16.1218 16.8802 16.875 16.1521 16.875H9.99999M9.99999 13.125H4.64722C4.25575 13.125 3.90028 13.3534 3.73762 13.7095L2.93824 15.4595C2.63572 16.1218 3.11974 16.875 3.84784 16.875H9.99999M9.99999 13.125V16.875M9.99999 8.125V9.375M15.625 3.125H16.875M3.12499 3.125H4.37499M6.24999 6.66667L5.41666 7.5M13.75 6.66667L14.5833 7.5M7.36413 3.125C7.64628 4.31946 8.71933 5.20833 9.99999 5.20833C11.2806 5.20833 12.3537 4.31946 12.6359 3.125",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})),M=e=>(0,s.jsxs)("svg",Object.assign({},e,{width:"37",height:"34",viewBox:"0 0 37 34",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("path",{d:"M18.4999 24.2727H31.8102C32.2017 24.2727 32.5571 24.5012 32.7198 24.8572L35.7928 31.5845C36.0953 32.2468 35.6112 33 34.8832 33H18.4999M18.4999 24.2727H5.18968C4.79821 24.2727 4.44274 24.5012 4.28008 24.8572L1.20713 31.5845C0.904613 32.2468 1.38863 33 2.11673 33H18.4999M18.4999 24.2727V33M18.4999 12.6364V15.5455M31.5909 1H34.4999M2.49994 1H5.40903M9.77267 9.24242L7.83327 11.1818M27.2272 9.24242L29.1666 11.1818M12.3656 1C13.0222 3.77983 15.5195 5.84848 18.4999 5.84848C21.4804 5.84848 23.9777 3.77983 24.6343 1",stroke:"url(#paint0_linear_3698_16469)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("defs",{children:(0,s.jsxs)("linearGradient",{id:"paint0_linear_3698_16469",x1:"38.7393",y1:"0.999999",x2:"1.08605",y2:"20.2501",gradientUnits:"userSpaceOnUse",children:[(0,s.jsx)("stop",{stopColor:"#F8F991"}),(0,s.jsx)("stop",{offset:"1",stopColor:"#FFCD00"})]})})]})),S=e=>(0,s.jsx)("svg",Object.assign({},e,{width:"17",height:"16",viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M13.8332 6L9.44266 10.3905C8.92196 10.9112 8.07774 10.9112 7.55704 10.3905L3.1665 6",stroke:"black",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})),L=e=>(0,s.jsxs)("svg",Object.assign({},e,{width:"115",height:"25",viewBox:"0 0 115 25",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("path",{d:"M13.3413 7.4821V3.125L10.9207 3.125V7.4821L13.3413 7.4821Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M13.3413 22.4899V18.1328H10.9207V22.4899H13.3413Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M10.8047 3.15057L10.1782 0.8125L7.84015 1.43895L8.46661 3.77703L10.8047 3.15057Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M16.4224 24.174L15.7959 21.8359L13.4578 22.4624L14.0843 24.8005L16.4224 24.174Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M10.5067 7.59747L8.32812 3.82422L6.23187 5.03453L8.41043 8.80778L10.5067 7.59747Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M18.0311 20.5818L15.8525 16.8086L13.7563 18.0189L15.9348 21.7922L18.0311 20.5818Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M8.13409 9.10433L4.36084 6.92578L3.15053 9.02203L6.92378 11.2006L8.13409 9.10433Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M21.1111 16.5965L17.3379 14.418L16.1276 16.5142L19.9008 18.6928L21.1111 16.5965Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M6.80583 11.5977H2.44873V14.0183H6.80583V11.5977Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M21.8136 11.5977H17.4565V14.0183H21.8136V11.5977Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M6.92364 14.4152L3.15039 16.5938L4.3607 18.69L8.13395 16.5114L6.92364 14.4152Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M19.9012 6.92301L16.1279 9.10156L17.3382 11.1978L21.1115 9.01926L19.9012 6.92301Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M8.41 16.8088L6.23145 20.582L8.3277 21.7923L10.5062 18.0191L8.41 16.8088Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M15.9339 3.8244L13.7554 7.59766L15.8516 8.80796L18.0302 5.03471L15.9339 3.8244Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M6.14033 5.11396L4.42871 3.40234L2.7171 5.11396L4.42871 6.82558L6.14033 5.11396Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M21.5451 20.5046L19.8335 18.793L18.1219 20.5046L19.8335 22.2162L21.5451 20.5046Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M3.08123 9.14208L0.743164 8.51562L0.11671 10.8537L2.45478 11.4802L3.08123 9.14208Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M24.1457 14.7632L21.8076 14.1367L21.1812 16.4748L23.5192 17.1012L24.1457 14.7632Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M2.45428 14.1353L0.116211 14.7617L0.742665 17.0998L3.08074 16.4733L2.45428 14.1353Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M23.5187 8.51417L21.1807 9.14062L21.8071 11.4787L24.1452 10.8522L23.5187 8.51417Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M2.45428 14.1353L0.116211 14.7617L0.742665 17.0998L3.08074 16.4733L2.45428 14.1353Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M23.5187 8.51417L21.1807 9.14062L21.8071 11.4787L24.1452 10.8522L23.5187 8.51417Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M2.45428 14.1353L0.116211 14.7617L0.742665 17.0998L3.08074 16.4733L2.45428 14.1353Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M23.5187 8.51417L21.1807 9.14062L21.8071 11.4787L24.1452 10.8522L23.5187 8.51417Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M4.42841 18.7923L2.7168 20.5039L4.42841 22.2155L6.14003 20.5039L4.42841 18.7923Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M19.8332 3.40167L18.1216 5.11328L19.8332 6.8249L21.5448 5.11328L19.8332 3.40167Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M8.46581 21.8377L7.83936 24.1758L10.1774 24.8022L10.8039 22.4642L8.46581 21.8377Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M14.0835 0.814273L13.457 3.15234L15.7951 3.7788L16.4216 1.44073L14.0835 0.814273Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M28.5913 14.914L30.0921 14.1394C30.431 14.8414 31.0119 15.2045 31.8591 15.2045C32.6821 15.2045 33.0452 14.914 33.0452 14.4783C33.0452 13.0744 28.9302 13.8248 28.9302 11.1379C28.9302 9.68552 30.1889 8.88672 31.7865 8.88672C32.9726 8.88672 34.0619 9.39505 34.6428 10.4117L33.1663 11.1863C32.8758 10.6296 32.3675 10.3633 31.7139 10.3633C31.0361 10.3633 30.673 10.6054 30.673 11.0653C30.673 12.3966 34.7881 11.622 34.7881 14.4057C34.7881 15.8097 33.6504 16.6569 31.8349 16.6569C30.2857 16.6569 29.1723 16.1486 28.5913 14.914Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M36.0952 5.88672H37.7896V10.0986C38.298 9.22716 39.1694 8.91249 40.1134 8.91249C41.8079 8.91249 43.0182 9.97756 43.0182 11.8414V16.5374H41.2753V12.4224C41.2753 11.2121 40.646 10.5343 39.6293 10.5343C38.6611 10.5343 37.8139 11.1394 37.8139 12.4466V16.5132H36.0952V5.88672Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M44.2529 12.8081C44.2529 10.4843 46.1168 8.88672 47.9081 8.88672C49.1426 8.88672 49.9172 9.32243 50.4013 10.1212V9.03196H52.0957V16.5117H50.3771V15.5434C49.8688 16.2454 49.0942 16.6569 47.9323 16.6569C46.141 16.6569 44.2529 15.1319 44.2529 12.8081ZM50.4981 12.7839C50.4981 11.501 49.4815 10.5085 48.1985 10.5085C46.9398 10.5085 45.9232 11.5252 45.9232 12.8081C45.9232 13.9942 46.9398 15.0351 48.1985 15.0351C49.4815 15.0351 50.4981 14.0184 50.4981 12.7839Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M53.4268 12.8339C53.4268 10.7037 55.0728 8.91249 57.2755 8.91249C58.0501 8.91249 59.1394 9.17875 59.6719 10.0744V5.88672H61.3664V16.5132H59.6719V15.6902C59.0668 16.2711 58.2438 16.6584 57.2997 16.6584C55.1212 16.6584 53.4268 14.9156 53.4268 12.8339ZM59.6477 12.8339C59.6477 11.4783 58.6311 10.5101 57.3481 10.5101C56.0652 10.5101 55.0728 11.5994 55.0728 12.8339C55.0728 13.9716 56.0894 15.0366 57.3481 15.0366C58.6311 15.0366 59.6477 14.0926 59.6477 12.8339Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M62.625 12.7597C62.625 10.6296 64.3678 8.88672 66.5706 8.88672C68.7734 8.88672 70.5404 10.6296 70.5404 12.7597C70.5404 14.8898 68.7734 16.6569 66.5706 16.6569C64.392 16.6569 62.625 14.8898 62.625 12.7597ZM68.8702 12.7597C68.8702 11.5736 67.8535 10.5085 66.5706 10.5085C65.2877 10.5085 64.271 11.5736 64.271 12.7597C64.271 13.97 65.2877 15.0351 66.5706 15.0351C67.8535 15.0351 68.8702 13.97 68.8702 12.7597Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M70.686 9.03516H72.5741L74.2685 14.2879L76.1566 9.03516H77.6574L79.5213 14.2879L81.2399 9.03516H83.128L80.4169 16.5149H78.7225L76.907 11.3832L75.14 16.5149H73.3729L70.686 9.03516Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M84.0234 9.03196H85.7179V10.097C86.2504 9.2256 87.0734 8.88672 87.9206 8.88672C89.0583 8.88672 89.8813 9.37084 90.2928 10.1696C90.9464 9.10457 91.963 8.88672 92.8345 8.88672C94.6015 8.88672 95.594 10.0728 95.594 11.7672V16.5117H93.8511V12.3966C93.8511 11.1863 93.3186 10.5085 92.3019 10.5085C91.2853 10.5085 90.6801 11.1863 90.6801 12.4208V16.4874H88.9373V12.3724C88.9373 11.1621 88.3805 10.4843 87.3639 10.4843C86.2988 10.4843 85.7663 11.2589 85.7663 12.4692V16.4874H84.0234V9.03196Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M96.8525 12.8081C96.8525 10.4843 98.7164 8.88672 100.508 8.88672C101.742 8.88672 102.517 9.32243 103.001 10.1212V9.03196H104.695V16.5117H102.952V15.5434C102.444 16.2454 101.67 16.6569 100.508 16.6569C98.7406 16.6569 96.8525 15.1319 96.8525 12.8081ZM103.074 12.7839C103.074 11.501 102.057 10.5085 100.774 10.5085C99.5152 10.5085 98.4986 11.5252 98.4986 12.8081C98.4986 13.9942 99.5152 15.0351 100.774 15.0351C102.057 15.0351 103.074 14.0184 103.074 12.7839Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M106.487 9.03509H108.181V10.0517C108.714 9.18033 109.803 8.91406 110.553 8.91406C112.732 8.91406 114.402 10.7053 114.402 12.8355C114.402 14.9172 112.683 16.66 110.505 16.66C109.416 16.66 108.738 16.2485 108.157 15.6434V19.9763H106.462V9.03509H106.487ZM112.756 12.8355C112.756 11.6009 111.764 10.5117 110.481 10.5117C109.198 10.5117 108.181 11.4799 108.181 12.8355C108.181 14.1184 109.198 15.0382 110.481 15.0382C111.764 15.0382 112.756 13.9731 112.756 12.8355Z",fill:"currentColor"})]})),T=e=>(0,s.jsxs)("svg",Object.assign({},e,{width:"16",height:"17",viewBox:"0 0 16 17",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("path",{d:"M7.16665 7.83325H7.99998L7.99998 11.3333M14.1666 8.49992C14.1666 11.9057 11.4057 14.6666 7.99998 14.6666C4.59422 14.6666 1.83331 11.9057 1.83331 8.49992C1.83331 5.09416 4.59422 2.33325 7.99998 2.33325C11.4057 2.33325 14.1666 5.09416 14.1666 8.49992Z",stroke:"#C1EBE9",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M7.99969 5.375C8.25272 5.375 8.4585 5.58003 8.45868 5.83301C8.45868 6.08614 8.25283 6.29199 7.99969 6.29199C7.74671 6.29182 7.54169 6.08603 7.54169 5.83301C7.54186 5.58014 7.74682 5.37518 7.99969 5.375Z",fill:"#C1EBE9",stroke:"#C1EBE9",strokeWidth:"0.25"})]})),j=e=>(0,s.jsx)("svg",Object.assign({},e,{width:"16",height:"17",viewBox:"0 0 16 17",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M8 2C9.72391 2 11.3772 2.68482 12.5962 3.90381C13.8152 5.12279 14.5 6.77609 14.5 8.5C14.5 10.2239 13.8152 11.8772 12.5962 13.0962C11.3772 14.3152 9.72391 15 8 15C6.27609 15 4.62279 14.3152 3.40381 13.0962C2.18482 11.8772 1.5 10.2239 1.5 8.5C1.5 6.77609 2.18482 5.12279 3.40381 3.90381C4.62279 2.68482 6.27609 2 8 2ZM8 16.5C10.1217 16.5 12.1566 15.6571 13.6569 14.1569C15.1571 12.6566 16 10.6217 16 8.5C16 6.37827 15.1571 4.34344 13.6569 2.84315C12.1566 1.34285 10.1217 0.5 8 0.5C5.87827 0.5 3.84344 1.34285 2.34315 2.84315C0.842855 4.34344 0 6.37827 0 8.5C0 10.6217 0.842855 12.6566 2.34315 14.1569C3.84344 15.6571 5.87827 16.5 8 16.5ZM6.75 11C6.33437 11 6 11.3344 6 11.75C6 12.1656 6.33437 12.5 6.75 12.5H9.25C9.66563 12.5 10 12.1656 10 11.75C10 11.3344 9.66563 11 9.25 11H9V8.25C9 7.83437 8.66563 7.5 8.25 7.5H6.75C6.33437 7.5 6 7.83437 6 8.25C6 8.66563 6.33437 9 6.75 9H7.5V11H6.75ZM8 6.5C8.26522 6.5 8.51957 6.39464 8.70711 6.20711C8.89464 6.01957 9 5.76522 9 5.5C9 5.23478 8.89464 4.98043 8.70711 4.79289C8.51957 4.60536 8.26522 4.5 8 4.5C7.73478 4.5 7.48043 4.60536 7.29289 4.79289C7.10536 4.98043 7 5.23478 7 5.5C7 5.76522 7.10536 6.01957 7.29289 6.20711C7.48043 6.39464 7.73478 6.5 8 6.5Z",fill:"#41A6A0"})})),P=e=>(0,s.jsx)("svg",Object.assign({},e,{version:"1.1",id:"Ebene_1",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",width:"54.027px",height:"54.027px",viewBox:"0 0 54.027 54.027",enableBackground:"new 0 0 54.027 54.027",fill:"currentColor",children:(0,s.jsx)("rect",{x:"1.513",y:"23.513",width:"51.125",height:"6.9"})})),E=e=>(0,s.jsxs)("svg",Object.assign({},e,{version:"1.1",id:"Ebene_1",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",width:"54.027px",height:"54.027px",viewBox:"0 0 54.027 54.027",enableBackground:"new 0 0 54.027 54.027",fill:"currentColor",children:[(0,s.jsx)("rect",{x:"1.513",y:"23.513",width:"51.125",height:"6.899"}),(0,s.jsx)("rect",{x:"23.626",y:"1.401",width:"6.899",height:"51.125"})]})),A=e=>(0,s.jsxs)("svg",Object.assign({},e,{width:"512",height:"512",viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("rect",{width:"512",height:"512",rx:"150",fill:"#5FC9F6"}),(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M241.718 112.614L234.877 87.04L209.345 93.8921L216.186 119.466L241.718 112.614ZM269.419 112.337V159.995H242.986V112.337H269.419ZM269.419 276.491V324.148H242.986V276.491H269.419ZM296.222 317.008L303.063 342.582L277.531 349.434L270.69 323.86L296.222 317.008ZM238.466 161.238L214.676 119.967L191.785 133.205L215.575 174.476L238.466 161.238ZM296.838 262.002L320.628 303.273L297.737 316.511L273.947 275.24L296.838 262.002ZM212.555 177.714L171.351 153.885L158.135 176.814L199.339 200.642L212.555 177.714ZM313.064 235.836L354.268 259.665L341.051 282.593L299.847 258.764L313.064 235.836ZM198.05 205.005H150.47V231.481H198.05V205.005ZM314.356 205.005H361.936V231.481H314.356V205.005ZM199.339 235.835L158.135 259.664L171.352 282.593L212.556 258.764L199.339 235.835ZM299.848 177.714L341.052 153.885L354.268 176.814L313.064 200.642L299.848 177.714ZM215.571 262.008L191.781 303.28L214.672 316.518L238.462 275.247L215.571 262.008ZM273.939 161.245L297.729 119.974L320.62 133.212L296.831 174.483L273.939 161.245ZM190.786 134.069L172.095 115.347L153.404 134.069L172.095 152.79L190.786 134.069ZM340.315 283.691L359.005 302.412L340.315 321.134L321.624 302.412L340.315 283.691ZM157.377 178.139L131.846 171.287L125.005 196.861L150.536 203.713L157.377 178.139ZM361.868 232.76L387.4 239.612L380.559 265.186L355.028 258.334L361.868 232.76ZM150.532 232.766L125 239.618L131.841 265.191L157.373 258.339L150.532 232.766ZM355.023 178.145L380.555 171.292L387.396 196.866L361.864 203.718L355.023 178.145ZM172.091 283.693L153.4 302.414L172.091 321.135L190.782 302.414L172.091 283.693ZM321.621 134.07L340.312 115.349L359.003 134.07L340.312 152.792L321.621 134.07ZM216.179 317.014L209.338 342.588L234.87 349.44L241.711 323.866L216.179 317.014ZM270.683 112.621L277.524 87.0471L303.056 93.8992L296.215 119.473L270.683 112.621Z",fill:"black"}),(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M247.391 428.288H238.595V368.542H247.391V428.288ZM255.319 407.792C255.319 420.239 265.194 429.45 277.309 429.45C289.507 429.45 299.299 420.239 299.299 407.792C299.299 395.261 289.507 386.134 277.309 386.134C265.194 386.134 255.319 395.261 255.319 407.792ZM290.503 407.792C290.503 415.924 284.694 421.401 277.309 421.401C270.007 421.401 264.115 415.924 264.115 407.792C264.115 399.659 270.007 394.183 277.309 394.183C284.694 394.183 290.503 399.659 290.503 407.792ZM316.029 428.288H307.233V387.295H316.029V392.274C318.767 388.208 323.082 386.134 327.148 386.134C329.887 386.134 331.878 386.797 333.621 388.042L334.202 397.17H333.04C331.214 395.178 328.725 394.183 325.986 394.183C321.091 394.183 316.029 397.336 316.029 405.385V428.288ZM337.166 407.626C337.166 419.907 346.542 429.45 359.238 429.45C364.715 429.45 370.026 427.873 375.005 424.554L375.337 415.758H374.424C369.362 420.322 364.715 421.815 359.57 421.815C352.6 421.815 346.791 417.749 345.713 410.115H378.241V406.796C378.241 395.178 370.524 386.134 358.243 386.134C346.376 386.134 337.166 395.427 337.166 407.626ZM369.777 403.643H346.044C347.455 396.838 352.6 393.436 357.994 393.436C364.383 393.436 369.03 397.419 369.777 403.643ZM386.486 428.288H395.282V405.385C395.282 397.336 400.344 394.183 405.24 394.183C407.978 394.183 410.468 395.178 412.293 397.17H413.455L412.874 388.042C411.132 386.797 409.14 386.134 406.402 386.134C402.336 386.134 398.021 388.208 395.282 392.274V387.295H386.486V428.288ZM187.056 447.042H195.852V423.309C198.839 426.96 203.818 429.45 210.125 429.45C221.327 429.45 230.621 421.069 230.621 407.792C230.621 395.013 221.742 386.134 210.042 386.134C203.652 386.134 198.922 389.038 195.852 392.523V387.295H187.056V447.042ZM221.825 407.792C221.825 415.343 216.348 421.401 208.631 421.401C200.914 421.401 195.437 415.343 195.437 407.792C195.437 400.157 200.914 394.183 208.631 394.183C216.348 394.183 221.825 400.157 221.825 407.792ZM153.173 428.288H143.381L156.907 407.045L144.377 387.295H154.168L161.886 400.157L169.603 387.295H179.312L167.03 406.962L180.224 428.288H170.516L161.803 414.015L153.173 428.288ZM99 407.626C99 419.907 108.377 429.45 121.073 429.45C126.55 429.45 131.861 427.873 136.839 424.554L137.171 415.758H136.259C131.197 420.322 126.55 421.815 121.405 421.815C114.434 421.815 108.626 417.749 107.547 410.115H140.076V406.796C140.076 395.178 132.358 386.134 120.077 386.134C108.211 386.134 99 395.427 99 407.626ZM131.612 403.643H107.879C109.29 396.838 114.434 393.436 119.828 393.436C126.218 393.436 130.865 397.419 131.612 403.643Z",fill:"black"})]})),D=e=>(0,s.jsxs)("svg",Object.assign({},e,{width:"512",height:"512",viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("rect",{width:"512",height:"512",rx:"150",fill:"#44FA8D"}),(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M241.718 112.614L234.877 87.04L209.346 93.8921L216.186 119.466L241.718 112.614ZM269.419 112.337V159.995H242.986V112.337H269.419ZM269.419 276.491V324.148H242.986V276.491H269.419ZM296.222 317.008L303.063 342.582L277.531 349.434L270.69 323.86L296.222 317.008ZM238.467 161.238L214.677 119.967L191.786 133.205L215.576 174.476L238.467 161.238ZM296.838 262.002L320.628 303.273L297.737 316.511L273.947 275.24L296.838 262.002ZM212.555 177.714L171.351 153.885L158.135 176.814L199.339 200.642L212.555 177.714ZM313.063 235.836L354.267 259.665L341.05 282.593L299.846 258.764L313.063 235.836ZM198.05 205.005H150.47V231.481H198.05V205.005ZM314.355 205.005H361.935V231.481H314.355V205.005ZM199.339 235.835L158.135 259.664L171.352 282.593L212.556 258.764L199.339 235.835ZM299.847 177.714L341.051 153.885L354.267 176.814L313.063 200.642L299.847 177.714ZM215.57 262.008L191.78 303.28L214.671 316.518L238.461 275.247L215.57 262.008ZM273.938 161.245L297.728 119.974L320.619 133.212L296.83 174.483L273.938 161.245ZM190.786 134.069L172.095 115.347L153.404 134.069L172.095 152.79L190.786 134.069ZM340.315 283.691L359.005 302.412L340.315 321.134L321.624 302.412L340.315 283.691ZM157.377 178.139L131.846 171.287L125.005 196.861L150.536 203.713L157.377 178.139ZM361.868 232.76L387.4 239.612L380.559 265.186L355.028 258.334L361.868 232.76ZM150.532 232.766L125 239.618L131.841 265.191L157.373 258.339L150.532 232.766ZM355.023 178.145L380.555 171.292L387.396 196.866L361.864 203.718L355.023 178.145ZM172.092 283.693L153.401 302.414L172.092 321.135L190.783 302.414L172.092 283.693ZM321.621 134.07L340.312 115.349L359.003 134.07L340.312 152.792L321.621 134.07ZM216.179 317.014L209.338 342.588L234.87 349.44L241.711 323.866L216.179 317.014ZM270.683 112.621L277.524 87.0471L303.056 93.8992L296.215 119.473L270.683 112.621Z",fill:"black"}),(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M154 428.288H162.796V406.298C162.796 399.078 168.024 394.183 173.998 394.183C179.309 394.183 183.043 397.253 183.043 403.062V428.288H191.839V400.406C191.839 391.195 185.782 386.134 176.986 386.134C171.426 386.134 165.7 388.955 162.796 392.938V368.542H154V428.288ZM221.32 429.45C209.205 429.45 199.33 420.239 199.33 407.792C199.33 395.261 209.205 386.134 221.32 386.134C233.518 386.134 243.31 395.261 243.31 407.792C243.31 420.239 233.518 429.45 221.32 429.45ZM221.32 421.401C228.705 421.401 234.514 415.924 234.514 407.792C234.514 399.659 228.705 394.183 221.32 394.183C214.018 394.183 208.126 399.659 208.126 407.792C208.126 415.924 214.018 421.401 221.32 421.401ZM251.243 428.288H260.039V405.385C260.039 398.498 263.94 394.183 269.001 394.183C273.233 394.183 276.221 396.589 276.221 401.817V428.288H285.017V404.141C285.017 398.166 289 394.183 293.813 394.183C298.211 394.183 300.949 396.755 300.949 401.817V428.288H309.745V399.162C309.745 391.112 305.181 386.134 297.049 386.134C291.572 386.134 286.759 388.54 283.689 392.357C281.615 388.042 277.549 386.134 272.404 386.134C267.425 386.134 262.612 388.623 260.039 392.357V387.295H251.243V428.288ZM317.237 407.626C317.237 419.907 326.614 429.45 339.31 429.45C344.787 429.45 350.098 427.873 355.077 424.554L355.409 415.758H354.496C349.434 420.322 344.787 421.815 339.642 421.815C332.672 421.815 326.863 417.749 325.785 410.115H358.313V406.796C358.313 395.178 350.596 386.134 338.315 386.134C326.448 386.134 317.237 395.427 317.237 407.626ZM349.849 403.643H326.116C327.527 396.838 332.672 393.436 338.066 393.436C344.455 393.436 349.102 397.419 349.849 403.643Z",fill:"black"})]})),O=e=>(0,s.jsxs)("svg",Object.assign({},e,{width:"512",height:"512",viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsxs)("g",{clipPath:"url(#clip0_2260_1204)",children:[(0,s.jsx)("path",{d:"M511.999 0H0V512H511.999V0Z",fill:"url(#paint0_radial_2260_1204)"}),(0,s.jsx)("path",{d:"M488.887 0H23.1118C10.3475 0 0 10.3475 0 23.1118V488.888C0 501.652 10.3475 512 23.1118 512H488.887C501.652 512 511.999 501.652 511.999 488.888V23.1118C511.999 10.3475 501.652 0 488.887 0Z",fill:"#FF7042"}),(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M241.718 112.614L234.877 87.04L209.346 93.8921L216.186 119.466L241.718 112.614ZM269.419 112.337V159.995H242.986V112.337H269.419ZM269.419 276.491V324.148H242.986V276.491H269.419ZM296.222 317.008L303.063 342.582L277.531 349.434L270.69 323.86L296.222 317.008ZM238.467 161.238L214.677 119.966L191.786 133.204L215.576 174.476L238.467 161.238ZM296.838 262.002L320.628 303.273L297.737 316.511L273.947 275.24L296.838 262.002ZM212.555 177.714L171.351 153.885L158.135 176.814L199.339 200.642L212.555 177.714ZM313.063 235.836L354.267 259.665L341.05 282.593L299.846 258.764L313.063 235.836ZM198.05 205.005H150.47V231.481H198.05V205.005ZM314.355 205.005H361.935V231.481H314.355V205.005ZM199.339 235.835L158.135 259.664L171.352 282.593L212.556 258.764L199.339 235.835ZM299.847 177.714L341.051 153.885L354.268 176.814L313.064 200.642L299.847 177.714ZM215.57 262.008L191.78 303.279L214.671 316.517L238.461 275.246L215.57 262.008ZM273.939 161.245L297.728 119.974L320.62 133.212L296.83 174.483L273.939 161.245ZM190.786 134.069L172.095 115.347L153.404 134.069L172.095 152.79L190.786 134.069ZM340.315 283.691L359.006 302.412L340.315 321.134L321.624 302.412L340.315 283.691ZM157.377 178.139L131.846 171.287L125.005 196.861L150.536 203.713L157.377 178.139ZM361.869 232.76L387.4 239.612L380.56 265.186L355.028 258.334L361.869 232.76ZM150.532 232.766L125 239.618L131.841 265.191L157.373 258.339L150.532 232.766ZM355.023 178.145L380.555 171.292L387.396 196.866L361.864 203.718L355.023 178.145ZM172.092 283.693L153.401 302.414L172.092 321.135L190.783 302.414L172.092 283.693ZM321.621 134.07L340.312 115.349L359.003 134.07L340.312 152.792L321.621 134.07ZM216.179 317.014L209.338 342.588L234.87 349.44L241.711 323.866L216.179 317.014ZM270.683 112.621L277.524 87.0471L303.056 93.8992L296.215 119.473L270.683 112.621Z",fill:"black"}),(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M276.76 429.45C265.06 429.45 256.098 420.322 256.098 407.792C256.098 394.681 265.392 386.133 277.092 386.133C283.067 386.133 287.962 388.457 290.867 391.942V368.542H299.663V428.288H290.867V423.309C287.713 426.877 283.15 429.45 276.76 429.45ZM278.088 421.4C286.054 421.4 291.282 415.343 291.282 407.792C291.282 400.157 286.054 394.183 278.088 394.183C270.121 394.183 264.894 400.157 264.894 407.792C264.894 415.343 270.121 421.4 278.088 421.4ZM308.467 374.848C308.467 378.002 311.039 380.574 314.192 380.574C317.346 380.574 320.001 378.002 320.001 374.848C320.001 371.612 317.346 369.04 314.192 369.04C311.039 369.04 308.467 371.612 308.467 374.848ZM309.794 428.288H318.59V387.295H309.794V428.288ZM326.518 407.792C326.518 420.239 336.392 429.45 348.508 429.45C360.706 429.45 370.498 420.239 370.498 407.792C370.498 395.262 360.706 386.134 348.508 386.134C336.392 386.134 326.518 395.262 326.518 407.792ZM361.702 407.792C361.702 415.924 355.893 421.401 348.508 421.401C341.205 421.401 335.314 415.924 335.314 407.792C335.314 399.66 341.205 394.183 348.508 394.183C355.893 394.183 361.702 399.66 361.702 407.792ZM210.918 415.177C210.918 424.388 216.893 429.45 225.44 429.45C231.082 429.45 236.393 426.628 239.298 422.645V428.288H248.093V387.295H239.298V409.285C239.298 416.505 234.568 421.401 228.593 421.401C223.365 421.401 219.714 418.33 219.714 412.522V387.295H210.918V415.177ZM194.592 429.45C188.119 429.45 182.891 425.383 182.891 416.919V394.929H175.506V387.295H182.891V379.993L191.687 375.927V387.295H203.056V394.929H191.687V416.753C191.687 420.405 194.094 421.815 196.583 421.815C198.326 421.815 200.151 421.4 202.807 419.409H203.802L203.139 427.375C199.985 428.952 198.243 429.45 194.592 429.45ZM142 425.384C145.651 427.79 150.298 429.45 156.19 429.45C164.322 429.45 171.458 424.554 171.458 416.422C171.458 409.368 166.728 406.63 160.173 404.39C154.281 402.315 151.377 400.821 151.377 397.668C151.377 395.013 154.115 393.685 157.434 393.685C161.667 393.685 164.82 395.013 168.222 397.502H168.803L168.471 389.038C165.484 387.213 162.164 386.134 157.517 386.134C149.053 386.134 143.162 391.113 143.162 398C143.162 404.224 147.809 407.875 153.866 409.949C159.758 411.941 162.662 413.269 162.662 416.588C162.662 419.575 160.007 421.401 155.941 421.401C151.46 421.401 147.809 419.575 144.572 417.086H144.075L142 425.384Z",fill:"black"})]}),(0,s.jsxs)("defs",{children:[(0,s.jsxs)("radialGradient",{id:"paint0_radial_2260_1204",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(162.279 67.7938) rotate(50.3369) scale(297.666 297.666)",children:[(0,s.jsx)("stop",{stopColor:"#F3F3C6"}),(0,s.jsx)("stop",{offset:"1",stopColor:"#F5F76E"})]}),(0,s.jsx)("clipPath",{id:"clip0_2260_1204",children:(0,s.jsx)("rect",{width:"512",height:"512",rx:"150",fill:"white"})})]})]})),k=e=>(0,s.jsxs)("svg",Object.assign({},e,{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("path",{d:"M13.675 4.317C13.249 2.561 10.751 2.561 10.325 4.317C10.049 5.452 8.749 5.99 7.753 5.382C6.209 4.442 4.443 6.209 5.383 7.752C5.5243 7.98375 5.60889 8.24559 5.62987 8.51621C5.65085 8.78683 5.60764 9.05859 5.50375 9.30935C5.39985 9.56011 5.23822 9.7828 5.032 9.95929C4.82578 10.1358 4.5808 10.2611 4.317 10.325C2.561 10.751 2.561 13.249 4.317 13.675C4.58056 13.7391 4.82529 13.8645 5.03127 14.0409C5.23726 14.2174 5.3987 14.44 5.50247 14.6906C5.60624 14.9412 5.64942 15.2128 5.62848 15.4832C5.60755 15.7537 5.5231 16.0153 5.382 16.247C4.442 17.791 6.209 19.557 7.752 18.617C7.98375 18.4757 8.24559 18.3911 8.51621 18.3701C8.78683 18.3491 9.05859 18.3924 9.30935 18.4963C9.56011 18.6001 9.7828 18.7618 9.95929 18.968C10.1358 19.1742 10.2611 19.4192 10.325 19.683C10.751 21.439 13.249 21.439 13.675 19.683C13.7391 19.4194 13.8645 19.1747 14.0409 18.9687C14.2174 18.7627 14.44 18.6013 14.6906 18.4975C14.9412 18.3938 15.2128 18.3506 15.4832 18.3715C15.7537 18.3924 16.0153 18.4769 16.247 18.618C17.791 19.558 19.557 17.791 18.617 16.248C18.4757 16.0162 18.3911 15.7544 18.3701 15.4838C18.3491 15.2132 18.3924 14.9414 18.4963 14.6907C18.6001 14.4399 18.7618 14.2172 18.968 14.0407C19.1742 13.8642 19.4192 13.7389 19.683 13.675C21.439 13.249 21.439 10.751 19.683 10.325C19.4194 10.2609 19.1747 10.1355 18.9687 9.95905C18.7627 9.78258 18.6013 9.55999 18.4975 9.30938C18.3938 9.05877 18.3506 8.78721 18.3715 8.51677C18.3924 8.24634 18.4769 7.98466 18.618 7.753C19.558 6.209 17.791 4.443 16.248 5.383C16.0162 5.5243 15.7544 5.60889 15.4838 5.62987C15.2132 5.65085 14.9414 5.60764 14.6907 5.50375C14.4399 5.39985 14.2172 5.23822 14.0407 5.032C13.8642 4.82578 13.7389 4.5808 13.675 4.317Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M14.1213 14.1213C14.6839 13.5587 15 12.7956 15 12C15 11.2044 14.6839 10.4413 14.1213 9.87868C13.5587 9.31607 12.7956 9 12 9C11.2044 9 10.4413 9.31607 9.87868 9.87868C9.31607 10.4413 9 11.2044 9 12C9 12.7956 9.31607 13.5587 9.87868 14.1213C10.4413 14.6839 11.2044 15 12 15C12.7956 15 13.5587 14.6839 14.1213 14.1213Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})),I=e=>(0,s.jsx)("svg",Object.assign({},e,{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M14.2426 10.0005H5.75736M10 14.2431V5.75781M19.25 10C19.25 15.1086 15.1086 19.25 10 19.25C4.89137 19.25 0.75 15.1086 0.75 10C0.75 4.89137 4.89137 0.75 10 0.75C15.1086 0.75 19.25 4.89137 19.25 10Z",stroke:"#C1EBE9",strokeWidth:"1.5",strokeLinecap:"round"})})),N=e=>(0,s.jsx)("svg",Object.assign({},e,{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M14.2426 10.0005H5.75736M19.25 10C19.25 15.1086 15.1086 19.25 10 19.25C4.89137 19.25 0.75 15.1086 0.75 10C0.75 4.89137 4.89137 0.75 10 0.75C15.1086 0.75 19.25 4.89137 19.25 10Z",stroke:"#C1EBE9",strokeWidth:"1.5",strokeLinecap:"round"})})),_=e=>(0,s.jsx)("svg",Object.assign({},e,{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.00016 1.66536C6.29978 1.66536 5.60625 1.80332 4.95918 2.07134C4.31211 2.33937 3.72417 2.73222 3.22893 3.22746C2.73368 3.72271 2.34083 4.31065 2.07281 4.95772C1.80478 5.60479 1.66683 6.29831 1.66683 6.9987C1.66683 8.41319 2.22873 9.76974 3.22893 10.7699C4.22912 11.7701 5.58568 12.332 7.00016 12.332C8.41465 12.332 9.7712 11.7701 10.7714 10.7699C11.7716 9.76974 12.3335 8.41319 12.3335 6.9987C12.3335 6.29831 12.1955 5.60479 11.9275 4.95772C11.6595 4.31065 11.2666 3.72271 10.7714 3.22746C10.2762 2.73222 9.68821 2.33937 9.04114 2.07134C8.39407 1.80332 7.70055 1.66536 7.00016 1.66536ZM4.44894 0.839501C5.25778 0.50447 6.12468 0.332031 7.00016 0.332031C7.87564 0.332031 8.74255 0.50447 9.55139 0.839501C10.3602 1.17453 11.0952 1.6656 11.7142 2.28465C12.3333 2.90371 12.8243 3.63864 13.1594 4.44747C13.4944 5.25631 13.6668 6.12322 13.6668 6.9987C13.6668 8.76681 12.9644 10.4625 11.7142 11.7127C10.464 12.963 8.76827 13.6654 7.00016 13.6654C5.23205 13.6654 3.53636 12.963 2.28612 11.7127C1.03587 10.4625 0.333496 8.76681 0.333496 6.9987C0.333496 6.12322 0.505934 5.25631 0.840966 4.44747C1.176 3.63864 1.66706 2.90371 2.28612 2.28465C2.90517 1.6656 3.6401 1.17453 4.44894 0.839501ZM6.8049 4.52729C7.06525 4.78764 7.06525 5.20975 6.8049 5.4701L5.94297 6.33203H9.66683C10.035 6.33203 10.3335 6.63051 10.3335 6.9987C10.3335 7.36689 10.035 7.66536 9.66683 7.66536H5.94297L6.8049 8.52729C7.06525 8.78764 7.06525 9.20975 6.8049 9.4701C6.54455 9.73045 6.12244 9.73045 5.86209 9.4701L3.86209 7.4701C3.60174 7.20975 3.60174 6.78764 3.86209 6.52729L5.86209 4.52729C6.12244 4.26694 6.54455 4.26694 6.8049 4.52729Z",fill:"#C1EBE9"})})),R=e=>(0,s.jsx)("svg",Object.assign({},e,{width:"10",height:"10",viewBox:"0 0 10 10",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M3.229 4.06266V2.91683C3.229 1.93883 4.02183 1.146 4.99984 1.146C5.67657 1.146 6.26464 1.5256 6.56273 2.0835M2.81234 8.85433H7.18734C7.64757 8.85433 8.02067 8.48123 8.02067 8.021V4.896C8.02067 4.43576 7.64757 4.06266 7.18734 4.06266H2.81234C2.3521 4.06266 1.979 4.43576 1.979 4.896V8.021C1.979 8.48123 2.3521 8.85433 2.81234 8.85433Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})})),V=e=>(0,s.jsx)("svg",Object.assign({},e,{width:"43",height:"42",viewBox:"0 0 43 42",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M21.5 6.125C13.2848 6.125 6.625 12.7848 6.625 21C6.625 29.2152 13.2848 35.875 21.5 35.875C29.7152 35.875 36.375 29.2152 36.375 21C36.375 12.7848 29.7152 6.125 21.5 6.125ZM4 21C4 11.335 11.835 3.5 21.5 3.5C31.165 3.5 39 11.335 39 21C39 30.665 31.165 38.5 21.5 38.5C11.835 38.5 4 30.665 4 21ZM17.5625 12.25C18.2874 12.25 18.875 12.8376 18.875 13.5625V19.6875C18.875 20.4124 18.2874 21 17.5625 21C16.8376 21 16.25 20.4124 16.25 19.6875V13.5625C16.25 12.8376 16.8376 12.25 17.5625 12.25ZM25.4375 12.25C26.1624 12.25 26.75 12.8376 26.75 13.5625V19.6875C26.75 20.4124 26.1624 21 25.4375 21C24.7126 21 24.125 20.4124 24.125 19.6875V13.5625C24.125 12.8376 24.7126 12.25 25.4375 12.25ZM14.687 26.0122C15.06 25.3906 15.8662 25.1891 16.4878 25.562C18.3073 26.6537 19.9351 27.1469 21.5 27.1469C23.0649 27.1469 24.6927 26.6537 26.5122 25.562C27.1338 25.1891 27.94 25.3906 28.313 26.0122C28.6859 26.6338 28.4844 27.44 27.8628 27.813C25.7448 29.0838 23.6539 29.7719 21.5 29.7719C19.3461 29.7719 17.2552 29.0838 15.1372 27.813C14.5157 27.44 14.3141 26.6338 14.687 26.0122Z",fill:"black"})})),B=e=>(0,s.jsx)("svg",Object.assign({},e,{width:"43",height:"42",viewBox:"0 0 43 42",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M21.5 6.125C13.2848 6.125 6.625 12.7848 6.625 21C6.625 29.2152 13.2848 35.875 21.5 35.875C29.7152 35.875 36.375 29.2152 36.375 21C36.375 12.7848 29.7152 6.125 21.5 6.125ZM4 21C4 11.335 11.835 3.5 21.5 3.5C31.165 3.5 39 11.335 39 21C39 30.665 31.165 38.5 21.5 38.5C11.835 38.5 4 30.665 4 21ZM11.3844 17.0094C11.897 16.4969 12.728 16.4969 13.2406 17.0094C13.539 17.3079 14.3215 17.6094 15.375 17.6094C16.4285 17.6094 17.211 17.3079 17.5094 17.0094C18.022 16.4969 18.853 16.4969 19.3656 17.0094C19.8781 17.522 19.8781 18.353 19.3656 18.8656C18.3515 19.8796 16.7278 20.2344 15.375 20.2344C14.0222 20.2344 12.3985 19.8796 11.3844 18.8656C10.8719 18.353 10.8719 17.522 11.3844 17.0094ZM23.6344 17.0094C24.147 16.4969 24.978 16.4969 25.4906 17.0094C25.789 17.3079 26.5715 17.6094 27.625 17.6094C28.6785 17.6094 29.461 17.3079 29.7594 17.0094C30.272 16.4969 31.103 16.4969 31.6156 17.0094C32.1281 17.522 32.1281 18.353 31.6156 18.8656C30.6015 19.8796 28.9778 20.2344 27.625 20.2344C26.2722 20.2344 24.6485 19.8796 23.6344 18.8656C23.1219 18.353 23.1219 17.522 23.6344 17.0094ZM16.4048 27.0311C16.6625 26.3536 17.4206 26.0132 18.0981 26.2709C20.4789 27.1764 22.5211 27.1764 24.9019 26.2709C25.5794 26.0132 26.3375 26.3536 26.5952 27.0311C26.8529 27.7086 26.5125 28.4668 25.835 28.7245C22.8531 29.8585 20.1469 29.8585 17.165 28.7245C16.4875 28.4668 16.1471 27.7086 16.4048 27.0311Z",fill:"black"})})),U=e=>(0,s.jsx)("svg",Object.assign({},e,{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:(0,s.jsx)("path",{d:"M6.45833 6.45833V4.79167C6.45833 3.87119 7.20453 3.125 8.125 3.125H15.2083C16.1288 3.125 16.875 3.87119 16.875 4.79167V11.8833C16.875 12.8038 16.1288 13.55 15.2083 13.55H13.5417M3.125 8.125V15.2083C3.125 16.1288 3.87119 16.875 4.79167 16.875H11.875C12.7955 16.875 13.5417 16.1288 13.5417 15.2083V8.125C13.5417 7.20453 12.7955 6.45833 11.875 6.45833H4.79167C3.87119 6.45833 3.125 7.20453 3.125 8.125Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})),F=e=>(0,s.jsx)("svg",Object.assign({},e,{width:"40",height:"40",viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("g",{id:"web_light_rd_na 1",children:(0,s.jsxs)("g",{id:"Clip path group",children:[(0,s.jsx)("mask",{id:"mask0_5475_50906",style:{maskType:"luminance"},maskUnits:"userSpaceOnUse",x:"12",y:"12",width:"16",height:"16",children:(0,s.jsx)("g",{id:"clip0_710_6217",children:(0,s.jsx)("path",{id:"Vector",d:"M28 12H12V28H28V12Z",fill:"white"})})}),(0,s.jsx)("g",{mask:"url(#mask0_5475_50906)",children:(0,s.jsxs)("g",{id:"Group",children:[(0,s.jsx)("path",{id:"Vector_2",d:"M27.68 20.1818C27.68 19.6146 27.6291 19.0691 27.5346 18.5454H20V21.64H24.3054C24.12 22.64 23.5564 23.4873 22.7091 24.0546V26.0618H25.2946C26.8073 24.6691 27.68 22.6182 27.68 20.1818Z",fill:"#4285F4"}),(0,s.jsx)("path",{id:"Vector_3",d:"M19.9998 28C22.1598 28 23.9707 27.2836 25.2943 26.0618L22.7089 24.0546C21.9925 24.5346 21.0761 24.8182 19.9998 24.8182C17.9161 24.8182 16.1525 23.4109 15.5234 21.52H12.8507V23.5927C14.1671 26.2073 16.8725 28 19.9998 28Z",fill:"#34A853"}),(0,s.jsx)("path",{id:"Vector_4",d:"M15.5236 21.52C15.3636 21.04 15.2727 20.5273 15.2727 20C15.2727 19.4727 15.3636 18.96 15.5236 18.48V16.4073H12.8509C12.3091 17.4873 12 18.7091 12 20C12 21.2909 12.3091 22.5127 12.8509 23.5927L15.5236 21.52Z",fill:"#FBBC04"}),(0,s.jsx)("path",{id:"Vector_5",d:"M19.9998 15.1818C21.1743 15.1818 22.2289 15.5854 23.058 16.3782L25.3525 14.0836C23.9671 12.7927 22.1561 12 19.9998 12C16.8725 12 14.1671 13.7927 12.8507 16.4073L15.5234 18.48C16.1525 16.5891 17.9161 15.1818 19.9998 15.1818Z",fill:"#E94235"})]})})]})})})),Z=e=>(0,s.jsx)("svg",Object.assign({},e,{width:"40",height:"40",viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M23.6133 14.7788C23.7923 14.7788 24.0975 14.8073 24.5288 14.8643C24.9601 14.9212 25.4321 15.084 25.9448 15.3525C26.4657 15.613 26.9377 16.0483 27.3608 16.6587C27.3364 16.6831 27.2184 16.7726 27.0068 16.9272C26.7952 17.0737 26.5592 17.2935 26.2988 17.5864C26.0384 17.8713 25.8105 18.2375 25.6152 18.6851C25.4199 19.1245 25.3223 19.6494 25.3223 20.2598C25.3223 20.9596 25.4443 21.5537 25.6885 22.042C25.9408 22.5303 26.2297 22.925 26.5552 23.2261C26.8888 23.519 27.1818 23.7347 27.4341 23.873C27.6945 24.0114 27.8328 24.0846 27.8491 24.0928C27.841 24.1253 27.7352 24.4142 27.5317 24.9595C27.3364 25.5047 27.0109 26.111 26.5552 26.7783C26.1564 27.3561 25.7251 27.8892 25.2612 28.3774C24.8055 28.8657 24.2562 29.1099 23.6133 29.1099C23.182 29.1099 22.828 29.0488 22.5513 28.9268C22.2746 28.7965 21.9897 28.6704 21.6968 28.5483C21.4038 28.4181 21.0091 28.353 20.5127 28.353C20.0326 28.353 19.6297 28.4181 19.3042 28.5483C18.9868 28.6785 18.6816 28.8088 18.3887 28.939C18.1038 29.0692 17.7661 29.1343 17.3755 29.1343C16.7814 29.1343 16.2606 28.8983 15.813 28.4263C15.3654 27.9543 14.9056 27.3887 14.4336 26.7295C13.8883 25.9482 13.4204 24.9961 13.0298 23.873C12.6473 22.7419 12.4561 21.6025 12.4561 20.4551C12.4561 19.2262 12.688 18.1968 13.1519 17.3667C13.6157 16.5285 14.2098 15.8978 14.9341 15.4746C15.6665 15.0433 16.4233 14.8276 17.2046 14.8276C17.6196 14.8276 18.0103 14.8968 18.3765 15.0352C18.7427 15.1654 19.0845 15.2996 19.4019 15.438C19.7274 15.5763 20.0203 15.6455 20.2808 15.6455C20.533 15.6455 20.826 15.5723 21.1597 15.4258C21.4933 15.2793 21.8677 15.1369 22.2827 14.9985C22.6978 14.8521 23.1413 14.7788 23.6133 14.7788ZM22.9419 13.2285C22.6245 13.611 22.2257 13.9325 21.7456 14.1929C21.2655 14.4451 20.8097 14.5713 20.3784 14.5713C20.2889 14.5713 20.2035 14.5632 20.1221 14.5469C20.1139 14.5225 20.1058 14.4777 20.0977 14.4126C20.0895 14.3475 20.0854 14.2783 20.0854 14.2051C20.0854 13.7168 20.1912 13.2448 20.4028 12.7891C20.6144 12.3252 20.8545 11.9427 21.123 11.6416C21.4648 11.2347 21.8962 10.897 22.417 10.6284C22.9378 10.3599 23.4342 10.2174 23.9062 10.2012C23.9307 10.307 23.9429 10.4331 23.9429 10.5796C23.9429 11.0679 23.8493 11.5439 23.6621 12.0078C23.4749 12.4635 23.2349 12.8704 22.9419 13.2285Z",fill:"black"})})),H=e=>(0,s.jsx)("svg",Object.assign({},e,{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:(0,s.jsx)("path",{d:"M21.5875 8.66978C21.9574 8.4834 22.1062 8.03243 21.9198 7.66252C21.7334 7.29261 21.2824 7.14383 20.9125 7.33022L21.5875 8.66978ZM3.08748 7.33022C2.71757 7.14383 2.2666 7.29261 2.08022 7.66252C1.89383 8.03243 2.04261 8.4834 2.41252 8.66978L3.08748 7.33022ZM12.45 12.434L12.7874 13.1038L12.45 12.434ZM11.55 12.434L11.8875 11.7642L11.55 12.434ZM20.5 5.75V18.25H22V5.75H20.5ZM20.25 18.5H3.75V20H20.25V18.5ZM3.5 18.25V5.75H2V18.25H3.5ZM3.75 5.5H20.25V4H3.75V5.5ZM20.9125 7.33022L12.1125 11.7642L12.7874 13.1038L21.5875 8.66978L20.9125 7.33022ZM11.8875 11.7642L3.08748 7.33022L2.41252 8.66978L11.2125 13.1038L11.8875 11.7642ZM3.5 5.75C3.5 5.61193 3.61193 5.5 3.75 5.5V4C2.7835 4 2 4.7835 2 5.75H3.5ZM3.75 18.5C3.61193 18.5 3.5 18.3881 3.5 18.25H2C2 19.2165 2.7835 20 3.75 20V18.5ZM20.5 18.25C20.5 18.3881 20.3881 18.5 20.25 18.5V20C21.2165 20 22 19.2165 22 18.25H20.5ZM12.1125 11.7642C12.0417 11.7999 11.9583 11.7999 11.8875 11.7642L11.2125 13.1038C11.7078 13.3533 12.2921 13.3533 12.7874 13.1038L12.1125 11.7642ZM22 5.75C22 4.7835 21.2165 4 20.25 4V5.5C20.3881 5.5 20.5 5.61193 20.5 5.75H22Z",fill:"black"})})),G=e=>(0,s.jsxs)("svg",Object.assign({},e,{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[(0,s.jsx)("path",{d:"M15.749 6.5C15.749 8.57107 14.0701 10.25 11.999 10.25C9.92796 10.25 8.24903 8.57107 8.24903 6.5C8.24903 4.42893 9.92796 2.75 11.999 2.75C14.0701 2.75 15.749 4.42893 15.749 6.5Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M11.999 13.25C8.20342 13.25 5.43294 15.7735 4.67058 19.1657C4.54137 19.7406 5.00819 20.25 5.59744 20.25H18.4006C18.9899 20.25 19.4567 19.7406 19.3275 19.1657C18.5651 15.7735 15.7946 13.25 11.999 13.25Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round"})]})),z=e=>(0,s.jsx)("svg",Object.assign({},e,{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:(0,s.jsx)("path",{d:"M8 7.11232C7.99902 5.5 10.0203 4.44629 11.999 4.44629C13.7574 4.44629 15.998 5.87173 15.998 7.63008C15.998 8.69459 15.466 9.68867 14.5803 10.2792L13.5819 10.9447C12.593 11.604 11.999 12.7139 11.999 13.9024V14.2217M11.999 19.1094V19.0916M12.4434 19.1094C12.4434 19.3548 12.2444 19.5537 11.999 19.5537C11.7536 19.5537 11.5547 19.3548 11.5547 19.1094C11.5547 18.864 11.7536 18.665 11.999 18.665C12.2444 18.665 12.4434 18.864 12.4434 19.1094Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})),W=e=>(0,s.jsxs)("svg",Object.assign({},e,{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("path",{d:"M19.25 21.25L18.7574 21.8156C18.9791 22.0086 19.2931 22.0544 19.5607 21.9326C19.8283 21.8108 20 21.544 20 21.25H19.25ZM16.6667 19L17.1593 18.4344C16.866 18.179 16.426 18.1901 16.1461 18.4601L16.6667 19ZM14.3333 21.25L13.8127 21.7899C14.1033 22.07 14.5634 22.07 14.8539 21.7899L14.3333 21.25ZM12 19L12.5206 18.4601C12.2301 18.18 11.7699 18.18 11.4794 18.4601L12 19ZM9.66667 21.25L9.14606 21.7899C9.4366 22.07 9.89674 22.07 10.1873 21.7899L9.66667 21.25ZM7.33333 19L7.85394 18.4601C7.57396 18.1901 7.13404 18.179 6.84075 18.4344L7.33333 19ZM4.75 21.25H4C4 21.544 4.17175 21.8108 4.43931 21.9326C4.70687 22.0544 5.02091 22.0086 5.24259 21.8156L4.75 21.25ZM15.792 8.28033C16.0849 7.98744 16.0849 7.51256 15.792 7.21967C15.4992 6.92678 15.0243 6.92678 14.7314 7.21967L15.792 8.28033ZM8.23139 13.7197C7.9385 14.0126 7.9385 14.4874 8.23139 14.7803C8.52428 15.0732 8.99916 15.0732 9.29205 14.7803L8.23139 13.7197ZM6.75 3.5H17.25V2H6.75V3.5ZM18.5 4.75V21.25H20V4.75H18.5ZM19.7426 20.6844L17.1593 18.4344L16.1741 19.5656L18.7574 21.8156L19.7426 20.6844ZM16.1461 18.4601L13.8127 20.7101L14.8539 21.7899L17.1873 19.5399L16.1461 18.4601ZM14.8539 20.7101L12.5206 18.4601L11.4794 19.5399L13.8127 21.7899L14.8539 20.7101ZM11.4794 18.4601L9.14606 20.7101L10.1873 21.7899L12.5206 19.5399L11.4794 18.4601ZM10.1873 20.7101L7.85394 18.4601L6.81273 19.5399L9.14606 21.7899L10.1873 20.7101ZM6.84075 18.4344L4.25741 20.6844L5.24259 21.8156L7.82592 19.5656L6.84075 18.4344ZM5.5 21.25V4.75H4V21.25H5.5ZM17.25 3.5C17.9404 3.5 18.5 4.05964 18.5 4.75H20C20 3.23122 18.7688 2 17.25 2V3.5ZM6.75 2C5.23122 2 4 3.23122 4 4.75H5.5C5.5 4.05964 6.05964 3.5 6.75 3.5V2ZM14.7314 7.21967L8.23139 13.7197L9.29205 14.7803L15.792 8.28033L14.7314 7.21967Z",fill:"black"}),(0,s.jsx)("path",{d:"M9 8V7.99M9.25 8C9.25 8.13807 9.13807 8.25 9 8.25C8.86193 8.25 8.75 8.13807 8.75 8C8.75 7.86193 8.86193 7.75 9 7.75C9.13807 7.75 9.25 7.86193 9.25 8Z",stroke:"black",strokeWidth:"1.5",strokeLinecap:"round"}),(0,s.jsx)("path",{d:"M15 14V13.99M15.25 14C15.25 14.1381 15.1381 14.25 15 14.25C14.8619 14.25 14.75 14.1381 14.75 14C14.75 13.8619 14.8619 13.75 15 13.75C15.1381 13.75 15.25 13.8619 15.25 14Z",stroke:"black",strokeWidth:"1.5",strokeLinecap:"round"})]})),X=e=>(0,s.jsxs)("svg",Object.assign({},e,{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("g",{clipPath:"url(#clip0_7602_36349)",children:(0,s.jsx)("path",{d:"M21 12.0001L2.75049 12.0001M18.5412 18.5407C14.9289 22.1531 9.0721 22.1531 5.45975 18.5407C1.8474 14.9284 1.8474 9.07161 5.45975 5.45926C9.0721 1.84691 14.9289 1.84691 18.5412 5.45926C22.1536 9.07161 22.1536 14.9284 18.5412 18.5407ZM12.0007 21.2153C10.3042 21.2153 8.929 17.0895 8.929 12.0002C8.929 6.91084 10.3042 2.78512 12.0007 2.78512C13.6971 2.78512 15.0724 6.91085 15.0724 12.0002C15.0724 17.0895 13.6971 21.2153 12.0007 21.2153Z",stroke:"black",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,s.jsx)("defs",{children:(0,s.jsx)("clipPath",{id:"clip0_7602_36349",children:(0,s.jsx)("rect",{width:"24",height:"24",fill:"white",transform:"translate(0.000488281)"})})})]})),Y=e=>(0,s.jsxs)("svg",Object.assign({},e,{width:"28",height:"28",viewBox:"0 0 28 28",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsxs)("g",{clipPath:"url(#clip0_7649_54949)",children:[(0,s.jsx)("path",{d:"M14 6.182C14.5304 6.182 15.0391 5.97129 15.4142 5.59621C15.7893 5.22114 16 4.71243 16 4.182V2C16 1.46957 15.7893 0.960859 15.4142 0.585786C15.0391 0.210714 14.5304 0 14 0C13.4696 0 12.9609 0.210714 12.5858 0.585786C12.2107 0.960859 12 1.46957 12 2V4.182C12 4.71243 12.2107 5.22114 12.5858 5.59621C12.9609 5.97129 13.4696 6.182 14 6.182Z",fill:"url(#paint0_linear_7649_54949)"}),(0,s.jsx)("path",{d:"M20.884 9.06201C21.1467 9.06272 21.407 9.01129 21.6497 8.9107C21.8924 8.81011 22.1128 8.66236 22.298 8.47601L23.842 6.93401C24.2063 6.55681 24.4079 6.0516 24.4033 5.52721C24.3988 5.00281 24.1884 4.50119 23.8176 4.13037C23.4468 3.75956 22.9452 3.54922 22.4208 3.54466C21.8964 3.5401 21.3912 3.74169 21.014 4.10601L19.47 5.64801C19.1904 5.92771 18.9999 6.28404 18.9228 6.67195C18.8457 7.05985 18.8853 7.46192 19.0366 7.82732C19.188 8.19272 19.4442 8.50504 19.7731 8.72481C20.1019 8.94458 20.4885 9.06193 20.884 9.06201Z",fill:"url(#paint1_linear_7649_54949)"}),(0,s.jsx)("path",{d:"M26 12H23.818C23.2876 12 22.7789 12.2107 22.4038 12.5858C22.0287 12.9609 21.818 13.4696 21.818 14C21.818 14.5304 22.0287 15.0391 22.4038 15.4142C22.7789 15.7893 23.2876 16 23.818 16H26C26.5304 16 27.0391 15.7893 27.4142 15.4142C27.7893 15.0391 28 14.5304 28 14C28 13.4696 27.7893 12.9609 27.4142 12.5858C27.0391 12.2107 26.5304 12 26 12Z",fill:"url(#paint2_linear_7649_54949)"}),(0,s.jsx)("path",{d:"M22.298 19.534C21.9208 19.1697 21.4156 18.9681 20.8912 18.9726C20.3668 18.9772 19.8652 19.1875 19.4944 19.5584C19.1235 19.9292 18.9132 20.4308 18.9086 20.9552C18.9041 21.4796 19.1057 21.9848 19.47 22.362L21.014 23.904C21.3912 24.2683 21.8964 24.4699 22.4208 24.4653C22.9452 24.4608 23.4468 24.2504 23.8176 23.8796C24.1884 23.5088 24.3988 23.0072 24.4033 22.4828C24.4079 21.9584 24.2063 21.4532 23.842 21.076L22.298 19.534Z",fill:"url(#paint3_linear_7649_54949)"}),(0,s.jsx)("path",{d:"M16 26V23.818C16 23.2876 15.7893 22.7789 15.4142 22.4038C15.0391 22.0287 14.5304 21.818 14 21.818C13.4696 21.818 12.9609 22.0287 12.5858 22.4038C12.2107 22.7789 12 23.2876 12 23.818V26C12 26.5304 12.2107 27.0391 12.5858 27.4142C12.9609 27.7893 13.4696 28 14 28C14.5304 28 15.0391 27.7893 15.4142 27.4142C15.7893 27.0391 16 26.5304 16 26Z",fill:"url(#paint4_linear_7649_54949)"}),(0,s.jsx)("path",{d:"M4.04197 21.076C3.85095 21.2605 3.69859 21.4812 3.59377 21.7252C3.48895 21.9692 3.43378 22.2316 3.43147 22.4972C3.42916 22.7627 3.47977 23.0261 3.58033 23.2719C3.68089 23.5177 3.8294 23.741 4.01718 23.9288C4.20497 24.1166 4.42827 24.2651 4.67406 24.3656C4.91986 24.4662 5.18322 24.5168 5.44878 24.5145C5.71434 24.5122 5.97677 24.457 6.22078 24.3522C6.46479 24.2474 6.68548 24.095 6.86998 23.904L8.41198 22.362C8.77629 21.9848 8.97788 21.4796 8.97332 20.9552C8.96877 20.4308 8.75843 19.9292 8.38761 19.5584C8.0168 19.1875 7.51517 18.9772 6.99078 18.9726C6.46638 18.9681 5.96118 19.1697 5.58397 19.534L4.04197 21.076Z",fill:"url(#paint5_linear_7649_54949)"}),(0,s.jsx)("path",{d:"M2 16H4.182C4.71244 16 5.22115 15.7893 5.59622 15.4142C5.97129 15.0391 6.182 14.5304 6.182 14C6.182 13.4696 5.97129 12.9609 5.59622 12.5858C5.22115 12.2107 4.71244 12 4.182 12H2C1.46957 12 0.96086 12.2107 0.585787 12.5858C0.210714 12.9609 0 13.4696 0 14C0 14.5304 0.210714 15.0391 0.585787 15.4142C0.96086 15.7893 1.46957 16 2 16Z",fill:"url(#paint6_linear_7649_54949)"}),(0,s.jsx)("path",{d:"M5.58402 8.47601C5.96122 8.84033 6.46643 9.04192 6.99082 9.03736C7.51521 9.0328 8.01684 8.82246 8.38766 8.45165C8.75847 8.08083 8.96881 7.57921 8.97337 7.05481C8.97792 6.53042 8.77634 6.02521 8.41202 5.64801L6.87002 4.10601C6.49281 3.74169 5.98761 3.5401 5.46321 3.54466C4.93882 3.54922 4.43719 3.75956 4.06638 4.13037C3.69556 4.50119 3.48522 5.00281 3.48067 5.52721C3.47611 6.0516 3.6777 6.55681 4.04201 6.93401L5.58402 8.47601Z",fill:"url(#paint7_linear_7649_54949)"}),(0,s.jsx)("path",{d:"M14 7.62998C12.7313 7.628 11.4906 8.00251 10.435 8.70609C9.37934 9.40967 8.5562 10.4107 8.0698 11.5824C7.58341 12.754 7.45563 14.0437 7.70264 15.2881C7.94965 16.5324 8.56035 17.6755 9.4574 18.5725C10.3545 19.4696 11.4975 20.0803 12.7419 20.3273C13.9862 20.5743 15.2759 20.4465 16.4476 19.9601C17.6193 19.4737 18.6203 18.6506 19.3238 17.5949C20.0274 16.5393 20.4019 15.2986 20.4 14.03C20.3957 12.3339 19.7201 10.7085 18.5208 9.50917C17.3215 8.30985 15.696 7.63421 14 7.62998Z",fill:"url(#paint8_linear_7649_54949)"})]}),(0,s.jsxs)("defs",{children:[(0,s.jsxs)("linearGradient",{id:"paint0_linear_7649_54949",x1:"13.7085",y1:"8.07094",x2:"10.8062",y2:"7.56667",gradientUnits:"userSpaceOnUse",children:[(0,s.jsx)("stop",{stopColor:"#F8F991"}),(0,s.jsx)("stop",{offset:"1",stopColor:"#FFCD00"})]}),(0,s.jsxs)("linearGradient",{id:"paint1_linear_7649_54949",x1:"21.2417",y1:"10.7479",x2:"17.394",y2:"9.71438",gradientUnits:"userSpaceOnUse",children:[(0,s.jsx)("stop",{stopColor:"#F8F991"}),(0,s.jsx)("stop",{offset:"1",stopColor:"#FFCD00"})]}),(0,s.jsxs)("linearGradient",{id:"paint2_linear_7649_54949",x1:"24.4584",y1:"17.2222",x2:"20.5166",y2:"15.5863",gradientUnits:"userSpaceOnUse",children:[(0,s.jsx)("stop",{stopColor:"#F8F991"}),(0,s.jsx)("stop",{offset:"1",stopColor:"#FFCD00"})]}),(0,s.jsxs)("linearGradient",{id:"paint3_linear_7649_54949",x1:"21.2555",y1:"26.1438",x2:"17.4248",y2:"25.1147",gradientUnits:"userSpaceOnUse",children:[(0,s.jsx)("stop",{stopColor:"#F8F991"}),(0,s.jsx)("stop",{offset:"1",stopColor:"#FFCD00"})]}),(0,s.jsxs)("linearGradient",{id:"paint4_linear_7649_54949",x1:"13.7085",y1:"29.8889",x2:"10.8062",y2:"29.3847",gradientUnits:"userSpaceOnUse",children:[(0,s.jsx)("stop",{stopColor:"#F8F991"}),(0,s.jsx)("stop",{offset:"1",stopColor:"#FFCD00"})]}),(0,s.jsxs)("linearGradient",{id:"paint5_linear_7649_54949",x1:"5.79849",y1:"26.208",x2:"1.93466",y2:"25.1704",gradientUnits:"userSpaceOnUse",children:[(0,s.jsx)("stop",{stopColor:"#F8F991"}),(0,s.jsx)("stop",{offset:"1",stopColor:"#FFCD00"})]}),(0,s.jsxs)("linearGradient",{id:"paint6_linear_7649_54949",x1:"2.64045",y1:"17.2222",x2:"-1.30143",y2:"15.5863",gradientUnits:"userSpaceOnUse",children:[(0,s.jsx)("stop",{stopColor:"#F8F991"}),(0,s.jsx)("stop",{offset:"1",stopColor:"#FFCD00"})]}),(0,s.jsxs)("linearGradient",{id:"paint7_linear_7649_54949",x1:"5.82669",y1:"10.7158",x2:"1.99713",y2:"9.68743",gradientUnits:"userSpaceOnUse",children:[(0,s.jsx)("stop",{stopColor:"#F8F991"}),(0,s.jsx)("stop",{offset:"1",stopColor:"#FFCD00"})]}),(0,s.jsxs)("linearGradient",{id:"paint8_linear_7649_54949",x1:"13.0556",y1:"24.3672",x2:"4.11763",y2:"21.967",gradientUnits:"userSpaceOnUse",children:[(0,s.jsx)("stop",{stopColor:"#F8F991"}),(0,s.jsx)("stop",{offset:"1",stopColor:"#FFCD00"})]}),(0,s.jsx)("clipPath",{id:"clip0_7649_54949",children:(0,s.jsx)("rect",{width:"28",height:"28",fill:"white"})})]})]})),$=e=>(0,s.jsxs)("svg",Object.assign({},e,{width:"32",height:"33",viewBox:"0 0 32 33",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("path",{d:"M14.3332 15.1667H15.9998L15.9998 22.1667M28.3332 16.5001C28.3332 23.3116 22.8113 28.8334 15.9998 28.8334C9.18833 28.8334 3.6665 23.3116 3.6665 16.5001C3.6665 9.68857 9.18833 4.16675 15.9998 4.16675C22.8113 4.16675 28.3332 9.68857 28.3332 16.5001Z",stroke:"#A7F1ED",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M16.0005 10.375C16.4376 10.3752 16.7915 10.7299 16.7915 11.167C16.7913 11.604 16.4375 11.9578 16.0005 11.958C15.5634 11.958 15.2087 11.6041 15.2085 11.167C15.2085 10.7298 15.5633 10.375 16.0005 10.375Z",fill:"#A7F1ED",stroke:"#A7F1ED",strokeWidth:"0.25"})]})),Q=e=>(0,s.jsx)("svg",Object.assign({},e,{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M9.7915 16.0417H16.8748C17.7953 16.0417 18.5415 15.2955 18.5415 14.375V7.29167C18.5415 6.37119 17.7953 5.625 16.8748 5.625H11.7251C11.1679 5.625 10.6475 5.3465 10.3384 4.88283L9.66128 3.86717C9.35217 3.4035 8.83179 3.125 8.27453 3.125H4.7915C3.87103 3.125 3.12484 3.87119 3.12484 4.79167V9.375M4.7915 11.875V14.375M4.7915 14.375V16.875M4.7915 14.375H2.2915M4.7915 14.375H7.2915",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})),q=e=>(0,s.jsx)("svg",Object.assign({},e,{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M10 5V10M10 10V15M10 10H15M10 10H5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})),K=e=>(0,s.jsx)("svg",Object.assign({},e,{width:"24",height:"25",viewBox:"0 0 24 25",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M15.5303 21.0303C15.8232 20.7374 15.8232 20.2626 15.5303 19.9697L8.94448 13.3839C8.45633 12.8957 8.45633 12.1043 8.94449 11.6161L15.5303 5.03033C15.8232 4.73744 15.8232 4.26256 15.5303 3.96967C15.2374 3.67678 14.7625 3.67678 14.4696 3.96967L7.88383 10.5554C6.80989 11.6294 6.80988 13.3706 7.88382 14.4445L14.4696 21.0303C14.7625 21.3232 15.2374 21.3232 15.5303 21.0303Z",fill:"currentColor"})})),J=e=>(0,s.jsxs)("svg",Object.assign({},e,{width:"62",height:"18",viewBox:"0 0 62 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("path",{d:"M0 0.611771H9.62557V3.12942H3.25571V5.85883H8.87062V8.40001H3.25571V11.1294H9.62557V13.6471H0V0.611771Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M11.3003 4.04706H14.3437L14.438 4.87059C14.8627 4.56471 15.3581 4.32941 15.9715 4.14118C16.5849 3.95294 17.1983 3.85883 17.8353 3.85883C19.0621 3.85883 19.9586 4.16471 20.5484 4.75294C21.1146 5.34118 21.4213 6.25883 21.4213 7.50588V13.6471H18.142V7.76471C18.142 7.22353 18.024 6.84706 17.7881 6.61177C17.5522 6.37647 17.1511 6.25883 16.5613 6.25883C16.2074 6.25883 15.8536 6.32941 15.4761 6.49412C15.1222 6.65883 14.8155 6.84706 14.556 7.10589V13.6471H11.3003V4.04706Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M23.4741 4.04705H26.3052L26.4703 4.87058C27.3196 4.18822 28.3105 3.83528 29.4901 3.83528C32.4627 3.83528 33.9254 5.43528 33.9254 8.63528C33.9254 10.3294 33.5244 11.6235 32.6986 12.5176C31.8965 13.4118 30.7641 13.8353 29.3014 13.8353C28.2869 13.8353 27.414 13.6235 26.7062 13.2V18H23.4741V4.04705ZM30.0799 10.7294C30.4338 10.2353 30.6225 9.5294 30.6225 8.58822C30.6225 7.69411 30.4574 7.08234 30.1507 6.75293C29.844 6.42352 29.3014 6.25881 28.57 6.25881C27.8858 6.25881 27.2724 6.49411 26.7534 6.98822V10.8706C27.0129 11.0823 27.296 11.2235 27.5556 11.3176C27.8151 11.4118 28.1454 11.4588 28.5228 11.4588C29.207 11.4588 29.726 11.2 30.0799 10.7294Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M36.2612 13.0588C35.6242 12.5412 35.2939 11.7882 35.2939 10.8235C35.2939 9.8353 35.6242 9.05883 36.3084 8.49412C36.9926 7.92941 37.9834 7.67059 39.3046 7.67059H41.9941V7.45883C41.9941 6.96471 41.829 6.61177 41.4987 6.4C41.1684 6.18824 40.555 6.09412 39.6821 6.09412C38.5968 6.09412 37.5116 6.25883 36.45 6.61177V4.51765C36.9454 4.32941 37.5352 4.16471 38.2194 4.04706C38.9035 3.92941 39.6113 3.85883 40.3427 3.85883C41.8761 3.85883 43.0557 4.16471 43.8815 4.8C44.7072 5.41177 45.1083 6.37647 45.1083 7.67059V13.6471H42.2536L42.0885 12.8471C41.3335 13.5294 40.2247 13.8588 38.6912 13.8588C37.7239 13.8353 36.8982 13.5765 36.2612 13.0588ZM41.9941 10.9177V9.55294H39.6821C39.1866 9.55294 38.8328 9.64706 38.5968 9.8353C38.3609 10.0235 38.243 10.3059 38.243 10.7059C38.243 11.4588 38.7384 11.8353 39.7528 11.8353C40.7201 11.8353 41.4751 11.5294 41.9941 10.9177Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M47.9391 13.1529C47.4908 12.7059 47.2549 11.9529 47.2549 10.9412V0H50.5106V10.6118C50.5106 10.9176 50.5814 11.1294 50.6993 11.2471C50.8173 11.3647 51.006 11.4118 51.2891 11.4118C51.643 11.4118 51.9733 11.3647 52.2564 11.2706V13.4824C51.9261 13.6 51.6194 13.6941 51.3127 13.7412C51.006 13.7882 50.6286 13.8118 50.2039 13.8118C49.1658 13.8353 48.4109 13.6 47.9391 13.1529Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M59.5226 14.2353C60.8907 14.2353 61.9997 13.1292 61.9997 11.7647C61.9997 10.4002 60.8907 9.29411 59.5226 9.29411C58.1545 9.29411 57.0454 10.4002 57.0454 11.7647C57.0454 13.1292 58.1545 14.2353 59.5226 14.2353Z",fill:e.fill||"#FFD233"})]})),ee=e=>(0,s.jsx)("svg",Object.assign({},e,{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M2.46005 9.95616L3.58876 16.3574C3.78057 17.4452 4.81789 18.1716 5.90567 17.9798L10.1141 17.2377M2.46005 9.95616L2.11275 7.98655C1.92094 6.89876 2.64728 5.86144 3.73507 5.66964L13.0907 4.01998C14.1785 3.82817 15.2158 4.55451 15.4077 5.6423L15.755 7.61191L2.46005 9.95616ZM15.9998 11.7499V13.9999L17.9998 15.9999M22.2498 13.9999C22.2498 17.4517 19.4516 20.2499 15.9998 20.2499C12.548 20.2499 9.74983 17.4517 9.74983 13.9999C9.74983 10.5481 12.548 7.74986 15.9998 7.74986C19.4516 7.74986 22.2498 10.5481 22.2498 13.9999Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})),et=e=>(0,s.jsxs)("svg",Object.assign({},e,{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("path",{d:"M2.75 6.75C2.75 5.64543 3.64543 4.75 4.75 4.75H13.25C14.3546 4.75 15.25 5.64543 15.25 6.75V17.25C15.25 18.3546 14.3546 19.25 13.25 19.25H4.75C3.64543 19.25 2.75 18.3546 2.75 17.25V6.75Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M15.25 9.99995L19.8028 7.72356C20.4677 7.39111 21.25 7.8746 21.25 8.61798V15.382C21.25 16.1253 20.4677 16.6088 19.8028 16.2764L15.25 14V9.99995Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round"})]})),ei=e=>(0,s.jsxs)("svg",Object.assign({},e,{width:"24",height:"25",viewBox:"0 0 24 25",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("path",{d:"M12.7162 6.91933L8.20489 9.19978M8.20489 9.19978L3.69356 6.91933M8.20489 9.19978V13.7607M13.4103 9.19978V7.03083C13.4103 6.5327 13.1434 6.07276 12.7109 5.82562L8.89358 3.64432C8.46683 3.40046 7.94294 3.40046 7.5162 3.64432L3.69892 5.82562C3.26642 6.07276 2.99951 6.5327 2.99951 7.03083V11.3687C2.99951 11.8669 3.26642 12.3268 3.69892 12.5739L7.5162 14.7552C7.94294 14.9991 8.46683 14.9991 8.89358 14.7552L10.8022 13.6646",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M17.0681 19.8025C14.4246 19.8025 12.9469 18.4469 12.3548 17.4875C12.1958 17.2299 12.223 16.9094 12.3714 16.6456L17.0681 8.2959L21.7393 16.6002C21.902 16.8895 21.9153 17.2439 21.7237 17.5149C21.0964 18.4026 19.6295 19.8025 17.0681 19.8025Z",stroke:"currentColor",strokeWidth:"1.5"}),(0,s.jsx)("path",{d:"M18.394 19.5V21.8333C18.2829 22.0111 17.8274 22.5 16.894 22.5C15.9607 22.5 15.5052 22.0556 15.394 21.8333V19.5",stroke:"currentColor",strokeWidth:"1.5"})]})),es=e=>(0,s.jsx)("svg",Object.assign({},e,{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M8.75 5.00016V17.5002M15.25 6.50016V19.0002M2.75 17.419V7.5813C2.75 6.93565 3.16315 6.36245 3.77566 6.15827L8.29397 4.65217C8.59056 4.55331 8.91063 4.54959 9.20944 4.64153L14.7906 6.35879C15.0894 6.45074 15.4094 6.44701 15.706 6.34815L19.2757 5.15827C20.247 4.83451 21.25 5.55746 21.25 6.5813V16.419C21.25 17.0647 20.8369 17.6379 20.2243 17.842L15.706 19.3482C15.4094 19.447 15.0894 19.4507 14.7906 19.3588L9.20944 17.6415C8.91063 17.5496 8.59056 17.5533 8.29397 17.6522L4.72434 18.842C3.75305 19.1658 2.75 18.4429 2.75 17.419Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"square",strokeLinejoin:"round"})})),en=e=>(0,s.jsxs)("svg",Object.assign({},e,{width:"24",height:"25",viewBox:"0 0 24 25",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsxs)("g",{clipPath:"url(#clip0_8487_5424)",children:[(0,s.jsx)("path",{d:"M14.75 12.5V20.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M9.25 12.5V20.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M3.75 20V13.5C3.75 8.94365 7.44365 5.25 12 5.25C16.5563 5.25 20.25 8.94365 20.25 13.5V20",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M12 5V1.25H14.25V2.75H12.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M2.75 20.75H21.25",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M2.75 12.25H21.25",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),(0,s.jsx)("defs",{children:(0,s.jsx)("clipPath",{id:"clip0_8487_5424",children:(0,s.jsx)("rect",{width:"24",height:"24",fill:"white",transform:"translate(0 0.5)"})})})]})),eo=e=>(0,s.jsx)("svg",Object.assign({},e,{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M12 15.75H18.5518C18.9433 15.75 19.2988 15.9784 19.4614 16.3345L20.6034 18.8345C20.9059 19.4968 20.4219 20.25 19.6938 20.25H12M12 15.75H5.44816C5.05668 15.75 4.70121 15.9784 4.53856 16.3345L3.39658 18.8345C3.09407 19.4968 3.57809 20.25 4.30618 20.25H12M12 15.75V20.25M12 9.75V11.25M18.75 3.75H20.25M3.75 3.75H5.25M7.5 8L6.5 9M16.5 8L17.5 9M8.83697 3.75C9.17555 5.18335 10.4632 6.25 12 6.25C13.5368 6.25 14.8245 5.18335 15.163 3.75",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})),er=e=>(0,s.jsxs)("svg",Object.assign({},e,{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("g",{clipPath:"url(#clip0_8487_5521)",children:(0,s.jsx)("path",{d:"M20.9995 12L2.75 12M18.5407 18.5407C14.9284 22.153 9.07161 22.153 5.45926 18.5407C1.84691 14.9283 1.84691 9.07154 5.45926 5.45919C9.07161 1.84684 14.9284 1.84684 18.5407 5.45919C22.1531 9.07154 22.1531 14.9283 18.5407 18.5407ZM12.0002 21.2152C10.3038 21.2152 8.92851 17.0895 8.92851 12.0001C8.92851 6.91078 10.3038 2.78505 12.0002 2.78505C13.6967 2.78505 15.0719 6.91078 15.0719 12.0001C15.0719 17.0895 13.6967 21.2152 12.0002 21.2152Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,s.jsx)("defs",{children:(0,s.jsx)("clipPath",{id:"clip0_8487_5521",children:(0,s.jsx)("rect",{width:"24",height:"24"})})})]})),ea=e=>(0,s.jsx)("svg",Object.assign({},e,{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M12 19.25V11.75M12 11.75L14.5 14.25M12 11.75L9.5 14.25M15 19.25H18.125C20.4032 19.25 22.25 17.4032 22.25 15.125C22.25 12.8468 20.4032 11 18.125 11C18.0814 11 18.038 11.0007 17.9948 11.002C17.9983 10.9184 18 10.8344 18 10.75C18 7.43629 15.3137 4.75 12 4.75C9.3716 4.75 7.13793 6.44009 6.32647 8.7928C3.74507 9.12339 1.75 11.3287 1.75 14C1.75 16.8995 4.10051 19.25 7 19.25H9",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})),el=e=>(0,s.jsx)("svg",Object.assign({},e,{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M12 3.75V15M12 3.75L16.5 8.25M12 3.75L7.5 8.25M20.25 12.75V18.25C20.25 19.3546 19.3546 20.25 18.25 20.25H5.75C4.64543 20.25 3.75 19.3546 3.75 18.25V12.75",stroke:"#FF7042",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})),ed=e=>(0,s.jsx)("svg",Object.assign({},e,{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M17.9289 8.20267L11.0839 17.4917C11.0031 17.5989 10.9017 17.6889 10.7858 17.7566C10.6698 17.8242 10.5415 17.868 10.4083 17.8855C10.2752 17.903 10.14 17.8938 10.0104 17.8585C9.88089 17.8232 9.7597 17.7624 9.65392 17.6797L4.76592 13.7717C4.66336 13.6896 4.57797 13.5881 4.51462 13.473C4.45128 13.358 4.41122 13.2315 4.39673 13.101C4.36747 12.8373 4.44416 12.5728 4.60992 12.3657C4.77568 12.1585 5.01694 12.0257 5.28061 11.9965C5.54429 11.9672 5.80879 12.0439 6.01592 12.2097L10.0919 15.4707L16.3189 7.01967C16.3939 6.90718 16.4909 6.81105 16.604 6.7371C16.7172 6.66316 16.8442 6.61292 16.9773 6.58943C17.1104 6.56594 17.2469 6.56969 17.3786 6.60044C17.5102 6.6312 17.6343 6.68833 17.7432 6.76837C17.8521 6.84842 17.9437 6.94972 18.0124 7.06615C18.0811 7.18259 18.1254 7.31174 18.1428 7.4458C18.1602 7.57987 18.1501 7.71606 18.1134 7.84615C18.0766 7.97624 18.0139 8.09752 17.9289 8.20267Z",fill:"currentColor"})}))},98041:function(e,t,i){i.d(t,{sg:function(){return b},wV:function(){return v}});var s=i(2873),n=i(14229),o=i(56354),r=i(6925),a=i(56972),l=i(23408),d=i(66704),h=i(86401),c=i(59527),u=i(53205);i(70846);var p=i(47831),m=i(950),g=i(412),f=i(57155);let x={shortText:"Your free trial has ended.",longText:"Your trial has ended. Upgrade to unlock Shadowmap Pro features.",btnText:"Upgrade to Pro",disappear:!1,cb:()=>{(0,m.bi)({subscription:g.K.ALL})}},w=e=>({shortText:`Use your code "${e}" to unlock Pro.`,longText:`Your trial has ended. Use your code "${e}" to unlock Shadowmap Pro.`,btnText:"Unlock",disappear:!1,cb:()=>{(0,m.bi)({subscription:g.K.ALL})}}),b={id:(0,a.Z)(),shortText:"No internet connection.",longText:"You lost the internet connection. Check your mobile data/wi-fi.",btnText:"Close",disappear:!0,cb:()=>{}},v=()=>{let e=f.ZP.t("lowerQualityToast.text");return{id:(0,a.Z)(),shortText:e,longText:e,disappear:!0,cb:()=>{}}},y=new n.X([]);u.eE.subscribe(e=>{!y.value.some(t=>t.id===e.id)&&(y.next([...y.value,e]),e.disappear&&setTimeout(()=>{y.next(y.value.filter(t=>t.id!==e.id))},2e4))}),(0,o.a)([u.Qs,u.yX]).pipe((0,r.x)()).subscribe(([e,t])=>{var i,s;if(e&&t)for(let n of t.toasts){if(n.due<=new Date)continue;let t=null==(i=e.user_metadata)?void 0:i.couponCode;if(n.type===d.W.TRIAL_ENDED){if(h.G.fromAppMetadata(null==(s=null==e?void 0:e.app_metadata)?void 0:s.roles).has(l.uU.PRO))return void(0,c.n)(n.id).catch(console.error);if(.2>Math.random()||(t?u.eE.next(Object.assign({id:n.id},w(t))):u.eE.next(Object.assign({id:n.id},x)),.8>Math.random()))return;(0,c.n)(n.id).catch(console.error),d.g.refresh()}else console.error(`Unknown toast type ${n.type}`)}}),t.ZP=()=>{let e=(0,p.Z)(y);if(!e||0===e.length)return null;let t=e=>{y.next(y.value.filter(t=>t.id!==e.id))},i=e=>{e.cb&&e.cb(),t(e)};return(0,s.jsx)("div",{className:"fixed w-full-safe-2.5 right-1/2 transform translate-x-1/2 z-30 space-y-[16px] mt-tsafe-2.5 md:w-auto md:transform-none md:right-auto",children:e.map(e=>(0,s.jsxs)("div",{className:"bg-white px-4 py-3 rounded-[8px] flex flex-col shadow-lg max-w-[450px]",children:[(0,s.jsxs)("div",{className:"flex flex-row items-start sm:items-center text-[14px] text-grey-800",children:[e.icon&&(0,s.jsx)("div",{className:"flex-shrink-0 mr-2",children:e.icon}),(0,s.jsx)("p",{className:"short-text md:hidden grow mr-2",children:e.shortText}),(0,s.jsx)("p",{className:"long-text hidden md:block grow mr-4",children:e.longText}),e.btnText&&(0,s.jsx)("button",{className:"btn-action btn btn-with-label btn-gradient-simple hidden sm:block mr-2 !text-[12px]",onClick:()=>i(e),children:e.btnText}),(0,s.jsx)("button",{className:"btn-close",onClick:()=>t(e),children:(0,s.jsxs)("svg",{className:"h-6 w-6 text-grey-800 feather feather-x",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,s.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),e.btnText&&(0,s.jsx)("button",{className:"btn-action btn btn-with-label btn-gradient-simple sm:hidden mt-3",onClick:()=>i(e),children:e.btnText})]},e.id))})}},97160:function(e,t,i){i.d(t,{$O:function(){return m},AK:function(){return n},Dl:function(){return c},Og:function(){return u},Ut:function(){return p},b1:function(){return a},eG:function(){return l},fm:function(){return d},rA:function(){return o},tq:function(){return r},zc:function(){return h}});var s=i(57155);function n(...e){return e.filter(Boolean).join(" ")}function o(){return window.innerWidth<640}function r(){return navigator.userAgentData?navigator.userAgentData.mobile:/iphone|android/.test(navigator.userAgent.toLowerCase())}function a(){return"maxTouchPoints"in navigator&&navigator.maxTouchPoints>0}function l(e,t=()=>{},i=5,s=1e3){let n=1,o=()=>{var r,a,l,d;return r=this,a=void 0,l=void 0,d=function*(){try{return yield e()}catch(r){if(n>=i)throw t(),r;let e=s*Math.pow(2,n);console.log(`Retry attempt ${n} after ${e}ms`),yield new Promise(t=>setTimeout(t,e)),n++,yield o()}},new(l||(l=Promise))(function(e,t){function i(e){try{n(d.next(e))}catch(e){t(e)}}function s(e){try{n(d.throw(e))}catch(e){t(e)}}function n(t){var n;t.done?e(t.value):((n=t.value)instanceof l?n:new l(function(e){e(n)})).then(i,s)}n((d=d.apply(r,a||[])).next())})};return o()}function d(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}function h(e){if(!e)return{};let t=r()&&a();return{onClick:i=>{t||e(i)},onTouchEnd:i=>{t&&e(i)}}}let c=e=>(+(e/36e5).toFixed(2)).toString(),u=e=>e.toLocaleString("de"===s.ZP.resolvedLanguage?"de-DE":"en-US",{useGrouping:!1}),p=e=>{let t=e/1e3;return t>=10?u(Math.round(t)):t>=1?u(+t.toFixed(1)):t>=.1?u(+t.toFixed(2)):u(+t.toFixed(3))},m=(e,t,i)=>{let s=+e.replace("#","0x"),n=s>>16,o=s>>8&255,r=255&s,a=+t.replace("#","0x");return"#"+(0x1000000+(n+i*((a>>16)-n)<<16)+(o+i*((a>>8&255)-o)<<8)+(r+i*((255&a)-r))|0).toString(16).slice(1)}},63609:function(e,t,i){i.d(t,{nd:function(){return n},nq:function(){return s},qL:function(){return r},yD:function(){return o}});let s=1440,n=36e5,o=60,r=6e4},31089:function(e,t,i){let s;var n,o,r,a,l=i(16433),d=i(56354),h=i(45666),c=i(14229),u=i(82072),p=i(56071),m=i(47386),g=i(12916),f=i(14737),x=i(66704),w=i(98041),b=i(44629),v=function(e,t,i,s){return new(i||(i=Promise))(function(n,o){function r(e){try{l(s.next(e))}catch(e){o(e)}}function a(e){try{l(s.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(r,a)}l((s=s.apply(e,t||[])).next())})},y=i(49419),C=i(56949),M=i(67068),S=i(48383),L=i(53205);i(51383);var T=i(53804),j=i(4419),P=i(15715),E=i(57575),A=i(89399),D=i(84100);let O=e=>{var t,i,s,n;return t=void 0,i=void 0,s=void 0,n=function*(){let{modelId:t,filename:i,version:s}=e,n=yield x.g.token();if(!n)throw Error("No token present to make request");let o=new URLSearchParams;s>1?(o.append("filename",`${t}/${i}`),o.append("version",s.toString())):o.append("filename",i);let r=yield fetch("/.netlify/functions/usermodel-url?"+o,{method:"GET",headers:{Authorization:`Bearer ${n}`}});if(r.ok)return r.json();throw Error((yield r.text()))},new(s||(s=Promise))(function(e,o){function r(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(t){var i;t.done?e(t.value):((i=t.value)instanceof s?i:new s(function(e){e(i)})).then(r,a)}l((n=n.apply(t,i||[])).next())})};var k=i(56972),I=i(33723),N=i(57155),_=i(56009),R=i(6925),V=i(26876),B=i(81098),U=i(15337),F=i(42261),Z=i(46366),H=i(3665),G=i(42589),z=i(79252);let W=new c.X(void 0),X=new c.X(void 0),Y=new c.X(void 0),$=new c.X(void 0),Q=new c.X(!1),q=new c.X(!1);L.l8.subscribe(e=>{e||setTimeout(()=>{1>+(localStorage.getItem("sunPathDragActionVersion")||"0")&&(q.next(!0),setTimeout(K,2e4))},5e3)});let K=()=>{q.next(!1),localStorage.setItem("sunPathDragActionVersion","1")},J=new c.X(void 0);B.mw.pipe((0,_.U)(e=>e.dateTime.year),(0,R.x)()).subscribe(e=>{let t=new U(e.toString()),i=1e3*m.ou.utc(e).toUnixInteger(),s=1e3*m.ou.utc(e+1).toUnixInteger()-i;J.next({springEquinox:{date:m.ou.fromJSDate(t.spring),progressThroughYear:(t.spring-i)/s},summerSolstice:{date:m.ou.fromJSDate(t.summer),progressThroughYear:(t.summer-i)/s},autumnEquinox:{date:m.ou.fromJSDate(t.autumn),progressThroughYear:(t.autumn-i)/s},winterSolstice:{date:m.ou.fromJSDate(t.winter),progressThroughYear:(t.winter-i)/s}})});let ee=new V.x;ee.pipe((0,p.M)(L.R9,J,Z.Xq),(0,F.h)(([e,t,i])=>!!t&&!!i)).subscribe(([e,t,i,s])=>{if(i){if(s.phantomLocks.dateSlider)return void L.y7.next({modal:H.o.COUPON_CODE,opts:{trigger:G.g.TimeUpgrade}});if(!t.isAllowedToUsePro()&&!s.capabilities.unlockEverything)return void L.y7.next({modal:H.o.FEATURE_UPGRADE,opts:{type:z.l.Date,trigger:"sun_hud_path_click"}});(0,M.fG)(i[e].date)}});var et=i(57364),ei=i(2873),es=i(70846);let en=(0,es.createContext)({currentTheme:{name:"default",gradient:"from-[#F8F991] to-[#FFCD00]",hoverGradient:"hover:from-sun-100 hover:to-sun-100",shadow:"shadow-sun-glow",hoverShadow:"hover:shadow-sun-glow-hover",toggleShadow:"shadow-sun-glow-toggle",actionColor:"text-neon-400",textColor:"text-grey-800",focusInputColor:"focus:ring-neon-300",zoomButtonsRadius:"full"}});var eo=i(71378),er=i(57487),ea=i(94829),el=i(97160),ed=i(42629),eh=({product:e,mode:t,onClick:i,isAbsolute:s=!0,isFullSize:n=!0})=>{let o=(e=>{switch(e){case"explorer":return"bg-shadowmap-blue";case"home":return"bg-shadowmap-green";case"studio":return"bg-shadowmap-red";case"generic":return"bg-shadowmap-yellow"}})(e);return(0,ei.jsx)("div",{onClick:e=>{e.stopPropagation(),i()},className:(0,el.AK)(s?"absolute top-0 left-0":"","cursor-pointer flex items-center justify-center group",n?"w-full h-full":""),children:(0,ei.jsxs)("button",{className:(0,el.AK)(o,"group-hover:opacity-70 rounded-[6px] p-[3px] flex items-center text-black"),children:[(0,ei.jsx)(ed.mB,{}),"big"===t&&(0,ei.jsx)("p",{className:"text-[8px] font-bold ml-[3px] mr-[2px]",children:"UPGRADE"})]})})};let ec={nextzen:"Nextzen",nextzenV2:"Nextzen v2",mapbox:"Mapbox",stadia:"Stadia",esri:"Esri"},eu=({isAllowedToUsePro:e,disabledAction:t})=>{let[i,s]=(0,et.mr)("elevationModel"),{currentTheme:n}=(0,es.useContext)(en),{t:o}=(0,ea.$G)(),r=!e,a=()=>{r&&(null==t||t())};return(0,ei.jsxs)("div",{className:"mt-0.5",children:[(0,ei.jsxs)("div",{className:"text-grey-100 text-sm flex pb-2 flex-start items-center",children:[o("settingsPanel.elevationModel.title"),!e&&(0,ei.jsx)("div",{className:"relative translate-x-5",children:(0,ei.jsx)(eh,{product:"home",mode:"small",onClick:()=>{null==t||t()}})})]}),(0,ei.jsxs)("div",{className:`relative flex flex-row justify-between items-center ${e?"":"[&>*]:opacity-30 [&>*]:pointer-events-none cursor-not-allowed"}`,onClick:a,children:[(0,ei.jsx)("select",{onChange:e=>{if(r){null==t||t();return}let i=e.target.value;s(i),P.n.onElevationModelChange(i)},onClick:a,value:i,className:`block w-full rounded-lg border-0 px-3 py-2 text-grey-100 bg-grey-800 hover:bg-grey-700
            ring-1 ring-inset ring-grey-500 hover:ring-grey-300 placeholder:text-grey-400 focus:bg-grey-700 ${n.focusInputColor}
            appearance-none !bg-none`,children:Object.entries(ec).map(([e,t])=>(0,ei.jsx)("option",{value:e,children:t},e))}),(0,ei.jsxs)("div",{className:"absolute inset-y-0 right-3 flex flex-col justify-center align-center pointer-events-none",children:[(0,ei.jsx)(eo.Z,{className:"block h-4 w-4 text-grey-100"}),(0,ei.jsx)(er.Z,{className:"block h-4 w-4 text-grey-100 -mt-2"})]})]})]})};var ep=i(79121),em=i(18320),eg=i(950),ef=i(412);i(27841),new c.X(void 0);var ex=i(35041),ew=i(86401);let eb=A.V5.shareId();(n=r||(r={}))[n.Loading=0]="Loading",n[n.Available=1]="Available",n[n.NotFound=2]="NotFound";let ev=new c.X(r.Loading),ey=new c.X(void 0),eC=ey.pipe((0,_.U)(e=>ew.G.fromAppMetadata(null==e?void 0:e.authorsRoles)),(0,R.x)((e,t)=>e.equals(t)));var eM=i(99898),eS=i(36313),eL=i(71868),eT=i.n(eL),ej=i(63966);let eP=({children:e})=>(0,ei.jsx)("p",{className:"m-0",children:e}),eE=()=>{let[e,t]=(0,es.useState)(""),[i,s]=(0,es.useState)(""),[n,o]=(0,es.useState)(""),[r,a]=(0,es.useState)("");return(0,es.useEffect)(()=>{let e=[M.TM.subscribe(({dateTime:e})=>{t(e.setZone("UTC").toLocaleString(m.ou.DATETIME_SHORT))}),M.sP.subscribe(e=>{if(!e.isTimeZoneDefined())return void s("Time zone is not defined");s(e.dateTime.toLocaleString(m.ou.DATETIME_SHORT))}),M.nM.subscribe(e=>{o(String(e))}),M.kp.subscribe(e=>{a(String(e))})];return()=>{for(let t of e)t.unsubscribe()}},[]),(0,ei.jsxs)("aside",{id:"debugPanel",className:"select-and-touch-none ease-in-out duration-300 transition-x-80 hidden fixed w-52 bg-white opacity-70 p-2 shadow rounded-md text-xxs text-grey-800 bottom-10 right-rsafe-2",children:[(0,ei.jsxs)(eP,{children:["UTC: ",(0,ei.jsx)("strong",{children:e})]}),(0,ei.jsxs)(eP,{children:["At location: ",(0,ei.jsx)("strong",{children:i})]}),(0,ei.jsxs)(eP,{children:["Timezone: ",(0,ei.jsx)("strong",{children:n})]}),(0,ei.jsxs)(eP,{children:["Offset hours: ",(0,ei.jsx)("strong",{children:r})]}),(0,ei.jsx)("hr",{}),(0,ei.jsxs)(eP,{children:["Lat: ",(0,ei.jsx)("strong",{id:"debug-lat"})]}),(0,ei.jsxs)(eP,{children:["Lng: ",(0,ei.jsx)("strong",{id:"debug-lng"})]}),(0,ei.jsxs)(eP,{children:["X: ",(0,ei.jsx)("strong",{id:"debug-x"})]}),(0,ei.jsxs)(eP,{children:["Y: ",(0,ei.jsx)("strong",{id:"debug-y"})]}),(0,ei.jsx)("hr",{}),(0,ei.jsxs)(eP,{children:["Zoom: ",(0,ei.jsx)("strong",{id:"debug-zoom"})]}),(0,ei.jsxs)(eP,{children:["Azimuth: ",(0,ei.jsx)("strong",{id:"debug-azimuth"})]}),(0,ei.jsxs)(eP,{children:["Polar: ",(0,ei.jsx)("strong",{id:"debug-polar"})]}),(0,ei.jsxs)(eP,{children:["Cam distance: ",(0,ei.jsx)("strong",{id:"debug-camera-distance"})]}),(0,ei.jsxs)(eP,{children:["Tile width: ",(0,ei.jsx)("strong",{id:"debug-tile-width"})]}),(0,ei.jsx)(eP,{children:(0,ei.jsx)("span",{id:"debug-txt"})})]})};var eA=i(93684),eD=i.n(eA);let eO=()=>{let[e,t]=(0,es.useState)(!1),i=(0,es.useRef)(null),s=(0,es.useRef)(null);return(0,es.useEffect)(()=>{i.current&&L.rE.next(i.current)},[i]),(0,es.useEffect)(()=>{s.current&&L.nb.next(s.current)},[s]),(0,es.useEffect)(()=>{let e=(0,et.ZW)("firstPersonView").subscribe(e=>{e?(0,el.b1)()&&t(!0):t(!1)});return()=>{e.unsubscribe()}},[]),(0,ei.jsx)("div",{className:eD()("fixed left-[30px] bottom-[75px] w-[140px] h-[140px] bg-white/10 rounded-full shadow-[0_0_10px_rgba(0,0,0,0.1)]",{hidden:!e}),ref:i,children:(0,ei.jsx)("div",{className:"relative top-10 left-10",children:(0,ei.jsx)("div",{className:"w-[60px] h-[60px] bg-white/20 rounded-full border-2 border-white shadow-[0_0_10px_rgba(0,0,0,0.1)]",ref:s})})})};var ek=i(14725),eI=()=>{let{currentTheme:e}=(0,es.useContext)(en),[t,i]=(0,et.mr)("visualQuality"),{t:s}=(0,ea.$G)(),n=[{name:s("settingsPanel.quality.low"),type:l.pV.DESKTOP_LOW},{name:s("settingsPanel.quality.medium"),type:l.pV.DESKTOP_MEDIUM},{name:s("settingsPanel.quality.high"),type:l.pV.DESKTOP_HIGH}],o=[{name:s("settingsPanel.quality.low"),type:l.pV.MOBILE_LOW},{name:s("settingsPanel.quality.medium"),type:l.pV.MOBILE_MEDIUM},{name:s("settingsPanel.quality.high"),type:l.pV.MOBILE_HIGH}],r=(0,el.tq)()?o:n;return(0,ei.jsx)(ek.O.Group,{onChange:e=>{let{type:t}=r[e],s="";switch(t){case l.pV.DESKTOP_HIGH:case l.pV.MOBILE_HIGH:s="high";break;case l.pV.DESKTOP_MEDIUM:case l.pV.MOBILE_MEDIUM:s="medium";break;case l.pV.DESKTOP_LOW:case l.pV.MOBILE_LOW:s="low"}P.n.onVisualQualityChange(s),i(t)},selectedIndex:r.findIndex(e=>e.type==t),children:(0,ei.jsx)(ek.O.List,{className:"flex w-full",children:r.map(({name:t,type:i},s)=>(0,ei.jsx)(ek.O,{as:"div",className:"flex-1 text-center cursor-pointer hover-bg-gradient-child",children:({selected:i})=>(0,ei.jsx)("div",{className:`font-bold text-sm ${i?`p-[1px] bg-gradient-to-t ${e.shadow} ${e.textColor} ${e.gradient}`:"py-2 bg-grey-800 border border-grey-500 hover:bg-grey-700 hover:border-grey-300"} ${0===s?"rounded-l-full":""} ${s===r.length-1?"rounded-r-full":""}`,children:(0,ei.jsx)("div",{className:i?`py-2 w-full h-full bg-gradient-to-b ${e.textColor} ${e.gradient} ${0===s?"rounded-l-full":""} ${s===r.length-1?"rounded-r-full":""}`:"",children:t})})},i))})})},eN=i(47208),e_=i(50047);let eR=({checked:e,disabled:t,onChange:i})=>{let{currentTheme:s}=(0,es.useContext)(en);return(0,ei.jsx)(eN.r,{disabled:t,checked:e,onChange:i,className:`inline-flex p-[1px] ${t?"cursor-not-allowed":"cursor-pointer"} rounded-full transition-colors duration-200 ease-in-out ${e?`bg-gradient-to-t active:bg-gradient-to-b ${s.gradient} ${!t?`${s.hoverShadow} ${s.hoverGradient}`:""}`:`bg-grey-500 ${!t?"hover:bg-grey-300":""}`}`,children:(0,ei.jsx)("div",{className:`inline-flex p-[3px] w-11 h-6 rounded-full items-center ${e?`bg-gradient-to-b active:bg-gradient-to-t ${s.gradient}`:`bg-grey-800 ${!t?"hover:bg-grey-700":""}`}`,children:(0,ei.jsx)("div",{className:`inline-block transition duration-200 p-px ease-in-out rounded-full ${e?`translate-x-[100%] bg-gradient-to-t h-[19px] w-[19px] ${s.gradient} ${s.toggleShadow}`:"translate-x-0 bg-white h-[18px] w-[18px]"}`,children:(0,ei.jsx)("div",{"aria-hidden":"true",className:"pointer-events-none transform rounded-full w-full h-full bg-white ring-0"})})})})},eV=()=>(0,ei.jsx)("svg",{width:"14",height:"12",viewBox:"0 0 14 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,ei.jsx)("path",{d:"M1.5 1.16602V6.16602C1.5 7.27058 2.39543 8.16602 3.5 8.16602H11.8333M9.83333 5.49935L12.5 8.16602L9.83333 10.8327",stroke:"#788591",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),eB=({label:e,noLabelStyle:t,checked:i,disabled:s,onChange:n,tooltip:o,isSub:r,showLock:a,disabledAction:l,productLock:d})=>(0,ei.jsxs)(eN.r.Group,{as:"div",className:`flex items-center justify-between gap-2 ${s?"opacity-30":""}`,children:[(0,ei.jsxs)("div",{className:"flex flex-start items-center",children:[(0,ei.jsxs)(eN.r.Label,{as:"span",className:t?"":"text-sm text-grey-100 flex gap-1.5 items-center",passive:!0,children:[r&&(0,ei.jsx)(eV,{}),e]}),o&&(0,ei.jsx)(e_.oD,{content:o,className:"ml-1.5"})]}),(0,ei.jsxs)("div",{className:"flex flex-end flex-row gap-2 items-center",children:[a&&d&&!i&&(0,ei.jsx)(eh,{product:d,mode:"small",onClick:null!=l?l:()=>{},isAbsolute:!1}),(0,ei.jsx)(eR,{checked:i,disabled:s,onChange:n})]})]}),eU=({label:e,stateKey:t,disabled:i,disabledAction:s,tooltip:n,showLock:o,productLock:r,isSub:a})=>{let[l,d]=(0,et.mr)(t);return(0,ei.jsx)(eB,{label:e,checked:l,disabled:i,onChange:()=>{if(o&&s)return void s();d(!l)},tooltip:n,showLock:o,disabledAction:s,productLock:r,isSub:a})};class eF{constructor(e){var t,i;this._format=new Intl.NumberFormat(e,{maximumFractionDigits:20});let s=this._format.formatToParts(12345.6),n=Array.from({length:10}).map((e,t)=>this._format.format(t)),o=new Map(n.map((e,t)=>[e,t]));this._group=RegExp(`[${null==(t=s.find(e=>"group"===e.type))?void 0:t.value}]`,"g"),this._decimal=RegExp(`[${null==(i=s.find(e=>"decimal"===e.type))?void 0:i.value}]`),this._numeral=RegExp(`[${n.join("")}]`,"g"),this._index=e=>o.get(e)}parse(e){let t=e.trim().replace(this._group,"").replace(this._decimal,".").replace(this._numeral,this._index);return t?+t:NaN}format(e){return this._format.format(e).replace(this._group,"")}}var eZ=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&0>t.indexOf(s)&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,s=Object.getOwnPropertySymbols(e);n<s.length;n++)0>t.indexOf(s[n])&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(i[s[n]]=e[s[n]]);return i};function eH(e,t){let i=Math.pow(10,t);return Math.round(Number((Math.abs(e)*i).toPrecision(15)))/i*Math.sign(e)}function eG(e){var{style:t={},modifiers:i={},onChange:s,onInput:n,blurredValue:o}=e,r=eZ(e,["style","modifiers","onChange","onInput","blurredValue"]);let[a,l]=(0,es.useState)(""),[d,h]=(0,es.useState)(""),c=(0,es.useRef)(0),u=(0,es.useRef)(null),p=r.step?+r.step:1,m=r.precision?+r.precision:p,g=(0,es.useMemo)(()=>Object.assign({shiftKey:.1},i),[i]),[,f]=(0,es.useState)([0,0]),x=Object.assign({cursor:"ew-resize"},t),w=new eF,b=e=>{l(w.format(e))},v=function(e,t=300){let i;return(...s)=>{clearTimeout(i),i=setTimeout(()=>{e.apply(this,s)},t)}}(e=>{null==s||s(e,u.current)},200),y=(0,es.useCallback)(e=>{requestAnimationFrame(()=>{null==n||n(e,u.current)}),v(e)},[v,n]),C=(0,es.useCallback)(e=>{f(t=>{let{clientX:i,clientY:s}=e,[n,o]=t,a=1;d&&(a=g[d]||1);let l=p*a,h=Math.floor(l)===l?0:l.toString().split(".")[1].length||0,u=c.current+eH((i-n+(o-s))*l,h);return void 0!==r.min&&(u=Math.max(u,+r.min)),void 0!==r.max&&(u=Math.min(u,+r.max)),b(u=eH(u,m)),y(u),t})},[d,r.max,r.min,p,y,g]),M=(0,es.useCallback)(()=>{document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",M)},[C]),S=(0,es.useCallback)(e=>{let t=w.parse(a);isNaN(t)&&(t=+(r.defaultValue||r.min||0)),c.current=t,f([e.clientX,e.clientY]),document.addEventListener("mousemove",C),document.addEventListener("mouseup",M)},[C,M,a,r.min,r.defaultValue]),L=e=>{e.metaKey?h("metaKey"):e.ctrlKey?h("ctrlKey"):e.altKey?h("altKey"):e.shiftKey&&h("shiftKey")},T=()=>{h("")};(0,es.useEffect)(()=>{"number"==typeof r.value&&b(eH(r.value,m))},[r.value]),(0,es.useEffect)(()=>(document.addEventListener("keydown",L),document.addEventListener("keyup",T),()=>{document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",M),document.removeEventListener("keydown",L),document.removeEventListener("keyup",T)}),[]);let j=()=>{void 0!==o&&u.current!==document.activeElement&&b(eH(o,m))};return(0,es.useEffect)(()=>{j()},[o]),(0,ei.jsx)("input",Object.assign({},r,{value:a,style:x,onMouseDown:S,onChange:e=>{let t=e.target.value,i=w.parse(t);if(t.endsWith(".")||t.endsWith(",")||""===t||"-"===t||t.endsWith("0"))return void l(t);if(isNaN(i))return;let n=function(e,t){let i=Math.pow(10,t);return Math.floor(Number((Math.abs(e)*i).toPrecision(15)))/i*Math.sign(e)}(i,m);b(n),null==s||s(n,u.current)},ref:u,onBlur:e=>{let t=w.parse(e.target.value);if(isNaN(t))b(c.current),null==s||s(c.current,u.current);else{let e=eH(t,m);r.min&&(e=Math.max(e,+r.min)),r.max&&(e=Math.min(e,+r.max)),b(e),null==s||s(e,u.current)}j()}}))}let ez=({className:e,label:t,stepPrecision:i=1,precision:s=i,initialValue:n,onClick:o,onChange:r,tooltip:a,max:l,min:d,disabled:h,buttonDisabled:c,buttonLabel:u,onButtonClick:p,lock:m,lockAction:g})=>{let f=(0,k.Z)(),[x,w]=(0,es.useState)(n),{currentTheme:b}=(0,es.useContext)(en),v=+Math.pow(10,-i).toFixed(i),y=e=>{let t=e;return void 0!==l&&(t=Math.min(l,t)),void 0!==d&&(t=Math.max(d,t)),t};(0,es.useEffect)(()=>{w(n)},[n]);let C=e=>{Number.isNaN(e)?w(n):(w(e),r(y(e)))};return(0,ei.jsxs)("div",{className:e,children:[(0,ei.jsxs)("label",{htmlFor:f,className:"text-grey-100 text-sm flex pb-1 flex-start items-center",children:[(0,ei.jsx)("span",{className:"text-ellipsis overflow-hidden",children:t}),a&&(0,ei.jsx)(e_.QC,{content:a,className:"tooltip-icon ml-1.5"}),m&&(0,ei.jsx)("div",{className:"ml-1.5",children:(0,ei.jsx)(eh,{product:m,mode:"small",onClick:()=>{null==g||g()},isAbsolute:!1,isFullSize:!1})})]}),(0,ei.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,ei.jsx)("div",{className:eD()("group w-full",{"opacity-30 cursor-not-allowed":h}),onClick:o,children:(0,ei.jsxs)("div",{className:"relative ",children:[(0,ei.jsx)(eG,{id:f,className:eD()("settings-input block w-full rounded-lg border-0 px-3 py-2 ring-1 ring-grey-500 group-hover:ring-grey-300 placeholder:text-grey-400 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",{[b.focusInputColor]:!0,["group-hover:"+b.focusInputColor]:!0,"pointer-events-none":h}),value:x,blurredValue:n,onInput:C,onChange:C,step:v,precision:s,min:d,max:l,inputMode:"decimal"}),(0,ei.jsxs)("div",{className:"absolute inset-y-0 right-0 flex flex-col rounded-r-lg invisible group-hover:visible",children:[(0,ei.jsx)("div",{className:"group/step flex-1 cursor-pointer pl-2 pr-3",onClick:()=>{h||C(y(x+v))},children:(0,ei.jsx)(eo.Z,{className:"relative -bottom-2 h-4 w-4 text-grey-100 group-hover/step:text-grey-500 pointer-events-none"})}),(0,ei.jsx)("div",{className:"group/step flex-1 cursor-pointer pl-2 pr-3",onClick:()=>{h||C(y(x-v))},children:(0,ei.jsx)(er.Z,{className:"relative -top-1 h-4 w-4 text-grey-100 group-hover/step:text-grey-500 pointer-events-none"})})]})]})}),u&&(0,ei.jsx)("button",{className:eD()("settings-reset self-end rounded-full uppercase whitespace-nowrap border-solid border-2 text-xs font-bold h-7 px-2.5 mb-[6px]",{"opacity-30 cursor-not-allowed":c}),onClick:p,children:u})]})]})},eW=({isAllowedToUsePro:e=!0,disabledAction:t})=>{let{t:i}=(0,ea.$G)(),[{floorHeight:s},n]=(0,et.mr)("floorLevelIndicationState"),o=!e;return void 0===s?null:(0,ei.jsx)(ez,{label:i("settingsPanel.floorLevelIndicator.label"),tooltip:i("settingsPanel.floorLevelIndicator.tooltip"),initialValue:s,onChange:e=>{if(o){null==t||t();return}n({enabled:!0,floorHeight:e})},onClick:()=>{o&&(null==t||t())},stepPrecision:1,precision:2,min:.1,buttonLabel:i("settingsPanel.floorLevelIndicator.reset"),onButtonClick:()=>{if(o){null==t||t();return}let e=(0,et.Lu)("floorLevelIndicationState").floorHeight;s!==e&&n({enabled:!0,floorHeight:e})},buttonDisabled:s===(0,et.Lu)("floorLevelIndicationState").floorHeight,disabled:o})},eX=({isAllowedToUsePro:e,disabledAction:t,productLock:i})=>{let{t:s}=(0,ea.$G)(),[{enabled:n},o]=(0,et.mr)("floorLevelIndicationState");return(0,ei.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,ei.jsx)(eB,{label:s("settingsPanel.floorLevelIndicator.title"),checked:n,disabled:!1,onChange:()=>{let i=!n;if(i&&!e){null==t||t();return}o({enabled:i,floorHeight:(0,et.Lu)("floorLevelIndicationState").floorHeight})},showLock:!e,disabledAction:t,productLock:i}),n&&(0,ei.jsx)("div",{className:"flex flex-col gap-2",children:(0,ei.jsx)(eW,{isAllowedToUsePro:e,disabledAction:t})})]})},eY=({disabled:e,disabledAction:t})=>{let{t:i}=(0,ea.$G)(),[s,n]=(0,et.mr)("cameraFocalLength");return void 0===s?null:(0,ei.jsx)(ez,{className:"mt-0.5",label:i("settingsPanel.camera.focalLength"),initialValue:s,onChange:i=>{if(e){null==t||t();return}n(i)},onClick:()=>{e&&(null==t||t())},buttonLabel:i("settingsPanel.camera.focalLengthReset"),onButtonClick:()=>{if(e){null==t||t();return}let i=(0,et.Lu)("cameraFocalLength");s!==i&&n(i)},disabled:e,buttonDisabled:s===(0,et.Lu)("cameraFocalLength")||e,stepPrecision:0,precision:1,min:5})};var e$=i(28290),eQ=i(47831);let eq=()=>{let{t:e}=(0,ea.$G)(),[t,i]=(0,es.useState)(),[s,n]=(0,es.useState)(),[o,r]=(0,es.useState)(),{currentTheme:a}=(0,es.useContext)(en),d=(0,eQ.Z)(ep.UW.pipe((0,_.U)(e=>e===ep.BS.Analytics)));return((0,es.useEffect)(()=>{let e=S.As.subscribe(e=>{i(e),e&&(n(e.lat),r(e.lng))});return()=>e.unsubscribe()},[]),t&&void 0!==s&&void 0!==o)?(0,ei.jsx)("form",{onSubmit:e=>{if(e.preventDefault(),d)return;P.n.onLocationChangeFromInput();let i=new l.Y(s,o,t.zoom);S.qi.next({location:i,dropPin:!0})},children:(0,ei.jsxs)("div",{className:"flex gap-2",children:[(0,ei.jsx)(ez,{label:e("settingsPanel.jumpToCoordinates.latitude"),initialValue:s,onChange:n,stepPrecision:5,precision:7,disabled:d}),(0,ei.jsx)(ez,{label:e("settingsPanel.jumpToCoordinates.longitude"),initialValue:o,onChange:r,stepPrecision:5,precision:7,disabled:d}),(0,ei.jsx)("button",{title:e("settingsPanel.jumpToCoordinates.submit"),type:"submit",className:eD()("rounded-full p-px mb-px self-end bg-gradient-to-t group active:bg-gradient-to-b",a.shadow,a.hoverShadow,a.gradient,a.hoverGradient,{"opacity-30 cursor-not-allowed":d}),children:(0,ei.jsx)("div",{className:`rounded-full p-3 bg-gradient-to-b group-active:bg-gradient-to-t ${a.textColor} ${a.gradient}`,children:(0,ei.jsx)(e$.Z,{className:"w-5 h-5"})})})]})}):null},eK=({active:e,name:t,imgUrl:i,onClick:s,locked:n=!1,lockProduct:o="generic",disabledAction:r,fullWidth:a,content:l=(0,ei.jsx)(ei.Fragment,{}),disabled:d})=>{let{currentTheme:h}=(0,es.useContext)(en);return(0,ei.jsxs)("div",{onClick:()=>{n||d||s()},title:t,className:`min-w-0 ${n||d?"cursor-auto":"cursor-pointer"}`,children:[(0,ei.jsxs)("div",{className:`relative rounded-[10px] p-0.5 ${e?"bg-gradient-to-t":"bg-grey-400 hover:bg-grey-300"} ${h.gradient}`,children:[(0,ei.jsx)("div",{className:`rounded-[8px] p-1 bg-grey-800/90 ${e?"":"hover:bg-grey-700"}`,children:(0,ei.jsx)("div",{className:`rounded-[4px] ${a?"h-[82px]":"aspect-square"} bg-cover bg-center overflow-hidden text-right`,style:{backgroundImage:`url(${i})`},children:l})}),n&&(0,ei.jsx)(eh,{product:o,mode:"small",onClick:r||(()=>{})})]}),(0,ei.jsx)("p",{className:`pl-2 text-sm truncate ${a?"w-full":"w-24"} ${e?h.actionColor:"text-grey-100 hover:text-white"}`,children:t})]})};var eJ=({isUnlocked:e,disabledAction:t,trackingEnabled:i,disabled:s,onClick:n})=>{let{t:o}=(0,ea.$G)(),[r,a]=(0,et.mr)("mapStyle"),[d,h]=(0,et.mr)("mapMode"),c=(0,Z.MG)(e=>e.phantomLocks.mapMode),u=[{type:"map",imgUrl:"img/basemap_vector_15_17878_11363.jpg",name:o("settingsPanel.mapStyle.standard"),trackingKey:"standard"},{type:"satellite",imgUrl:"img/basemap_satellite_15_11363_17878.jpg",name:o("settingsPanel.mapStyle.satellite"),locked:!e||c,trackingKey:"satellite"},{type:"outdoor",imgUrl:"img/basemap_outdoor_15_17878_11363.jpg",name:o("settingsPanel.mapStyle.outdoor"),locked:!e||c,trackingKey:"outdoor"}];return(0,ei.jsx)("div",{className:eD()("flex w-full gap-2 justify-between",{"opacity-30":s}),children:u.map(({type:e,imgUrl:o,name:u,locked:p=!1,trackingKey:m})=>(0,ei.jsx)(eK,{active:r===e&&d===l.M$.DEFAULT,name:u,imgUrl:o,onClick:()=>{!s&&(a(e),h(l.M$.DEFAULT),n&&n(),i&&P.n.onMapStyleChange(m))},locked:p,lockProduct:c?"generic":"home",disabledAction:()=>{if(n&&n(),c)return void L.y7.next({modal:H.o.COUPON_CODE,opts:{trigger:G.g.Generic}});t&&t(m)},disabled:s},e))})},e1=i(5906),e0=({onClick:e})=>{let{t}=(0,ea.$G)(),[i,s]=(0,et.mr)("mapMode"),n=(0,eQ.Z)(L.R9),o=(0,Z.MG)(e=>e.capabilities.unlockEverything),r=(0,Z.MG)(e=>e.phantomLocks.mapMode),a=(null==n?void 0:n.isAllowedToUseStudio())||o;return(0,ei.jsx)("div",{className:eD()("mt-2 w-full"),children:(0,ei.jsx)(eK,{active:i===l.M$.GOOGLE,name:t("settingsPanel.mapStyle.google3D"),imgUrl:"./img/basemap_google.jpg",onClick:()=>{if(e&&e(),r)return void L.y7.next({modal:H.o.COUPON_CODE,opts:{trigger:G.g.Generic}});if(a){s(l.M$.GOOGLE),P.n.onMapStyleChange("google3d");return}P.n.onGooglePreviewClick(),(0,e1.cn)()?e1.Yy.next(!0):L.y7.next({modal:H.o.GOOGLE_3D_PREVIEW_DIALOG})},fullWidth:!0,content:(0,ei.jsx)("div",{className:"flex justify-end items-center p-3 pointer-events-none w-full h-full bg-gradient-to-r from-grey-800/0 to-grey-800/70",children:r?(0,ei.jsx)("div",{className:"flex flex-row justify-center items-center w-full",children:(0,ei.jsx)(eh,{product:"generic",mode:"big",isAbsolute:!1,onClick:()=>{}})}):a?(0,ei.jsx)("div",{className:"w-[80%]",children:(0,ei.jsx)("div",{className:"text-white font-bold text-xs",children:t("settingsPanel.mapStyle.google3DDescription")})}):(0,ei.jsx)("div",{className:"flex flex-row justify-center items-center w-full",children:(0,ei.jsx)("button",{className:"bg-shadowmap-yellow group-hover:opacity-70 rounded-[6px] p-[3px] flex items-center text-black cursor-pointer",children:(0,ei.jsx)("p",{className:"text-[10px] font-bold ml-[3px] mr-[2px]",children:t("settingsPanel.mapStyle.google3DPreview")})})})}),disabled:!1})})},e2=i(25363);let e5=()=>{let{t:e}=(0,ea.$G)();return(0,ei.jsxs)("div",{className:"flex flex-col grow bg-grey-700/90 divide-y divide-grey-400 backdrop-filter-map overflow-y-auto pb-bsafe-4",children:[(0,ei.jsxs)("div",{className:"p-4",children:[(0,ei.jsx)("div",{className:"font-bold mb-4",children:e("settingsPanel.mapStyle.title")}),(0,ei.jsx)(eJ,{isUnlocked:!0}),(0,ei.jsx)(e0,{})]}),(0,ei.jsxs)("div",{className:"p-4",children:[(0,ei.jsx)("div",{className:"font-bold mb-4 flex",children:e("settingsPanel.data.title")}),(0,ei.jsx)(()=>(0,ei.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,ei.jsx)(eU,{label:e("settingsPanel.data.showTrees"),stateKey:"showTrees",tooltip:e("settingsPanel.data.showTreesTooltip")}),(0,ei.jsx)(eX,{isAllowedToUsePro:!0}),(0,ei.jsx)(eu,{isAllowedToUsePro:!0})]}),{})]}),(0,ei.jsxs)("div",{className:"p-4",children:[(0,ei.jsx)("div",{className:"font-bold mb-4 flex",children:e("settingsPanel.camera.title")}),(0,ei.jsx)(()=>(0,ei.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,ei.jsx)(eU,{label:e("settingsPanel.camera.autoRotate"),stateKey:"autoRotate"}),(0,ei.jsx)(eY,{disabled:!1})]}),{})]}),(0,ei.jsxs)("div",{className:"p-4",children:[(0,ei.jsx)("div",{className:"font-bold mb-4 flex",children:e("settingsPanel.presentation.title")}),(0,ei.jsx)(()=>{let[t,i]=(0,et.mr)("sunPathEnabled"),[s,n]=(0,et.mr)("sunPathLocked");return(0,ei.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,ei.jsx)(eU,{label:e("settingsPanel.presentation.autoPlayTime"),stateKey:"autoPlayTime"}),(0,ei.jsx)(eU,{label:e("settingsPanel.presentation.sunPath"),stateKey:"sunPathEnabled"}),t&&(0,ei.jsx)(eB,{label:e("settingsPanel.presentation.sunPathLock"),checked:s,onChange:()=>{var e,t,i,o;return e=void 0,t=void 0,i=void 0,o=function*(){let e=yield(0,e2.z)(S.PG);n(!s),(0,et.I5)("sunPathLockLocation",{lat:e.lat,lng:e.lng})},new(i||(i=Promise))(function(s,n){function r(e){try{l(o.next(e))}catch(e){n(e)}}function a(e){try{l(o.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?s(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(r,a)}l((o=o.apply(e,t||[])).next())})},isSub:!0}),(0,ei.jsx)(eU,{label:e("settingsPanel.presentation.sunVector"),stateKey:"sunVectorVisible"}),(0,ei.jsx)(eU,{label:e("settingsPanel.presentation.hideUI"),stateKey:"hideUI"})]})},{})]}),(0,ei.jsxs)("div",{className:"p-4",children:[(0,ei.jsx)("div",{className:"font-bold mb-4",children:e("settingsPanel.quality.title")}),(0,ei.jsx)("div",{className:"flex w-full gap-2",children:(0,ei.jsx)(eI,{})})]})]})},e3=({children:e})=>{let t=(0,eQ.Z)(Z.Xq);return t?(0,ei.jsx)(en.Provider,{value:{currentTheme:t.theme},children:e}):null};var e4=({isAllowedToUse:e,disabledAction:t})=>{let{t:i}=(0,ea.$G)(),[s,n]=(0,et.mr)("defaultBuildingHeight"),o=(0,et.Lu)("defaultBuildingHeight");return(0,ei.jsx)(ez,{className:"mt-0.5",label:i("settingsPanel.defaultBuildingHeight.label"),tooltip:i("settingsPanel.defaultBuildingHeight.tooltip"),initialValue:s,onChange:i=>{if(!e)return void t();n(i)},onClick:()=>{e||t()},disabled:!e,stepPrecision:1,precision:2,min:.1,buttonLabel:i("settingsPanel.defaultBuildingHeight.reset"),onButtonClick:()=>n(o),buttonDisabled:s===o,lock:e?void 0:"home",lockAction:t})},e8=i(84400);let e9=()=>L.Jt.next(!L.Jt.value),e7=()=>{L.Jt.value||e9()},e6=()=>{L.Jt.value&&e9()};(0,et.hu)("firstPersonView",e=>{e?e6():e7()});let te=({isAllowedToUseExplorer:e,isAllowedToUseHome:t,buyExplorer:i,buyHome:s})=>{let{showAntiAliasing:n,showAmbientOcclusion:o,allowChangeSunPathLock:r,showHideUI:a,showAutoPlayTime:l}=(0,Z.MG)(e=>e.capabilities),[d,h]=(0,et.mr)("sunPathEnabled"),[c,u]=(0,et.mr)("sunPathLocked"),[p,m]=(0,et.mr)("autoPlayTime"),g=(0,eQ.Z)(ep.UW.pipe((0,_.U)(e=>e===ep.BS.Analytics)));return(0,ei.jsxs)("div",{className:"flex flex-col gap-2",children:[l&&(0,ei.jsx)(eB,{label:(0,N.t)("settingsPanel.presentation.autoPlayTime"),checked:p,onChange:()=>{m(!p)},disabled:g}),(0,ei.jsx)(eB,{label:(0,N.t)("settingsPanel.presentation.sunPath"),tooltip:(0,N.t)("settingsPanel.presentation.sunPathTooltip"),checked:d,onChange:()=>{h(!d)},disabled:g}),d&&r&&(0,ei.jsx)(eB,{label:(0,N.t)("settingsPanel.presentation.sunPathLock"),checked:c,onChange:()=>{var e,t,i,s;return e=void 0,t=void 0,i=void 0,s=function*(){let e=yield(0,e2.z)(S.PG);u(!c),(0,et.I5)("sunPathLockLocation",{lat:e.lat,lng:e.lng})},new(i||(i=Promise))(function(n,o){function r(e){try{l(s.next(e))}catch(e){o(e)}}function a(e){try{l(s.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(r,a)}l((s=s.apply(e,t||[])).next())})},isSub:!0}),(0,ei.jsx)(eU,{label:(0,N.t)("settingsPanel.presentation.sunVector"),tooltip:(0,N.t)("settingsPanel.presentation.sunVectorTooltip"),stateKey:"sunVectorVisible",disabled:g}),a&&(0,ei.jsx)(eU,{label:(0,N.t)("settingsPanel.presentation.hideUI"),tooltip:(0,N.t)("settingsPanel.presentation.hideUITooltip"),stateKey:"hideUI",showLock:!e,disabledAction:()=>i("settings_hide_ui"),productLock:"explorer"}),n&&(0,ei.jsx)(eU,{label:(0,N.t)("settingsPanel.presentation.antiAliasing"),stateKey:"antiAliasing",showLock:!t,disabledAction:()=>s("settings_anti_aliasing"),productLock:"home"}),o&&(0,ei.jsx)(eU,{label:(0,N.t)("settingsPanel.presentation.ambientOcclusion"),tooltip:(0,N.t)("settingsPanel.presentation.ambientOcclusionTooltip"),stateKey:"ambientOcclusion",showLock:!t,disabledAction:()=>s("settings_ambient_occlusion"),productLock:"home"})]})},tt=({isAllowedToUseExplorer:e,buyExplorer:t})=>{let{t:i}=(0,ea.$G)(),{showFirstPersonView:s,showFocalLength:n,showAutoRotate:o}=(0,Z.MG)(e=>e.capabilities),r=(0,eQ.Z)(ep.UW.pipe((0,_.U)(e=>e===ep.BS.Analytics))),[a]=(0,et.mr)("firstPersonView");return o||s||n?(0,ei.jsxs)("div",{className:"p-4",children:[(0,ei.jsxs)("div",{className:"font-bold mb-4 flex",children:[i("settingsPanel.camera.title"),!e&&(0,ei.jsx)("div",{className:"relative translate-x-10",children:(0,ei.jsx)(eh,{product:"explorer",mode:"big",onClick:()=>{t("settings_camera_section")}})})]}),(0,ei.jsxs)("div",{className:"flex flex-col gap-2",children:[o&&(0,ei.jsx)(eU,{label:i("settingsPanel.camera.autoRotate"),stateKey:"autoRotate",showLock:!e,disabled:a||r,disabledAction:()=>t("settings_auto_rotate")}),s&&(0,ei.jsx)(eU,{label:(0,ei.jsxs)("p",{children:[i("settingsPanel.camera.firstPersonView")," ",(0,ei.jsx)("span",{className:"bg-grey-800 rounded-md px-1 py-0.5 font-bold text-xs text-mint-200",children:"BETA"})]}),stateKey:"firstPersonView",showLock:!e,disabledAction:()=>t("settings_first_person_view"),disabled:r}),n&&(0,ei.jsx)(eY,{disabled:!e,disabledAction:()=>t("settings_focal_length")})]})]}):null},ti=({isAllowedToUseHome:e,buyHome:t})=>{let{t:i}=(0,ea.$G)(),{showElevationModel:s,showFloorLevelToggle:n,showDefaultBuildingHeight:o,showTreesToggle:r}=(0,Z.MG)(e=>e.capabilities),a=(0,Z.MG)(e=>e.phantomLocks.floorLevelIndication);return s||n||o||r?(0,ei.jsxs)("div",{className:"p-4",children:[(0,ei.jsx)("div",{className:"font-bold mb-4 flex",children:i("settingsPanel.data.title")}),(0,ei.jsxs)("div",{className:"flex flex-col gap-2",children:[r&&(0,ei.jsx)(eU,{label:i("settingsPanel.data.showTrees"),stateKey:"showTrees",tooltip:i("settingsPanel.data.showTreesTooltip")}),n&&(0,ei.jsx)(eX,{isAllowedToUsePro:!a&&e,disabledAction:()=>{if(a)return void L.y7.next({modal:H.o.COUPON_CODE,opts:{trigger:G.g.Generic}});t("settings_floor_level_indication")},productLock:a?"generic":"home"}),o&&(0,ei.jsx)(e4,{isAllowedToUse:e,disabledAction:()=>{t("settings_floor_level_indication")}}),s&&(0,ei.jsx)(eu,{isAllowedToUsePro:e,disabledAction:()=>{t("settings_elevation_model")}})]})]}):null},ts=()=>{let{t:e}=(0,ea.$G)(),[t,i]=(0,e8.Z)();return(0,ei.jsxs)("div",{className:"flex flex-col items-center gap-[14px] py-[25px] pb-[12px] px-[8px] text-sm text-center",children:[(0,ei.jsx)(ed.xc,{}),(0,ei.jsxs)("div",{children:[(0,ei.jsx)("div",{children:e("settingsPanel.feedback.line1")}),(0,ei.jsxs)("div",{children:[e("settingsPanel.feedback.line2")," ",(0,ei.jsx)("a",{href:t,target:"_blank",className:"underline cursor-pointer text-mint-400",children:i})]})]})]})},tn=()=>{let{t:e}=(0,ea.$G)(),[t]=(0,et.mr)("mapMode"),i=(0,eQ.Z)(L.R9),{unlockEverything:s,showCoordinateInput:n,showSettingsFeedback:o}=(0,Z.MG)(e=>e.capabilities);if(!i)return null;let r=i.isAllowedToUseExplorer()||s,a=i.isAllowedToUseHome()||s,d=e=>{(0,eg.si)({roles:i,subscription:ef.K.PRO_AND_HIGHER,trigger:e})},h=e=>{(0,eg.si)({roles:i,subscription:ef.K.LIGHT_AND_HIGHER,trigger:e})};return(0,ei.jsxs)("div",{className:"flex flex-col grow settings-panel divide-y divide-grey-400 overflow-y-auto pb-bsafe-4",children:[t!==l.M$.GOOGLE&&(0,ei.jsx)(ti,{isAllowedToUseHome:a,buyHome:d}),(0,ei.jsx)(tt,{isAllowedToUseExplorer:r,buyExplorer:h}),(0,ei.jsxs)("div",{className:"p-4",children:[(0,ei.jsx)("div",{className:"font-bold mb-4 flex",children:e("settingsPanel.presentation.title")}),(0,ei.jsx)(te,{isAllowedToUseExplorer:r,isAllowedToUseHome:a,buyExplorer:h,buyHome:d})]}),(0,ei.jsxs)("div",{className:"p-4",children:[(0,ei.jsx)("div",{className:"font-bold mb-4",children:e("settingsPanel.quality.title")}),(0,ei.jsx)("div",{className:"flex w-full gap-2",children:(0,ei.jsx)(eI,{})})]}),n&&(0,ei.jsxs)("div",{className:"p-4",children:[(0,ei.jsx)("div",{className:"font-bold mb-4",children:e("settingsPanel.jumpToCoordinates.title")}),(0,ei.jsx)(eq,{})]}),o&&(0,ei.jsx)(ts,{})]})},to=()=>{let{t:e}=(0,ea.$G)(),[t,i]=(0,es.useState)(!1),[s,n]=(0,es.useState)(!0),[o,r]=(0,es.useState)(!1),a=(0,es.useRef)(null);return(0,es.useEffect)(()=>{let e=em.Mm.subscribe(e=>{i(void 0!==e),e?e7():e6()});return()=>e.unsubscribe()},[]),(0,es.useEffect)(()=>{if(!a.current)return;let e=()=>{L.Jt.value||n(!0)};a.current.addEventListener("transitionend",e);let t=L.Jt.subscribe(e=>{e&&n(!1),r(e)});return()=>{var i;null==(i=a.current)||i.removeEventListener("transitionend",e),t.unsubscribe()}},[a.current]),(0,ei.jsx)("div",{ref:a,className:eD()("fixed right-0 transition-transform transform w-full md:w-[323px] h-full",{invisible:s,"translate-x-full":!o}),children:(0,ei.jsx)(e3,{children:(0,ei.jsxs)("div",{className:"flex flex-col w-full h-full divide-y divide-white/20 text-white",children:[(0,ei.jsxs)("div",{className:"settings-panel-title flex justify-between p-4 pt-tsafe-2.5",children:[(0,ei.jsx)("p",{className:"font-bold",children:e("settingsPanel.title")}),(0,ei.jsx)("div",{className:"cursor-pointer",onClick:e9,children:(0,ei.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:(0,ei.jsx)("path",{d:"M6 6L18 18M6 18L18 6L6 18Z",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),t?(0,ei.jsx)(e5,{}):(0,ei.jsx)(tn,{})]})})})};var tr=i(58004),ta=i(68171),tl=i(78135),td=i(84828);let th=({name:e,onSave:t,className:i,isSelected:s})=>{let[n,o]=(0,es.useState)(!1),[r,a]=(0,es.useState)(""),l=i=>{i.preventDefault(),i.stopPropagation();let s=r.trim();s&&s!==e&&t(s),o(!1)};return n?(0,ei.jsxs)("div",{className:eD()("flex items-center gap-2 w-full",i),children:[(0,ei.jsx)("input",{type:"text",value:r,onChange:e=>a(e.target.value),onKeyDown:e=>{"Enter"===e.key?(e.stopPropagation(),l(e)):"Escape"===e.key&&(e.stopPropagation(),o(!1))},onClick:e=>{e.stopPropagation()},onBlur:e=>{setTimeout(()=>{document.activeElement!==e.target&&o(!1)},100)},className:"flex-1 min-w-0 w-0 bg-grey-800 text-white text-sm px-2 py-1 rounded border border-grey-400 focus:border-neon-200 focus:outline-none",autoFocus:!0}),(0,ei.jsx)("button",{className:"flex-shrink-0 text-mint-300 hover:text-neon-200 p-1",onClick:l,children:(0,ei.jsx)(tl.Z,{className:"w-4 h-4"})})]}):(0,ei.jsxs)("div",{className:eD()("group flex items-center gap-2",i),children:[(0,ei.jsx)("span",{title:e,className:"text-sm font-medium text-white truncate",children:e}),(0,ei.jsx)("button",{className:eD()("opacity-0 group-hover:opacity-100 text-mint-300 hover:text-neon-200 p-1 transition-opacity",{"!opacity-100":s}),onClick:t=>{t.stopPropagation(),a(e),o(!0)},children:(0,ei.jsx)(td.Z,{className:"w-4 h-4"})})]})};var tc=i(32750);let tu=({containerClassName:e,limitHeight:t=!1,children:i})=>{let s=(0,es.useRef)(null),[n,o]=(0,es.useState)(!1),[r,a]=(0,es.useState)(!1),l=()=>{if(!s.current||!t){o(!1),a(!1);return}let{scrollTop:e,scrollHeight:i,clientHeight:n}=s.current;i>n?(o(e>0),a(e+n<i-1)):(o(!1),a(!1))};return(0,es.useEffect)(()=>{l();let e=s.current;if(e)return e.addEventListener("scroll",l),()=>e.removeEventListener("scroll",l)},[t]),(0,es.useEffect)(()=>{let e=setTimeout(l,0);return()=>clearTimeout(e)},[i]),(0,ei.jsxs)("div",{className:"relative",children:[n&&(0,ei.jsx)("div",{className:"absolute top-0 left-0 right-0 h-16 pointer-events-none z-10",style:{background:"linear-gradient(180deg, #33404D 0%, rgba(51, 64, 77, 0) 100%)"}}),(0,ei.jsx)("div",{ref:s,className:eD()(e,t&&"max-h-[350px] overflow-y-auto"),children:i}),r&&(0,ei.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-16 pointer-events-none z-10",style:{background:"linear-gradient(0deg, #33404D 0%, rgba(51, 64, 77, 0) 100%)"}})]})};var tp=i(73628),tm=function(e,t,i,s){return new(i||(i=Promise))(function(n,o){function r(e){try{l(s.next(e))}catch(e){o(e)}}function a(e){try{l(s.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(r,a)}l((s=s.apply(e,t||[])).next())})};let tg=e=>{if(e.customName)return e.customName;let t=(0,N.t)("studio.prefabs.types.userShape");return e.name?`${t} #${e.name.padStart(3,"0")}`:`${t} ${e.id}`},tf=e=>{var t;if(e.customName)return e.customName;let i=(0,N.t)(`studio.prefabs.types.${e.type}`),s=null!=i?i:e.type;return`${s} #${(null!=(t=e.name)?t:"").padStart(3,"0")}`},tx=({firstUpload:e})=>{let{t}=(0,ea.$G)(),i=e?(0,ei.jsxs)("div",{className:"relative flex h-[34px] items-center justify-center text-mint-200 font-bold text-base group-hover:text-neon-200",children:[(0,ei.jsx)(ed.pO,{className:"h-5 w-5"}),t("studio.customShapes.createNewShape")]}):(0,ei.jsx)("div",{className:"relative flex items-center px-3 py-0.5 text-mint-200 group-hover:text-neon-200 font-bold text-xs uppercase",children:t("studio.customShapes.create")}),s=e&&(0,ei.jsx)("div",{className:"bg-grey-800/60 rounded-lg text-xs text-white mt-2 p-4 text-center",children:t("studio.customShapes.description")});return(0,ei.jsxs)("div",{className:"flex flex-col",children:[(0,ei.jsx)("button",{className:"group relative border-2 border-mint-200 rounded-full overflow-clip hover:border-neon-200 hover:bg-grey-800",onClick:()=>{D.ml.next(!0),P.n.onStudioSidebarAddPrefabClick()},children:i}),s]})};function tw({id:e,name:t,hidden:i,selected:s,onVisibilityToggleClick:n,onDeleteClick:o,onCloneClick:r,onClick:a,onNameSave:l}){return(0,ei.jsxs)("div",{className:eD()("flex-shrink-0 group relative flex h-14 md:h-12 border cursor-pointer transition-all items-center hover:bg-grey-700/70 rounded-lg",s?"bg-grey-700/70 border-neon-100":"border-grey-400 hover:border-grey-100"),onClick:a,children:[(0,ei.jsx)("div",{className:"h-full ml-4 mr-2",children:(0,ei.jsx)("button",{className:"flex justify-center items-center w-full h-full text-mint-300 hover:text-neon-200",onClick:e=>{e.stopPropagation(),n()},children:i?(0,ei.jsx)(ed.Xl,{className:"w-5"}):(0,ei.jsx)(ed.tE,{className:"w-5"})})}),(0,ei.jsx)("div",{className:"flex-1 pr-2 min-w-0",children:(0,ei.jsx)(th,{name:t,onSave:l,isSelected:s})}),(0,ei.jsx)("div",{className:"w-7 h-full flex-shrink-0",children:(0,ei.jsx)("button",{className:eD()("flex justify-center items-center w-full h-full text-mint-300 hover:text-neon-200",s?"visible":"invisible group-hover:visible"),onClick:e=>{e.stopPropagation(),r()},children:(0,ei.jsx)(ed.dt,{className:"w-5"})})}),(0,ei.jsx)("div",{className:"w-7 h-full mr-2 flex-shrink-0",children:(0,ei.jsx)("button",{className:eD()("flex justify-center items-center w-full h-full text-mint-300 hover:text-red-500",s?"visible":"invisible group-hover:visible"),onClick:e=>{e.stopPropagation(),o()},children:(0,ei.jsx)(ed.XH,{className:"w-5"})})})]})}let tb=({showCloseButton:e=!0})=>(0,ei.jsx)("div",{className:"relative",children:(0,ei.jsxs)("div",{className:"absolute top-0 left-0 w-full bg-grey-800 rounded-lg px-[6px] py-[18px] z-[1]",style:{boxShadow:"0px 1px 9px 0px rgba(0, 0, 0, 0.40)"},children:[e&&(0,ei.jsx)(tc.Z,{className:"h-[24px] w-[24px] cursor-pointer absolute top-2 right-2 opacity-90 hover:opacity-100",onClick:()=>D.ml.next(!1)}),(0,ei.jsx)("div",{className:"flex flex-col gap-4",children:(0,ei.jsx)(tv,{})})]})}),tv=()=>{let{t:e}=(0,ea.$G)(),t=(0,eQ.Z)(L.R9),i=null==t?void 0:t.isAllowedToUseHome(),s=e=>{if(!i&&e.isHomeOnly)return void(0,eg.si)({roles:t,subscription:ef.K.PRO_AND_HIGHER,trigger:"studio_locked_prefab"});if(D.ml.next(!1),P.n.onStudioPrefabCreate(e.name),"userShape"===e.name){D.dG.next(!0),(0,el.rA)()&&D.Do.next(!1);return}(0,D.qW)(e.name),(0,el.rA)()&&D.Do.next(!1)};return Object.entries(l.d8).map(([t,n])=>{let o=e(`studio.prefabs.categories.${t}`);return(0,ei.jsxs)("div",{children:[(0,ei.jsx)("div",{className:"text-white text-sm font-bold px-1 mb-[6px]",children:o}),(0,ei.jsx)("div",{className:"flex flex-row flex-wrap gap-1",children:n.map(t=>{let n=e(`studio.prefabs.types.${t.name}`);return(0,ei.jsxs)("div",{className:"flex flex-col items-center gap-[2px] w-[calc(33.3333%-4px)] group cursor-pointer",onClick:()=>s(t),children:[(0,ei.jsx)("div",{className:"w-full aspect-square rounded-lg border-[1px] border-transparent group-hover:border-shadowmap-yellow p-[3px]",children:(0,ei.jsx)("div",{className:eD()("flex justify-center items-center w-full h-full rounded-[5px] bg-contain bg-no-repeat bg-center",!i&&t.isHomeOnly?"bg-[#99a0a6] group-hover:bg-white":"bg-white"),style:{boxShadow:"0px 1px 1px 0px rgba(0, 0, 0, 0.13), 0px 2px 4px 0px rgba(0, 0, 0, 0.15)",backgroundImage:`url(${t.iconURL})`},children:!i&&t.isHomeOnly&&(0,ei.jsx)(eh,{mode:"small",product:"generic",isAbsolute:!1,isFullSize:!1,onClick:()=>s(t)})})}),(0,ei.jsx)("div",{className:"text-white group-hover:text-shadowmap-yellow text-xs w-full px-1",children:n})]},t.name)})})]},t)})},ty=({isFromButton:e=!1,limitHeight:t=!1})=>{var i,s;let{t:n}=(0,ea.$G)(),o=null!=(i=(0,eQ.Z)(D.Vi.pipe((0,_.U)(e=>null==e?void 0:e.shapes))))?i:[],r=null!=(s=(0,eQ.Z)(D.Vi.pipe((0,_.U)(e=>null==e?void 0:e.prefabs))))?s:[],a=(0,eQ.Z)(D.rB.pipe((0,_.U)(e=>null==e?void 0:e.id))),l=(0,eQ.Z)(D.E3.pipe((0,_.U)(e=>null==e?void 0:e.id))),d=(0,eQ.Z)(D.ml),h=(e,t)=>()=>tm(void 0,void 0,void 0,function*(){D.ck.next({action:t?"selectAndGoTo":"select",shape:e}),ep.UW.next(ep.BS.Default),(0,el.rA)()&&D.Do.next(!1)}),c=(e,t)=>()=>tm(void 0,void 0,void 0,function*(){D.TX.next({action:t?"selectAndGoTo":"select",prefab:e}),ep.UW.next(ep.BS.Default),(0,el.rA)()&&D.Do.next(!1)}),u=[];for(let e of o)"deleted"!==e.status&&u.push({shape:e});for(let e of r)u.push({prefab:e});u.sort((e,t)=>{let i=e.shape?e.shape.createdAt:e.prefab.createdAt,s=t.shape?t.shape.createdAt:t.prefab.createdAt;return i&&s?new Date(i).getTime()-new Date(s).getTime():0});let p=(null==u?void 0:u.length)===0,m=e&&d&&u.length>0;return(0,ei.jsxs)(ei.Fragment,{children:[(0,ei.jsx)("div",{className:"flex items-center mb-3.5 text-white min-h-[26px]",children:m?(0,ei.jsx)("div",{children:(0,ei.jsx)(tp.Z,{className:"text-mint-200",onClick:()=>{D.ml.next(!1)}})}):(0,ei.jsxs)(ei.Fragment,{children:[(0,ei.jsx)(ed.sj,{className:"w-5 h-5 mr-1"}),(0,ei.jsx)("div",{className:"text-base font-bold",children:n("studio.customShapes.title")}),(0,ei.jsx)(e_.oD,{content:n("studio.customShapes.description"),className:"ml-1.5"}),(0,ei.jsx)("div",{className:"grow"}),!p&&!d&&(0,ei.jsx)(tx,{firstUpload:!1})]})}),d&&(e?(0,ei.jsx)(tv,{}):(0,ei.jsx)(tb,{})),!(e&&d)&&(0,ei.jsxs)(ei.Fragment,{children:[(0,ei.jsx)("div",{className:"flex",children:p&&(0,ei.jsx)(tx,{firstUpload:!0})}),(0,ei.jsxs)(tu,{containerClassName:"flex flex-col gap-2",limitHeight:t,children:[(!o||!r)&&(0,ei.jsx)("div",{className:"text-xs text-white",children:n("studio.customShapes.loading")}),o&&r&&u.map(({shape:e,prefab:t})=>{if(e){let t,i,s,n;return(0,ei.jsx)(tw,{id:e.id,name:tg(e),hidden:e.hidden,selected:a===e.id,onVisibilityToggleClick:(t=e.id,()=>tm(void 0,void 0,void 0,function*(){let e=D.Vi.value;if(e){let i=e.shapes.findIndex(e=>e.id===t);-1!==i&&(e.shapes[i].hidden=!e.shapes[i].hidden,D.Vi.next(Object.assign(Object.assign({},e),{shapes:[...e.shapes],hasChanges:!0})))}})),onDeleteClick:(i=e.id,()=>tm(void 0,void 0,void 0,function*(){var e;let t=D.Vi.value;if(t){let s=t.shapes.filter(e=>e.id!==i);D.Vi.next(Object.assign(Object.assign({},t),{shapes:s,hasChanges:!0})),(null==(e=D.rB.value)?void 0:e.id)===i&&D.rB.next(void 0)}})),onClick:h(e,!0),onCloneClick:(s=e.id,()=>tm(void 0,void 0,void 0,function*(){let e=o.find(e=>e.id===s);h((yield(0,D.B1)(e)),!1)()})),onNameSave:(n=e.id,e=>{let t=D.Vi.value;if(t){let i=t.shapes.findIndex(e=>e.id===n);-1!==i&&(t.shapes[i].customName=e,D.Vi.next(Object.assign(Object.assign({},t),{shapes:[...t.shapes],hasChanges:!0})))}})},e.id)}if(t){let e,i,s,n;return(0,ei.jsx)(tw,{id:t.id,name:tf(t),hidden:t.hidden,selected:l===t.id,onVisibilityToggleClick:(e=t.id,()=>tm(void 0,void 0,void 0,function*(){let t=D.Vi.value;if(t){let i=t.prefabs.findIndex(t=>t.id===e);-1!==i&&(t.prefabs[i].hidden=!t.prefabs[i].hidden,D.Vi.next(Object.assign(Object.assign({},t),{prefabs:[...t.prefabs],hasChanges:!0})))}})),onDeleteClick:(i=t.id,()=>tm(void 0,void 0,void 0,function*(){var e;let t=D.Vi.value;if(t){let s=t.prefabs.findIndex(e=>e.id===i);if(-1!==s){let n=[...t.prefabs];n.splice(s,1),D.Vi.next(Object.assign(Object.assign({},t),{prefabs:n,hasChanges:!0})),(null==(e=D.E3.value)?void 0:e.id)===i&&D.E3.next(void 0)}}})),onClick:c(t,!0),onCloneClick:(s=t.id,()=>tm(void 0,void 0,void 0,function*(){let e=r.find(e=>e.id===s);c((yield(0,D.F7)(e)),!1)()})),onNameSave:(n=t.id,e=>{let t=D.Vi.value;if(t){let i=t.prefabs.findIndex(e=>e.id===n);-1!==i&&(t.prefabs[i].customName=e,D.Vi.next(Object.assign(Object.assign({},t),{prefabs:[...t.prefabs],hasChanges:!0})))}})},t.id)}})]})]})]})};var tC=function(e,t,i,s){return new(i||(i=Promise))(function(n,o){function r(e){try{l(s.next(e))}catch(e){o(e)}}function a(e){try{l(s.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(r,a)}l((s=s.apply(e,t||[])).next())})};function tM({userBuilding:e,selected:t,onVisibilityToggleClick:i,onDeleteClick:s}){let{buildingId:n,hidden:o}=e;return(0,ei.jsxs)("div",{className:`flex-shrink-0 group relative flex h-14 md:h-12 border cursor-pointer transition-all items-center hover:bg-grey-700/70 rounded-lg ${t?"bg-grey-700/70 border-neon-100":"border-grey-400 hover:border-grey-100"}`,onClick:()=>{D.NB.next({building:e,jumpToLocation:!0}),(0,D.A$)(e),(0,el.rA)()&&D.Do.next(!1)},children:[(0,ei.jsx)("div",{className:"h-full ml-4 mr-2",children:(0,ei.jsx)("button",{className:"flex justify-center items-center w-full h-full text-mint-300 hover:text-neon-200",onClick:i,children:o?(0,ei.jsx)(ed.Xl,{className:"w-5"}):(0,ei.jsx)(ed.tE,{className:"w-5"})})}),(0,ei.jsxs)("div",{className:"flex-1 text-sm font-medium text-white truncate",children:["Building ",n]}),(0,ei.jsx)("div",{className:"w-11 h-full",children:(0,ei.jsx)("button",{className:`flex justify-center items-center w-full h-full text-mint-300 hover:text-red-500 ${t?"visible":"invisible group-hover:visible"}`,onClick:s,children:(0,ei.jsx)(ed.XH,{className:"w-5"})})})]})}function tS({tree:e,selected:t,onVisibilityToggleClick:i,onDeleteClick:s}){let{lat:n,lng:o,hidden:r}=e,a=`Tree at ${n.toFixed(6)}, ${o.toFixed(6)}`;return(0,ei.jsxs)("div",{className:`flex-shrink-0 group relative flex h-14 md:h-12 border cursor-pointer transition-all items-center hover:bg-grey-700/70 rounded-lg ${t?"bg-grey-700/70 border-neon-100":"border-grey-400 hover:border-grey-100"}`,onClick:()=>{D.up.next({tree:e,jumpToLocation:!0}),(0,D.hU)(e),(0,el.rA)()&&D.Do.next(!1)},children:[(0,ei.jsx)("div",{className:"h-full ml-4 mr-2",children:(0,ei.jsx)("button",{className:"flex justify-center items-center w-full h-full text-mint-300 hover:text-neon-200",onClick:i,children:r?(0,ei.jsx)(ed.Xl,{className:"w-5"}):(0,ei.jsx)(ed.tE,{className:"w-5"})})}),(0,ei.jsx)("div",{className:"flex-1 text-sm font-medium text-white truncate",children:a}),(0,ei.jsx)("div",{className:"w-11 h-full",children:(0,ei.jsx)("button",{className:`flex justify-center items-center w-full h-full text-mint-300 hover:text-red-500 ${t?"visible":"invisible group-hover:visible"}`,onClick:s,children:(0,ei.jsx)(ed.XH,{className:"w-5"})})})]})}let tL=({isFromButton:e=!1,limitHeight:t=!1})=>{var i,s;let{t:n}=(0,ea.$G)(),o=null!=(i=(0,eQ.Z)(D.Vi.pipe((0,_.U)(e=>null==e?void 0:e.buildings))))?i:[],r=null!=(s=(0,eQ.Z)(D.Vi.pipe((0,_.U)(e=>null==e?void 0:e.treeOverrides))))?s:[],a=(0,eQ.Z)(D.fZ),l=(0,eQ.Z)(D.fn),d=o&&r&&0===o.length&&0===r.length;return(0,ei.jsxs)(ei.Fragment,{children:[(0,ei.jsxs)("div",{className:"flex items-center text-white",children:[(0,ei.jsx)(ed.xI,{className:"w-5 h-5 mr-1"}),(0,ei.jsx)("div",{className:"text-base font-bold",children:n("studio.buildingList.title")}),!d&&(0,ei.jsx)(e_.oD,{content:n("studio.buildingList.emptyMessage"),className:"ml-1.5"})]}),(0,ei.jsxs)(tu,{containerClassName:"mt-3.5 flex flex-col gap-2",limitHeight:t,children:[(!o||!r)&&(0,ei.jsx)("div",{className:"text-xs text-white",children:n("studio.buildingList.loading")}),d&&(0,ei.jsx)("div",{className:eD()("rounded-lg text-xs mt-2 p-4 text-center",e?"bg-grey-600 text-grey-100":"bg-grey-800/60 text-white"),children:n("studio.buildingList.emptyMessage")}),o&&Array.from(o.values()).map(e=>{let t,i;return(0,ei.jsx)(tM,{userBuilding:e,selected:(null==a?void 0:a.buildingId)===e.buildingId,onVisibilityToggleClick:(t=e.buildingId,e=>tC(void 0,void 0,void 0,function*(){e.stopPropagation();let i=D.Vi.value;if(i){let e=i.buildings.findIndex(e=>e.buildingId===t);-1!==e&&(i.buildings[e].hidden=!i.buildings[e].hidden,D.Vi.next(Object.assign(Object.assign({},i),{buildings:[...i.buildings],hasChanges:!0})))}})),onDeleteClick:(i=e.buildingId,e=>tC(void 0,void 0,void 0,function*(){e.stopPropagation();let t=D.Vi.value;if(t){let e=t.buildings.findIndex(e=>e.buildingId===i);-1!==e&&(t.buildings.splice(e,1),D.Vi.next(Object.assign(Object.assign({},t),{buildings:[...t.buildings],hasChanges:!0})))}}))},e.buildingId)}),r&&r.map(e=>(0,ei.jsx)(tS,{tree:e,selected:(null==l?void 0:l.lat)===e.lat&&(null==l?void 0:l.lng)===e.lng,onVisibilityToggleClick:t=>tC(void 0,void 0,void 0,function*(){t.stopPropagation();let i=D.Vi.value;if(i){let t=i.treeOverrides.findIndex(t=>t.lat===e.lat&&t.lng===e.lng);-1!==t&&(i.treeOverrides[t].hidden=!i.treeOverrides[t].hidden,D.Vi.next(Object.assign(Object.assign({},i),{treeOverrides:[...i.treeOverrides],hasChanges:!0})))}}),onDeleteClick:t=>tC(void 0,void 0,void 0,function*(){t.stopPropagation();let i=D.Vi.value;if(i){let t=i.treeOverrides.findIndex(t=>t.lat===e.lat&&t.lng===e.lng);-1!==t&&(i.treeOverrides.splice(t,1),D.Vi.next(Object.assign(Object.assign({},i),{treeOverrides:[...i.treeOverrides],hasChanges:!0})))}})},`${e.lat} ${e.lng}`))]})]})};var tT=i(17707);let tj=(e,t,i,s)=>{var n,o,r,a;return n=void 0,o=void 0,r=void 0,a=function*(){let n=yield x.g.token();if(!n)throw Error("No token present to make request");let o=s?JSON.stringify({usermodel_upload:{uuid:e,filename:t,content_type:i,content_encoding:"gzip"}}):JSON.stringify({usermodel_upload:{uuid:e,filename:t,content_type:i}}),r=yield fetch("/.netlify/functions/usermodel-upload-url",{method:"POST",body:o,headers:{Authorization:`Bearer ${n}`}});if(r.ok)return r.json();throw Error((yield r.text()))},new(r||(r=Promise))(function(e,t){function i(e){try{l(a.next(e))}catch(e){t(e)}}function s(e){try{l(a.throw(e))}catch(e){t(e)}}function l(t){var n;t.done?e(t.value):((n=t.value)instanceof r?n:new r(function(e){e(n)})).then(i,s)}l((a=a.apply(n,o||[])).next())})};var tP=function(e,t,i,s){return new(i||(i=Promise))(function(n,o){function r(e){try{l(s.next(e))}catch(e){o(e)}}function a(e){try{l(s.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(r,a)}l((s=s.apply(e,t||[])).next())})};let tE=(e,t,i,s)=>tP(void 0,void 0,void 0,function*(){if(!(yield x.g.token()))throw Error("No token present to make request");let n=i?yield tP(void 0,void 0,void 0,function*(){let t;return yield(t=e.stream().pipeThrough(new CompressionStream("gzip")),tP(void 0,void 0,void 0,function*(){let e=t.getReader(),i=[],s=0;for(;;){let{done:t,value:n}=yield e.read();if(t)break;i.push(n),s+=n.length}let n=new Uint8Array(s),o=0;for(let e of i)n.set(e,o),o+=e.length;return n}))}):e,o=new XMLHttpRequest;return o.open("PUT",t),o.upload.addEventListener("progress",e=>{s&&s(e.loaded/e.total)}),i&&o.setRequestHeader("Content-Encoding","gzip"),new Promise((e,t)=>{o.onload=()=>{200===o.status?e(!0):t(o.responseText)},o.send(n)})});var tA=i(11772),tD=i(79379),tO=function(e,t,i,s){return new(i||(i=Promise))(function(n,o){function r(e){try{l(s.next(e))}catch(e){o(e)}}function a(e){try{l(s.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(r,a)}l((s=s.apply(e,t||[])).next())})};function tk({setLastUploadedModelId:e,firstUpload:t=!1,isLocked:i=!1,onLockClick:s}){let{t:n}=(0,ea.$G)(),[o,r]=(0,es.useState)(),[a,d]=(0,es.useState)();(0,es.useEffect)(()=>{let e=S.As.subscribe(e=>{d(e)});return()=>{e.unsubscribe()}});let h=(0,es.useId)(),c=e=>{e.currentTarget.value=""},u=null!=o,p=e=>tO(this,void 0,void 0,function*(){let t=m(Array.from(e.target.files||[]));t?function(e){var t;for(let i of[e.model,...null!=(t=e.textures)?t:[]])if(i.size>(0,tD.V)())return!1;return!0}(t)?yield f(t):L.y7.next({modal:H.o.USER_MODEL_ERROR,opts:{reason:tA.J.TOO_LARGE}}):L.y7.next({modal:H.o.USER_MODEL_ERROR,opts:{reason:tA.J.INVALID}}),e.target.value=""}),m=e=>{for(let t of e){let i=g(t);if(i)return{model:t,type:i,textures:e.filter(e=>e!==t)}}},g=e=>{let t=e.name.toLowerCase();return t.endsWith(".obj")?l.BY.OBJ:t.endsWith(".glb")?l.BY.GLB:t.endsWith(".dae")?l.BY.DAE:t.endsWith(".fbx")?l.BY.FBX:t.endsWith(".ifc")?l.BY.IFC:void 0},f=t=>tO(this,void 0,void 0,function*(){var i;try{e(null),r(.1);let s=(0,k.Z)(),n=e=>tO(this,void 0,void 0,function*(){let t=yield tj(s,e.name,e.type,!1);yield tE(e,t.url,!1)});yield Promise.all((null==(i=t.textures)?void 0:i.map(n))||[]);let o=yield tj(s,t.model.name,t.type,!0);if(r(.2),yield tE(t.model,o.url,!0,e=>{r(.2+e*(.8-.2))}),r(.8),!a)throw Error("no location for user model upload position");let{lat:l,lng:d}=a,h={id:(0,k.Z)(),modelId:s,version:3,filename:o.filename.split("/")[1],type:t.type,offsetInMeters:0,scale:1,lat:l,lng:d,rotation:0,zUp:!1,hidden:!1,reCentered:!1},c=D.Vi.value;if(!c)throw Error("no active studio project");r(.95),h.needsHeightCheck=!0,h.status="selecting",D.Vi.next(Object.assign(Object.assign({},c),{models:[...c.models,h],hasChanges:!0})),r(1),P.n.onStudioModelUpload(s),e(h.id||null),(0,el.rA)()&&D.Do.next(!1)}catch(e){console.log(e),alert(n("studio.modelUpload.genericErrorMessage"))}finally{setTimeout(()=>{r(null)},5e3)}}),x=({firstUpload:e})=>{let t=e?(0,ei.jsxs)("div",{className:"relative flex h-[34px] items-center justify-center gap-1 text-mint-200 font-bold text-base group-hover:text-neon-200",children:[(0,ei.jsx)(ed.pO,{className:"h-5 w-5"}),n("studio.modelUpload.labelFirstUpload"),i&&(0,ei.jsx)(ed.mB,{className:"text-shadowmap-yellow w-[14px] h-[14px]"})]}):(0,ei.jsx)("div",{className:"relative flex items-center px-3 py-0.5 text-mint-200 group-hover:text-neon-200 font-bold text-xs uppercase",children:n("studio.modelUpload.label")});return(0,ei.jsxs)("div",{className:eD()("flex flex-col",{"flex-grow":e}),children:[(0,ei.jsxs)("label",{htmlFor:h,className:"group relative border-2 border-mint-200 rounded-full overflow-clip hover:border-neon-200 hover:bg-grey-800",onClick:i?s:void 0,children:[(0,ei.jsx)("div",{className:"absolute top-0 bg-gradient-to-tl from-[#6AF1EA] to-[#528CAD]  h-full w-full transition-all",style:{right:`${100*(1-(o||0))}%`,width:`${100*(o||0)}%`}}),(0,ei.jsxs)("div",{className:"bg-transparent cursor-pointer",children:[t,!i&&(0,ei.jsx)("input",{id:h,disabled:u,type:"file",className:"hidden",multiple:!0,onChange:p,onClick:c})]})]}),e&&(0,ei.jsx)("div",{className:"bg-grey-800/60 rounded-lg text-xs text-white mt-2 p-4 text-center",children:n("studio.modelUpload.description",{size:(0,tD.V)()/1e6})})]})};return(0,ei.jsxs)(ei.Fragment,{children:[(0,ei.jsxs)("div",{className:"flex items-center mb-3.5 text-white",children:[(0,ei.jsx)(ed.YC,{className:"w-5 h-5 mr-1"}),(0,ei.jsx)("div",{className:"text-base font-bold",children:n("studio.modelList.title")}),i&&(0,ei.jsx)(ed.mB,{className:"text-shadowmap-yellow w-[14px] h-[14px] ml-2 mt-0.25"}),!t&&(0,ei.jsx)(e_.oD,{content:n("studio.modelUpload.description",{size:(0,tD.V)()/1e6}),className:"ml-1.5"}),(0,ei.jsx)("div",{className:"grow"}),!t&&(0,ei.jsx)(x,{firstUpload:!1})]}),(0,ei.jsx)("div",{className:"flex",children:t&&(0,ei.jsx)(x,{firstUpload:!0})})]})}var tI=i(35533),tN=function(e,t,i,s){return new(i||(i=Promise))(function(n,o){function r(e){try{l(s.next(e))}catch(e){o(e)}}function a(e){try{l(s.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(r,a)}l((s=s.apply(e,t||[])).next())})};let t_=({numberOfFreeModels:e,isFromButton:t})=>{let{t:i}=(0,ea.$G)();return e>0?null:(0,ei.jsx)(ei.Fragment,{children:(0,ei.jsxs)("div",{className:eD()("mt-2 rounded-lg p-4 flex flex-col items-center text-xs",t?"bg-grey-600 text-grey-100":"bg-grey-800/60 text-white"),children:[e<=0?(0,ei.jsx)("div",{className:"text-center",children:(0,ei.jsxs)(ea.cC,{i18nKey:"studio.modelLimit.limitReached",children:["You reached your ",(0,ei.jsx)("b",{children:"model limit"})," on your current plan."]})}):(0,ei.jsx)("div",{className:"text-center",children:(0,ei.jsxs)(ea.cC,{i18nKey:"studio.modelLimit.currentLimit",count:e,children:[(0,ei.jsxs)("b",{children:["Upload ",{numberOfFreeModels:e}," more model(s)"]})," on your current plan."]})}),(0,ei.jsx)("a",{href:"mailto:sales@shadowmap.org?subject=Upgrade Studio model slots",target:"_blank",rel:"noreferrer",children:(0,ei.jsx)("button",{className:"text-sun-400",children:i("studio.modelLimit.upgradeMessage")})}),e<=0&&(0,ei.jsx)("a",{href:"mailto:sales@shadowmap.org?subject=Upgrade Studio model slots",target:"_blank",rel:"noreferrer",children:(0,ei.jsx)("button",{className:"flex mt-2 rounded-full items-center justify-center px-4 h-8 text-grey-800 text-sm font-bold btn-gradient disabled:opacity-30",children:i("studio.modelLimit.upgradeNow")})})]})})},tR=({isFromButton:e=!1,limitHeight:t=!1})=>{var i,s;let n=(0,eQ.Z)(D.Xi),[o,r]=(0,es.useState)(null),[a,l]=(0,es.useState)(0),d=null==(i=(0,eQ.Z)(L.R9))?void 0:i.hasFullStudioAccess(),h=null!=(s=(0,eQ.Z)(D.Vi.pipe((0,_.U)(e=>null==e?void 0:e.models))))?s:[],c=(0,eQ.Z)(L.R9);(0,es.useEffect)(()=>{let e=L.R9.subscribe(e=>{l(null==e?void 0:e.numberOfUploadsPerStudioProject())});return()=>e.unsubscribe()});let u=(e,t)=>{for(let i of h||[]){let s=["visible","error",void 0];i.id===e&&s.includes(i.status)&&(i.status=t)}let i=D.Vi.value;i&&D.Vi.next(Object.assign(Object.assign({},i),{models:[...h]})),ep.UW.next(ep.BS.Default)},p=({id:e,status:t})=>{switch(t){case"visible":default:return null;case"pending":case"selecting":case"loading":return(0,ei.jsx)(tI.Z,{className:"w-5"});case"error":return(0,ei.jsxs)("button",{className:"flex justify-center items-center w-full h-full text-mint-300 hover:text-neon-200",onClick:t=>tN(void 0,void 0,void 0,function*(){for(let i of(t.stopPropagation(),h))i.id===e&&"visible"!==i.status&&(i.status="pending");let i=D.Vi.value;i&&D.Vi.next(Object.assign(Object.assign({},i),{models:[...h]}))}),children:[(0,ei.jsx)(tT.Z,{className:"text-red-500 w-5"})," "]});case"deleted":return(0,ei.jsx)(ed.XH,{className:"text-red-500 animate-ping w-5"})}},m=({model:e,selected:t})=>{let{id:i,status:s,hidden:n}=e;return i?(0,ei.jsx)("div",{className:`group relative flex flex-col items-center cursor-pointer border transition-all hover:bg-grey-700/70 rounded-lg ${t?"bg-grey-700/70 border-neon-100":"border-grey-400 hover:border-grey-100"}`,children:(0,ei.jsxs)("div",{className:"group relative flex w-full h-14 md:h-12 items-center",onClick:()=>{u(i,"selectingAndJumpingToLocation"),(0,el.rA)()&&D.Do.next(!1)},children:[i&&(0,ei.jsx)("div",{className:"h-full ml-4 mr-2",children:(0,ei.jsx)("button",{className:"flex justify-center items-center w-full h-full text-mint-300 hover:text-neon-200",onClick:e=>tN(void 0,void 0,void 0,function*(){e.stopPropagation(),u(i,"selecting"),(0,el.rA)()&&D.Do.next(!1);let t=[];for(let e of h)if(e.id===i){let i=Object.assign(Object.assign({},e),{hidden:!e.hidden});D.Xi.next(i),t.push(i)}else t.push(e);let s=D.Vi.value;s&&D.Vi.next(Object.assign(Object.assign({},s),{models:t}))}),children:n?(0,ei.jsx)(ed.Xl,{className:"w-5"}):(0,ei.jsx)(ed.tE,{className:"w-5"})})}),(0,ei.jsx)("div",{className:"flex-1 pr-2 min-w-0",children:(0,ei.jsx)(th,{name:e.customName?e.customName:e.version>1?e.filename:(e=>{let t=e.split("_");return t.shift(),t.join("_")})(e.filename),onSave:e=>{let t=D.Vi.value;if(t){let s=t.models.findIndex(e=>e.id===i);-1!==s&&(t.models[s].customName=e,D.Vi.next(Object.assign(Object.assign({},t),{models:[...t.models],hasChanges:!0})))}},isSelected:t})}),"visible"!==s&&void 0!==s&&(0,ei.jsx)("div",{className:"w-11 h-full flex justify-center items-center",children:(0,ei.jsx)(p,{status:s,id:i})}),(0,ei.jsx)("div",{className:"w-7 h-full",children:(0,ei.jsx)("button",{className:eD()("flex justify-center items-center w-full h-full text-mint-300 hover:text-neon-200",t?"visible":"invisible group-hover:visible"),onClick:t=>{t.stopPropagation(),e.id&&(0,D.Lo)(e.id)},children:(0,ei.jsx)(ed.dt,{className:"w-5"})})}),(0,ei.jsx)("div",{className:"w-7 h-full mr-2",children:(0,ei.jsx)("button",{className:`flex justify-center items-center w-full h-full text-mint-300 hover:text-red-500 ${t?"visible":"invisible group-hover:visible"}`,onClick:t=>tN(void 0,void 0,void 0,function*(){var i;t.stopPropagation();let s=D.Vi.value;if(s){let t=s.models.findIndex(t=>t.id===e.id);if(-1!==t){let e=[...s.models];e[t].status="deleted",D.Vi.next(Object.assign(Object.assign({},s),{models:e,hasChanges:!0}))}(null==(i=D.Xi.value)?void 0:i.id)===e.id&&D.Xi.next(void 0)}else console.error("No active studio project")}),children:(0,ei.jsx)(ed.XH,{className:"w-5"})})})]})}):null},g=null==h?void 0:h.filter(e=>"deleted"!==e.status),f=a-g.length;return d||0!==g.length?(0,ei.jsxs)(ei.Fragment,{children:[g&&g.length>0&&f>0&&(0,ei.jsx)(tk,{setLastUploadedModelId:r}),g&&0===g.length&&f>0&&(0,ei.jsx)(tk,{firstUpload:!0,setLastUploadedModelId:r}),(0,ei.jsxs)(tu,{containerClassName:"flex flex-col gap-2",limitHeight:t,children:[void 0===g&&(0,ei.jsx)("div",{className:"text-xs text-white",children:"Loading..."}),g&&Array.from(g).map(e=>(0,ei.jsx)(m,{model:e,selected:(null==n?void 0:n.id)===e.id},e.id))]}),a<1/0&&(0,ei.jsx)(t_,{numberOfFreeModels:f,isFromButton:e})]}):(0,ei.jsx)(tk,{firstUpload:!0,setLastUploadedModelId:r,isLocked:!0,onLockClick:()=>{(0,eg.si)({roles:c,subscription:ef.K.STUDIO_PROJECT,trigger:"studio_upload_model_button"})}})},tV=({className:e,showControls:t})=>{let i=(0,eQ.Z)(D.Do),s=(0,tr.pw)(D.wD,!1),n=(0,tr.pw)(D.nJ),o=(0,tr.pw)(D.Vi.pipe((0,_.U)(e=>!!e)),!1),r=(0,tr.pw)(D.Vi.pipe((0,_.U)(e=>{var t;return null!=(t=null==e?void 0:e.models.length)?t:0})),0),a=(0,tr.pw)(D.Vi.pipe((0,_.U)(e=>{var t;return null!=(t=null==e?void 0:e.prefabs.length)?t:0})),0),l=(0,tr.pw)(D.Vi.pipe((0,_.U)(e=>{var t,i;return(null!=(t=null==e?void 0:e.buildings.length)?t:0)+(null!=(i=null==e?void 0:e.treeOverrides.length)?i:0)})),0),{t:d}=(0,ea.$G)(),h=(0,eQ.Z)(L.R9),c=(0,eQ.Z)(ep.UW);return(0,ei.jsxs)("div",{className:eD()("mt-[6px] ease-in-out duration-300 flex flex-col gap-2.5",e),children:[(0,ei.jsxs)("div",{onClick:()=>{let e=!i;D.Do.next(e),e&&P.n.onStudioSidebarOpen()},className:"relative flex flex-row justify-center items-center gap-[6px] px-4 py-2 cursor-pointer h-[40px] bg-[#222B33] rounded-full transition-all font-bold text-[14px] text-white border border-1 border-white border-opacity-20 hover:border-opacity-60",style:{boxShadow:"0 1px 1px rgba(0, 0, 0, 0.10)",transition:"border-color 100ms ease-in-out"},children:[(null==h?void 0:h.isAllowedToUseStudio())?(0,ei.jsx)(ed.zW,{className:"text-shadowmap-yellow"}):(0,ei.jsx)(ed.vZ,{className:"text-shadowmap-yellow"}),d("studio.editButton"),(0,ei.jsx)(ta.u,{show:s,as:es.Fragment,children:(0,ei.jsx)(ta.u.Child,{enter:"transition-all duration-200 ease-out",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-all duration-150 ease-in",leaveFrom:"opacity-100",leaveTo:"opacity-0",className:"absolute top-0 right-[-4px] bg-shadowmap-red w-[14px] h-[14px] border-[1.5px] border-white rounded-full"})}),t&&(0,ei.jsx)(ta.u,{show:s,as:es.Fragment,children:(0,ei.jsxs)(ta.u.Child,{enter:"transition-all duration-200 ease-out",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-all duration-150 ease-in",leaveFrom:"opacity-100",leaveTo:"opacity-0",className:"absolute left-[calc(100%+15px)] top-[50%] bg-shadowmap-yellow text-black rounded-[4px] px-[14px] py-2 text-[12px] leading-[1.1] font-bold text-center cursor-pointer text-nowrap transform -translate-y-1/2",style:{boxShadow:"0 1px 9px rgba(0, 0, 0, 0.40)"},children:[d("studio.editButtonUnsavedBubble"),(0,ei.jsx)("div",{className:"absolute left-0 top-[50%] w-0 h-0 border-t-[6px] border-b-[6px] border-r-[5px] border-t-transparent border-b-transparent border-r-shadowmap-yellow transform -translate-x-full -translate-y-1/2"})]})})]}),t&&o&&c!==ep.BS.Analytics&&(0,ei.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,ei.jsxs)("div",{className:"relative w-[38px] h-[38px]",children:[(0,ei.jsx)("div",{className:eD()("relative flex flex-row justify-center items-center w-[38px] h-[38px] cursor-pointer rounded-full font-bold border-white border-opacity-20 hover:border-opacity-60","3d-models"===n?"bg-white text-grey-800":"bg-[#222B33] border text-shadowmap-yellow"),style:{boxShadow:"0 1px 1px rgba(0, 0, 0, 0.10)",transition:"border-color 100ms ease-in-out"},onClick:()=>{D.nJ.next("3d-models"===n?void 0:"3d-models")},children:"3d-models"===n?(0,ei.jsx)(ed._9,{}):(0,ei.jsx)(ed.lH,{})}),r>0&&"3d-models"!==n&&(0,ei.jsx)("div",{className:"absolute top-[-1px] right-[-2px] bg-white rounded-full text-[12px] text-grey-800 font-bold flex justify-center w-[14px] h-[14px] leading-none pt-[0.5px] cursor-pointer",onClick:()=>{D.nJ.next("3d-models")},children:r}),"3d-models"===n&&(0,ei.jsx)("div",{className:"absolute top-0 right-0 w-[290px] transform translate-x-[calc(100%+12px)] bg-grey-800 p-2.5 rounded-lg",style:{boxShadow:"0 1px 9px 0 rgba(0, 0, 0, 0.40)"},children:(0,ei.jsx)(tR,{isFromButton:!0,limitHeight:!0})})]}),(0,ei.jsxs)("div",{className:"relative w-[38px] h-[38px]",children:[(0,ei.jsx)("div",{className:eD()("relative flex flex-row justify-center items-center w-[38px] h-[38px] cursor-pointer rounded-full font-bold border-white border-opacity-20 hover:border-opacity-60","prefabs"===n?"bg-white text-grey-800":"bg-[#222B33] border text-shadowmap-yellow"),style:{boxShadow:"0 1px 1px rgba(0, 0, 0, 0.10)",transition:"border-color 100ms ease-in-out"},onClick:()=>{D.nJ.next("prefabs"===n?void 0:"prefabs")},children:"prefabs"===n?(0,ei.jsx)(ed._9,{}):(0,ei.jsx)(ed.OX,{})}),a>0&&"prefabs"!==n&&(0,ei.jsx)("div",{className:"absolute top-[-1px] right-[-2px] bg-white rounded-full text-[12px] text-grey-800 font-bold flex justify-center w-[14px] h-[14px] leading-none pt-[0.5px] cursor-pointer",onClick:()=>{D.nJ.next("prefabs")},children:a}),"prefabs"===n&&(0,ei.jsx)("div",{className:"absolute top-0 right-0 w-[290px] transform translate-x-[calc(100%+12px)] bg-grey-800 p-2.5 rounded-lg",style:{boxShadow:"0 1px 9px 0 rgba(0, 0, 0, 0.40)"},children:(0,ei.jsx)(ty,{limitHeight:!0,isFromButton:!0})})]}),(0,ei.jsxs)("div",{className:"relative w-[38px] h-[38px]",children:[(0,ei.jsx)("div",{className:eD()("relative flex flex-row justify-center items-center w-[38px] h-[38px] cursor-pointer rounded-full font-bold border-white border-opacity-20 hover:border-opacity-60","overrides"===n?"bg-white text-grey-800":"bg-[#222B33] border text-shadowmap-yellow"),style:{boxShadow:"0 1px 1px rgba(0, 0, 0, 0.10)",transition:"border-color 100ms ease-in-out"},onClick:()=>{D.nJ.next("overrides"===n?void 0:"overrides")},children:"overrides"===n?(0,ei.jsx)(ed._9,{}):(0,ei.jsx)(ed.GG,{})}),l>0&&"overrides"!==n&&(0,ei.jsx)("div",{className:"absolute top-[-1px] right-[-2px] bg-white rounded-full text-[12px] text-grey-800 font-bold flex justify-center w-[14px] h-[14px] leading-none pt-[0.5px] cursor-pointer",onClick:()=>{D.nJ.next("overrides")},children:l}),"overrides"===n&&(0,ei.jsx)("div",{className:"absolute top-0 right-0 w-[290px] transform translate-x-[calc(100%+12px)] bg-grey-800 p-2.5 rounded-lg",style:{boxShadow:"0 1px 9px 0 rgba(0, 0, 0, 0.40)"},children:(0,ei.jsx)(tL,{isFromButton:!0,limitHeight:!0})})]})]})]})},tB=()=>{let e=(0,eQ.Z)(e1.Yy),[t]=(0,et.mr)("hideUI"),i=(0,tr.pw)(Z.Xq).capabilities.enableStudio;return e||t||!i?null:(0,ei.jsx)(tV,{className:"hidden sm:flex fixed left-lsafe-3 top-tsafe-2.5",showControls:!0})};var tU=()=>{let[e,t]=(0,es.useState)(!1),[i,s]=(0,es.useState)(!1);return((0,es.useEffect)(()=>{let e=L.di.subscribe(e=>{e?(t(!0),setTimeout(()=>{s(!0)},1e3)):(t(!1),s(!1))});return()=>e.unsubscribe()},[]),i)?null:(0,ei.jsx)("section",{className:"absolute z-[2] top-0 left-0 w-full h-full bg-transparent pointer-events-none",children:(0,ei.jsx)("div",{id:"global-loader",className:eD()({"fade-out":e})})})},tF=i(23408),tZ=es.memo(()=>{let{t:e}=(0,ea.$G)(),t=(0,eQ.Z)(L.Qs);return(0,ei.jsx)("button",Object.assign({title:e("infoModalButton.title")},(0,el.zc)(()=>{P.n.onInfoModalOpen(),L.y7.next({modal:H.o.INFO})}),{className:"w-[40px] h-[40px] rounded-icon btn-gradient flex items-center justify-center flex-shrink-0",children:t?(0,ei.jsx)(ed.Ub,{}):(0,ei.jsx)(ed.dl,{})}))});function tH(){let[e,t]=es.useState({width:window.innerWidth,height:window.innerHeight}),i=()=>{t({width:window.innerWidth,height:window.innerHeight})};return es.useEffect(()=>(window.addEventListener("resize",i),()=>{window.removeEventListener("resize",i)}),[]),e}var tG=i(53277),tz=({modalSide:e})=>{let t=(0,eQ.Z)(S.nl.pipe((0,_.U)(e=>null==e?void 0:e.data))),i=(0,eQ.Z)(S.nl.pipe((0,_.U)(e=>null==e?void 0:e.isEmpty))),s=(0,es.useRef)(null),n=(0,eQ.Z)(S.tY),o=(0,eQ.Z)(ep.UW),[r]=(0,et.mr)("hideUI"),a=(0,eQ.Z)(L.$l.pipe((0,_.U)(e=>{var t;return null==(t=null==e?void 0:e.country)?void 0:t.code}))),l=(0,eQ.Z)(e1.Yy);if(!t||r||o===ep.BS.Analytics||l)return null;let d=()=>{var e,t,i,n;return e=void 0,t=void 0,i=void 0,n=function*(){s.current&&L.y7.next({modal:H.o.WEATHER,opts:{action:"toggle",parentElement:s.current}})},new(i||(i=Promise))(function(s,o){function r(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?s(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(r,a)}l((n=n.apply(e,t||[])).next())})};return(0,ei.jsx)(ta.u,{show:!i,enter:"transition-opacity duration-500",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-500",leaveFrom:"opacity-100",leaveTo:"opacity-0",afterLeave:()=>{L.y7.next({modal:H.o.WEATHER,opts:{action:"open",parentElement:s.current}})},children:(0,ei.jsxs)("div",{className:"pointer-events-auto relative",children:[(0,ei.jsxs)("div",{className:"rounded-[12px] backdrop-filter-map h-full bg-white bg-opacity-80 hover:bg-opacity-70 flex flex-row items-center justify-center text-grey-800 leading-none cursor-pointer p-[7px] w-[75px]",style:{boxShadow:"0px 1px 1px 0px rgba(0, 0, 0, 0.10)"},onClick:d,children:[n&&(0,ei.jsx)("div",{className:"absolute top-[2px] right-[2px]",children:(0,ei.jsx)(eh,{product:"home",mode:"small",onClick:d})}),(0,ei.jsx)("div",{className:eD()("w-[24px] h-[24px] bg-center",{"opacity-30":n}),style:{backgroundImage:`url(${t.weatherIcon})`,backgroundSize:"120%"}}),(0,ei.jsxs)("div",{className:eD()("flex flex-col justify-center items-center min-w-[38px]",{"opacity-30":n}),children:[(0,ei.jsx)("div",{className:"text-[16px]",children:(0,tG.a9)(t.temperature,a)}),(0,ei.jsxs)("div",{className:"text-[10px] flex flex-row justify-center items-center gap-1",children:[(0,ei.jsxs)("span",{children:["UV ",Math.round(t.uvIndex)]}),(0,ei.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"8",height:"8",viewBox:"0 0 8 8",fill:"none",children:(0,ei.jsx)("circle",{cx:"4",cy:"4",r:"3.5",fill:(0,tG.e3)(t.uvIndex),stroke:"#33404D"})})]})]})]}),(0,ei.jsx)("div",{className:eD()("absolute left-0","top"===e?"bottom-[calc(100%_+_12px)]":"top-[calc(100%_+_12px)]"),ref:s})]})})},tW=()=>{let{t:e}=(0,ea.$G)(),t=(0,eQ.Z)(Z.Xq.pipe((0,_.U)(e=>e.capabilities.showInfoButton&&"bottom"===e.infoButtonPosition))),i=(0,eQ.Z)(Z.Xq.pipe((0,_.U)(e=>e.capabilities.showUpgradeButton))),s=(0,eQ.Z)(Z.Xq.pipe((0,_.U)(e=>e.capabilities.enableAuth))),n=(0,eQ.Z)(L.R9),o=(0,eQ.Z)(ey),r=tH();if(!n)return null;let a=!1,l=e("buyButton.label"),d=!1,h=!1,c=!1;s&&(n.isGuest()?(a=!1,d=!0,h=!0):(n.isFreemium()||n.has(tF.uU.TRIAL))&&(l=e("upgradeButton.label"),a=!0,d=!1,h=!1)),o&&(c=!0);let u=a||d||h||c;return(0,ei.jsxs)("div",{className:"flex flex-row justify-between items-center w-full pointer-events-none",children:[(0,ei.jsx)("div",{className:"pointer-events-auto",children:r.width<640&&(0,ei.jsx)(tz,{modalSide:"bottom"})}),(0,ei.jsxs)("div",{className:"flex justify-end items-start gap-2 pointer-events-auto",children:[i&&(0,ei.jsx)("div",{className:"flex flex-row justify-end gap-2",children:(0,ei.jsx)("a",{href:"https://app.shadowmap.org?buy",target:"_blank",className:"btn-gradient rounded-full uppercase font-bold text-sm btn-with-label text-text-button hover:text-text-button-hover",children:e("upgradeButton.label")})}),u&&(0,ei.jsxs)("div",{className:"flex gap-x-2 drop-shadow-sm bg-grey-800 bg-opacity-60 backdrop-filter-map rounded-full p-1.5 items-center",children:[h&&(0,ei.jsx)("button",{className:"px-4 py-1 text-sm text-mint-200 hover:text-neon-300 font-bold rounded-full","data-marketing-id":"log-in-btn",onClick:()=>{L.y7.next({modal:H.o.LOGIN})},children:e("loginButton.label")}),d&&(0,ei.jsx)("button",{className:"btn-gradient px-4 py-1 text-sm font-bold rounded-full","data-marketing-id":"sign-up-btn",onClick:()=>{(0,eg.ms)({trigger:"sign_up_button",subscription:ef.K.ALL})},children:e("signUpButton.label")}),a&&(0,ei.jsx)("button",{className:"btn-gradient px-4 py-1 text-sm font-bold rounded-full","data-marketing-id":"buy-btn",onClick:()=>{(0,eg.bi)({trigger:"upgrade_from_free_button",subscription:ef.K.ALL})},children:l}),c&&(0,ei.jsx)("button",{className:"btn-gradient px-4 py-1 text-sm font-bold rounded-full","data-marketing-id":"buy-btn",onClick:()=>{window.location.href="/?utm_source=shadowmap-project-share&utm_medium=cta-button"},children:e("createProjectFromShareButton.label")})]}),t&&(0,ei.jsx)(tZ,{})]})]})},tX=i(75939),tY=i(44987),t$=i(1885);let tQ=new c.X(1),tq=new c.X({from:0,to:11});var tK=({data:e,onRangeChange:t,isLoading:i,showChart:s})=>{let{t:n}=(0,ea.$G)(),o=(0,tr.pw)(tq,{from:0,to:11}),[r,a]=(0,es.useState)(100),[l,d]=(0,es.useState)(0),h=(0,es.useRef)(null),c=(0,es.useRef)(null),u=(0,es.useRef)(null),p=(0,eQ.Z)(tQ),m=n("analyticsInfo.chart.monthLetters",{returnObjects:!0}),g=n("analyticsInfo.chart.monthNames",{returnObjects:!0});(0,es.useEffect)(()=>{},[]),(0,es.useEffect)(()=>{d(e=>e+1)},[i]),(0,es.useEffect)(()=>{if(!s)return;let e=tQ.subscribe(e=>{h.current&&(h.current.style.height=`${56+30*e}px`),c.current&&(c.current.style.opacity=e.toString()),u.current&&(u.current.style.height=`${28*e}px`,u.current.style.overflow=e>.9?"visible":"hidden",u.current.style.opacity=e.toString())});return()=>{e.unsubscribe()}},[i,s]),(0,es.useLayoutEffect)(()=>{if(e&&e.length>0){let t=Math.max(...e.map(e=>e.maxValue))/1e3;a(t=t<20?Math.ceil(t):10*Math.ceil(t/10))}},[e]);let f=i&&(!e||0===e.length);return(0,ei.jsxs)("div",{children:[(0,ei.jsxs)("div",{className:"relative w-full select-none flex flex-row",ref:h,children:[(0,ei.jsxs)("div",{className:"relative h-full flex-grow flex flex-col",children:[s&&(0,ei.jsxs)("div",{className:"relative w-full h-full flex-grow",children:[(0,ei.jsx)(t$.Z.Button,{className:eD()("!w-full !h-full !min-w-0 !rounded-lg",f?"!block":"!hidden"),active:!0}),s&&(0,ei.jsxs)("div",{className:"relative w-full h-full",children:[(0,ei.jsx)("div",{className:eD()("absolute inset-x-0 top-0 border-t border-grey-400",f?"hidden":"block")}),(0,ei.jsx)("div",{className:eD()("absolute inset-x-0 top-1/2 border-t border-grey-400",f?"hidden":"block"),style:{opacity:p}}),(0,ei.jsx)("div",{className:eD()("absolute inset-x-0 bottom-0 border-t border-grey-400",f?"hidden":"block")}),(0,ei.jsx)("div",{className:eD()("flex flex-row w-full h-full",f?"hidden":"block"),children:e&&e.map((e,t)=>{let i=Math.min(100,e.maxValue/(1e3*r)*100),s=100*(0,tY.uZ)(0,1,e.value/e.maxValue),a=g[t],l=(0,ei.jsxs)(ei.Fragment,{children:[(0,ei.jsx)("div",{className:"font-bold",children:a}),(0,ei.jsxs)("div",{children:[n("analyticsInfo.chart.tooltip.energy")," ",(0,el.Ut)(e.value)," ",n("analyticsInfo.chart.unit")]}),(0,ei.jsxs)("div",{children:[n("analyticsInfo.chart.tooltip.lost")," ",(0,el.Ut)(Math.max(0,e.maxValue-e.value))," ",n("analyticsInfo.chart.unit")]})]});return(0,ei.jsx)("div",{className:"w-[calc(100%/12)] flex flex-row justify-center items-end h-full opacity-0",style:{animation:"show-bar 300ms ease-in-out forwards"},children:(0,ei.jsx)(e_.u,{content:l,placement:"top",children:(0,ei.jsx)("div",{className:"w-full z-[1] flex justify-center transition-all duration-300 ease-in-out",style:{height:`${i}%`},children:(0,ei.jsx)("div",{className:eD()("cursor-pointer w-[40%] h-full rounded-t-[2px] bg-[#a9ad70] overflow-hidden flex flex-col justify-end",{"opacity-20":t<o.from||t>o.to}),children:(0,ei.jsx)("div",{className:"cursor-pointer w-full bg-[#F9F687]",style:{height:`${s}%`}})})})})},`${t} ${e.value}`)})})]})]},l),(0,ei.jsx)("div",{className:eD()("flex flex-row w-full flex-shrink-0",s?"h-[24px]":"leading-none"),children:m.map((e,t)=>(0,ei.jsx)("div",{className:"w-[calc(100%/12)] text-sm text-white flex justify-center items-center h-full",children:e},t))})]}),s&&(0,ei.jsx)("div",{className:"w-[60px] h-full pb-[25px]",children:(0,ei.jsxs)("div",{className:"relative w-full h-full",children:[(0,ei.jsxs)("div",{className:"absolute right-0 -translate-y-1/2 text-[10px] text-[#B8CBDE] whitespace-nowrap",children:[Math.round(r)," ",n("analyticsInfo.chart.unit")]}),(0,ei.jsxs)("div",{className:"absolute right-0 top-1/2 -translate-y-1/2 text-[10px] text-[#B8CBDE] whitespace-nowrap",ref:c,children:[Math.round(r/2)," ",n("analyticsInfo.chart.unit")]}),(0,ei.jsxs)("div",{className:"absolute right-0 bottom-0 translate-y-1/2 text-[10px] text-[#B8CBDE] whitespace-nowrap",children:["0 ",n("analyticsInfo.chart.unit")]})]})})]}),(0,ei.jsx)("div",{className:eD()("flex flex-row justify-center mb-2",s?"w-[calc(100%-60px)]":"w-full"),ref:u,children:(0,ei.jsx)("div",{className:"w-[91.6666667%] mt-[8px]",children:(0,ei.jsx)(tX.Z,{range:!0,min:0,max:11,step:1,value:[o.from,o.to],onChange:e=>{let t=Math.min(e[0],e[1]),i=Math.max(e[0],e[1]);tq.next({from:t,to:i})},onChangeComplete:e=>{t(Math.min(e[0],e[1]),Math.max(e[0],e[1]))},classNames:{track:"!bg-gradient !h-2 rounded-full",rail:"!bg-grey-800 !h-2 rounded-full",handle:"custom-handle sun !opacity-100 !mt-[-3px]"}})})})]})},tJ=i(86723),t1=i(38284),t0=i(63224),t2=i(16361),t5=i(69789);let t3=({progress:e,isLoading:t,maxValue:i})=>{let{t:s}=(0,ea.$G)();return t||void 0===e?(0,ei.jsx)("div",{className:"flex flex-row gap-2 items-center justify-center h-4 mt-1.5",children:(0,ei.jsx)(t$.Z.Button,{className:"!w-full !h-2 !min-w-0 block !rounded-full",active:!0})}):(0,ei.jsxs)("div",{className:"flex flex-row gap-2 items-center justify-center h-4 mt-1.5",children:[(0,ei.jsxs)("div",{className:"text-[#B8CBDE] text-[10px] flex-shrink-0",children:["0 ",s("analyticsCard.annualEnergyUnit")]}),(0,ei.jsx)("div",{className:"w-full rounded-full border border-grey-800 border-[0.5px] h-2 relative flex-grow",style:{backgroundImage:"url('./img/colormaps/magma.png')",backgroundSize:"100% 100%"},children:(0,ei.jsx)("div",{className:"bg-grey-800 border-l-[2px] border-white h-[14px] w-1 absolute",style:{transform:"translateY(calc(-50% + 3px))",left:`${(null!=e?e:0)*100}%`}})}),(0,ei.jsxs)("div",{className:"text-[#B8CBDE] text-[10px] flex-shrink-0",children:[(0,el.Ut)(null!=i?i:0)," ",s("analyticsCard.annualEnergyUnit")]})]})};var t4=()=>{var e;let{t}=(0,ea.$G)(),i=(0,tr.pw)(ep.IR),s=(0,tr.pw)(ep.RH),n=(0,tr.pw)(ep.UH),o=(0,tr.pw)(ep.Q_),r=(0,t5.Z)(),[a,l]=(0,t2.Z)(),d=(0,es.useRef)(null),h=(0,es.useRef)(null),c=(0,eQ.Z)(Z.Gn.pipe((0,_.U)(e=>"dahler"===e))),u=c?292:158,p=r.width<640,m=(null!=(e=l.height)?e:u)-u+(c?208:p?73:64),g=(e,t)=>{if(!e)return;let i=(0,tY.uZ)(0,1,t/m),s=(0,el.$O)("#FFE434","#B8CBDE",i);tQ.next(i);for(let t=0;t<e.children.length;t++){let i=e.children[t].querySelector("path");i&&i.setAttribute("fill",s)}e.children[0].style.display=i<.5?"block":"none",e.children[1].style.display=i>=.5?"block":"none"},[{h:f},x]=(0,t1.q_)(()=>({h:0,onChange:({value:e})=>{g(d.current,e.h)}}),[m]);(0,es.useLayoutEffect)(()=>{g(d.current,f.get())},[m]);let w=({canceled:e=!1})=>{x.start({h:m,immediate:!1,config:e?t1.vc.wobbly:t1.vc.stiff})},b=()=>{x.start({h:0,immediate:!1,config:t1.vc.stiff})},v=(0,t0.useDrag)(({last:e,velocity:[,t],direction:[,i],offset:[,s],canceled:n})=>{e?s>.5*m||t>.5&&i>0?w({canceled:n}):b():x.start({h:s,immediate:!0})},{from:()=>[0,f.get()],bounds:{top:0,bottom:m},axis:"y",rubberband:!0,pointer:{touch:!0}});if((0,es.useEffect)(()=>{n||!i.isAccessible||x.start({h:0,immediate:!0}),g(d.current,f.get())},[n,i.isAccessible]),(0,es.useEffect)(()=>{p||(x.start({h:m,immediate:!0}),tQ.next(1))},[p]),!i)return null;let y=n||!i.isAccessible,C=(0,el.Ut)(i.energy),M=(s[1]-s[0])/864e5,S=(0,el.Og)(+(0,el.Dl)(i.time/M))||"0",T=(0,el.Og)(Math.round(100*i.timeInDaylightFraction)),j=t("analyticsInfo.chart.monthNames",{returnObjects:!0}),P=new Date(s[0]).getUTCMonth(),E=new Date(s[1]-1).getUTCMonth(),A=0===P&&11===E,D=P===E,O=i.isReady&&i.timeInDaylightFraction<.5;return(0,ei.jsxs)("div",{className:"relative",children:[!y&&p&&(0,ei.jsxs)("div",{className:"absolute bottom-[9px] left-0 right-0 flex justify-center z-[1] pointer-events-none",ref:d,children:[(0,ei.jsx)("svg",{width:"32",height:"10",viewBox:"0 0 32 10",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,ei.jsx)("path",{d:"M0.5 3.24963C0.5 1.35074 2.29203 -0.0375398 4.13069 0.436951L16 3.5L27.8693 0.436951C29.708 -0.0375397 31.5 1.35074 31.5 3.24963C31.5 4.57437 30.6037 5.7313 29.321 6.06232L16 9.5L2.67898 6.06232C1.39627 5.7313 0.5 4.57437 0.5 3.24963Z",fill:"#FFE434"})}),(0,ei.jsx)("svg",{width:"32",height:"10",viewBox:"0 0 32 10",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,ei.jsx)("path",{d:"M0.5 7.07899C0.5 9.01613 2.38806 10.3909 4.23166 9.79624L16 6L27.7683 9.79624C29.6119 10.3909 31.5 9.01613 31.5 7.07899C31.5 5.83985 30.7007 4.74216 29.5214 4.36174L16 0L2.4786 4.36174C1.29929 4.74216 0.5 5.83985 0.5 7.07899Z",fill:"#B8CBDE"})})]}),(0,ei.jsx)(t1.q.div,Object.assign({},p?v():{},{style:{height:y||!p?"auto":f.to(e=>`${e+u}px`),maskImage:f.to(e=>{let t=y||!p?1:(0,tY.uZ)(0,1,e/m);return`linear-gradient(black calc(100% - 55px), rgba(0, 0, 0, ${t}) calc(100% - 12px), rgba(0, 0, 0, ${t}) 100%)`})},ref:h,className:"relative overflow-hidden select-none p-4 touch-none",onClick:e=>{var t,i;let s=null==(t=h.current)?void 0:t.getBoundingClientRect();s&&e.clientY>(null!=(i=s.bottom)?i:0)-70&&(f.get()>0?b():w({canceled:!1}))},children:(0,ei.jsx)("div",{ref:a,style:{height:p&&!y?"237px":"auto"},children:(0,ei.jsxs)(tJ.ZP,{theme:{components:{Skeleton:{gradientFromColor:"rgba(94, 107, 120, 0.7)",gradientToColor:"rgba(184, 203, 222, 0.7)"}}},children:[y&&(0,ei.jsxs)("div",{className:"flex flex-col gap-4",children:[!c&&(0,ei.jsx)(tK,{data:void 0,isLoading:!1,onRangeChange:(e,t)=>{let i=new Date().getFullYear(),s=new Date(Date.UTC(i,e,1)),n=new Date(Date.UTC(i,t+1,1));ep.RH.next([+s,+n])},showChart:!1}),(0,ei.jsxs)("div",{className:"flex flex-row items-center justify-center text-[12px]",children:[(0,ei.jsx)("span",{className:"block md:hidden",children:t("analyticsInfo.mobile")}),(0,ei.jsx)("span",{className:"hidden md:block",children:t("analyticsInfo.desktop")})]}),c&&(0,ei.jsxs)("div",{children:[(0,ei.jsx)("div",{className:"h-[1px] w-full bg-grey-400"}),(0,ei.jsxs)("div",{className:"flex flex-row justify-center items-center flex-wrap gap-x-4 gap-y-2 mt-3 text-[14px] font-bold font-[Poppins]",children:[(0,ei.jsx)(ed.mf,{className:"w-[62px]"}),(0,ei.jsxs)("div",{className:"flex flex-row items-center gap-4",children:[(0,ei.jsx)("div",{children:t("analyticsInfo.dahler.text")}),(0,ei.jsx)("a",{className:"block text-[#FFD233] underline cursor-pointer",href:"https://empfehlen.enpal.de/u/dba867a4-1ba7-41e4-9188-515910a65964",target:"_blank",children:t("analyticsInfo.dahler.link")})]})]})]})]}),(0,ei.jsxs)("div",{style:{display:y?"none":"block"},className:"mt-3",children:[(0,ei.jsx)(tK,{data:0===o.length?void 0:o.map(e=>({value:e.energy,maxValue:e.maxEnergyAtNormal})),isLoading:0===o.length,onRangeChange:(e,t)=>{let i=new Date().getFullYear(),s=new Date(Date.UTC(i,e,1)),n=new Date(Date.UTC(i,t+1,1));ep.RH.next([+s,+n])},showChart:!0}),(0,ei.jsxs)(es.Fragment,{children:[(0,ei.jsxs)("div",{className:"flex justify-between items-end mt-1 text-[14px]",children:[(0,ei.jsx)("div",{className:"flex flex-row gap-1 items-center",children:(0,ei.jsxs)("div",{children:[t(A?"analyticsCard.energyAnnual":"analyticsCard.energyOverPeriod"),!A&&!D&&(0,ei.jsxs)(ei.Fragment,{children:[" ",j[P],"  ",j[E]]}),!A&&D&&(0,ei.jsxs)(ei.Fragment,{children:[" ",j[P]]})]})}),(0,ei.jsx)("div",{className:"font-bold",children:i.isReady?(0,ei.jsxs)(ei.Fragment,{children:[C," ",t("analyticsCard.annualEnergyUnit")]}):(0,ei.jsx)(t$.Z.Button,{className:"!w-[52px] !h-[16px] !min-w-0 block !rounded-lg",active:!0})})]}),c&&(0,ei.jsxs)("div",{className:"relative w-full h-[120px] bg-white bg-opacity-90 rounded-2xl font-[Poppins] mt-4 mb-2",style:{boxShadow:"0 4px 10px rgba(0, 0, 0, 0.50)"},onClick:()=>{ep.UW.next(ep.BS.Analytics)},children:[(0,ei.jsx)("div",{className:"absolute",style:{top:-8,left:"90%",width:0,height:0,borderLeft:"8px solid transparent",borderRight:"8px solid transparent",borderBottom:"8px solid rgba(255, 255, 255, 0.90)"}}),(0,ei.jsxs)("div",{className:"p-4 pt-5 h-full flex flex-col gap-1 justify-between relative text-[#072543] text-[10px] sm:text-[14px]",children:[(0,ei.jsx)("div",{className:"text-center leading-[1.2]",children:(0,ei.jsx)(ea.cC,{i18nKey:O?"analyticsCard.dahlerBanner.textLowEnergy":"analyticsCard.dahlerBanner.text",components:{logo:(0,ei.jsx)(ed.mf,{className:"inline-block w-[48px] mx-[2px]"})}})}),(0,ei.jsx)("a",{className:"flex flex-row justify-center items-center flex-wrap gap-x-1.5 py-4 px-2 rounded-lg bg-[#FFD233] cursor-pointer font-bold",style:{boxShadow:"0 1px 1px 0 rgba(0, 0, 0, 0.13), 0 2px 4px 0 rgba(0, 0, 0, 0.15)"},href:"https://empfehlen.enpal.de/u/dba867a4-1ba7-41e4-9188-515910a65964",target:"_blank",children:(0,ei.jsx)(ea.cC,{i18nKey:O?"analyticsCard.dahlerBanner.buttonLowEnergy":"analyticsCard.dahlerBanner.button",components:{logo:(0,ei.jsx)(ed.mf,{fill:"#fff",className:"w-[62px]"})}})})]})]}),(0,ei.jsx)(t3,{maxValue:null==i?void 0:i.maxEnergy,progress:i.isReady?i.energy/i.maxEnergy:void 0,isLoading:!i.isReady}),(0,ei.jsxs)("div",{className:"flex justify-between items-center mt-1 text-[14px]",children:[(0,ei.jsx)("div",{className:"flex flex-row gap-1 items-center",children:(0,ei.jsx)("div",{children:t("analyticsCard.dailyTime")})}),(0,ei.jsx)("div",{className:"font-bold",children:i.isReady?(0,ei.jsxs)(ei.Fragment,{children:[S," ",t("analyticsCard.dailyTimeUnit")]}):(0,ei.jsx)(t$.Z.Button,{className:"!w-[52px] !h-[16px] !min-w-0 block !rounded-lg",active:!0})})]}),(0,ei.jsxs)("div",{className:"flex justify-between items-center mt-1 text-[14px]",children:[(0,ei.jsx)("div",{className:"flex flex-row gap-1 items-center",children:(0,ei.jsx)("div",{children:t("analyticsCard.annualTimePercentage")})}),(0,ei.jsx)("div",{className:"font-bold",children:i.isReady?(0,ei.jsxs)(ei.Fragment,{children:[T,"%"]}):(0,ei.jsx)(t$.Z.Button,{className:"!w-[52px] !h-[16px] !min-w-0 block !rounded-lg",active:!0})})]}),(0,ei.jsx)("div",{className:"flex flex-row justify-end mt-[14px]",children:(0,ei.jsxs)("button",{className:"bg-grey-800 rounded-full border-none text-xs focus:outline-none px-2 py-1 flex flex-row items-center gap-1",onClick:e=>{e.stopPropagation(),L.y7.next({modal:H.o.INFO,opts:{goToAnalytics:!0}})},children:[(0,ei.jsx)(ed.r0,{className:"w-4 h-4 text-mint-200"}),(0,ei.jsx)("span",{children:t("analyticsCard.infoButton")})]})})]},`${C} ${S} ${T} ${P} ${E} ${i.isReady}`)]})]})})}))]})},t8=i(13826),t9=i(9521),t7=i(63609);class t6{}t6.isValid=e=>e instanceof Date&&!isNaN(e.getTime()),t6.minutesOfTheDay=e=>e.get("hour")*t7.yD+e.get("minute"),t6.toNoon=e=>{let t=new Date(e.getTime());return t.setHours(12),t.setMinutes(0),t.setMilliseconds(0),t};let ie=(e,t)=>{let i=Math.floor(e/t7.yD),s=Math.floor(e-i*t7.yD);return t.set({hour:i,minute:s})};var it=i(60570),ii=i.n(it);let is=e=>{if(!e||!e.isValid)return{time:"",postfix:""};let t=e.toLocaleString({hour:"numeric",minute:"2-digit"});return{time:t.replace(" AM","").replace(" PM",""),postfix:t.includes("AM")?"am":t.includes("PM")?"pm":""}},io=e=>({range:{min:[0],max:[t7.nq-1]},start:[e]}),ir=new V.x;ir.pipe((0,p.M)(M.sP)).subscribe(([e,{dateTime:t}])=>{let i=ie(e,t);M.TM.next({dateTime:i,source:M.V2.TIME_SLIDER})}),ir.pipe((0,t9.P)(()=>(0,t8.F)(6e4))).subscribe(e=>{P.n.onTimeSliderChange()});let ia=new c.X(!1),il=new c.X(!1);(0,d.a)([ia,il]).subscribe(([e,t])=>{M.kd.next(e||t)});var id=es.memo(()=>{let e=(0,es.useRef)(null),[t,i]=(0,es.useState)(),[s,n]=(0,es.useState)({time:"",postfix:""}),[o,r]=(0,es.useState)({time:"",postfix:""}),[a,l]=(0,es.useState)(io(0).range),[d,h]=(0,es.useState)([0]),[c,u]=(0,es.useState)(0),p=(0,eQ.Z)(M.Pn),m=()=>{p&&(P.n.onSunriseClick(),(0,M.UX)(p.sunrise.plus({minute:15})))},g=()=>{p&&(P.n.onSunsetClick(),(0,M.UX)(p.sunset.minus({minute:15})))};return(0,es.useEffect)(()=>{let e,t;if(n(is(p?p.sunrise:void 0)),r(is(p?p.sunset:void 0)),!p)return;if(!p.areValid()){let e=io(c);l(e.range),h(e.start);return}let i=(e=t6.minutesOfTheDay(p.sunrise),t=t6.minutesOfTheDay(p.sunset),{range:{min:[0],"10%":[e],"90%":[t],max:[t7.nq-1]},start:[c]});l(i.range),h(i.start)},[p,c]),(0,es.useEffect)(()=>{let e=M.sP.pipe((0,_.U)(e=>e.dateTime),(0,_.U)(e=>e.get("hour")*t7.yD+e.get("minute")),(0,R.x)()).subscribe(e=>{u(e)});return()=>{e.unsubscribe()}},[]),(0,es.useEffect)(()=>{t&&t.noUiSlider&&t.noUiSlider.set(c)},[c,t]),(0,es.useEffect)(()=>{if(!e.current)return;let t=Q.subscribe(t=>{let i=e.current.getElementsByClassName("noUi-touch-area")[0].getElementsByClassName("custom-handle");0!==i.length&&(t?i[0].classList.add("custom-handle-active"):i[0].classList.remove("custom-handle-active"))});return()=>t.unsubscribe()},[e]),(0,ei.jsxs)("div",{ref:e,className:"relative w-full",children:[(0,ei.jsx)("div",{className:eD()("absolute left-[10%] bg-gradient opacity-100 h-2 w-4/5 rounded-full transition-all duration-200",{"!left-0 !w-full":p&&!p.areValid()})}),(0,es.createElement)("button",Object.assign({title:(0,N.t)("sunriseButton.title"),className:eD()("absolute z-[1] -left-5 -bottom-[.37rem] xxs:-left-3 active py-0.5 px-[7px] bg-opacity-70 opacity-80 tabular-nums tracking-tight",{hidden:!p||!p.areValid()})},(0,el.zc)(e=>{e.stopPropagation(),m()}),{onTouchStart:e=>{e.stopPropagation(),e.preventDefault(),m()},key:`sunrise ${s.time} ${s.postfix}`}),s.time,s.postfix&&(0,ei.jsx)("span",{className:"text-xxxs",children:s.postfix})),(0,es.createElement)("button",Object.assign({title:(0,N.t)("sunsetButton.title"),className:eD()("absolute z-[1] -right-5 -bottom-[.37rem] xxs:-right-3 active py-0.5 px-[7px] bg-opacity-70 opacity-80 tabular-nums tracking-tight",{hidden:!p||!p.areValid()})},(0,el.zc)(e=>{e.stopPropagation(),g()}),{onTouchStart:e=>{e.stopPropagation(),e.preventDefault(),g()},key:`sunset ${o.time} ${o.postfix}`}),o.time,o.postfix&&(0,ei.jsx)("span",{className:"text-xxxs",children:o.postfix})),(0,ei.jsx)(ii(),{animate:!1,start:d,step:1,keyboardSupport:!1,range:a,onSlide:e=>{ir.next(e[0])},instanceRef:s=>{if(!t&&s&&s.children.length>0){i(s);let t=e.current.getElementsByClassName("noUi-touch-area")[0],n=document.createElement("div");n.classList.add("custom-handle","sun"),t.appendChild(n);let o=M.TM.getValue().dateTime,r=o.get("hour")*t7.yD+o.get("minute");t.addEventListener("mouseenter",()=>{ia.next(!0)}),t.addEventListener("mouseleave",()=>{ia.next(!1)}),s.noUiSlider.set(r)}},onStart:()=>{null==t||t.focus(),il.next(!0)},onEnd:()=>{il.next(!1)}})]})}),ih=i(72867),ic=i(33012);let iu=e=>({animate:!1,step:1,range:{min:[1],max:[e]}}),ip=new V.x;ip.pipe((0,t9.P)(()=>(0,t8.F)(6e4))).subscribe(e=>{P.n.onDateSliderChange()}),ip.pipe((0,p.M)(M.sP)).subscribe(([e,t])=>{let i=t.setDayOfTheYear(e);M.TM.next({dateTime:i,source:M.V2.DATE_SLIDER})}),(0,d.a)([L.R9,Z.Xq]).pipe((0,R.x)()).subscribe(([e,t])=>{if(!e.isAllowedToUseExplorer()&&!t.capabilities.unlockEverything){let e=M.TM.getValue().dateTime,t=m.ou.now(),i=e.set({day:t.day,month:t.month,year:t.year});M.TM.next({dateTime:i,source:M.V2.OTHER})}});let im=({onClick:e,label:t,progress:i})=>(0,ei.jsx)("div",{className:"absolute top-1/2 transform -translate-x-1/2 -translate-y-1/2 flex justify-center items-center",style:{left:`${100*i}%`},children:(0,ei.jsx)(e_.u,{content:t,offsetY:-4,placement:"bottom",hideAfterTimeout:!0,children:(0,ei.jsx)("div",{className:"date-fixed-point-container",onMouseDown:t=>{t.stopPropagation(),null==e||e()},onTouchStart:t=>{t.stopPropagation(),null==e||e()},style:{left:`${100*i}%`},children:(0,ei.jsx)("div",{className:"date-fixed-point"})})})}),ig=es.memo(()=>{let e=(0,eQ.Z)(J),t=(0,eQ.Z)(L.R9),i=(0,Z.MG)(e=>e.capabilities.unlockEverything),s=(0,Z.MG)(e=>e.phantomLocks.dateSlider),n=(0,eQ.Z)(S.As),{t:o}=(0,ea.$G)();return e&&n?(0,ei.jsx)(ei.Fragment,{children:Object.entries(e).map(([e,r])=>(0,ei.jsx)(im,{label:o(`datePicker.events.${(0,tY.wT)(e,n.lat)}`),progress:r.progressThroughYear,onClick:()=>{if(t){if(s)return void L.y7.next({modal:H.o.COUPON_CODE,opts:{trigger:G.g.TimeUpgrade}});t.isAllowedToUseExplorer()||i?(0,M.fG)(r.date):L.y7.next({modal:H.o.FEATURE_UPGRADE,opts:{type:z.l.Date,trigger:"date_slider_point_click"}})}}},e))}):null}),ix=m.ou.utc(0,1,1).toLocaleString({month:"2-digit",day:"2-digit"}),iw=m.ou.utc(0,12,31).toLocaleString({month:"2-digit",day:"2-digit"});var ib=es.memo(()=>{let e=(0,es.useRef)(null),[t,i]=(0,es.useState)(iu(365).range),[s,n]=(0,es.useState)(),[o,r]=(0,es.useState)(1),a=(0,Z.MG)(e=>e.capabilities.canChooseDate),l=(0,Z.MG)(e=>e.phantomLocks.dateSlider),h=(0,eQ.Z)(L.R9),c=(0,eQ.Z)((0,d.a)([L.R9,Z.Xq]).pipe((0,_.U)(([e,t])=>e.isAllowedToUseExplorer()||t.capabilities.unlockEverything)));(0,es.useEffect)(()=>{let e=[M.sP.pipe((0,_.U)(e=>e.dayOfTheYear()),(0,R.x)()).subscribe(e=>{r(e)}),M.sP.pipe((0,_.U)(({dateTime:e})=>e.isInLeapYear),(0,R.x)()).subscribe(e=>{i(iu(e?366:365).range)})];return()=>{for(let t of e)t.unsubscribe()}},[]),(0,es.useEffect)(()=>{s&&s.noUiSlider&&s.noUiSlider.set(o)},[o,s]),(0,es.useEffect)(()=>{if(!s||!s.noUiSlider)return;let e=(0,d.a)([L.R9,Z.Xq]).pipe((0,R.x)()).subscribe(([e,t])=>{(e.isAllowedToUseExplorer()||t.capabilities.unlockEverything)&&!t.phantomLocks.dateSlider?s.noUiSlider.enable(0):s.noUiSlider.disable(0)});return()=>e.unsubscribe()},[o]);let u=e=>{if(l){e.preventDefault(),e.stopPropagation(),L.y7.next({modal:H.o.COUPON_CODE,opts:{trigger:G.g.TimeUpgrade}});return}c||(e.preventDefault(),e.stopPropagation(),L.y7.next({modal:H.o.FEATURE_UPGRADE,opts:{type:z.l.Date,trigger:"date_slider"}}))};return a&&h?(0,ei.jsxs)("div",{ref:e,className:"relative w-full",children:[(0,ei.jsx)("span",{className:"absolute -left-5 -bottom-[.37rem] xxs:-left-3 active py-0.5 px-[7px] bg-opacity-70 opacity-80",children:ix}),(0,ei.jsxs)("div",{className:"relative left-[10%] w-4/5",onMouseDownCapture:u,onTouchStartCapture:u,onTouchMove:u,children:[(0,ei.jsx)("div",{className:"absolute w-full bg-blue-grey-200/70 h-2 rounded-full"}),(0,ei.jsxs)("div",{children:[(0,ei.jsx)(ii(),{animate:!1,start:1,step:1,keyboardSupport:!1,range:t,onSlide:e=>{ip.next(Math.round(e[0]))},instanceRef:t=>{if(!s&&t&&t.children.length>0){n(t);let i=e.current.getElementsByClassName("noUi-touch-area")[0],s=document.createElement("div");s.classList.add("custom-handle","date"),i.appendChild(s);let o=new ih.I(M.TM.getValue().dateTime,ic.I).dayOfTheYear();t.noUiSlider.set(o)}},onStart:()=>{null==s||s.focus()}}),(0,ei.jsx)(ig,{})]})]}),(0,ei.jsx)("span",{className:"absolute -right-5 -bottom-[.37rem] xxs:-right-3 active py-0.5 px-[7px] bg-opacity-70 opacity-80",children:iw})]}):null});class iv{constructor(e,t){this.onUpdate=void 0,this.isRunning=!1,this.currentTime=e,this.dayStart=e,this.dayEnd=t;let i=new f.kX({}).to({},1e3).repeat(1/0),s=Date.now();i.onUpdate(()=>{let e=Date.now()-s;s=Date.now(),this.isRunning&&(this.currentTime+=e/15,this.currentTime>this.dayEnd&&(this.currentTime=this.dayStart),this.onUpdate&&this.onUpdate(this.currentTime))}),i.start()}static createDefaultAnimation(){return new iv(0,1439)}setDayStartEnd(e,t){this.dayStart=e,this.dayEnd=t,this.currentTime=(0,tY.uZ)(e,t,this.currentTime)}play(){this.isRunning=!0}pause(){this.isRunning=!1}setCurrentTime(e){this.currentTime=e}}let iy=t7.nq-1;var iC=()=>{let{t:e}=(0,ea.$G)(),[t]=(0,es.useState)(iv.createDefaultAnimation()),[i,s]=(0,et.mr)("autoPlayTime"),n=(0,eQ.Z)(L.nh);return(0,es.useEffect)(()=>()=>t.pause(),[]),(0,es.useEffect)(()=>{i?t.play():t.pause()},[i,t]),(0,es.useEffect)(()=>{let e=M.Pn.pipe((0,p.M)(M.sP)).subscribe(([e,{dateTime:i}])=>{let{dayStart:s,dayEnd:n,dayProgress:o}=((e,t)=>{let i=t6.minutesOfTheDay(e);if(!t.areValid())return{dayStart:0,dayEnd:iy,dayProgress:i%iy};let s=t6.minutesOfTheDay(t.sunset),n=t6.minutesOfTheDay(t.sunrise);return{dayStart:n,dayEnd:s,dayProgress:Math.max(n,Math.min(s,i))}})(i,e);t.setDayStartEnd(s,n),t.setCurrentTime(o),t.onUpdate=e=>{let t=ie(e,i);M.TM.next({dateTime:t,source:M.V2.PLAY})}});return()=>e.unsubscribe()},[t]),(0,ei.jsx)("div",{className:"flex flex-col items-center xxxs:ml-auto h-[38px]",children:n?(0,ei.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"animate-spin w-6 h-6",children:[(0,ei.jsx)("circle",{opacity:"0.25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,ei.jsx)("path",{opacity:"0.75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):(0,ei.jsxs)("button",Object.assign({className:"flex flex-col items-center group",title:e("playButton.title")},(0,el.zc)(e=>{e.target.blur(),t.isRunning?s(!1):(s(!0),P.n.onPlayDayCycle())}),{children:[i?(0,ei.jsx)("svg",{className:"text-date-time-svg group-hover:text-date-time-svg w-6 h-6",fill:"none",stroke:"currentColor",strokeWidth:"1.5",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,ei.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.25 9v6m-4.5 0V9M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}):(0,ei.jsxs)("svg",{className:"stroke-date-time-svg group-hover:stroke-date-time-svg-hover w-6 h-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:[(0,ei.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}),(0,ei.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.91 11.672a.375.375 0 010 .656l-5.603 3.113a.375.375 0 01-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112z",className:"fill-date-time-svg group-hover:fill-date-time-svg-hover "})]}),(0,ei.jsx)("p",{className:"text-grey-100 text-xxs",children:"24H"})]}))})},iM=i(36289),iS=i.n(iM),iL=()=>{let{t:e}=(0,ea.$G)(),t=(0,eQ.Z)(L.R9),i=(0,eQ.Z)((0,d.a)([L.R9,Z.Xq]).pipe((0,_.U)(([e,t])=>e.isPayingUser()||t.capabilities.unlockEverything))),s=(0,eQ.Z)((0,d.a)([ey,eC]).pipe((0,_.U)(([e,t])=>!e||t.isAllowedToUseExplorer()))),n=(0,eQ.Z)(Z.Xq.pipe((0,_.U)(e=>e.capabilities.canChooseDate))),[o,r]=(0,es.useState)(""),[a,l]=(0,es.useState)(void 0),[c,u]=(0,es.useState)(!1),p=(0,es.useRef)(null),g=(0,Z.MG)(e=>!!e.phantomLocks.calendar),f=(0,eQ.Z)(L.$l);return((0,es.useEffect)(()=>{let e=M.sP.subscribe(({dateTime:e})=>{!c&&(r(e.toLocaleString({month:"2-digit",day:"2-digit",year:"numeric"})),a&&a.setDate(e.toJSDate(),!0))});return()=>e.unsubscribe()},[a,c]),(0,es.useEffect)(()=>{var t;p.current&&f&&l(new(iS())({field:p.current,reposition:!1,position:"bottom left",firstDay:+((null==(t=null==f?void 0:f.country)?void 0:t.code)!=="US"),i18n:{previousMonth:e("datePicker.pikaday.previousMonth"),nextMonth:e("datePicker.pikaday.previousMonth"),months:e("datePicker.pikaday.months",{returnObjects:!0}),weekdays:e("datePicker.pikaday.weekdays",{returnObjects:!0}),weekdaysShort:e("datePicker.pikaday.weekdaysShort",{returnObjects:!0})},onSelect:e=>{M.sP.pipe((0,h.P)()).subscribe(({dateTime:t})=>{let i=m.ou.fromJSDate(e),s=t.set({year:i.get("year"),month:i.get("month"),day:i.get("day")});(0,M.UX)(s),P.n.onDatePickerChange()})},onOpen:()=>u(!0),onClose:()=>u(!1)}))},[p,i,f]),(0,es.useEffect)(()=>{a&&!i&&(a.destroy(),l(void 0))},[a,i]),t)?(0,ei.jsxs)("div",{className:"relative flex flex-row items-center text-[14px]",children:[i?(0,ei.jsxs)("button",Object.assign({title:e("datePicker.title"),className:eD()("button-date rounded-3xl xxxs:w-28 w-[90px] hover:shadow h-9.25 tabular-nums tracking-tight flex flex-row items-center justify-center",{"w-[121px]":g,"!cursor-default pointer-events-none":!s}),disabled:!n},(0,el.zc)(()=>{if(s){if(g)return void L.y7.next({modal:H.o.COUPON_CODE,opts:{trigger:G.g.TimeUpgrade}});P.n.onOpenDatePicker()}}),{ref:g?null:p,children:[(0,ei.jsx)("div",{className:"xxxs:text-[14px] text-[10px]",children:o}),g&&(0,ei.jsx)("div",{className:"ml-1 text-shadowmap-yellow w-[12px] h-[12px] flex-shrink-0",children:(0,ei.jsx)(ed.mB,{className:"w-full h-full"})})]})):(0,ei.jsxs)("button",Object.assign({className:"group relative text-mint-200 border-white border-opacity-50 border rounded-3xl w-28 bg-opacity-80 hover:bg-opacity-20 hover:bg-grey-900 hover:shadow h-9.25 tabular-nums tracking-tight",title:` ${e("datePicker.title")}`},(0,el.zc)(e=>{e.target.blur(),L.y7.next({modal:H.o.FEATURE_UPGRADE,opts:{type:z.l.Date,trigger:"date_picker"}})}),{children:[(0,ei.jsx)("div",{className:"absolute top-0 left-0 w-full h-full z-10 items-center justify-center hidden group-hover:flex",children:(0,ei.jsx)("div",{className:"mx-4 icon-unlock",children:(0,ei.jsxs)("div",{className:"bg-shadowmap-blue rounded-[6px] p-[3px] flex items-center text-black",children:[(0,ei.jsx)("svg",{width:"10",height:"10",viewBox:"0 0 10 10",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,ei.jsx)("path",{d:"M3.229 4.06266V2.91683C3.229 1.93883 4.02183 1.146 4.99984 1.146C5.67657 1.146 6.26464 1.5256 6.56273 2.0835M2.81234 8.85433H7.18734C7.64757 8.85433 8.02067 8.48123 8.02067 8.021V4.896C8.02067 4.43576 7.64757 4.06266 7.18734 4.06266H2.81234C2.3521 4.06266 1.979 4.43576 1.979 4.896V8.021C1.979 8.48123 2.3521 8.85433 2.81234 8.85433Z",stroke:"black",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,ei.jsx)("p",{className:"text-[8px] font-bold ml-[3px] mr-[2px]",children:"UPGRADE"})]})})}),(0,ei.jsx)("span",{className:"group-hover:hidden",children:o})]})),(0,ei.jsxs)("button",Object.assign({className:"ml-[12px] h-9.25 flex flex-col items-center group",title:e("timeResetButton.title")},(0,el.zc)(e=>{e.target.blur(),P.n.onTimeResetToNow(),(0,M.UX)(m.ou.now())}),{children:[(0,ei.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",className:"-ml-[2px] flex-shrink-0 stroke-date-time-svg group-hover:stroke-date-time-svg-hover",children:(0,ei.jsx)("path",{d:"M13.5 8V12L16.5 15M22.5 12C22.5 13.1819 22.2672 14.3522 21.8149 15.4442C21.3626 16.5361 20.6997 17.5282 19.864 18.364C19.0282 19.1997 18.0361 19.8626 16.9442 20.3149C15.8522 20.7672 14.6819 21 13.5 21C12.3181 21 11.1478 20.7672 10.0558 20.3149C8.96392 19.8626 7.97177 19.1997 7.13604 18.364C6.30031 17.5282 5.63738 16.5361 5.18508 15.4442C4.73279 14.3522 4.5 13.1819 4.5 12C4.5 9.61305 5.44821 7.32387 7.13604 5.63604C8.82387 3.94821 11.1131 3 13.5 3C15.8869 3 18.1761 3.94821 19.864 5.63604C21.5518 7.32387 22.5 9.61305 22.5 12Z",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,ei.jsx)("div",{className:"text-grey-100 text-xxs w-full",children:e("timeResetButton.label")})]}))]}):null};let iT=(e,t)=>{var i;return null==(i=e.find(e=>e.type===t))?void 0:i.value};var ij=()=>{let{t:e}=(0,ea.$G)(),[t,i]=(0,es.useState)(""),[s,n]=(0,es.useState)(""),[o,r]=(0,es.useState)(""),[a,l]=(0,es.useState)(""),[d,h]=(0,es.useState)(null),c=(0,es.useRef)(null);return(0,es.useEffect)(()=>{let e=[M.sP.subscribe(({dateTime:e})=>{var t,s,o;let a=e.toLocaleParts({hour:"numeric",minute:"numeric"});i(null!=(t=iT(a,"hour"))?t:""),n(null!=(s=iT(a,"minute"))?s:""),r(null!=(o=iT(a,"dayPeriod"))?o:"")}),M.E0.subscribe(e=>{l(e)})];return()=>{for(let t of e)t.unsubscribe()}},[]),(0,es.useEffect)(()=>{if(!c.current)return;let e=()=>{let e=c.current,t=e.children[0],i=e.children[1],s=e.children[2];Promise.all([document.fonts.load(window.getComputedStyle(t).font),document.fonts.load(window.getComputedStyle(i).font),document.fonts.load(window.getComputedStyle(s).font)]).then(()=>{var e,n,o,r;return e=void 0,n=void 0,o=void 0,r=function*(){let e=t.innerText,n=s.innerText;t.innerText="00",s.innerText="00",t.style.width="auto",i.style.width="auto",s.style.width="auto";let o=t.offsetWidth,r=i.offsetWidth+2,a=s.offsetWidth;t.innerText=e,s.innerText=n,h(e=>{var n,l,d;let h,c,u;return 0===o||0===r||0===a?(h=Math.max(null!=(n=null==e?void 0:e.hours)?n:0,o),c=Math.max(null!=(l=null==e?void 0:e.colon)?l:0,r),u=Math.max(null!=(d=null==e?void 0:e.minutes)?d:0,a)):(h=o,c=r,u=a),t.style.width=`${h}px`,i.style.width=`${c}px`,s.style.width=`${u}px`,{hours:h,colon:c,minutes:u}})},new(o||(o=Promise))(function(t,i){function s(e){try{l(r.next(e))}catch(e){i(e)}}function a(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var i;e.done?t(e.value):((i=e.value)instanceof o?i:new o(function(e){e(i)})).then(s,a)}l((r=r.apply(e,n||[])).next())})})};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[c]),(0,ei.jsxs)("div",{className:"flex gap-2",children:[(0,ei.jsxs)("div",{className:"flex items-end xxxs:text-[28px] text-[22px] time-display",title:e("timeDisplay.title"),style:{textShadow:"0 5px 10px #00000033"},children:[(0,ei.jsxs)("div",{className:"flex flex-row items-center",ref:c,children:[(0,ei.jsx)("div",{className:"text-right leading-none",style:{width:d?`${d.hours}px`:"auto"},children:t}),(0,ei.jsx)("div",{className:"leading-none text-center",style:{width:d?`${d.colon}px`:"auto"},children:":"}),(0,ei.jsx)("div",{className:"text-left leading-none",style:{width:d?`${d.minutes}px`:"auto"},children:s})]}),(0,ei.jsx)("div",{className:eD()("w-[18px] text-xs lowercase ml-0.5 leading-none mb-0.5",{hidden:!o}),children:o})]}),(0,ei.jsxs)("div",{className:"hidden xxs:flex flex-col justify-end items-center w-[33px] leading-none mb-0.5",children:[a.startsWith("UTC")&&(0,ei.jsx)("span",{className:"text-[8px] text-grey-100 text-center",children:"UTC"}),(0,ei.jsx)("span",{className:"text-[12px] tracking-tight tabular-nums",children:a.replace("UTC","")})]})]})},iP=i(76644);let iE=({children:e})=>{let[t]=(0,es.useState)(()=>document.createElement("div"));return(0,es.useEffect)(()=>(document.body.appendChild(t),()=>{document.body.removeChild(t)}),[]),(0,iP.createPortal)(e,t)};var iA=({children:e})=>{let[t,i]=(0,es.useState)(!1),[s,n]=(0,es.useState)({top:0,left:0,arrowLeft:0}),o=(0,es.useRef)(null),r=(0,es.useRef)(null),a=(0,eQ.Z)(Z.Gn.pipe((0,_.U)(e=>"dahler"===e)));(0,es.useEffect)(()=>{if(!a)return;let e=setTimeout(()=>{i(ep.UW.getValue()!==ep.BS.Analytics)},5e3);return()=>clearTimeout(e)},[a]),(0,es.useEffect)(()=>{let e=ep.UW.subscribe(e=>{e===ep.BS.Analytics&&i(!1)});return()=>e.unsubscribe()},[]);let l=()=>{if(!o.current)return;let e=o.current.getBoundingClientRect(),t=e.bottom+8,i=e.left+e.width/2-150;i<16?i=16:i+300>window.innerWidth-16&&(i=window.innerWidth-16-300),t+100>window.innerHeight-16&&(t=e.top-100-8);let s=e.left+e.width/2-i-8;n({top:t,left:i,arrowLeft:s})};return(0,es.useEffect)(()=>{if(t&&a){let e;l();let t=()=>l(),i=()=>l(),s=null,n=()=>{if(!o.current)return;let t=o.current.getBoundingClientRect();s&&s.top===t.top&&s.left===t.left&&s.width===t.width&&s.height===t.height||(l(),s=t),e=requestAnimationFrame(n)};return n(),window.addEventListener("resize",t),window.addEventListener("scroll",i),()=>{window.removeEventListener("resize",t),window.removeEventListener("scroll",i),e&&cancelAnimationFrame(e)}}},[t,a]),(0,ei.jsxs)(ei.Fragment,{children:[es.cloneElement(e,{ref:o}),t&&(0,ei.jsx)(iE,{children:(0,ei.jsxs)("div",{ref:r,className:"fixed z-[0] bg-white rounded-2xl font-[Poppins] cursor-pointer",style:{boxShadow:"0 4px 10px rgba(0, 0, 0, 0.50)",top:s.top,left:s.left,width:300,height:100},onClick:()=>{ep.UW.next(ep.BS.Analytics)},children:[(0,ei.jsx)("div",{className:"absolute",style:{top:-8,left:Math.max(8,Math.min(s.arrowLeft,284)),width:0,height:0,borderLeft:"8px solid transparent",borderRight:"8px solid transparent",borderBottom:"8px solid #fff"}}),(0,ei.jsxs)("button",{type:"button",className:"absolute z-[1] top-0 right-0 pt-2 pr-2 text-black focus:outline-none cursor-pointer",onClick:e=>{e.stopPropagation(),i(!1)},children:[(0,ei.jsx)("span",{className:"sr-only",children:"Close"}),(0,ei.jsx)(tc.Z,{className:"h-4 w-4","aria-hidden":"true"})]}),(0,ei.jsxs)("div",{className:"p-4 h-full flex flex-col justify-between items-center relative",children:[(0,ei.jsx)("div",{className:"text-center font-bold text-[#072543] text-[14px] leading-[1.2]",children:(0,ei.jsx)(ea.cC,{i18nKey:"dahlerAnalyticsPopup.text",components:{b:(0,ei.jsx)("span",{className:"text-[#FFB000]"})}})}),(0,ei.jsx)("div",{className:"",children:(0,ei.jsx)(ed.mf,{className:"w-[80px] text-[#072543]"})})]})]})})]})};let iD=()=>(0,ei.jsx)("svg",{width:"25",height:"24",viewBox:"0 0 25 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,ei.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.2502 1.76758C13.2502 1.35336 12.9144 1.01758 12.5002 1.01758C12.0859 1.01758 11.7502 1.35336 11.7502 1.76758V3.29083C11.7502 3.70505 12.0859 4.04083 12.5002 4.04083C12.9144 4.04083 13.2502 3.70505 13.2502 3.29083V1.76758ZM5.79495 4.23429C5.50206 3.9414 5.02718 3.9414 4.73429 4.23429C4.4414 4.52718 4.4414 5.00206 4.73429 5.29495L5.8114 6.37206C6.10429 6.66495 6.57916 6.66495 6.87206 6.37206C7.16495 6.07916 7.16495 5.60429 6.87206 5.3114L5.79495 4.23429ZM20.2656 5.29501C20.5585 5.00212 20.5585 4.52724 20.2656 4.23435C19.9727 3.94146 19.4979 3.94146 19.205 4.23435L18.1279 5.31146C17.835 5.60435 17.835 6.07922 18.1279 6.37212C18.4208 6.66501 18.8956 6.66501 19.1885 6.37212L20.2656 5.29501ZM15.6819 8.8181C13.9246 7.06078 11.0754 7.0608 9.31802 8.81814C7.56068 10.5755 7.56066 13.4247 9.31797 15.1821L15.6819 8.8181ZM16.7426 7.75748C14.3995 5.41434 10.6005 5.41434 8.25736 7.75748C5.91421 10.1006 5.91421 13.8996 8.25736 16.2428C10.6005 18.5859 14.3995 18.5859 16.7426 16.2428C19.0858 13.8996 19.0858 10.1006 16.7426 7.75748ZM2.26758 11.2501C1.85336 11.2501 1.51758 11.5859 1.51758 12.0001C1.51758 12.4143 1.85336 12.7501 2.26758 12.7501H3.79083C4.20505 12.7501 4.54083 12.4143 4.54083 12.0001C4.54083 11.5859 4.20505 11.2501 3.79083 11.2501H2.26758ZM21.209 11.2501C20.7948 11.2501 20.459 11.5859 20.459 12.0001C20.459 12.4144 20.7948 12.7501 21.209 12.7501H22.7322C23.1465 12.7501 23.4822 12.4144 23.4822 12.0001C23.4822 11.5859 23.1465 11.2501 22.7322 11.2501H21.209ZM19.1885 17.6282C18.8956 17.3353 18.4208 17.3353 18.1279 17.6282C17.835 17.9211 17.835 18.396 18.1279 18.6889L19.205 19.766C19.4979 20.0589 19.9727 20.0589 20.2656 19.766C20.5585 19.4731 20.5585 18.9982 20.2656 18.7053L19.1885 17.6282ZM6.87213 18.689C7.16503 18.3961 7.16503 17.9212 6.87213 17.6283C6.57924 17.3354 6.10437 17.3354 5.81147 17.6283L4.73437 18.7054C4.44148 18.9983 4.44148 19.4732 4.73437 19.7661C5.02726 20.059 5.50214 20.059 5.79503 19.7661L6.87213 18.689ZM13.2502 20.7094C13.2502 20.2952 12.9144 19.9594 12.5002 19.9594C12.0859 19.9594 11.7502 20.2952 11.7502 20.7094V22.2327C11.7502 22.6469 12.0859 22.9827 12.5002 22.9827C12.9144 22.9827 13.2502 22.6469 13.2502 22.2327V20.7094Z",fill:"currentColor"})}),iO=()=>(0,ei.jsx)("svg",{width:"25",height:"24",viewBox:"0 0 25 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,ei.jsx)("path",{d:"M12.5 15.75H19.0518C19.4433 15.75 19.7988 15.9784 19.9614 16.3345L21.1034 18.8345C21.4059 19.4968 20.9219 20.25 20.1938 20.25H12.5M12.5 15.75H5.94816C5.55668 15.75 5.20121 15.9784 5.03856 16.3345L3.89658 18.8345C3.59407 19.4968 4.07809 20.25 4.80618 20.25H12.5M12.5 15.75V20.25M12.5 9.75V11.25M19.25 3.75H20.75M4.25 3.75H5.75M8 8L7 9M17 8L18 9M9.33697 3.75C9.67555 5.18335 10.9632 6.25 12.5 6.25C14.0368 6.25 15.3245 5.18335 15.663 3.75",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})});var ik=()=>{let e=(0,tr.pw)(ep.UW),t=(0,tr.pw)(L.R9),i=(0,Z.MG)(e=>e.capabilities.unlockEverything),s=(0,Z.MG)(e=>e.capabilities.enableStudio),n=(null==t?void 0:t.isAllowedToUseStudio())||i,o=(0,tr.pw)(em.Us),r=(0,Z.MG)(e=>e.capabilities.enableAnalytics),a=(0,Z.MG)(e=>!!e.phantomLocks.analytics),l=(0,tr.pw)(ey),d=(0,tr.pw)(eC),{t:h}=(0,ea.$G)();if(!r||l&&!(null==d?void 0:d.isAllowedToUseStudio()))return null;let c="btn-gradient app-mode-active-bg",u="border bg-grey-800 border-grey app-mode-inactive-bg cursor-pointer";return o?null:(0,ei.jsxs)("div",{className:"flex flex-row w-full",children:[(0,ei.jsxs)("div",Object.assign({className:`flex flex-row items-center justify-center w-[50%] rounded-analytics-mode-l gap-1 py-2 ${e===ep.BS.Default?c:u}`},(0,el.zc)(()=>{ep.UW.next(ep.BS.Default)}),{children:[(0,ei.jsx)("div",{className:e===ep.BS.Default?"app-mode-icon-active":"app-mode-icon-inactive",children:(0,ei.jsx)(iD,{})}),(0,ei.jsx)("div",{className:"uppercase text-[10px] xxxs:text-sm app-mode-text",children:h("visualizationMode.visualize")})]})),(0,ei.jsx)(iA,{children:(0,ei.jsxs)("div",Object.assign({className:`flex flex-row items-center justify-center w-[50%] rounded-analytics-mode-r cursor-pointer gap-1 py-2 ${e===ep.BS.Analytics?c:u}`},(0,el.zc)(()=>{if(a)return void L.y7.next({modal:H.o.COUPON_CODE,opts:{trigger:G.g.AnalyticsUpgrade}});n?(()=>{if(t){if(!s||t.isAllowedToUseStudio())return ep.UW.next(ep.BS.Analytics);L.y7.next({modal:H.o.FEATURE_UPGRADE,opts:{type:z.l.Analytics,trigger:"analyze_mode_button"}})}})():t&&L.y7.next({modal:H.o.FEATURE_UPGRADE,opts:{type:z.l.Analytics,trigger:"analyze_mode_button"}})}),{children:[(0,ei.jsx)("div",{className:e===ep.BS.Analytics?"app-mode-icon-active":"app-mode-icon-inactive",children:(0,ei.jsx)(iO,{})}),(0,ei.jsx)("div",{className:"uppercase text-[10px] xxxs:text-sm app-mode-text",children:h("visualizationMode.analyze")}),!n&&(0,ei.jsx)("div",{className:"mx-1",children:(0,ei.jsx)(eh,{product:"studio",mode:"small",onClick:()=>{t&&L.y7.next({modal:H.o.FEATURE_UPGRADE,opts:{type:z.l.Analytics,trigger:"analyze_mode_button"}})},isAbsolute:!1})}),a&&(0,ei.jsx)("div",{className:"ml-2 text-shadowmap-yellow w-[12px] h-[12px]",children:(0,ei.jsx)(ed.mB,{className:"w-full h-full"})})]}))})]})},iI=(i(84526),i(96634)),iN=i(27896),i_=i(23903),iR=i(56275);(o=a||(a={})).ADDRESS="address",o.VENUE="venue",o.STREET="street",o.INTERSECTION="intersection",o.EMPIRE="empire",o.COUNTRY="country",o.DEPENDENCY="dependency",o.DISPUTED="disputed",o.REGION="region",o.COUNTY="county",o.LOCALADMIN="localadmin",o.LOCALITY="locality",o.BOROUGH="borough",o.NEIGHBOURHOOD="neighbourhood";let iV=Object.values(a),iB=e=>{switch(e){case a.DISPUTED:return(0,ei.jsx)(iI.Z,{className:"inline h-4 w-4 mx-2 shrink-0 mb-[3px]"});case a.EMPIRE:case a.COUNTRY:case a.DEPENDENCY:case a.REGION:case a.COUNTY:case a.LOCALADMIN:case a.LOCALITY:return(0,ei.jsx)(iN.Z,{className:"inline h-4 w-4 mx-2 shrink-0 mb-[3px]"});default:return(0,ei.jsx)(i_.Z,{className:"inline h-4 w-4 mx-2 shrink-0 mb-[4px]"})}},iU=e=>e?e.place_name?e.place_name:e.properties.label:"Undefined";var iF=()=>{var e;let[t,i]=(0,es.useState)({text:"",features:[],provider:"geocode_earth"}),[s,n]=(0,es.useState)(!1),o=(0,es.useRef)(null),r=(0,es.useRef)(null),{t:d,i18n:{resolvedLanguage:h}}=(0,ea.$G)(),c=(0,Z.MG)(e=>e.locationSearchCountryCode),u=(0,eQ.Z)(L.Qs),p=(0,t5.Z)(),m=(0,es.useCallback)(e=>{e&&(0,e2.z)(S.PG).then(t=>{let s={layers:iV,size:7,lang:h,focusPoint:t.decimalZoom>5?{lat:t.lat,lon:t.lng}:void 0};c&&(s.boundary={country:c});((e,t,i="en")=>{var s,n,o,r;return s=void 0,n=void 0,o=void 0,r=function*(){"en"!==i&&(i+=",en");let s=encodeURIComponent(e.replace(","," ")),n=`https://api.maptiler.com/geocoding/${s}.json?autocomplete=true&excludeTypes=true&fuzzyMatch=true&limit=7&language=${i}&key=${window.SHADOWMAP.MAPTILER_API_KEY}`;t&&(n+=`&proximity=${t.lng},${t.lat}`);let o=yield fetch(n,{method:"GET"}),r=yield o.json();return Array.isArray(r)&&r.length>0?r[0]:r},new(o||(o=Promise))(function(e,t){function i(e){try{l(r.next(e))}catch(e){t(e)}}function a(e){try{l(r.throw(e))}catch(e){t(e)}}function l(t){var s;t.done?e(t.value):((s=t.value)instanceof o?s:new o(function(e){e(s)})).then(i,a)}l((r=r.apply(s,n||[])).next())})})(e,t,h).then(({features:t,discard:s})=>{var r,a;n(!1),s||(null==(a=null==(r=null==o?void 0:o.current)?void 0:r.value)?void 0:a.trim())!==e||(i({text:e,features:null!=t?t:[],provider:"maptiler"}),M())}).catch(t=>f(t,e))})},[h,u]),g=(0,es.useCallback)(eT()(m,600,{leading:!0,trailing:!0}),[m]),f=(e,t)=>{var i;if(n(!1),null==(i=null==e?void 0:e.message)?void 0:i.match(/queries per second exceeded/gi))return void console.info(`autocomplete threw error for term ${t}`,e);console.error(`autocomplete threw an error for term ${t}`,e)},{isOpen:x,getLabelProps:w,getMenuProps:b,getInputProps:v,highlightedIndex:y,getItemProps:C,openMenu:M,setInputValue:T}=(0,iR.Kb)({environment:window,itemToString:iU,items:t.features,onInputValueChange:({type:e,inputValue:t})=>{if(iR.Kb.stateChangeTypes.InputChange!==e&&iR.Kb.stateChangeTypes.FunctionSetInputValue!==e)return;let s=(null!=t?t:"").trim();if(!((null==s?void 0:s.match(/^\/+$/))||(null==s?void 0:s.match(/^\\+$/)))){if(s.length<3){n(!1),i({text:"",features:[],provider:"geocode_earth"});return}n(!0),g(s)}},onSelectedItemChange:({selectedItem:e})=>{if(!e)return void console.error(`Selected item is ${e}`);i({text:"",features:[],provider:"geocode_earth"});let t=e.center?e.center[1]:e.geometry.coordinates[1],s=e.center?e.center[0]:e.geometry.coordinates[0],n=e.center?((e,t)=>{switch(e){case"address":return"street"===t?16:17;case"poi":return 16;case"country":return 5;case"region":case"subregion":case"county":return 9;case"joint_municipality":case"joint_submunicipality":case"municipality":case"municipal_district":case"locality":case"neighbourhood":return 14;default:return 15}})(e.place_type[0],e.properties.kind):(e=>{switch(e){case a.ADDRESS:return 17;case a.VENUE:case a.STREET:case a.INTERSECTION:return 16;case a.EMPIRE:case a.COUNTRY:return 5;case a.DEPENDENCY:case a.DISPUTED:case a.REGION:case a.COUNTY:return 9;case a.LOCALADMIN:case a.LOCALITY:case a.BOROUGH:case a.NEIGHBOURHOOD:return 14;default:return 15}})(e.properties.layer);o.current&&o.current.blur(),S.qi.next({location:new l.Y(t,s,n),dropPin:!0,highlightBuilding:!0}),ep.UW.next(ep.BS.Default),P.n.onSearchSelect(e.center?e.text:e.properties.label)}}),j=x&&t.features.length>0,E=p.width<640,A=d(E?"search_placeholder_mobile":"search_placeholder"),D=()=>(0,ei.jsxs)("div",{className:(0,el.AK)(j?"flex":"hidden",E?"fixed flex flex-col left-2 right-2 bg-white rounded-3xl overflow-hidden text-grey-800 shadow z-50":"absolute flex flex-col top-[50px] left-0 w-full bg-white rounded-3xl overflow-hidden text-grey-800 shadow"),style:E&&j?{top:(()=>{if(!r.current)return{top:0,left:0,width:0};let e=r.current.getBoundingClientRect();return{top:e.bottom+12,left:e.left,width:e.width}})().top}:void 0,translate:"no",children:[(0,ei.jsx)("ol",Object.assign({},b(),{children:"geocode_earth"===t.provider?t.features.map((e,t)=>(0,ei.jsxs)("li",Object.assign({className:(0,el.AK)(y===t&&"bg-grey-100","first:pt-3 overflow-hidden whitespace-nowrap text-ellipsis p-2 cursor-pointer")},C({item:e,index:t}),{onTouchEnd:e=>e.stopPropagation(),children:[iB(e.properties.layer),(0,ei.jsx)("strong",{className:"shrink-0",children:e.properties.name}),(0,ei.jsxs)("span",{className:"ml-1.5 mb-[1px] text-grey-600 self-end text-xs",children:[e.properties.locality,e.properties.locality&&e.properties.country&&", ",e.properties.country]})]}),e.properties.id)):t.features.map((e,t)=>(0,ei.jsxs)("li",Object.assign({className:(0,el.AK)(y===t&&"bg-grey-100","first:pt-3 overflow-hidden whitespace-nowrap text-ellipsis p-2 cursor-pointer")},C({item:e,index:t}),{onTouchEnd:e=>e.stopPropagation(),children:[iB(e.place_type[0]),(0,ei.jsx)("strong",{className:"shrink-0",children:e.text}),(0,ei.jsx)("span",{className:"ml-1.5 mb-[1px] text-grey-600 self-end text-xs",children:e.place_name})]}),e.id))})),"geocode_earth"===t.provider?(0,ei.jsxs)("div",{className:"py-2 px-6 text-xxs text-right",children:["\xa9\xa0",(0,ei.jsx)("a",{href:"https://geocode.earth",target:"_blank",className:"link link-grey",children:"Geocode Earth"}),",\xa0",(0,ei.jsx)("a",{href:"https://openstreetmap.org/copyright",target:"_blank",className:"link link-grey",children:"OpenStreetMap"}),",\xa0and\xa0",(0,ei.jsx)("a",{href:"https://geocode.earth/guidelines",target:"_blank",className:"link link-grey",children:"others"}),"."]}):(0,ei.jsxs)("div",{className:"py-2 px-6 text-xxs text-right",children:["\xa9\xa0",(0,ei.jsx)("a",{className:"link link-grey",rel:"noopener noreferrer",href:"https://www.maptiler.com/copyright/",target:"_blank",children:"MapTiler"}),",\xa0",(0,ei.jsx)("a",{href:"https://openstreetmap.org/copyright",target:"_blank",className:"link link-grey",children:"OpenStreetMap"}),"."]})]});return(0,ei.jsxs)("div",{className:"location-search relative flex flex-row items-center grow bg-[#222B33] text-[#E3E8ED] z-20 shadow h-[40px] sm:ml-0",children:[(0,ei.jsx)("label",Object.assign({},w(),{className:"sr-only",children:A})),(0,ei.jsxs)("div",{className:"flex flex-row flex-1 px-2.5 gap-1 items-center h-10 group",ref:r,children:[(0,ei.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,ei.jsx)("path",{d:"M16.6667 16.6667L13.4388 13.4388M13.4388 13.4388C14.5321 12.3454 15.2083 10.835 15.2083 9.16667C15.2083 5.82995 12.5034 3.125 9.16667 3.125C5.82995 3.125 3.125 5.82995 3.125 9.16667C3.125 12.5034 5.82995 15.2083 9.16667 15.2083C10.835 15.2083 12.3454 14.5321 13.4388 13.4388Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,ei.jsx)("input",Object.assign({},v({ref:o}),{spellCheck:!1,placeholder:A,className:"location-search-input bg-transparent flex-1 outline-none text-grey-200 placeholder-white placeholder-opacity-50 w-full"})),s?(0,ei.jsx)(tI.Z,{className:"w-[16px] h-[16px] mr-2"}):(null==(e=null==o?void 0:o.current)?void 0:e.value)?(0,ei.jsxs)("button",{onClick:()=>{var e;(null==(e=null==o?void 0:o.current)?void 0:e.value)&&(T(""),o.current.value="",S.bq.next({visible:!1}),S.MV.next(!0))},title:"Clear",children:[(0,ei.jsx)("span",{className:"sr-only",children:"Close"}),(0,ei.jsx)(tc.Z,{className:"w-5 h-5 text-[#E3E8ED]"})]}):null]}),E&&j?(0,iP.createPortal)(D(),document.body):D()]})},iZ=()=>{let e=(0,Z.MG)(e=>e.capabilities.showInfoButton&&"top"===e.infoButtonPosition),t=(0,Z.MG)(e=>e.capabilities.canSearchLocation),i=(0,Z.MG)(e=>e.hideUIWithSettingsOpen),s=(0,eQ.Z)(ep.UW),[n,o]=(0,es.useState)(!1),[r]=(0,et.mr)("hideUI"),a=(0,eQ.Z)(e1.Yy),l=(0,tr.pw)(Z.Xq).capabilities.enableStudio,d=(0,tr.pw)(ey),h=(0,tr.pw)(eC);return(0,es.useEffect)(()=>{let e=L.Jt.subscribe(e=>{o(e)});return()=>e.unsubscribe()},[]),(0,ei.jsxs)("div",{className:eD()("transition-transform flex flex-col gap-2.5 fixed w-full-safe-2.5 right-1/2 transform translate-x-1/2 mx-auto mt-tsafe-2.5 sm:max-w-md sm:right-0 sm:mr-rsafe-2.5 sm:transform-none top-0 text-white select-and-touch-none pointer-events-none",{hidden:r||i&&n||a,"md:-translate-x-[323px]":n,"sm:transform-none":!n,"sm:!mr-[60px]":i}),children:[(0,ei.jsxs)("div",{className:eD()("flex flex-row justify-between gap-[6px] w-full pointer-events-auto z-[1]",{hidden:!t&&!e&&!l}),children:[l&&(0,ei.jsx)(tV,{className:"sm:hidden",showControls:!1}),(t||e)&&(0,ei.jsxs)("div",{className:eD()("search-panel flex flex-row items-center gap-2 justify-end bg-grey-800 bg-opacity-80 backdrop-filter-map rounded-full p-[6px] shadow ml-auto",{"flex-grow":t}),children:[t&&(0,ei.jsx)(iF,{}),e&&(0,ei.jsx)(tZ,{})]})]}),(0,ei.jsx)("div",{className:"flex flex-col gap-2.5 pointer-events-auto z-[0]",children:(0,ei.jsxs)("div",{className:"relative flex-col items-center top-panel select-none z-10 shadow text-white",children:[(0,ei.jsx)(ik,{}),(0,ei.jsxs)("div",{className:eD()("px-3 py-2 pt-3 w-full flex-col items-center flex",{hidden:s===ep.BS.Analytics}),children:[(0,ei.jsxs)("div",{className:"w-full flex flex-wrap justify-between gap-2 items-center",children:[(0,ei.jsx)(ij,{}),(0,ei.jsx)(iL,{}),(0,ei.jsx)(iC,{})]}),(0,ei.jsxs)("div",{className:"flex flex-col gap-[20px] mt-[18px] mb-[12px] w-full text-[.7rem]",style:{width:"calc(100% - 22px)"},children:[(0,ei.jsx)(id,{}),(!d||(null==h?void 0:h.isAllowedToUseExplorer()))&&(0,ei.jsx)(ib,{})]})]}),(0,ei.jsx)("div",{className:eD()("text-gray-100 text-center",{hidden:s!==ep.BS.Analytics}),children:(0,ei.jsx)(t4,{})})]})}),(0,ei.jsx)(tW,{})]})};let iH=()=>{var e,t;let{t:i}=(0,ea.$G)(),{width:s,height:n}=(0,t5.Z)(),o=(0,eQ.Z)(D.Qq),[r,a]=(0,es.useState)(0),[l,d]=(0,es.useState)(!1),h=(0,es.useRef)(null),c=(0,eQ.Z)(L.Nt);if(!(0,tr.pw)(Z.Xq).capabilities.enableStudio||((0,es.useLayoutEffect)(()=>{var e;a(null!=(e=null==o?void 0:o.userBuilding.height)?e:0),d(!(null==o?void 0:o.userBuilding.hidden))},[o]),(0,es.useLayoutEffect)(()=>{if(!h.current)return;let e=D.Qq.subscribe(e=>{if(!h.current||!e)return;let t=(0,tY.sb)("#side-panel-studio").getBoundingClientRect(),i=Math.max(0,t.left+t.width),o=n/2<e.screenY,r=h.current.offsetWidth,a=h.current.offsetHeight,l=e.screenX-r/2,d=e.screenY+(o?-a-20:20),c=(0,tY.uZ)(8+i,s-r-8,l),u=(0,tY.uZ)(8,n-a-8,d);h.current.style.left=`${c}px`,h.current.style.top=`${u}px`});return()=>e.unsubscribe()},[o]),!o))return null;let u=(e,t)=>{let i=Object.assign(Object.assign({},o.userBuilding),{height:e,hidden:!t}),s=D.Vi.value;if(s){let e=s.buildings.findIndex(e=>e.buildingId===i.buildingId);if(-1===e)D.Vi.next(Object.assign(Object.assign({},s),{buildings:[...s.buildings,i],hasChanges:!0}));else{let t=[...s.buildings];t[e]=i,D.Vi.next(Object.assign(Object.assign({},s),{buildings:t,hasChanges:!0}))}}(0,D.A$)(i)},p="imperial"===c?3.28084*r:r,m=(t=0,Math.round(Number((10*Math.abs(e=p)).toPrecision(15)))/10*Math.sign(e)).toString().replace(/[.,]/g,"").length;return(0,ei.jsxs)("div",{ref:h,className:"absolute bg-grey-700 bg-opacity-80 backdrop-filter-map text-grey-800 rounded-lg shadow-lg p-[5px] flex flex-row items-start gap-1",children:[(0,ei.jsx)(e_.u,{content:i(l?"studio.buildingOverlayMenu.hideBuilding":"studio.buildingOverlayMenu.undoHideBuilding"),mouseOnly:!0,children:(0,ei.jsx)("div",{className:"w-[30px] h-[30px] flex justify-center items-center bg-white rounded-md cursor-pointer",onClick:()=>{if(!D.Vi.value)return void L.y7.next({modal:H.o.SELECT_PROJECT});P.n.onStudioBuildingVisibilityChange(),d(!l),u(r,!l)},children:(0,ei.jsxs)("svg",{width:"24",height:"25",viewBox:"0 0 24 25",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,ei.jsx)("path",{d:"M14.1213 14.6213C14.6839 14.0587 15 13.2956 15 12.5C15 11.7044 14.6839 10.9413 14.1213 10.3787C13.5587 9.81607 12.7956 9.5 12 9.5C11.2044 9.5 10.4413 9.81607 9.87868 10.3787C9.31607 10.9413 9 11.7044 9 12.5C9 13.2956 9.31607 14.0587 9.87868 14.6213C10.4413 15.1839 11.2044 15.5 12 15.5C12.7956 15.5 13.5587 15.1839 14.1213 14.6213Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,ei.jsx)("path",{d:"M2.45801 12.5C3.73201 8.443 7.52301 5.5 12 5.5C16.478 5.5 20.268 8.443 21.542 12.5C20.268 16.557 16.478 19.5 12 19.5C7.52301 19.5 3.73201 16.557 2.45801 12.5Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})})}),"3dtile"!==o.userBuilding.type&&l&&(0,ei.jsx)(e_.u,{content:i("studio.buildingOverlayMenu.changeHeight"),mouseOnly:!0,children:(0,ei.jsxs)("div",{className:"flex flex-row items-center h-[30px] rounded-md bg-white p-[5px]",children:[(0,ei.jsx)("svg",{width:"21",height:"20",viewBox:"0 0 21 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,ei.jsx)("path",{d:"M7.89583 7.39583L10.0833 9.58333M7.89583 7.39583L4.97916 10.3125M7.89583 7.39583L10.8125 4.47916M6.33333 11.6667L4.97916 10.3125M4.97916 10.3125L3.13684 12.1548C2.48596 12.8057 2.48596 13.861 3.13684 14.5118L5.98815 17.3631C6.63902 18.014 7.6943 18.014 8.34517 17.3631L17.8631 7.84517C18.514 7.1943 18.514 6.13902 17.8631 5.48815L15.0118 2.63684C14.361 1.98596 13.3057 1.98596 12.6548 2.63684L10.8125 4.47916M12.1667 5.83333L10.8125 4.47916",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,ei.jsx)(eG,{min:0,step:1,className:eD()("h-full px-1 py-0 text-[14px] text-right",m>3?"w-[50px]":"w-[36px]"),value:p,onChange:e=>{if(!D.Vi.value)return void L.y7.next({modal:H.o.SELECT_PROJECT});P.n.onStudioBuildingHeightChange(),"imperial"===c&&(e/=3.28084),a(e),isNaN(e)||u(e,l)},disabled:!l},o.userBuilding.buildingId),(0,ei.jsx)("div",{className:"text-grey-400 text-[12px] mr-1 mt-0.5",children:"metric"===c?"m":"ft"})]})}),o.userBuilding.lastUpdateDate&&(0,ei.jsx)(e_.u,{hideAfterTimeout:!0,content:(0,ei.jsx)("span",{className:"whitespace-pre-line",children:(0,ei.jsx)(ea.cC,{i18nKey:"studio.buildingOverlayMenu.lastUpdate",values:{date:new Date(o.userBuilding.lastUpdateDate).toLocaleDateString()},shouldUnescape:!0})}),children:(0,ei.jsx)("div",{className:"h-[30px] flex justify-center items-center text-mint-200 cursor-pointer",children:(0,ei.jsx)(ed.Pv,{className:"w-4 h-4"})})},o.userBuilding.buildingId)]})};function iG({href:e,children:t,className:i,target:s="_blank"}){return(0,ei.jsx)("a",{className:(0,el.AK)("btn btn-neon btn-with-label",i),href:e,target:s,children:t})}let iz=({screenX:e,screenY:t,type:i,name:s,address:n,text:o,url:r,phone:a,ctaText:l,ctaUrl:d})=>{let{width:h,height:c}=(0,t5.Z)(),u=Math.min(h-270-8,Math.max(8,e-135));return(0,ei.jsxs)("div",{className:"bg-white z-50 text-grey-700 absolute rounded-3xl shadow-lg w-[270px] p-6",style:c/2<t?{left:u,bottom:c-t+12}:{left:u,top:t+12},children:[(0,ei.jsxs)("div",{className:"space-y-2",children:[(0,ei.jsx)("div",{className:"text-sm text-blue-600 mb-1.5",children:i}),(0,ei.jsx)("div",{className:"uppercase font-bold",children:s}),(0,ei.jsxs)("div",{className:"space-y-0.5 flex flex-col",children:[(0,ei.jsx)("span",{children:n}),(0,ei.jsx)("div",{dangerouslySetInnerHTML:{__html:o}}),(0,ei.jsx)("a",{href:r,target:"_blank",className:"link link-grey",children:r}),(0,ei.jsx)("a",{href:`tel:${a}`,className:"link link-grey",children:a})]})]}),(0,ei.jsx)("div",{className:"mt-4 flex justify-center",children:(0,ei.jsx)(iG,{href:d,children:(0,ei.jsx)("span",{children:l})})})]})},iW=()=>(0,ei.jsxs)("svg",{width:"10",height:"10",viewBox:"0 0 10 10",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,ei.jsx)("path",{d:"M6 2L1 8.5H9",stroke:"white",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,ei.jsx)("path",{d:"M6.33333 7.83203C6.33333 6.94314 6.33333 5 4.5 4",stroke:"white",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),iX=(0,es.forwardRef)((e,t)=>{var i;let s=e.isBig?"text-xs px-[10px] py-[5px]":"text-xs px-[5px] py-[3px]",n=e.hideBackground?`fixed font-medium text-white leading-normal pointer-events-none ${s}`:`fixed font-medium shadow-sm transition-opacity duration-300 bg-grey-700/80 backdrop-blur-[2px] border rounded border-white/50 text-white leading-normal pointer-events-none mix-w-[24px] ${s}`;return(0,ei.jsx)("div",{className:n,style:{top:e.position.y,left:e.position.x,position:"fixed",transform:e.isCentered?"translate(-50%, -50%)":"translate(-50%, calc(-100% - 4px))",filter:e.hideBackground?"drop-shadow(rgba(0, 0, 0, 0.75) 0 0 2px)":"none",opacity:null!=(i=e.opacity)?i:1},ref:t,children:(0,ei.jsxs)("div",{className:"flex items-center gap-0.5 whitespace-nowrap",children:[e.showIcon&&(0,ei.jsx)(iW,{}),e.label]})})}),iY=()=>{var e;let{t}=(0,ea.$G)(),{width:i,height:s}=(0,t5.Z)(),n=(0,eQ.Z)(D.L3),o=(0,es.useRef)(null);if(!(0,tr.pw)(Z.Xq).capabilities.enableStudio||((0,es.useEffect)(()=>{if(!o.current)return;let e=D.L3.subscribe(e=>{if(!o.current||!e)return;let t=(0,tY.sb)("#side-panel-studio").getBoundingClientRect(),n=Math.max(0,t.left+t.width),r=s/2<e.screenY,a=o.current.offsetWidth,l=o.current.offsetHeight,d=e.screenX-a/2,h=e.screenY+(r?-l-20:20),c=(0,tY.uZ)(8+n,i-a-8,d),u=(0,tY.uZ)(8,s-l-8,h);o.current.style.left=`${c}px`,o.current.style.top=`${u}px`});return()=>e.unsubscribe()},[n]),!n))return null;let r=!(null==(e=null==n?void 0:n.tree)?void 0:e.hidden);return(0,ei.jsx)("div",{ref:o,className:"absolute bg-grey-700 bg-opacity-80 backdrop-filter-map text-grey-800 rounded-lg shadow-lg p-[5px] flex flex-row items-start gap-1",children:(0,ei.jsx)("div",{children:(0,ei.jsx)(e_.u,{content:t(r?"studio.treeOverlayMenu.hide":"studio.treeOverlayMenu.show"),children:(0,ei.jsx)("div",{className:"w-[30px] h-[30px] flex justify-center items-center bg-white rounded-md cursor-pointer",onClick:()=>{if(!D.Vi.value)return void L.y7.next({modal:H.o.SELECT_PROJECT});(null==n?void 0:n.tree)&&(P.n.onStudioTreeVisibilityChange(),(0,D.hU)(Object.assign(Object.assign({},n.tree),{hidden:!(null==n?void 0:n.tree.hidden)})))},children:(0,ei.jsxs)("svg",{width:"24",height:"25",viewBox:"0 0 24 25",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,ei.jsx)("path",{d:"M14.1213 14.6213C14.6839 14.0587 15 13.2956 15 12.5C15 11.7044 14.6839 10.9413 14.1213 10.3787C13.5587 9.81607 12.7956 9.5 12 9.5C11.2044 9.5 10.4413 9.81607 9.87868 10.3787C9.31607 10.9413 9 11.7044 9 12.5C9 13.2956 9.31607 14.0587 9.87868 14.6213C10.4413 15.1839 11.2044 15.5 12 15.5C12.7956 15.5 13.5587 15.1839 14.1213 14.6213Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,ei.jsx)("path",{d:"M2.45801 12.5C3.73201 8.443 7.52301 5.5 12 5.5C16.478 5.5 20.268 8.443 21.542 12.5C20.268 16.557 16.478 19.5 12 19.5C7.52301 19.5 3.73201 16.557 2.45801 12.5Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})})})})})},i$=(0,es.forwardRef)(({x:e,y:t},i)=>(0,ei.jsx)("div",{className:"pointer-events-none fixed",style:{top:t,left:e,transform:"translate(-50%, 28px)",width:51,height:44,filter:"drop-shadow(0px 0px 5px rgba(0, 0, 0, 0.2))"},ref:i,children:(0,ei.jsx)("img",{src:"img/sun_path_finger_v2.svg",className:"h-full w-full block absolute sun-path-action"})}));var iQ=()=>{let e=(0,eQ.Z)(ep.UW.pipe((0,_.U)(e=>e===ep.BS.Analytics))),t=(0,es.useRef)(null);return((0,es.useEffect)(()=>{let e=(0,d.a)([ep.IR,ep.UH]).subscribe(([e,i])=>{if(t.current){let s=i||!e.isCrosshairVisible;t.current.style.top=`${e.y}px`,t.current.style.left=`${e.x}px`,t.current.style.display=s?"none":"block"}});return()=>{e.unsubscribe()}},[e]),e)?(0,ei.jsx)("img",{className:"absolute",style:{transform:"translate(-50%, -50%)",display:"none",pointerEvents:"none"},src:"./img/icon/analytics_crosshair.svg",alt:"Crosshair",ref:t}):null};let iq=({subject:e,isCentered:t,showIcon:i,isBig:s,hideBackground:n,opacity:o,transformLabel:r})=>{let[a,l]=(0,es.useState)(void 0),d=(0,es.useRef)(null);return((0,es.useEffect)(()=>{let t=e.pipe((0,R.x)()).subscribe(e=>{r?l(e?Object.assign(Object.assign({},e),{label:r(e.label)}):e):l(e),e&&d.current&&(d.current.style.left=`${e.position.x}px`,d.current.style.top=`${e.position.y}px`)});return()=>t.unsubscribe()},[d,r]),a)?(0,ei.jsx)(iX,Object.assign({},a,{isCentered:t,showIcon:i,isBig:s,hideBackground:n,opacity:o,ref:d})):null},iK=({subject:e})=>{let[t,i]=(0,es.useState)(void 0),s=(0,es.useRef)(null);return((0,es.useEffect)(()=>{let t=e.pipe((0,R.x)()).subscribe(e=>{i(e),e&&s.current&&(s.current.style.left=`${e.x}px`,s.current.style.top=`${e.y}px`)});return()=>t.unsubscribe()},[s]),t)?(0,ei.jsx)(i$,Object.assign({},t,{ref:s})):null},iJ=()=>{let[e,t]=(0,es.useState)(void 0),[i,s]=(0,es.useState)(!1),[n,o]=(0,es.useState)({x:0,y:0}),r=(0,es.useRef)(null);return((0,es.useEffect)(()=>{let e=L.IX.subscribe(e=>{s(e.isVisible),e.isVisible&&(t((+e.distance.toFixed(1)).toString()+" m"),o(e.position),e&&r.current&&(r.current.style.left=`${e.position.x}px`,r.current.style.top=`${e.position.y}px`))});return()=>e.unsubscribe()},[r]),i)?(0,ei.jsx)(iX,{label:null!=e?e:"",position:n,isCentered:!0,showIcon:!1,isBig:!1,ref:r}):null},i1=(e,t,i)=>{let s=Math.max(0,Math.min(1,(i-e)/(t-e)));return s*s*(3-2*s)};var i0=()=>{let{t:e}=(0,ea.$G)(),t=(0,eQ.Z)(L.jR),[i]=(0,et.mr)("analyticsEnabled"),[s]=(0,et.mr)("sunPathEnabled"),n=(0,eQ.Z)(q),o=(0,eQ.Z)(S.As),r=(0,eQ.Z)((0,d.a)([X,$]).pipe((0,_.U)(([e,t])=>{if(!e||!t)return 0;let i=Math.hypot(e.position.x-t.x,e.position.y-t.y);return i1(t.radius,t.radius+10,i)}))),a=(0,eQ.Z)((0,d.a)([Y,$]).pipe((0,_.U)(([e,t])=>{if(!e||!t)return 0;let i=Math.hypot(e.position.x-t.x,e.position.y-t.y);return i1(t.radius,t.radius+10,i)})));return(0,ei.jsxs)(ei.Fragment,{children:[t&&(0,ei.jsx)(iz,Object.assign({},t)),(0,ei.jsx)(iH,{}),(0,ei.jsx)(iY,{}),s&&(0,ei.jsxs)(ei.Fragment,{children:[(0,ei.jsx)(iq,{subject:X,isCentered:!0,showIcon:!1,isBig:!1,hideBackground:!0,opacity:r}),(0,ei.jsx)(iq,{subject:Y,isCentered:!0,showIcon:!0,isBig:!1,hideBackground:!0,opacity:a}),(0,ei.jsx)(iq,{subject:W,isCentered:!1,showIcon:!1,isBig:!0,hideBackground:!1,transformLabel:t=>{var i;return e(`datePicker.events.${(0,tY.wT)(t,null!=(i=null==o?void 0:o.lat)?i:0)}`)}}),(0,ei.jsx)(ta.u,{appear:!0,show:!!n,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,ei.jsx)(iK,{subject:$.pipe((0,_.U)(e=>e?{x:e.x,y:e.y}:void 0))})})]}),i&&(0,ei.jsx)(iQ,{}),(0,ei.jsx)(iJ,{})]})},i2=i(56167);let i5=()=>{let[e]=(0,et.mr)("mapMode");return(0,ei.jsx)("div",{className:"pointer-events-auto",children:(0,ei.jsxs)("div",{className:"flex items-center xs:gap-[12px] gap-[8px] flex-row",children:[(0,ei.jsx)("a",{href:"https://shadowmap.org",target:"_blank",className:"block text-white",children:(0,ei.jsx)(ed.Zb,{className:"xs:w-[115px] w-[92px] max-w-full flex-shrink"})}),e===l.M$.GOOGLE&&(0,ei.jsxs)(ei.Fragment,{children:[(0,ei.jsx)("div",{className:"h-[24px] w-[1px] bg-white flex-shrink-0"}),(0,ei.jsx)("a",{href:"https://shadowmap.org",target:"_blank",className:"block",children:(0,ei.jsx)("img",{className:"xs:w-[59px] w-[48px] flex-shrink",src:"img/google_on_non_white_hdpi.png",alt:"Google"})})]})]})})},i3=({canHide:e})=>{let{t}=(0,ea.$G)(),[i,s]=(0,es.useState)(100),[n,o]=(0,es.useState)(!1),[r,a]=(0,es.useState)(null),[l,d]=(0,es.useState)(0),[h,c]=(0,es.useState)(0),u=(0,es.useRef)(null);(0,es.useEffect)(()=>{if(!u.current)return;let e=L.OJ.subscribe(e=>{c(e)});return()=>{e.unsubscribe()}},[u.current]),(0,es.useEffect)(()=>{l!==h&&(d(h),u.current.children[0].style.transform=`rotate(${h}rad)`,.01>Math.abs(h)?(r&&clearTimeout(r),s(0),a(setTimeout(()=>{o(!0)},1e3))):(o(!1),s(100),r&&clearTimeout(r)))},[l,h,r]);let p="transition-opacity duration-500 delay-300 btn btn-white-blur backdrop-filter-map w-11 h-11 items-center justify-center [&>svg]:inline";return n&&e?p+=" hidden":p+=" flex",0===i&&e?p+=" opacity-0":p+=" opacity-100",(0,ei.jsx)("button",Object.assign({ref:u,title:t("compassButton.title"),className:p},(0,el.zc)(()=>{L.kY.next("reset-north")}),{dangerouslySetInnerHTML:{__html:'<svg width="32" height="33" viewBox="0 0 32 33" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M14 0.0999756V5.11565H14.6796V1.37539L17.3982 5.11565H18V0.0999756H17.3204V3.84024L14.5947 0.0999756H14Z" fill="#3F4C5A" fill-opacity="0.8"/>\n<line x1="29" y1="16.1" x2="32" y2="16.1" stroke="#3F4C5A" stroke-opacity="0.8"/>\n<line y1="16.1" x2="3" y2="16.1" stroke="#3F4C5A" stroke-opacity="0.8"/>\n<line x1="16" y1="32.1" x2="16" y2="29.1" stroke="#3F4C5A" stroke-opacity="0.8"/>\n<path d="M16 7.09998L19 15.1H13L16 7.09998Z" fill="#FF0000"/>\n<path d="M16 25.1L13 17.1L19 17.1L16 25.1Z" fill="#3F4C5A" fill-opacity="0.6"/>\n</svg>\n'}}))},i4=()=>{let[e,t]=(0,es.useState)([]),i=(0,eQ.Z)(e1.Yy);return((0,es.useEffect)(()=>{let e=L.tl.subscribe(e=>{t(e)});return()=>{e.unsubscribe()}},[]),i)?null:(0,ei.jsx)("div",{className:"pointer-events-auto px-2 select-and-touch-none text-xxxs xs:text-xxs opacity-60 text-white text-center w-full no-underline h-[11px] xs:h-[15px] overflow-hidden absolute bottom-[2px]",style:{textShadow:"0 1px 1px #000000aa"},children:e.map((t,i)=>(0,ei.jsxs)(es.Fragment,{children:[0===i&&(0,ei.jsx)("span",{children:"\xa9 "}),(0,ei.jsx)("span",{onClick:()=>{t.includes("others")&&L.y7.next({modal:H.o.INFO,opts:{goToAcknowledgements:!0}})},dangerouslySetInnerHTML:{__html:t}}),i<e.length-1&&(0,ei.jsx)("span",{children:", "})]},t))})};var i8=i(33578);let i9=()=>{let e=(0,eQ.Z)(e1.Yy),t=(0,eQ.Z)(L.R9);return e?null:(0,ei.jsx)("button",Object.assign({id:"share",title:(0,N.t)("shareButton.title"),className:"rounded-icon btn btn-grey-blur backdrop-filter-map w-11 h-11 flex items-center justify-center"},(0,el.zc)(()=>{(0,D.JD)(t)}),{children:i8.Z.isLikelyAppleUser?(0,ei.jsx)("div",{children:(0,ei.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,ei.jsx)("path",{d:"M12 3.75V15M12 3.75L16.5 8.25M12 3.75L7.5 8.25M20.25 12.75V18.25C20.25 19.3546 19.3546 20.25 18.25 20.25H5.75C4.64543 20.25 3.75 19.3546 3.75 18.25V12.75",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})}):(0,ei.jsx)("div",{className:"-ml-0.5 text-white",children:(0,ei.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:(0,ei.jsx)("path",{d:"M18 16.08C17.24 16.08 16.56 16.38 16.04 16.85L8.91 12.7C8.96 12.47 9 12.24 9 12C9 11.76 8.96 11.53 8.91 11.3L15.96 7.19C16.5 7.69 17.21 8 18 8C19.66 8 21 6.66 21 5C21 3.34 19.66 2 18 2C16.34 2 15 3.34 15 5C15 5.24 15.04 5.47 15.09 5.7L8.04 9.81C7.5 9.31 6.79 9 6 9C4.34 9 3 10.34 3 12C3 13.66 4.34 15 6 15C6.79 15 7.5 14.69 8.04 14.19L15.16 18.35C15.11 18.56 15.08 18.78 15.08 19C15.08 20.61 16.39 21.92 18 21.92C19.61 21.92 20.92 20.61 20.92 19C20.92 17.39 19.61 16.08 18 16.08Z"})})})}))},i7=()=>{let e=(0,eQ.Z)(L.R9),t=(0,Z.MG)(e=>e.capabilities.unlockEverything);if(!e)return null;let i=e.isAllowedToUseHome()||t,s=()=>{L.a7.next(!L.a7.getValue())};return(0,ei.jsxs)(ei.Fragment,{children:[(0,ei.jsx)(eJ,{onClick:s,isUnlocked:!!i,trackingEnabled:!0,disabledAction:e=>{L.y7.next({modal:H.o.FEATURE_UPGRADE,opts:{type:z.l.Satellite,trigger:"satellite"===e?"map_style_satellite":"map_style_outdoor"}})}}),(0,ei.jsx)(e0,{onClick:s})]})},i6=()=>{let e=(0,eQ.Z)(L.R9),t=(0,eQ.Z)(L.a7);return e?(0,ei.jsx)(ta.u,{show:t,as:es.Fragment,children:(0,ei.jsxs)(ta.u.Child,{enter:"transition-transform duration-200 ease-out",enterFrom:"translate-y-full",enterTo:"translate-y-0",leave:"transition-transform duration-150 ease-in",leaveFrom:"translate-y-0",leaveTo:"translate-y-full",className:"sm:hidden fixed bottom-0 left-0 right-0 w-screen bg-grey-800 bg-opacity-80 backdrop-filter-map rounded-t-3xl px-12 pt-6 pb-bsafe-6 flex flex-row justify-center",style:{boxShadow:"0 0 10px 0 rgba(0, 0, 0, 0.40)"},children:[(0,ei.jsx)(tc.Z,{className:"absolute top-4 right-4 w-6 h-6 text-white cursor-pointer",onClick:()=>L.a7.next(!1)}),(0,ei.jsx)("div",{className:"w-[304px] max-w-full",children:(0,ei.jsx)(i7,{})})]})}):null};var se=()=>{let{t:e}=(0,ea.$G)(),t=(0,eQ.Z)(L.R9),i=(0,eQ.Z)(L.a7),s=(0,eQ.Z)(em.Mm),n=(0,eQ.Z)(e1.Yy),o=(0,eQ.Z)(e1.s6),r=(0,eQ.Z)((0,d.a)([e1.QA,(0,et.ZW)("mapMode"),L.R9]).pipe((0,_.U)(([e,i])=>e&&i!==l.M$.GOOGLE&&!(null==t?void 0:t.isAllowedToUseStudio()))));if(!t||s||n)return null;let a=()=>{L.a7.next(!L.a7.getValue())};return(0,ei.jsxs)("div",{className:"relative pointer-events-auto",children:[(0,ei.jsx)(ta.u,{show:o,as:es.Fragment,children:(0,ei.jsxs)(ta.u.Child,{enter:"transition-all duration-200 ease-out",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-all duration-150 ease-in",leaveFrom:"opacity-100",leaveTo:"opacity-0",className:"absolute bottom-[calc(100%+12px)] right-0 bg-shadowmap-yellow text-black rounded-[4px] px-2 py-3 w-[170px] text-[12px] leading-[1.1] font-bold text-center cursor-pointer",style:{boxShadow:"0 1px 9px rgba(0, 0, 0, 0.40)"},onClick:a,children:[e("settingsPanel.mapStyle.google3DPreviewBubble"),(0,ei.jsx)(tc.Z,{className:"absolute top-[5px] right-[5px] w-4 h-4 cursor-pointer",onClick:e=>{e.stopPropagation(),(0,e1.nA)()}}),(0,ei.jsx)("div",{className:"absolute top-full right-[16px] w-0 h-0 border-l-[6px] border-r-[6px] border-t-[5px] border-l-transparent border-r-transparent border-t-shadowmap-yellow"})]})}),(0,ei.jsx)(ta.u,{show:i,as:es.Fragment,children:(0,ei.jsx)(ta.u.Child,{enter:"transition-all duration-200 ease-out",enterFrom:"opacity-0 scale-95 translate-y-2 translate-x-2",enterTo:"opacity-100 scale-100 translate-y-0",leave:"transition-all duration-150 ease-in",leaveFrom:"opacity-100 scale-100 translate-y-0",leaveTo:"opacity-0 scale-95 translate-y-2 translate-x-2",className:"hidden sm:block absolute right-0 bottom-[calc(100%+10px)] bg-grey-800 bg-opacity-80 backdrop-filter-map rounded-3xl p-4",children:(0,ei.jsx)(i7,{})})}),(0,ei.jsx)("button",Object.assign({className:eD()("rounded-icon btn btn-grey-blur backdrop-filter-map w-11 h-11 flex items-center justify-center text-white",{"border-[1.5px] border-shadowmap-yellow":r})},(0,el.zc)(a),{children:(0,ei.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,ei.jsx)("path",{d:"M8.75 5.00016V17.5002M15.25 6.50016V19.0002M2.75 17.419V7.5813C2.75 6.93565 3.16315 6.36245 3.77566 6.15827L8.29397 4.65217C8.59056 4.55331 8.91063 4.54959 9.20944 4.64153L14.7906 6.35879C15.0894 6.45074 15.4094 6.44701 15.706 6.34815L19.2757 5.15827C20.247 4.83451 21.25 5.55746 21.25 6.5813V16.419C21.25 17.0647 20.8369 17.6379 20.2243 17.842L15.706 19.3482C15.4094 19.447 15.0894 19.4507 14.7906 19.3588L9.20944 17.6415C8.91063 17.5496 8.59056 17.5533 8.29397 17.6522L4.72434 18.842C3.75305 19.1658 2.75 18.4429 2.75 17.419Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"square",strokeLinejoin:"round"})})}))]})},st=()=>{let{t:e}=(0,ea.$G)();return(0,eQ.Z)(e1.Yy)?null:(0,ei.jsxs)(ei.Fragment,{children:[(0,ei.jsx)("button",Object.assign({className:"btn-settings btn-grey-blur shadow select-and-touch-none rounded-icon backdrop-filter-map w-11 h-11 flex items-center justify-center",title:e("settingsButton.title")},(0,el.zc)(()=>{L.Jt.next(!L.Jt.value)}),{children:(0,ei.jsx)(ed.wf,{})})),(0,ei.jsx)("div",{className:"absolute top-0 right-0 hidden",children:(0,ei.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"13",height:"13",viewBox:"0 0 13 13",fill:"none",children:[(0,ei.jsx)("circle",{cx:"6.5",cy:"6.5",r:"6",fill:"url(#paint0_linear_2423_6177)",stroke:"white"}),(0,ei.jsx)("defs",{children:(0,ei.jsxs)("linearGradient",{id:"paint0_linear_2423_6177",x1:"4.47312",y1:"2.99125e-08",x2:"9.56445",y2:"12.0264",gradientUnits:"userSpaceOnUse",children:[(0,ei.jsx)("stop",{stopColor:"#F8F991"}),(0,ei.jsx)("stop",{offset:"1",stopColor:"#FFCD00"})]})})]})})]})},si=i(77779),ss=()=>{let{t:e}=(0,ea.$G)(),[t,i]=(0,si.Z)(S.oI),[s,n]=(0,es.useState)(!1);if((0,es.useEffect)(()=>{if(!(null==t?void 0:t.value))return;P.n.onMoveToCurrentLocation();let e=t.value;S.qi.next({location:e,dropPin:!1}),S.Em.next({location:e,accuracy:.5,visible:!0}),n(!0)},[t]),!navigator.geolocation)return null;let o=t.loading;return(0,ei.jsx)("button",Object.assign({title:e("currentLocationButton.title"),className:eD()("pointer-events-auto rounded-icon btn btn-grey-blur backdrop-filter-map w-11 h-11 flex items-center justify-center text-white",{"border-[1.5px] border-shadowmap-yellow":s})},(0,el.zc)(()=>{var e,t,o,r;return e=void 0,t=void 0,o=void 0,r=function*(){if(s){S.Em.next(void 0),n(!1);return}if(P.n.onRequestCurrentLocation(),y.md){let e=yield y.md.requestLocation().catch(console.warn);if(!(null==e?void 0:e.success))return;let t=new l.Y(e.body.lat,e.body.lng,15);S.qi.next({location:t,dropPin:!1}),S.Em.next({location:t,accuracy:.5,visible:!0});return}i()},new(o||(o=Promise))(function(i,s){function n(e){try{l(r.next(e))}catch(e){s(e)}}function a(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof o?t:new o(function(e){e(t)})).then(n,a)}l((r=r.apply(e,t||[])).next())})}),{children:o?(0,ei.jsx)(tI.Z,{className:"w-[16px] h-[16px]"}):(0,ei.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,ei.jsx)("path",{d:"M10.26 10.7352V17.1474C10.26 17.3902 10.4094 17.6079 10.6359 17.6952C10.9333 17.8098 11.2679 17.6661 11.3896 17.3715L16.9625 3.8747L17.0172 3.75545C17.3615 3.00476 16.6067 2.22125 15.8437 2.53735L15.728 2.58529L2.55154 8.70212C2.28406 8.82629 2.15085 9.13017 2.24078 9.41102C2.31824 9.65294 2.54299 9.81721 2.79701 9.81757L9.35272 9.8267C9.85399 9.8274 10.26 10.2339 10.26 10.7352Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})}))};let sn=()=>{let{t:e}=(0,ea.$G)(),t=(0,Z.MG)(e=>e.bottomButtonsPosition),{currentTheme:i}=(0,es.useContext)(en);return(0,ei.jsxs)("div",{className:eD()("hidden sm:flex flex-row",{"flex-col-reverse":"left"===t}),children:[(0,ei.jsx)("button",Object.assign({className:eD()("btn-grey-blur backdrop-filter-map shadow w-11 h-11 border-r border-white border-opacity-20 flex items-center justify-center select-none","right"===t?`rounded-l-${"lystio"===i.name?"lg":"full"}`:"rounded-b"),title:e("zoomOutButton.title")},(0,el.zc)(()=>{(0,et.NN)("firstPersonView")?L.Br.next("decrement"):L.kY.next("zoom-out")}),{children:(0,ei.jsx)(ed.dT,{className:"w-4 h-auto"})})),(0,ei.jsx)("button",Object.assign({className:eD()("btn-grey-blur backdrop-filter-map shadow w-11 h-11 flex items-center justify-center select-none","right"===t?`rounded-r-${"lystio"===i.name?"lg":"full"}`:"rounded-t"),title:e("zoomInButton.title")},(0,el.zc)(()=>{(0,et.NN)("firstPersonView")?L.Br.next("increment"):L.kY.next("zoom-in")}),{children:(0,ei.jsx)(ed.jL,{className:"w-4 h-auto"})}))]})};var so=()=>{let{t:e}=(0,ea.$G)(),t=(0,eQ.Z)(L.Jt),{showSettingsButton:i,canSearchLocation:s,enableCurrentLocationButton:n}=(0,Z.MG)(e=>e.capabilities),o=(0,Z.MG)(e=>e.capabilities.showMapStyle),r=(0,Z.MG)(e=>e.showLogo),a=(0,Z.MG)(e=>e.bottomButtonsPosition),h=(0,eQ.Z)((0,d.a)([em.Us,Z.Xq]).pipe((0,_.U)(([e,t])=>!e&&t.capabilities.showShareButton))),c=tH(),[u,p]=(0,et.mr)("mapMode"),m=(0,Z.MG)(e=>e.showFastMapModeSelector);return(0,ei.jsxs)("div",{className:"pointer-events-none fixed w-full pb-[16px]",style:{bottom:"env(safe-area-inset-bottom)"},children:[m&&(0,ei.jsx)("div",{className:"pointer-events-auto flex flex-row justify-center w-full static md:absolute top-[-4px] left-0 mb-2",children:(0,ei.jsx)("div",{style:{background:"rgba(63, 76, 90, 0.80)",boxShadow:"0px 1px 1px 0px rgba(0, 0, 0, 0.10)",backdropFilter:"blur(5px)"},className:"p-1 rounded-[8px]",children:(0,ei.jsxs)("div",{className:"bg-[#2D3741] rounded-md",children:[(0,ei.jsx)("button",{className:eD()("w-[103px] text-center py-1.5 text-sm font-bold rounded-[6px]",u===l.M$.DEFAULT?"btn-gradient":"text-white"),onClick:()=>{p(l.M$.DEFAULT)},children:e("fastMapModeSelector.standard")}),(0,ei.jsx)("button",{className:eD()("w-[103px] text-center py-1.5 text-sm font-bold rounded-[6px]",u===l.M$.GOOGLE?"btn-gradient":"text-white"),onClick:()=>{p(l.M$.GOOGLE)},children:e("fastMapModeSelector.google3D")})]})})}),(0,ei.jsxs)("div",{id:"bottom-top-container",children:[(0,ei.jsxs)("div",{className:eD()("w-full flex justify-between items-end","right"===a?"flex-row":"flex-row-reverse"),children:[r&&(0,ei.jsxs)("div",{className:eD()("flex flex-col gap-[25px] mb-2","right"===a?"ml-lsafe-4":"mr-rsafe-4"),children:[c.width>=640&&(0,ei.jsx)(tz,{modalSide:"top"}),(0,ei.jsx)(i5,{})]}),(0,ei.jsx)("div",{className:eD()("pointer-events-none select-and-touch-none translate-x-0 transition-transform transform",{"translate-x-0":!t,"md:-translate-x-[323px]":t&&"right"===a}),style:{marginRight:"max(calc(8px - env(safe-area-inset-right)), 0px)",marginLeft:"max(calc(8px - env(safe-area-inset-left)), 0px)"},children:(0,ei.jsxs)("div",{className:"flex flex-col gap-2",children:[o&&(0,ei.jsx)("div",{className:"flex flex-row gap-2 justify-end",children:(0,ei.jsx)(se,{})}),s&&n&&(0,ei.jsx)("div",{className:"flex flex-row gap-2 justify-end",children:(0,ei.jsx)(ss,{})}),(0,ei.jsxs)("div",{className:eD()("flex flex-row gap-2 pointer-events-auto",{"flex-col-reverse":"left"===a}),children:[(0,ei.jsx)(i3,{canHide:"right"===a}),h&&(0,ei.jsx)(i9,{}),(0,ei.jsx)("div",{className:"relative",children:i&&(0,ei.jsx)(st,{})}),!(0,el.b1)()&&(0,ei.jsx)(e3,{children:(0,ei.jsx)(sn,{})})]})]})})]}),(0,ei.jsx)(i4,{})]})]})};let sr=({title:e,value:t,onSwitch:i,tooltip:s})=>(0,ei.jsxs)("div",{children:[(0,ei.jsxs)("h3",{className:"text-sm font-bold text-white leading-3 mb-2 flex",children:[(0,ei.jsx)("span",{className:"text-ellipsis overflow-hidden",children:e}),s&&(0,ei.jsx)(e_.oD,{content:s,className:"ml-1"})]}),(0,ei.jsx)(eN.r,{checked:t,onChange:()=>i(!t),className:`${t?"bg-gradient-to-r from-sun-600 to-neon-500":"bg-grey-200"} relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full p-0.5 transition-colors duration-200 ease-in-out`,children:(0,ei.jsx)("span",{className:`${t?"translate-x-5":"translate-x-0"} pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out`})})]}),sa=e=>"type"in e&&"name"in e,sl=({selectedObject:e,onAttributeChange:t})=>{let{t:i}=(0,ea.$G)(),{scale:s,height:n}=(e=>{if("originalHeightInModelUnits"in e){let{scale:t,originalHeightInModelUnits:i,zUp:s}=e;if(!i)throw Error("originalHeightInModelUnits is undefined");return{scale:t,height:s?i.z:i.y}}if("polygon"in e){let{scale:t,height:i}=e;return{scale:t,height:i}}{if(!sa(e))return{scale:1,height:1};let{scaleX:t,scaleY:i}=e;return{scale:t,height:i}}})(e);return(0,ei.jsx)(ek.O.Panel,{children:(0,ei.jsxs)("div",{className:"flex gap-4",children:[(0,ei.jsx)("div",{className:"min-w-0",children:(0,ei.jsx)(ez,{label:i("studio.transformModeControls.height.heightInPercent.label"),initialValue:100*s,onChange:i=>{t(e,"scale")(i/100)},stepPrecision:1,precision:2,tooltip:i("studio.transformModeControls.height.heightInPercent.tooltip",{heightInM:n})})}),(0,ei.jsx)("div",{className:"min-w-0",children:(0,ei.jsx)(ez,{label:i("studio.transformModeControls.height.heightInM.label"),initialValue:n*s,onChange:i=>{t(e,"scale")(i/n)},stepPrecision:1,precision:2})})]})},"height")},sd=({size:e})=>{let t=(0,eQ.Z)(D.Xi),i=(0,eQ.Z)(D.rB),s=(0,eQ.Z)(D.E3),n=(0,eQ.Z)(D.sT),o=(0,eQ.Z)(D.fK.pipe((0,_.U)(e=>e[0])));return o?t&&"deleted"!==t.status?(0,ei.jsx)(su,{selectedModel:t,mode:o,size:e}):i&&"deleted"!==i.status?(0,ei.jsx)(sp,{selectedShape:i,mode:o,size:e}):s?(0,ei.jsx)(sm,{prefab:s,mode:o,size:e}):n?(0,ei.jsx)(sg,{selectedSolarPanel:n,mode:o,size:e}):null:null},sh=(e,t)=>i=>{let s=Object.assign(Object.assign({},e),{[t]:i});return"originalHeightInModelUnits"in e?D.Xi.next(s):"polygon"in e?D.rB.next(s):sa(e)?D.E3.next(s):D.sT.next(s),s},sc=({attributeConfig:e,selectedObject:t,mode:i,size:s,showHeight:n})=>{let{t:o}=(0,ea.$G)(),{currentTheme:r}=(0,es.useContext)(en),a=e.map(e=>e.mode);return n&&a.push("zScale"),(0,ei.jsxs)(ek.O.Group,{onChange:e=>{let i=a[e],s="originalHeightInModelUnits"in t||"sizeX"in t;D.fK.next([i,"translate"!==i||s?"local":"world"])},selectedIndex:a.indexOf(i),children:[(0,ei.jsxs)(ek.O.List,{className:"flex w-full",children:[e.map((t,i)=>{let s=0===i,o=i===e.length-1&&!n;return(0,ei.jsx)(ek.O,{as:"div",className:"flex-1 text-center cursor-pointer hover-bg-gradient-child text-white ",children:({selected:e})=>(0,ei.jsx)("div",{className:eD()("font-bold text-sm",{"p-[1px] bg-gradient-to-t":e,[r.shadow]:e,[r.textColor]:e,[r.gradient]:e,"py-2 px-2 md:px-5 bg-grey-800 border border-grey-500 hover:bg-grey-700 hover:border-grey-300":!e,"rounded-l-full":s,"rounded-r-full":o}),children:(0,ei.jsx)("div",{className:eD()({"py-2 px-2 md:px-5 w-full h-full bg-gradient-to-b":e,[r.textColor]:e,[r.gradient]:e,"rounded-l-full":s,"rounded-r-full":o}),children:t.label})})},t.label)}),n&&(0,ei.jsx)(ek.O,{as:"div",className:"flex-1 text-center cursor-pointer hover-bg-gradient-child text-white ",children:({selected:e})=>(0,ei.jsx)("div",{className:`font-bold text-sm rounded-r-full ${e?`p-[1px] bg-gradient-to-t ${r.shadow} ${r.textColor} ${r.gradient}`:"py-2 px-2 md:px-5 bg-grey-800 border border-grey-500 hover:bg-grey-700 hover:border-grey-300"}`,children:(0,ei.jsx)("div",{className:`rounded-r-full ${e?`py-2 px-2 md:px-5 w-full h-full bg-gradient-to-b ${r.textColor} ${r.gradient}`:""}`,children:o("studio.transformModeControls.height.label")})})},"height")]}),"LARGE"===s&&(0,ei.jsxs)(ek.O.Panels,{className:eD()("mt-3",e[0].items.length>=4?"h-[284px]":"h-[230px]"),children:[e.map(e=>(0,ei.jsx)(ek.O.Panel,{className:"grid gap-3",children:e.items.map(e=>{let{title:t,stepPrecision:i,precision:s,tooltip:n,setAttribute:o,getAttribute:r}=e;return e.switch?(0,ei.jsx)(sr,{title:t,value:r(),onSwitch:o,tooltip:n},t):(0,ei.jsx)(ez,{label:t,initialValue:r(),onChange:o,stepPrecision:null!=i?i:1,precision:s,tooltip:n},t)})},e.label)),n&&(0,ei.jsx)(sl,{selectedObject:t,onAttributeChange:sh})]})]})},su=({selectedModel:e,mode:t,size:i})=>{let{t:s}=(0,ea.$G)(),n=[{label:s("studio.transformModeControls.move.label"),mode:"translate",items:[{title:s("studio.transformModeControls.move.longitude"),getAttribute:()=>e.lng,setAttribute:sh(e,"lng"),stepPrecision:5,precision:7},{title:s("studio.transformModeControls.move.latitude"),getAttribute:()=>e.lat,setAttribute:sh(e,"lat"),stepPrecision:5,precision:7},{title:s("studio.transformModeControls.move.offsetFromGround.title"),setAttribute:sh(e,"offsetInMeters"),getAttribute:()=>e.offsetInMeters,stepPrecision:1,precision:2,switch:!1,tooltip:s("studio.transformModeControls.move.offsetFromGround.tooltip")},{title:s("studio.transformModeControls.move.reCenter.title"),setAttribute:sh(e,"reCentered"),getAttribute:()=>e.reCentered,switch:!0,tooltip:s("studio.transformModeControls.move.reCenter.tooltip")}]},{label:s("studio.transformModeControls.rotate.label"),mode:"xyRotate",items:[{title:s("studio.transformModeControls.rotate.rotation.title"),setAttribute:sh(e,"rotation"),getAttribute:()=>e.rotation,stepPrecision:1,precision:2},{title:s("studio.transformModeControls.rotate.flipOrientation.title"),setAttribute:sh(e,"zUp"),getAttribute:()=>e.zUp,switch:!0,tooltip:s("studio.transformModeControls.rotate.flipOrientation.tooltip")}]}];return(0,ei.jsx)(sc,{attributeConfig:n,selectedObject:e,mode:t,size:i,showHeight:!0})},sp=({selectedShape:e,mode:t,size:i})=>{let{t:s}=(0,ea.$G)(),n=[{label:s("studio.transformModeControls.move.label"),mode:"translate",items:[{title:s("studio.transformModeControls.move.longitude"),setAttribute:sh(e,"lng"),getAttribute:()=>e.lng,stepPrecision:5,precision:7},{title:s("studio.transformModeControls.move.latitude"),setAttribute:sh(e,"lat"),getAttribute:()=>e.lat,stepPrecision:5,precision:7},{title:s("studio.transformModeControls.move.offsetFromGround.title"),setAttribute:sh(e,"offsetInMeters"),getAttribute:()=>e.offsetInMeters,stepPrecision:1,precision:2,switch:!1,tooltip:s("studio.transformModeControls.move.offsetFromGround.tooltip")}]},{label:s("studio.transformModeControls.rotate.label"),mode:"rotate",items:[{title:s("studio.transformModeControls.rotate.rotationX"),setAttribute:sh(e,"rotationX"),getAttribute:()=>e.rotationX,stepPrecision:1,precision:2},{title:s("studio.transformModeControls.rotate.rotationY"),setAttribute:sh(e,"rotationY"),getAttribute:()=>e.rotationY,stepPrecision:1,precision:2},{title:s("studio.transformModeControls.rotate.rotationZ"),setAttribute:sh(e,"rotationZ"),getAttribute:()=>e.rotationZ,stepPrecision:1,precision:2}]}];return(0,ei.jsx)(sc,{attributeConfig:n,selectedObject:e,mode:t,size:i,showHeight:!0})},sm=({prefab:e,mode:t,size:i})=>{let{t:s}=(0,ea.$G)(),n=l.wz.find(t=>t.name===e.type).controls,o=e=>{let t=D.E3.getValue();t&&D.E3.next(Object.assign(Object.assign({},t),e))},r=[{label:s("studio.transformModeControls.move.label"),mode:"translate",items:[{title:s("studio.transformModeControls.move.longitude"),setAttribute:e=>o({lng:e}),getAttribute:()=>e.lng,stepPrecision:5,precision:7},{title:s("studio.transformModeControls.move.latitude"),setAttribute:e=>o({lat:e}),getAttribute:()=>e.lat,stepPrecision:5,precision:7},{title:s("studio.transformModeControls.move.offsetFromGround.title"),setAttribute:e=>o({offsetFromGround:e}),getAttribute:()=>e.offsetFromGround,stepPrecision:1,precision:2,switch:!1,tooltip:s("studio.transformModeControls.move.offsetFromGround.tooltip")}]},{label:s("studio.transformModeControls.rotate.label"),mode:"rotate",items:[{title:s("studio.transformModeControls.rotate.rotationX"),setAttribute:e=>o({rotationX:e}),getAttribute:()=>e.rotationX,stepPrecision:1,precision:2},{title:s("studio.transformModeControls.rotate.rotationY"),setAttribute:e=>o({rotationY:e}),getAttribute:()=>e.rotationY,stepPrecision:1,precision:2},{title:s("studio.transformModeControls.rotate.rotationZ"),setAttribute:e=>o({rotationZ:e}),getAttribute:()=>e.rotationZ,stepPrecision:1,precision:2}]}];return"full"===n?r.push({label:s("studio.transformModeControls.scale.label"),mode:"scale",items:[{title:s("studio.transformModeControls.scale.length"),setAttribute:e=>o({scaleX:e}),getAttribute:()=>e.scaleX,stepPrecision:1,precision:2},{title:s("studio.transformModeControls.scale.width"),setAttribute:e=>o({scaleY:e}),getAttribute:()=>e.scaleY,stepPrecision:1,precision:2},{title:s("studio.transformModeControls.scale.height"),setAttribute:e=>o({scaleZ:e}),getAttribute:()=>e.scaleZ,stepPrecision:1,precision:2}]}):"tree"===n&&r.push({label:s("studio.transformModeControls.scale.label"),mode:"scale",items:[{title:s("studio.transformModeControls.scale.diameter"),getAttribute:()=>e.scaleX,setAttribute:e=>{o({scaleX:e,scaleY:e})},stepPrecision:1,precision:2},{title:s("studio.transformModeControls.scale.height"),setAttribute:e=>o({scaleZ:e}),getAttribute:()=>e.scaleZ,stepPrecision:1,precision:2}]}),(0,ei.jsx)(sc,{attributeConfig:r,selectedObject:e,mode:t,size:i,showHeight:!1})},sg=({selectedSolarPanel:e,mode:t,size:i})=>{let{t:s}=(0,ea.$G)(),n=[{label:s("studio.transformModeControls.move.label"),mode:"translate",items:[{title:s("studio.transformModeControls.move.longitude"),setAttribute:sh(e,"lng"),getAttribute:()=>e.lng,stepPrecision:5,precision:7},{title:s("studio.transformModeControls.move.latitude"),setAttribute:sh(e,"lat"),getAttribute:()=>e.lat,stepPrecision:5,precision:7},{title:s("studio.transformModeControls.move.offsetFromGround.title"),setAttribute:sh(e,"offsetFromGround"),getAttribute:()=>e.offsetFromGround,stepPrecision:1,precision:2,switch:!1,tooltip:s("studio.transformModeControls.move.offsetFromGround.tooltip")}]},{label:s("studio.transformModeControls.rotate.label"),mode:"rotate",items:[{title:s("studio.transformModeControls.rotate.rotationX"),setAttribute:sh(e,"rotationX"),getAttribute:()=>e.rotationX,stepPrecision:1,precision:2},{title:s("studio.transformModeControls.rotate.rotationY"),setAttribute:sh(e,"rotationY"),getAttribute:()=>e.rotationY,stepPrecision:1,precision:2},{title:s("studio.transformModeControls.rotate.rotationZ"),setAttribute:sh(e,"rotationZ"),getAttribute:()=>e.rotationZ,stepPrecision:1,precision:2}]},{label:s("studio.transformModeControls.scale.label"),mode:"scale",items:[{title:s("studio.transformModeControls.scale.width"),setAttribute:sh(e,"sizeX"),getAttribute:()=>e.sizeX,stepPrecision:1,precision:2},{title:s("studio.transformModeControls.scale.height"),setAttribute:sh(e,"sizeY"),getAttribute:()=>e.sizeY,stepPrecision:1,precision:2}]}];return(0,ei.jsx)(sc,{attributeConfig:n,selectedObject:e,mode:t,size:i,showHeight:!1})},sf=()=>(0,ei.jsx)("div",{className:"fixed bottom-28 max-w-full px-5",children:(0,ei.jsx)(sd,{size:"SMALL"})}),sx=()=>{let{t:e}=(0,ea.$G)(),[t,i]=(0,es.useState)(null),[s,n]=(0,es.useState)(null),[o,r]=(0,es.useState)(null),[a,l]=(0,es.useState)(null);if((0,es.useEffect)(()=>{let e=D.Xi.subscribe(e=>{if(!e)return void i(null);e.id!==(null==t?void 0:t.id)&&(i(e),D.fK.next(["translate","local"]))});return()=>{e.unsubscribe()}}),(0,es.useEffect)(()=>{let e=D.rB.subscribe(e=>{if(!e)return void n(null);e.id!==(null==s?void 0:s.id)&&(n(e),D.fK.next(["translate","world"]))});return()=>{e.unsubscribe()}}),(0,es.useEffect)(()=>{let e=D.E3.subscribe(e=>{if(!e)return void r(null);e.id!==(null==o?void 0:o.id)&&(r(e),D.fK.next(["translate","world"]))});return()=>{e.unsubscribe()}}),(0,es.useEffect)(()=>{let e=D.sT.subscribe(e=>{if(!e)return void l(null);e.id!==(null==a?void 0:a.id)&&(l(e),D.fK.next(["translate","local"]))});return()=>{e.unsubscribe()}}),null===t&&null===s&&null===o&&null===a)return null;let d=e("studio.userModelView.title");return o?d+=" "+tf(o):s?d+=" "+tg(s):a&&(d+=" Solar Panel"),(0,ei.jsxs)("div",{className:"p-5 bg-grey-600 shadow-[0px_-6px_14px_0_rgba(0,0,0,0.25)]",children:[(0,ei.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,ei.jsx)("h2",{className:"text-base text-white font-bold pb-2.5",children:d}),(0,ei.jsx)(tc.Z,{className:"h-5 w-5 cursor-pointer",onClick:()=>{L.bS.next("reset-selection")}})]}),(0,ei.jsx)(sd,{size:"LARGE"})]})};var sw=i(55426);function sb({data:e}){let{t}=(0,ea.$G)(),[i,s]=(0,es.useState)(!1),{onConfirm:n,onCancel:o,show:r=!1}=e||{},[a]=(0,e8.Z)("Activating Project");(0,es.useEffect)(()=>{s(!r)},[r]);let l=e=>{var t,i,o,r;return t=this,i=void 0,o=void 0,r=function*(){e.preventDefault(),s(!0),yield null==n?void 0:n()},new(o||(o=Promise))(function(e,s){function n(e){try{l(r.next(e))}catch(e){s(e)}}function a(e){try{l(r.throw(e))}catch(e){s(e)}}function l(t){var i;t.done?e(t.value):((i=t.value)instanceof o?i:new o(function(e){e(i)})).then(n,a)}l((r=r.apply(t,i||[])).next())})};return(0,ei.jsx)(ta.u.Root,{show:r,as:es.Fragment,children:(0,ei.jsxs)(sw.V,{as:"div",className:"relative",onClose:()=>null==o?void 0:o(),children:[(0,ei.jsx)(ta.u.Child,{as:es.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,ei.jsx)("div",{className:"fixed inset-0 bg-grey-800 bg-opacity-70 backdrop-filter-map transition-all"})}),(0,ei.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,ei.jsx)("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:(0,ei.jsx)(ta.u.Child,{as:es.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:(0,ei.jsx)("form",{className:"group",onSubmit:l,children:(0,ei.jsxs)(sw.V.Panel,{className:"transform w-116 max-w-full overflow-hidden rounded-3xl text-left shadow-xl transition-all bg-grey-800 text-white divide-y divide-white/30",children:[(0,ei.jsxs)("div",{className:"relative p-6",children:[(0,ei.jsx)("div",{className:"absolute top-6 right-6",children:(0,ei.jsxs)("button",{type:"button",className:"text-white hover:text-gray-500 focus:outline-none",onClick:o,children:[(0,ei.jsx)("span",{className:"sr-only",children:t("studio.activationDialog.close")}),(0,ei.jsx)(tc.Z,{className:"h-6 w-6","aria-hidden":"true"})]})}),(0,ei.jsx)(sw.V.Title,{as:"h3",className:"text-3xl text-white",children:t("studio.activationDialog.title")}),(0,ei.jsx)("div",{className:"mt-6 text-sm",children:t("studio.activationDialog.description")}),(0,ei.jsx)("div",{className:"mt-6 text-sm",children:(0,ei.jsxs)("label",{children:[(0,ei.jsx)("input",{className:"mr-2 rounded bg-transparent checked:bg-transparent border-mint-200 focus:outline-none focus:shadow-none",type:"checkbox",required:!0}),t("studio.activationDialog.confirmation")," ",(0,ei.jsx)("a",{className:"underline",href:a,target:"_blank",children:t("studio.activationDialog.contactUs")})]})})]}),(0,ei.jsxs)("div",{className:"flex justify-between px-6 py-4",children:[(0,ei.jsx)("button",{type:"button",className:"flex items-center justify-center px-5 h-8 border-2 text-mint-200 border-mint-200 hover:text-neon-200 hover:border-neon-200 hover:bg-grey-800 disabled:bg-grey-800 disabled:border-grey-200 disabled:text-grey-200 text-sm font-bold rounded-full",onClick:o,disabled:i,children:t("studio.activationDialog.cancel")}),(0,ei.jsx)("button",{type:"submit",className:"rounded-full items-center justify-center px-5 h-8 text-grey-800 text-sm font-bold btn-gradient group-invalid:opacity-30",disabled:i,children:t("studio.activationDialog.confirm")})]})]})})})})})]})})}let sv=(e,t,i,s)=>{var n,o,r,a;return n=void 0,o=void 0,r=void 0,a=function*(){let n=yield x.g.token();if(!n)throw Error("No token present to make request");let o=JSON.stringify({project:{id:e,name:t,viewOnly:i,initialLocation:s}}),r=yield fetch("/.netlify/functions/update-studio-project-properties",{method:"POST",body:o,headers:{Authorization:`Bearer ${n}`}});if(!r.ok)throw Error((yield r.text()));return r.json()},new(r||(r=Promise))(function(e,t){function i(e){try{l(a.next(e))}catch(e){t(e)}}function s(e){try{l(a.throw(e))}catch(e){t(e)}}function l(t){var n;t.done?e(t.value):((n=t.value)instanceof r?n:new r(function(e){e(n)})).then(i,s)}l((a=a.apply(n,o||[])).next())})};var sy=i(66794),sC='<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M9.99999 3.125V12.5M9.99999 3.125L13.75 6.875M9.99999 3.125L6.25 6.875M16.875 10.625V15.2083C16.875 16.1288 16.1288 16.875 15.2083 16.875H4.79167C3.87119 16.875 3.125 16.1288 3.125 15.2083V10.625" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',sM='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">\n    <circle opacity="0.25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>\n    <path opacity="0.75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>\n</svg>\n      ',sS=i(71851),sL=function(e,t,i,s){return new(i||(i=Promise))(function(n,o){function r(e){try{l(s.next(e))}catch(e){o(e)}}function a(e){try{l(s.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(r,a)}l((s=s.apply(e,t||[])).next())})};let sT={show:!1,onConfirm:()=>{},onCancel:()=>{}},sj=({setEditable:e})=>{let{t}=(0,ea.$G)(),[i,s]=(0,es.useState)(sT),[n,o]=(0,es.useState)(!1);return(0,es.useEffect)(()=>{let e=(0,d.a)([L.yX,D.ic,L.R9]).subscribe(([e,t,i])=>{if(e){let i=(null==t?void 0:t.filter(e=>!1===e.viewOnly))||[];o(Math.max(0,e.studioProjectLimit-i.length)>0)}});return()=>e.unsubscribe()}),(0,ei.jsxs)("div",{className:"flex flex-col items-center mt-4 bg-grey-800/60 p-4 rounded-lg",children:[(0,ei.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"red",children:[(0,ei.jsx)("path",{d:"M23.0901 9.66C23.0001 9.54 18.2001 4 12.0001 4C8.00011 4 4.00011 6.22 0.910111 9.66C0.326863 10.2978 0.00341797 11.1307 0.00341797 11.995C0.00341797 12.8593 0.326863 13.6922 0.910111 14.33C5.37011 19.25 9.79011 20 12.0001 20C14.2101 20 18.6701 19.21 23.0901 14.33C23.6734 13.6922 23.9968 12.8593 23.9968 11.995C23.9968 11.1307 23.6734 10.2978 23.0901 9.66ZM21.6101 13C21.5101 13.12 17.2101 18.13 12.0001 18C7.07011 17.88 3.48011 14.2 2.38011 13C2.12994 12.7271 1.99117 12.3702 1.99117 12C1.99117 11.6298 2.12994 11.2729 2.38011 11C4.75011 8.4 8.33011 5.92 12.0001 6C16.4301 5.9 20.4201 9.7 21.6101 11C21.8624 11.2719 22.0027 11.6291 22.0027 12C22.0027 12.3709 21.8624 12.7281 21.6101 13Z",fill:"url(#paint0_linear_2619_8313_1)"}),(0,ei.jsx)("path",{d:"M12 8H11.61C11.5675 8.00429 11.5268 8.01942 11.4917 8.04393C11.4567 8.06844 11.4286 8.10151 11.41 8.14C11.3881 8.17801 11.3765 8.22112 11.3765 8.265C11.3765 8.30888 11.3881 8.352 11.41 8.39C11.6108 8.69092 11.7262 9.04066 11.7439 9.40197C11.7616 9.76328 11.681 10.1226 11.5107 10.4418C11.3404 10.7609 11.0866 11.0279 10.7766 11.2142C10.4665 11.4006 10.1117 11.4993 9.75 11.5C9.29423 11.4968 8.85322 11.338 8.5 11.05C8.46352 11.0289 8.42213 11.0178 8.38 11.0178C8.33787 11.0178 8.29648 11.0289 8.26 11.05C8.2193 11.0623 8.1828 11.0856 8.15456 11.1174C8.12631 11.1492 8.10743 11.1881 8.1 11.23C8.03893 11.4823 8.0054 11.7405 8 12C8 12.7911 8.2346 13.5645 8.67412 14.2223C9.11365 14.8801 9.73836 15.3928 10.4693 15.6955C11.2002 15.9983 12.0044 16.0775 12.7804 15.9231C13.5563 15.7688 14.269 15.3878 14.8284 14.8284C15.3878 14.269 15.7688 13.5563 15.9231 12.7804C16.0775 12.0044 15.9983 11.2002 15.6955 10.4693C15.3928 9.73836 14.8801 9.11365 14.2223 8.67412C13.5645 8.2346 12.7911 8 12 8Z",fill:"url(#paint1_linear_2619_8313_1)"}),(0,ei.jsxs)("defs",{children:[(0,ei.jsxs)("linearGradient",{id:"paint0_linear_2619_8313_1",x1:"7.12645",y1:"5",x2:"11.0785",y2:"20.3556",gradientUnits:"userSpaceOnUse",children:[(0,ei.jsx)("stop",{stopColor:"#3BEDE3"}),(0,ei.jsx)("stop",{offset:"1",stopColor:"#528CAD"})]}),(0,ei.jsxs)("linearGradient",{id:"paint1_linear_2619_8313_1",x1:"10.375",y1:"8.5",x2:"13.1249",y2:"15.625",gradientUnits:"userSpaceOnUse",children:[(0,ei.jsx)("stop",{stopColor:"#3BEDE3"}),(0,ei.jsx)("stop",{offset:"1",stopColor:"#528CAD"})]})]})]}),(0,ei.jsx)("p",{className:"font-bold text-grey-50 mt-2",children:t("studio.project.viewOnlyHint.title")}),(0,ei.jsx)("p",{className:"text-xs text-grey-100 text-center mt-2",children:t("studio.project.viewOnlyHint.description")}),(0,ei.jsx)("button",{type:"button",className:"mt-4 flex items-center justify-center px-5 py-1 border-2 text-mint-200 border-mint-200 enabled:hover:text-neon-200 enabled:hover:border-neon-200 enabled:hover:bg-grey-800 disabled:opacity-30 text-sm font-bold rounded-full",onClick:()=>{s({show:!0,onConfirm:()=>sL(void 0,void 0,void 0,function*(){e(),s(Object.assign(Object.assign({},i),{show:!1}))}),onCancel:()=>{s(Object.assign(Object.assign({},i),{show:!1}))}})},disabled:!n,children:t("studio.project.viewOnlyHint.activateProject")}),(0,ei.jsx)(sb,{data:i})]})},sP=()=>{let{t:e}=(0,ea.$G)(),t=(0,tr.pw)(L.R9),i=[{icon:(0,ei.jsx)(ed.YC,{className:"w-5 h-5"}),text:e("studio.sidebarUpgradeInfo.items.3dModels")},{icon:(0,ei.jsx)(ed.Bq,{className:"w-5 h-5"}),text:e("studio.sidebarUpgradeInfo.items.analytics")},{icon:(0,ei.jsx)(ed.zW,{className:"w-5 h-5"}),text:e("studio.sidebarUpgradeInfo.items.multipleProjects")}];return(0,ei.jsxs)("div",{className:"mt-4 px-4 py-6 border-t border-grey-400 cursor-pointer",onClick:()=>{(0,eg.si)({roles:t,subscription:ef.K.STUDIO_PROJECT,trigger:"studio_sidebar_upgrade_ad"})},children:[(0,ei.jsx)("div",{className:"text-xs text-shadowmap-yellow mb-4",children:e("studio.sidebarUpgradeInfo.title")}),(0,ei.jsx)("div",{className:"font-bold flex flex-col gap-4",children:i.map((e,t)=>(0,ei.jsxs)("div",{className:"flex items-center gap-1",children:[e.icon,(0,ei.jsx)("div",{className:"leading-[1.35]",children:e.text}),(0,ei.jsx)(ed.mB,{className:"text-shadowmap-yellow w-[14px] h-[14px] mt-0.25 ml-1"})]},t))})]})},sE=()=>{let{t:e}=(0,ea.$G)(),t=(0,tr.pw)(D.pi),i=(0,tr.pw)(D.Vi.pipe((0,_.U)(e=>(0,sS.X)(e)))),s=(0,tr.pw)(D.Vi.pipe((0,_.U)(e=>null==e?void 0:e.viewOnly))),n=(0,tr.pw)(D.wD,!1),o=(0,tr.pw)(D.Kw,!1),[r,a]=(0,es.useState)(e("studio.save")),l=(0,tr.pw)(D.ry,!1),d=(0,tr.pw)(D.ws),h=(0,tr.pw)(L.R9),c=null==h?void 0:h.isGuest(),u=(0,eQ.Z)(D.Vi.pipe((0,_.U)(e=>(null==e?void 0:e.models.length)||0)),0);(0,es.useEffect)(()=>{o?a(e("studio.saving")):n?a(e("studio.save")):a(e("studio.saved"))},[o,n]);let p=(0,es.useCallback)(()=>n&&!o,[n,o]);if((0,sy.Z)(p,"You have unsaved changes, are you sure?"),!t)return null;let m=(e,t)=>sL(void 0,void 0,void 0,function*(){D.Kw.next(!0);let i=yield(0,D.UI)(e,t);return D.Kw.next(!1),i});return(0,ei.jsxs)("div",{className:"flex flex-col divide-y divide-white/30 h-full pt-tsafe-2.5 pb-bsafe-0",children:[(0,ei.jsxs)("div",{className:"p-4 w-full",children:[(0,ei.jsxs)("div",{className:"flex flex-col gap-3",children:[!d&&(0,ei.jsxs)("button",{className:"flex items-center cursor-pointer w-full h-8 bg-gradient-to-r text-mint-200 hover:border-neon-200 hover:text-neon-200 font-bold text-sm uppercase",onClick:e=>sL(void 0,void 0,void 0,function*(){e.stopPropagation(),n&&!o?L.y7.next({modal:H.o.UNSAVED_PROJECT_CHANGES,opts:{onConfirm:()=>sL(void 0,void 0,void 0,function*(){D.Kw.next(!0);let e=yield m(D.Vi.getValue(),!0);D.Kw.next(!1),e&&(0,D.BU)()}),onCancel:()=>{(0,D.BU)()}}}):(0,D.BU)()}),children:[(0,ei.jsx)(tc.Z,{className:"h-4 w-4 mr-2"}),e("studio.project.close")]}),(0,ei.jsxs)("div",{className:"flex items-center w-full text-white",children:[(null==h?void 0:h.isAllowedToUseStudio())?(0,ei.jsx)(ed.RO,{className:"h-6"}):(0,ei.jsx)(ed.gL,{className:"h-6"}),(0,ei.jsx)("div",{className:"flex-1 text-lg font-bold ml-2",children:i})]})]}),(0,ei.jsxs)("div",{className:"flex gap-2 mt-4 items-center",children:[(0,ei.jsx)("button",{className:"flex flex-1 min-w-0 items-center justify-center cursor-pointer w-full h-8 px-2 bg-gradient-to-r enabled:hover:bg-gradient-to-l from-sun-600 to-neon-500 rounded-full disabled:opacity-30 transition-opacity",onClick:e=>sL(void 0,void 0,void 0,function*(){var t;if(e.stopPropagation(),c)return void(0,eg.ms)({subscription:ef.K.FREE,trigger:"studio_project_save_button"});D.Kw.next(!0);let i=D.Vi.getValue(),s=yield m(i,!1);D.Kw.next(!1),s&&(null==(t=D.Vi.value)?void 0:t.id)===i.id&&D.Vi.next(Object.assign(Object.assign({},s),{hasChanges:!1}))}),disabled:!n||o,children:(0,ei.jsx)("div",{className:"text-grey-800 font-bold text-sm truncate",children:r})}),(0,ei.jsxs)("button",{className:"group flex items-center justify-center cursor-pointer px-3 h-8 bg-gradient-to-r border-2 border-mint-200 text-mint-200 hover:border-neon-200 hover:text-neon-200 hover:bg-grey-800 font-bold text-sm rounded-full disabled:opacity-30 transition-opacity",onClick:e=>sL(void 0,void 0,void 0,function*(){e.stopPropagation(),yield(0,D.JD)(h)}),disabled:l,children:[(0,ei.jsx)("div",{className:"h-5 w-5 mr-2 stroke-mint-200 group-hover:stroke-neon-200 group-disabled:animate-spin",dangerouslySetInnerHTML:{__html:l?sM:sC}}),e("studio.preview")]})]}),c&&(0,ei.jsxs)("div",{className:"bg-white rounded-lg text-grey-800 text-[12px] text-center p-4 mt-4 relative whitespace-pre-line",children:[(0,ei.jsx)("div",{className:"absolute -top-[7px] left-[75px] w-0 h-0 border-l-[7.5px] border-l-transparent border-r-[7.5px] border-r-transparent border-b-[7px] border-b-white"}),(0,ei.jsx)(ea.cC,{i18nKey:"studio.signUpRequiredBubble",components:{a:(0,ei.jsx)("span",{className:"font-semibold underline cursor-pointer",onClick:()=>{(0,eg.ms)({subscription:ef.K.FREE,trigger:"studio_unsaved_project_bubble"})}})}})]})]}),s?(0,ei.jsx)("div",{className:"p-4",children:(0,ei.jsx)(sj,{setEditable:()=>sL(void 0,void 0,void 0,function*(){var e;let t=D.Vi.getValue().id,i=yield sv(t,void 0,!1);if(i){let{updatedProject:s}=i;D.Vi.next(Object.assign(Object.assign({},s),{hasChanges:(null==(e=D.Vi.value)?void 0:e.hasChanges)||!1})),D.ic.next((D.ic.value||[]).map(e=>e.id===t?s:e))}})})}):(0,ei.jsxs)("div",{className:"flex flex-col overflow-y-auto flex-grow",children:[(0,ei.jsxs)("div",{className:"overflow-y-auto flex-grow",children:[(0,ei.jsxs)("div",{className:"p-4 flex flex-col gap-6",children:[((null==h?void 0:h.isAllowedToUseStudio())||u>0)&&(0,ei.jsx)("div",{children:(0,ei.jsx)(tR,{})}),(0,ei.jsx)("div",{children:(0,ei.jsx)(ty,{})}),(0,ei.jsx)("div",{children:(0,ei.jsx)(tL,{})})]}),!(null==h?void 0:h.isAllowedToUseStudio())&&(0,ei.jsx)(sP,{})]}),(0,ei.jsx)(sx,{})]})]})};var sA=i(36168),sD=function(e,t,i,s){return new(i||(i=Promise))(function(n,o){function r(e){try{l(s.next(e))}catch(e){o(e)}}function a(e){try{l(s.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(r,a)}l((s=s.apply(e,t||[])).next())})};let sO=({label:e,value:t,placeholder:i,onChange:s,onClick:n,buttonLabel:o,onButtonClick:r,disabled:a})=>{let l=(0,k.Z)();return(0,ei.jsxs)("div",{children:[(0,ei.jsx)("label",{htmlFor:l,className:"text-grey-100 text-sm",children:e}),(0,ei.jsxs)("div",{className:"mt-2 flex flex-row justify-between items-center",children:[(0,ei.jsx)("div",{className:"relative flex-1",children:(0,ei.jsx)("input",{type:"text",id:l,value:t,onChange:e=>s(e.target.value),onClick:n,className:"block w-full rounded-lg border-0 px-3 py-2 text-grey-700 bg-grey-50 hover:bg-grey-100 ring-1 ring-inset ring-grey-500 enabled:hover:ring-grey-300 placeholder:text-grey-400 enabled:focus:bg-grey-100 enabled:focus:ring-neon-300 disabled:opacity-30 transition-opacity",placeholder:i,disabled:a})}),o&&(0,ei.jsx)("button",{className:"rounded-full uppercase text-mint-200 border-mint-200 border-solid border-2 text-xs font-bold h-7 px-2.5 ml-2.5",onClick:r,children:o})]})]})},sk=({checked:e,onChange:t,disabled:i})=>{let{t:s}=(0,ea.$G)();return(0,ei.jsxs)(eN.r.Group,{as:"div",className:`flex items-center space-x-4 transition-opacity ${i&&"opacity-30"}`,children:[(0,ei.jsx)(eN.r.Label,{as:"span",className:"text-sm text-grey-100",passive:!0,children:(0,ei.jsxs)("div",{className:"flex space-x-2",children:[(0,ei.jsx)(sI,{}),(0,ei.jsx)("p",{children:s("studio.projectSettingsDialog.viewOnlyToggle.label")})]})}),(0,ei.jsx)(eN.r,{disabled:i,checked:e,onChange:t,className:`inline-flex p-[1px] enabled:cursor-pointer rounded-full transition-colors duration-200 ease-in-out ${e?"bg-gradient-to-t active:bg-gradient-to-b from-[#F8F991] to-[#FFCD00] enabled:hover:from-sun-100 enabled:hover:to-sun-100":"bg-grey-500 enabled:hover:bg-grey-300"}`,children:(0,ei.jsx)("div",{className:`inline-flex p-[3px] w-11 h-6 rounded-full items-center ${e?"bg-gradient-to-b active:bg-gradient-to-t from-[#F8F991] to-[#FFCD00]":"bg-grey-800 enabled:hover:bg-grey-700"}`,children:(0,ei.jsx)("div",{className:`inline-block transition duration-200 p-px ease-in-out rounded-full ${e?"translate-x-[100%] bg-gradient-to-t h-[19px] w-[19px] from-[#F8F991] to-[#FFCD00] shadow-sun-glow-toggle":"translate-x-0 bg-white h-[18px] w-[18px]"}`,children:(0,ei.jsx)("div",{"aria-hidden":"true",className:"pointer-events-none transform rounded-full w-full h-full bg-white ring-0"})})})})]})},sI=()=>(0,ei.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[(0,ei.jsx)("path",{d:"M23.0901 9.66C23.0001 9.54 18.2001 4 12.0001 4C8.00011 4 4.00011 6.22 0.910111 9.66C0.326863 10.2978 0.00341797 11.1307 0.00341797 11.995C0.00341797 12.8593 0.326863 13.6922 0.910111 14.33C5.37011 19.25 9.79011 20 12.0001 20C14.2101 20 18.6701 19.21 23.0901 14.33C23.6734 13.6922 23.9968 12.8593 23.9968 11.995C23.9968 11.1307 23.6734 10.2978 23.0901 9.66ZM21.6101 13C21.5101 13.12 17.2101 18.13 12.0001 18C7.07011 17.88 3.48011 14.2 2.38011 13C2.12994 12.7271 1.99117 12.3702 1.99117 12C1.99117 11.6298 2.12994 11.2729 2.38011 11C4.75011 8.4 8.33011 5.92 12.0001 6C16.4301 5.9 20.4201 9.7 21.6101 11C21.8624 11.2719 22.0027 11.6291 22.0027 12C22.0027 12.3709 21.8624 12.7281 21.6101 13Z",fill:"url(#paint0_linear_2413_6876)"}),(0,ei.jsx)("path",{d:"M12 8H11.61C11.5675 8.00429 11.5268 8.01942 11.4917 8.04393C11.4567 8.06844 11.4286 8.10151 11.41 8.14C11.3881 8.17801 11.3765 8.22112 11.3765 8.265C11.3765 8.30888 11.3881 8.352 11.41 8.39C11.6108 8.69092 11.7262 9.04066 11.7439 9.40197C11.7616 9.76328 11.681 10.1226 11.5107 10.4418C11.3404 10.7609 11.0866 11.0279 10.7766 11.2142C10.4665 11.4006 10.1117 11.4993 9.75 11.5C9.29423 11.4968 8.85322 11.338 8.5 11.05C8.46352 11.0289 8.42213 11.0178 8.38 11.0178C8.33787 11.0178 8.29648 11.0289 8.26 11.05C8.2193 11.0623 8.1828 11.0856 8.15456 11.1174C8.12631 11.1492 8.10743 11.1881 8.1 11.23C8.03893 11.4823 8.0054 11.7405 8 12C8 12.7911 8.2346 13.5645 8.67412 14.2223C9.11365 14.8801 9.73836 15.3928 10.4693 15.6955C11.2002 15.9983 12.0044 16.0775 12.7804 15.9231C13.5563 15.7688 14.269 15.3878 14.8284 14.8284C15.3878 14.269 15.7688 13.5563 15.9231 12.7804C16.0775 12.0044 15.9983 11.2002 15.6955 10.4693C15.3928 9.73836 14.8801 9.11365 14.2223 8.67412C13.5645 8.2346 12.7911 8 12 8Z",fill:"url(#paint1_linear_2413_6876)"}),(0,ei.jsxs)("defs",{children:[(0,ei.jsxs)("linearGradient",{id:"paint0_linear_2413_6876",x1:"7.12645",y1:"5",x2:"11.0785",y2:"20.3556",gradientUnits:"userSpaceOnUse",children:[(0,ei.jsx)("stop",{stopColor:"#3BEDE3"}),(0,ei.jsx)("stop",{offset:"1",stopColor:"#528CAD"})]}),(0,ei.jsxs)("linearGradient",{id:"paint1_linear_2413_6876",x1:"10.375",y1:"8.5",x2:"13.1249",y2:"15.625",gradientUnits:"userSpaceOnUse",children:[(0,ei.jsx)("stop",{stopColor:"#3BEDE3"}),(0,ei.jsx)("stop",{offset:"1",stopColor:"#528CAD"})]})]})]});function sN({show:e,canEnableProject:t,project:i,onProjectUpdated:s,onProjectArchived:n,onProjectActivated:o,onClose:r}){let[a,l]=(0,es.useState)(!1),[d,h]=(0,es.useState)(""),[c,u]=(0,es.useState)(i.viewOnly),[p,m]=(0,es.useState)(!1),{t:g}=(0,ea.$G)();(0,es.useEffect)(()=>{var t,s;l(!e),h(null!=(t=null==i?void 0:i.name)?t:""),u(null!=(s=null==i?void 0:i.viewOnly)&&s)},[e,i]),(0,es.useEffect)(()=>{let e=L.R9.subscribe(e=>{m(e.isAllowedToUseViewOnlyProjectsFeature())});return()=>e.unsubscribe()});let f=e=>sD(this,void 0,void 0,function*(){let t,i;if(e.name!==d&&(t=d),e.viewOnly!==c&&(i=c),void 0===t&&void 0===i)return void r();s((yield sv(e.id,t,i)).updatedProject)}),x=()=>sD(this,void 0,void 0,function*(){l(!0),null!==i&&(!0===i.viewOnly&&!1===c?yield o(i,f):yield f(i))}),w=()=>sD(this,void 0,void 0,function*(){null!==i&&(l(!0),yield n(i))});return(0,ei.jsx)(ta.u.Root,{show:e,as:es.Fragment,children:(0,ei.jsxs)(sw.V,{as:"div",className:"relative",onClose:r,children:[(0,ei.jsx)(ta.u.Child,{as:es.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,ei.jsx)("div",{className:"fixed inset-0 bg-grey-800 bg-opacity-70 backdrop-filter-map transition-all"})}),(0,ei.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,ei.jsx)("div",{className:"flex min-h-full items-center justify-center text-center p-4",children:(0,ei.jsx)(ta.u.Child,{as:es.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:(0,ei.jsxs)(sw.V.Panel,{className:"transform w-116 max-w-full overflow-hidden rounded-3xl text-left shadow-xl transition-all bg-grey-800 text-white divide-y divide-white/30",children:[(0,ei.jsxs)("div",{className:"relative p-6",children:[(0,ei.jsx)("div",{className:"absolute top-6 right-6",children:(0,ei.jsxs)("button",{type:"button",className:"text-white hover:text-gray-500 focus:outline-none",onClick:r,children:[(0,ei.jsx)("span",{className:"sr-only",children:g("studio.projectSettingsDialog.cancel")}),(0,ei.jsx)(tc.Z,{className:"h-6 w-6","aria-hidden":"true"})]})}),(0,ei.jsx)(sw.V.Title,{as:"h3",className:"text-3xl text-white",children:g("studio.projectSettingsDialog.title")}),(0,ei.jsxs)("div",{className:"mt-1 text-sm",children:[(0,ei.jsx)("div",{className:"mt-4",children:(0,ei.jsx)(sO,{label:g("studio.projectSettingsDialog.projectName.label"),placeholder:g("studio.projectSettingsDialog.projectName.placeholder"),value:d,onChange:e=>{h(e)},disabled:a})}),p&&(0,ei.jsxs)("div",{className:"mt-7",children:[(0,ei.jsx)(sk,{checked:c,onChange:u,disabled:!t&&i.viewOnly||a}),(0,ei.jsx)("p",{className:"text-grey-100 text-xs mt-4",children:g("studio.projectSettingsDialog.viewOnlyToggle.description")})]})]})]}),(0,ei.jsxs)("div",{className:"flex justify-between px-6 py-4 gap-4",children:[i.isFree?(0,ei.jsx)("div",{}):(0,ei.jsxs)("button",{type:"button",className:"flex items-center justify-center px-5 h-8 border-2 text-red-500 border-red-600 enabled:hover:text-white enabled:hover:border-white text-sm font-bold rounded-full disabled:opacity-30 transition-opacity",onClick:w,disabled:a,children:[(0,ei.jsx)(ed.XH,{className:"h-5 w-5 mr-2"}),g("studio.projectSettingsDialog.archive")]}),(0,ei.jsx)("button",{type:"button",className:"relative rounded-full items-center justify-center px-5 h-8 text-grey-800 text-sm font-bold btn-gradient disabled:opacity-30 transition-opacity",onClick:x,disabled:a||0===d.length,children:(0,ei.jsxs)(ei.Fragment,{children:[(0,ei.jsx)("p",{className:a?"opacity-0 transition-opacity":"",children:g("studio.projectSettingsDialog.saveChanges")}),(0,ei.jsx)("div",{className:`absolute inset-0 flex justify-center items-center ${!a?"opacity-0 transition-opacity":""}`,children:(0,ei.jsx)(tI.Z,{className:"h-5 w-5"})})]})})]})]})})})})]})})}let s_=()=>{let{t:e}=(0,ea.$G)(),[t,i]=(0,es.useState)(),[s,n]=(0,e8.Z)();return((0,es.useEffect)(()=>{let e=L.R9.subscribe(i);return()=>e.unsubscribe()},[]),t)?(0,ei.jsxs)("div",{className:"mt-4 rounded-lg p-4 bg-[#3d4a56] flex flex-row items-center gap-4 text-xs sticky bottom-0 shadow-[0_0_8px_16px_#4c5864,0_32px_8px_16px_#4c5864]",children:[(0,ei.jsx)(ed.hz,{}),(0,ei.jsxs)("div",{className:"flex flex-grow flex-col text-[12px] text-white",children:[(0,ei.jsx)("div",{children:e("studio.projectList.feedback.title")}),(0,ei.jsx)("a",{className:"text-[#A7F1ED] font-bold underline cursor-pointer",href:s,target:"_blank",children:e("studio.projectList.feedback.contact")})]})]}):null},sR=({openCreateProjectDialog:e,canCreateStudioProject:t,numberOfStudioProjects:i})=>{let{t:s}=(0,ea.$G)();return(0,ei.jsx)("button",{className:"group w-full flex-none relative border-[1.5px] border-mint-200 rounded-2xl overflow-clip hover:border-neon-200 bg-grey-800 cursor-pointer z-[1]",style:{boxShadow:"0px 1px 1px 0px rgba(0, 0, 0, 0.13), 0px 2px 4px 0px rgba(0, 0, 0, 0.15)"},onClick:e,children:(0,ei.jsxs)("div",{className:"relative py-14 px-4",children:[(0,ei.jsxs)("div",{className:"flex flex-col gap-1 items-center justify-center text-mint-200 font-bold text-base group-hover:text-neon-200 ",children:[(0,ei.jsx)(ed.zW,{className:"w-8"}),s("studio.projectList.createFirstProject")]}),t&&(0,ei.jsx)("div",{className:"text-xs text-white mt-2 text-center",children:s("studio.projectList.projectLimitText",{numberOfStudioProjects:i})})]})})},sV=({isFirstProject:e,hasStudioAccess:t,studioProjectLimit:i,noProjectSlotsAvailable:s})=>{let{t:n}=(0,ea.$G)(),o=(0,eQ.Z)(L.R9),r=i8.Z.isNativeiOS,[a,l]=(0,e8.Z)();if(!o)return null;let d=()=>{t?L.y7.next({modal:H.o.CREATE_STUDIO_PROJECT}):o&&(0,eg.si)({roles:o,subscription:ef.K.STUDIO_PROJECT,trigger:"studio_sidebar_create_project_button"})};if(e)return(0,ei.jsx)(sR,{openCreateProjectDialog:d,canCreateStudioProject:t,numberOfStudioProjects:i});let h=t&&s;return(0,ei.jsxs)("div",{className:eD()("group w-full overflow-hidden cursor-pointer",e?"rounded-2xl":"rounded-[20px]"),style:{boxShadow:"0px 1px 1px 0px rgba(0, 0, 0, 0.13), 0px 2px 4px 0px rgba(0, 0, 0, 0.15)"},onClick:()=>{h?r||L.y7.next({modal:H.o.STUDIO_UPGRADE_DIALOG}):d()},children:[(0,ei.jsx)("button",{className:eD()("w-full flex-none relative border-[1.5px] border-mint-200 bg-grey-800 z-[1]",e?"rounded-2xl":"rounded-[20px]",!r&&(h?"group-hover:border-shadowmap-yellow":"group-hover:border-neon-200")),children:h?(0,ei.jsxs)("div",{className:eD()("flex items-center justify-center w-full px-3 h-[37px] text-mint-200 font-bold text-[16px]",r?"opacity-50":"group-hover:text-shadowmap-yellow"),children:[(0,ei.jsx)(ed.J6,{className:"mr-1"}),n("studio.projectList.newProjectLocked")]}):(0,ei.jsxs)("div",{className:eD()("flex items-center justify-center w-full px-3 h-[37px] text-mint-200 group-hover:text-neon-200 font-bold text-[16px]"),children:[(0,ei.jsx)(ed.so,{className:"mr-2"}),n("studio.projectList.newProject")]})}),h&&(0,ei.jsxs)("div",{className:"w-full p-[30px_12px_16px_12px] bg-shadowmap-yellow rounded-b-[20px] rounded-t-0 shadow-[0px_1px_9px_0px_rgba(0,0,0,0.40)] text-[12px] text-black text-center transform translate-y-[-19px] mb-[-19px]",children:[(0,ei.jsx)("div",{className:"font-bold",children:n("studio.projectList.buyProjects.title")}),(0,ei.jsx)("div",{children:r?(0,ei.jsx)(ea.cC,{i18nKey:"studio.projectList.buyProjects.ctaAppStore",components:{a:(0,ei.jsx)("a",{href:a,target:"_blank",className:"link"})}}):n("studio.projectList.buyProjects.cta")})]})]})},sB=({project:e,openProjectSettingsDialog:t})=>{let i=(0,sS.X)(e),s=e.isDemo?"./img/demo_share_v2.png":`https://screenshots.shdw.mp/studioShares/${e.shareId}.jpg?time=${e.updatedAt}`;return(0,ei.jsx)("div",{className:"group flex flex-col items-end gap-2 cursor-pointer px-2 py-[10px] border transition-all hover:bg-grey-700/70 rounded-lg border-grey-400 hover:border-grey-100",onClick:t=>{var i,s,n,o;return i=void 0,s=void 0,n=void 0,o=function*(){t.stopPropagation(),(0,D.Y9)(e)},new(n||(n=Promise))(function(e,t){function r(e){try{l(o.next(e))}catch(e){t(e)}}function a(e){try{l(o.throw(e))}catch(e){t(e)}}function l(t){var i;t.done?e(t.value):((i=t.value)instanceof n?i:new n(function(e){e(i)})).then(r,a)}l((o=o.apply(i,s||[])).next())})},children:(0,ei.jsxs)("div",{className:"flex flex-col items-start w-full gap-2",children:[e.shareId&&(0,ei.jsx)("img",{className:"w-full aspect-[2.2] object-cover rounded-md",src:s,alt:`Thumbnail of ${i}`}),(0,ei.jsxs)("div",{className:"flex items-center w-full",children:[(0,ei.jsx)(ed.RO,{className:"w-6 h-6"}),(0,ei.jsx)("div",{className:"flex-1 text-base font-bold text-white ml-2",children:i}),!e.isDemo&&(0,ei.jsx)("div",{className:"w-11 h-full",children:(0,ei.jsx)("button",{className:"flex justify-center items-center w-full h-full text-mint-300 md:invisible group-hover:visible hover:text-white",onClick:e=>{e.stopPropagation(),t()},children:(0,ei.jsx)(ed.ew,{className:"h-5 w-5 ml-2"})})})]})]})})};var sU=function(e,t,i,s){return new(i||(i=Promise))(function(n,o){function r(e){try{l(s.next(e))}catch(e){o(e)}}function a(e){try{l(s.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(r,a)}l((s=s.apply(e,t||[])).next())})};let sF={show:!1,onConfirm:()=>{},onCancel:()=>{}},sZ=({show:e,children:t,className:i})=>(0,ei.jsx)(ta.u,{className:i,appear:!0,show:e,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:t}),sH=({title:e,count:t,max:i})=>(0,ei.jsx)(ek.O,{className:"flex-1 focus:outline-none",children:({selected:s})=>(0,ei.jsxs)("div",{className:`flex justify-center items-center p-2 font-bold rounded-full ${s?"bg-mint-200 text-grey-800":"hover:bg-grey-900"}`,children:[(0,ei.jsx)("p",{children:e}),(0,ei.jsx)("div",{className:`rounded-full text-xs ml-2 mt-0.5 min-w-[16px] leading-[15px] h-4 ${s?"bg-mint-50 text-grey-700":"bg-grey-800 text-grey-200"} ${i?"px-2":"px-1"}`,children:i?`${t}/${i}`:t})]})}),sG=({empty:e})=>{let{t}=(0,ea.$G)();return(0,ei.jsxs)("div",{className:"flex flex-col items-center mt-4 bg-grey-800/60 p-4 rounded-lg",children:[e?(0,ei.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"44",height:"44",viewBox:"0 0 44 44",fill:"none",children:[(0,ei.jsxs)("g",{clipPath:"url(#clip0_2623_9705)",children:[(0,ei.jsx)("path",{d:"M30.7804 18.0892L24.1063 14.2359C23.9508 14.1421 23.8383 13.991 23.793 13.8152C23.7477 13.6393 23.7732 13.4527 23.864 13.2955L27.344 7.26793C27.412 7.15262 27.5118 7.05943 27.6315 6.99961C27.7513 6.9398 27.8858 6.91591 28.0188 6.93084C28.1518 6.94578 28.2776 6.99888 28.3811 7.08375C28.4846 7.16863 28.5613 7.28164 28.602 7.40915C29.3816 9.84538 30.9592 14.713 31.7846 17.2833C31.8331 17.4168 31.8385 17.5621 31.8002 17.6989C31.762 17.8356 31.6818 17.957 31.5711 18.0458C31.4603 18.1347 31.3245 18.1867 31.1827 18.1945C31.0409 18.2023 30.9002 18.1655 30.7804 18.0892Z",fill:"#788591"}),(0,ei.jsx)("path",{d:"M20.9309 12.4019L14.2798 8.56187C14.1605 8.49145 14.0649 8.38687 14.0056 8.26163C13.9463 8.1364 13.9258 7.99625 13.9469 7.85928C13.968 7.72231 14.0296 7.5948 14.1239 7.49321C14.2181 7.39161 14.3407 7.32059 14.4757 7.28931C17.0913 6.70558 22.1186 5.65134 24.6067 5.10177C24.7386 5.073 24.876 5.08334 25.0021 5.13153C25.1282 5.17972 25.2374 5.26367 25.3165 5.37306C25.3956 5.48246 25.441 5.61256 25.4472 5.74739C25.4533 5.88222 25.42 6.01593 25.3513 6.13211L21.878 12.1481C21.7861 12.3073 21.6346 12.4235 21.457 12.4711C21.2794 12.5187 21.0901 12.4938 20.9309 12.4019Z",fill:"#788591"}),(0,ei.jsx)("path",{d:"M16.4118 28.8683C16.2787 28.979 16.109 29.0359 15.9361 29.0278C15.7632 29.0197 15.5995 28.9472 15.4773 28.8246C15.3552 28.7019 15.2833 28.538 15.2758 28.365C15.2684 28.1921 15.3259 28.0226 15.4371 27.8899L22.0238 16.4815C22.1181 16.3316 22.2662 16.2235 22.4377 16.1794C22.6092 16.1353 22.7911 16.1584 22.946 16.2441L29.7241 20.1574C29.8319 20.2181 29.9214 20.3065 29.9835 20.4134C30.0456 20.5204 30.078 20.642 30.0773 20.7656C30.0765 20.8893 30.0428 21.0105 29.9794 21.1167C29.9161 21.2229 29.8255 21.3102 29.7171 21.3697L16.4118 28.8683Z",fill:"#788591"}),(0,ei.jsx)("path",{d:"M12.9929 10.498L19.771 14.4113C19.9302 14.5032 20.0464 14.6547 20.094 14.8323C20.1416 15.0099 20.1167 15.1992 20.0248 15.3584L13.4381 26.7668C13.3788 26.9295 13.2608 27.0641 13.1073 27.1441C12.9538 27.2241 12.7759 27.2438 12.6086 27.1994C12.4413 27.1549 12.2967 27.0494 12.2032 26.9037C12.1097 26.758 12.0741 26.5826 12.1034 26.4119L11.912 11.0902C11.9088 10.9629 11.9407 10.8372 12.0042 10.7269C12.0677 10.6165 12.1603 10.5258 12.272 10.4646C12.3836 10.4035 12.5099 10.3742 12.6371 10.3801C12.7643 10.386 12.8874 10.4268 12.9929 10.498Z",fill:"#788591"}),(0,ei.jsx)("path",{d:"M13.5751 27.8626C13.7485 27.8914 13.9146 27.9541 14.0636 28.0472C14.2127 28.1403 14.3419 28.262 14.4438 28.4053C14.5457 28.5485 14.6182 28.7105 14.6573 28.8819C14.6963 29.0533 14.7011 29.2307 14.6713 29.4039C14.5885 29.6887 14.5696 29.9884 14.6161 30.2813C14.6625 30.5743 14.7731 30.8534 14.94 31.0986C15.788 32.2965 18.386 32.7033 20.475 33.0318C21.8375 33.144 23.1718 33.4825 24.4231 34.0334C28.0951 36.1534 27.1389 41.0361 27.0966 41.2427C27.0696 41.4236 27.0055 41.597 26.9086 41.7521C26.8116 41.9072 26.6837 42.0406 26.533 42.1442C26.3822 42.2478 26.2117 42.3192 26.0321 42.3541C25.8526 42.389 25.6678 42.3865 25.4892 42.3469C25.3524 42.3158 25.2207 42.2657 25.0979 42.1979C24.8385 42.0657 24.6295 41.8522 24.5029 41.59C24.3762 41.3279 24.3389 41.0315 24.3965 40.7461C24.3965 40.7461 25.0874 37.4961 23.0898 36.3428C22.1148 35.9794 21.0969 35.7436 20.0615 35.6413C17.3511 35.2158 14.2921 34.7275 12.7865 32.642C12.4161 32.1134 12.1591 31.5139 12.0316 30.8812C11.904 30.2486 11.9087 29.5963 12.0454 28.9655C12.0734 28.7927 12.1352 28.627 12.2272 28.478C12.3192 28.329 12.4397 28.1996 12.5818 28.0972C12.7238 27.9948 12.8847 27.9214 13.0551 27.8811C13.2256 27.8409 13.4022 27.8346 13.5751 27.8626Z",fill:"#788591"})]}),(0,ei.jsx)("defs",{children:(0,ei.jsx)("clipPath",{id:"clip0_2623_9705",children:(0,ei.jsx)("rect",{width:"32",height:"32",fill:"white",transform:"matrix(-0.866025 -0.5 -0.5 0.866025 43.8564 16)"})})})]}):(0,ei.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[(0,ei.jsx)("path",{d:"M23.0901 9.66C23.0001 9.54 18.2001 4 12.0001 4C8.00011 4 4.00011 6.22 0.910111 9.66C0.326863 10.2978 0.00341797 11.1307 0.00341797 11.995C0.00341797 12.8593 0.326863 13.6922 0.910111 14.33C5.37011 19.25 9.79011 20 12.0001 20C14.2101 20 18.6701 19.21 23.0901 14.33C23.6734 13.6922 23.9968 12.8593 23.9968 11.995C23.9968 11.1307 23.6734 10.2978 23.0901 9.66ZM21.6101 13C21.5101 13.12 17.2101 18.13 12.0001 18C7.07011 17.88 3.48011 14.2 2.38011 13C2.12994 12.7271 1.99117 12.3702 1.99117 12C1.99117 11.6298 2.12994 11.2729 2.38011 11C4.75011 8.4 8.33011 5.92 12.0001 6C16.4301 5.9 20.4201 9.7 21.6101 11C21.8624 11.2719 22.0027 11.6291 22.0027 12C22.0027 12.3709 21.8624 12.7281 21.6101 13Z",fill:"url(#paint0_linear_2619_8313)"}),(0,ei.jsx)("path",{d:"M12 8H11.61C11.5675 8.00429 11.5268 8.01942 11.4917 8.04393C11.4567 8.06844 11.4286 8.10151 11.41 8.14C11.3881 8.17801 11.3765 8.22112 11.3765 8.265C11.3765 8.30888 11.3881 8.352 11.41 8.39C11.6108 8.69092 11.7262 9.04066 11.7439 9.40197C11.7616 9.76328 11.681 10.1226 11.5107 10.4418C11.3404 10.7609 11.0866 11.0279 10.7766 11.2142C10.4665 11.4006 10.1117 11.4993 9.75 11.5C9.29423 11.4968 8.85322 11.338 8.5 11.05C8.46352 11.0289 8.42213 11.0178 8.38 11.0178C8.33787 11.0178 8.29648 11.0289 8.26 11.05C8.2193 11.0623 8.1828 11.0856 8.15456 11.1174C8.12631 11.1492 8.10743 11.1881 8.1 11.23C8.03893 11.4823 8.0054 11.7405 8 12C8 12.7911 8.2346 13.5645 8.67412 14.2223C9.11365 14.8801 9.73836 15.3928 10.4693 15.6955C11.2002 15.9983 12.0044 16.0775 12.7804 15.9231C13.5563 15.7688 14.269 15.3878 14.8284 14.8284C15.3878 14.269 15.7688 13.5563 15.9231 12.7804C16.0775 12.0044 15.9983 11.2002 15.6955 10.4693C15.3928 9.73836 14.8801 9.11365 14.2223 8.67412C13.5645 8.2346 12.7911 8 12 8Z",fill:"url(#paint1_linear_2619_8313)"}),(0,ei.jsxs)("defs",{children:[(0,ei.jsxs)("linearGradient",{id:"paint0_linear_2619_8313",x1:"7.12645",y1:"5",x2:"11.0785",y2:"20.3556",gradientUnits:"userSpaceOnUse",children:[(0,ei.jsx)("stop",{stopColor:"#3BEDE3"}),(0,ei.jsx)("stop",{offset:"1",stopColor:"#528CAD"})]}),(0,ei.jsxs)("linearGradient",{id:"paint1_linear_2619_8313",x1:"10.375",y1:"8.5",x2:"13.1249",y2:"15.625",gradientUnits:"userSpaceOnUse",children:[(0,ei.jsx)("stop",{stopColor:"#3BEDE3"}),(0,ei.jsx)("stop",{offset:"1",stopColor:"#528CAD"})]})]})]}),(0,ei.jsx)("p",{className:"font-bold text-grey-50 mt-2",children:t(e?"studio.projectList.viewOnly.title_empty":"studio.projectList.viewOnly.title")}),(0,ei.jsx)("p",{className:"text-xs text-grey-100 text-center mt-2",children:t(e?"studio.projectList.viewOnly.description_empty":"studio.projectList.viewOnly.description")})]})},sz=({className:e})=>{let{t}=(0,ea.$G)(),i=(0,eQ.Z)(P.Y),s={show:!1,title:t("studio.archiveProjectDialog.title"),body:t("studio.archiveProjectDialog.body"),confirmText:t("studio.archiveProjectDialog.confirm"),cancelText:t("studio.archiveProjectDialog.cancel"),onConfirm:()=>{},onCancel:()=>{}},[n,o]=(0,es.useState)(!1),[r,a]=(0,es.useState)(void 0),[l,d]=(0,es.useState)(0),[h,c]=(0,es.useState)(s),[u,p]=(0,es.useState)(sF),[m,g]=(0,es.useState)(!1),[f,w]=(0,es.useState)(null),[b,v]=(0,es.useState)(!1),[y,C]=(0,es.useState)(!1);(0,tr.pw)(L.R9),(0,es.useEffect)(()=>{let e=L.R9.subscribe(e=>{o(e.isAllowedToUseStudio()),v(e.hasFullStudioAccess()),C(e.isStudioProjectsUser())});return()=>e.unsubscribe()}),(0,es.useEffect)(()=>{let e=D.ic.subscribe(a);return()=>e.unsubscribe()}),(0,es.useEffect)(()=>{let e=L.yX.subscribe(e=>{d(e?e.studioProjectLimit:0)});return()=>e.unsubscribe()});let M=e=>()=>{g(!0),w(e)},S=void 0===r,T=(null==r?void 0:r.filter(e=>e.isDemo))||[],j=(null==r?void 0:r.filter(e=>!e.viewOnly&&!e.isDemo))||[],E=(null==r?void 0:r.filter(e=>e.viewOnly))||[],A=void 0!==j&&0===j.length,O=void 0!==j&&j.length>0,k=l?Math.max(0,l-j.length):0;return(0,ei.jsx)("div",{className:`flex flex-col divide-y divide-white/30 h-full pt-tsafe-2.5 pb-bsafe-6 overflow-y-auto ${e}`,children:(0,ei.jsxs)("div",{className:"p-4 pb-0 flex-grow flex flex-col",children:[(0,ei.jsxs)("div",{className:"mt-1 text-white flex flex-row items-center gap-[10px]",children:[(0,ei.jsx)("div",{className:"font-bold text-lg",children:t("studio.projectList.title")}),y&&(0,ei.jsxs)("div",{className:"rounded-full text-[12px] h-4 px-2 bg-grey-500 leading-none flex items-center mt-0.5",children:[j.length,"/",l]})]}),(0,ei.jsxs)("div",{className:"mt-4 flex-grow flex flex-col",children:[(0,ei.jsx)(sZ,{show:S,className:"text-center",children:(0,ei.jsx)(tI.Z,{className:"w-8 h-8"})}),(0,ei.jsx)(sZ,{show:T.length>0&&A,className:"",children:!i&&T.length>0&&(0,ei.jsx)("div",{className:"mb-4",children:(0,ei.jsx)(sB,{project:T[0],openProjectSettingsDialog:M(T[0]),hasFullStudioAccess:b},T[0].id)})}),(0,ei.jsx)(sZ,{show:A,className:"flex flex-grow flex-col",children:(0,ei.jsx)(sV,{isFirstProject:!0,studioProjectLimit:l||0,noProjectSlotsAvailable:l>0&&k<=0,hasStudioAccess:n})}),(0,ei.jsx)(sZ,{show:O,className:"flex-grow flex flex-col",children:(0,ei.jsxs)(ek.O.Group,{children:[(0,ei.jsx)(ek.O.List,{className:"flex gap-0.5",children:b&&!y&&(0,ei.jsxs)("div",{className:"mb-4",children:[(0,ei.jsx)(sH,{title:t("studio.projectList.tabs.active"),count:j.length,max:l}),(0,ei.jsx)(sH,{title:t("studio.projectList.tabs.viewOnly"),count:E.length})]})}),(0,ei.jsxs)(ek.O.Panels,{className:"flex-grow flex flex-col",children:[(0,ei.jsxs)(ek.O.Panel,{className:"flex-grow flex flex-col",children:[(0,ei.jsx)(sV,{isFirstProject:!1,studioProjectLimit:l||0,noProjectSlotsAvailable:k<=0,hasStudioAccess:n}),(0,ei.jsx)("div",{className:"mt-4 flex flex-col gap-4 flex-grow",children:[...j,...T].map(e=>(0,ei.jsx)(sB,{project:e,openProjectSettingsDialog:M(e),hasFullStudioAccess:b},e.id))})]}),(0,ei.jsxs)(ek.O.Panel,{children:[(0,ei.jsx)(sG,{empty:0===E.length}),(0,ei.jsx)("div",{className:"mt-4 flex flex-col gap-2",children:E.map(e=>(0,ei.jsx)(sB,{project:e,openProjectSettingsDialog:M(e),hasFullStudioAccess:b},e.id))})]})]})]})}),n&&(0,ei.jsx)(s_,{})]}),(0,ei.jsx)(sA.Z,{data:h}),(0,ei.jsx)(sb,{data:u}),null!=f&&(0,ei.jsx)(sN,{show:m,canEnableProject:k>0,project:f,onProjectUpdated:e=>{g(!1),w(e),r&&D.ic.next(r.map(t=>t.id===e.id?e:t))},onProjectArchived:e=>{c(t=>Object.assign(Object.assign({},t),{show:!0,onConfirm:()=>sU(void 0,void 0,void 0,function*(){var t,i,s,n,o;yield(t=e.id,i=void 0,s=void 0,n=void 0,o=function*(){let e=yield x.g.token();if(!e)throw Error("No token present to make request");let i=JSON.stringify({project:{id:t}}),s=yield fetch("/.netlify/functions/archive-studio-project",{method:"POST",body:i,headers:{Authorization:`Bearer ${e}`}});if(!s.ok)throw Error((yield s.text()));return s.json()},new(n||(n=Promise))(function(e,t){function r(e){try{l(o.next(e))}catch(e){t(e)}}function a(e){try{l(o.throw(e))}catch(e){t(e)}}function l(t){var i;t.done?e(t.value):((i=t.value)instanceof n?i:new n(function(e){e(i)})).then(r,a)}l((o=o.apply(i,s||[])).next())})),g(!1),w(e),r&&D.ic.next(r.filter(t=>t.id!==e.id)),c(Object.assign(Object.assign({},h),{show:!1}))}),onCancel:()=>{c(Object.assign(Object.assign({},h),{show:!1}))}}))},onProjectActivated:(e,t)=>{p({show:!0,onConfirm:()=>sU(void 0,void 0,void 0,function*(){t(e),p(Object.assign(Object.assign({},u),{show:!1}))}),onCancel:()=>{p(Object.assign(Object.assign({},u),{show:!1}))}})},onClose:()=>{g(!1)}})]})})},sW=()=>{var e;let{t}=(0,ea.$G)(),i=(0,tr.pw)(D.ws),s=(0,eQ.Z)(L.R9);return(0,ei.jsx)("div",{className:"flex flex-col divide-y divide-white/30 h-full pt-tsafe-2.5 pb-bsafe-0",children:(0,ei.jsxs)("div",{className:"p-4 w-full flex flex-col h-full",children:[(0,ei.jsxs)("div",{className:"flex flex-col gap-3",children:[!i&&(0,ei.jsxs)("button",{className:"flex items-center cursor-pointer w-full h-8 bg-gradient-to-r text-mint-200 hover:border-neon-200 hover:text-neon-200 font-bold text-sm uppercase",onClick:e=>{var t,i,s,n;return t=void 0,i=void 0,s=void 0,n=function*(){e.stopPropagation(),(0,D.BU)()},new(s||(s=Promise))(function(e,o){function r(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(t){var i;t.done?e(t.value):((i=t.value)instanceof s?i:new s(function(e){e(i)})).then(r,a)}l((n=n.apply(t,i||[])).next())})},children:[(0,ei.jsx)(tc.Z,{className:"h-4 w-4 mr-2"}),t("studio.project.close")]}),(0,ei.jsxs)("div",{className:"flex items-center w-full text-white",children:[(null==s?void 0:s.isAllowedToUseStudio())?(0,ei.jsx)(ed.RO,{className:"h-6"}):(0,ei.jsx)(ed.vZ,{className:"h-6"}),(0,ei.jsx)("div",{className:"flex-1 text-lg font-bold ml-2",children:null==(e=D.SH.getValue())?void 0:e.name})]})]}),(0,ei.jsx)("div",{className:"flex-grow flex justify-center items-center",children:(0,ei.jsx)("div",{className:"h-6 w-6 animate-spin",dangerouslySetInnerHTML:{__html:sM}})})]})})};var sX=()=>{let e=(0,eQ.Z)(D.NH),t=(0,eQ.Z)(D.LP),i=(0,eQ.Z)(D.Do);return(0,ei.jsx)("aside",{id:"side-panel-studio",className:eD()("top-0 left-0 right-12 md:w-80 bg-grey-700 bg-opacity-90 backdrop-filter-map shadow text-white fixed h-full ease-in-out duration-300 -translate-x-full",i?"translate-x-0":"translate-x-[calc(-100%-24px)]"),children:(0,ei.jsxs)("div",{className:"w-full h-full relative",children:[(0,ei.jsx)("div",{onClick:()=>{D.Do.next(!1)},className:"group cursor-pointer h-[46px] w-[46px] rounded-full flex justify-center items-center transition-all btn-gradient absolute right-0 top-tsafe-2.5 transform translate-x-1/2 z-[2]",children:(0,ei.jsx)(ed.wy,{})}),(0,ei.jsx)(sz,{className:e||t?"hidden":""}),t?(0,ei.jsx)(sW,{}):(0,ei.jsx)(sE,{})]})})},sY=i(81275),s$=i(58017),sQ=function(e,t,i,s){return new(i||(i=Promise))(function(n,o){function r(e){try{l(s.next(e))}catch(e){o(e)}}function a(e){try{l(s.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(r,a)}l((s=s.apply(e,t||[])).next())})};let sq=()=>{let{t:e}=(0,ea.$G)();return(0,ei.jsxs)("div",{className:"flex flex-col items-center bg-grey-800 rounded-lg p-4",children:[(0,ei.jsx)("div",{className:"h-8 w-8",dangerouslySetInnerHTML:{__html:'<svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M16 5V20M16 5L22 11M16 5L10 11M27 17V24.3333C27 25.8061 25.8061 27 24.3333 27H7.66667C6.19391 27 5 25.8061 5 24.3333V17" stroke="url(#paint0_linear_4298_12108)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n<defs>\n<linearGradient id="paint0_linear_4298_12108" x1="28.4103" y1="5" x2="4.30042" y2="15.9935" gradientUnits="userSpaceOnUse">\n<stop stop-color="#F8F991"/>\n<stop offset="1" stop-color="#FFCD00"/>\n</linearGradient>\n</defs>\n</svg>\n'}}),(0,ei.jsx)("h3",{className:"font-bold text-base text-grey-50 mb-2",children:e("studio.previewDialog.previewTitle")}),(0,ei.jsx)("p",{className:"text-[12px] text-grey-50",children:e("studio.previewDialog.previewText")})]})},sK=({titleIcon:e,title:t,description:i,shareContent:s,copySuccessMessage:n,copyButtonLabel:o})=>{let r=(0,es.useRef)(null),a=()=>{r.current&&r.current.select()};return(0,ei.jsxs)(ei.Fragment,{children:[(0,ei.jsxs)("h3",{className:"inline-flex items-center gap-x-1 h-12 font-bold text-base text-grey-50",children:[(0,ei.jsx)("span",{className:"h-5 w-5 stroke-white",dangerouslySetInnerHTML:{__html:e}}),t]}),(0,ei.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,ei.jsx)("p",{className:"text-[12px] text-grey-50",children:i}),(0,ei.jsx)("input",{ref:r,className:"flex-grow text-grey-100 bg-grey-800 ring-grey-500 overflow-hidden text-ellipsis whitespace-nowrap border-none rounded-lg focus:ring-2 focus:ring-mint-200",type:"text",value:s,onFocus:a,onClick:a,readOnly:!0}),(0,ei.jsx)("button",{className:"flex items-center justify-center cursor-pointer h-8 px-2 bg-gradient-to-r border-2 border-mint-200 text-mint-200 hover:border-neon-200 hover:text-neon-200 hover:bg-grey-800 font-bold text-sm rounded-full",onClick:()=>sQ(void 0,void 0,void 0,function*(){"clipboard"in navigator?navigator.clipboard.writeText(s):document.execCommand("copy",!0,s),L.eE.next({id:(0,k.Z)(),shortText:n,longText:n,disappear:!0})}),children:(0,ei.jsx)("span",{children:o})})]})]})},sJ=()=>{let{t:e}=(0,ea.$G)(),[t,i]=(0,es.useState)(e("studio.previewDialog.update")),[s,n]=(0,es.useState)(!1),[o,r]=(0,es.useState)(!1),[a,l]=(0,es.useState)();if((0,es.useEffect)(()=>{let e=em.Us.subscribe(l);return()=>e.unsubscribe()}),(0,es.useEffect)(()=>{let t=em.IN.subscribe(t=>{r(t),!s&&t&&i(e("studio.previewDialog.update"))});return()=>t.unsubscribe()},[a]),!a)return null;let d=t=>sQ(void 0,void 0,void 0,function*(){return i(e("studio.previewDialog.updating")),n(!0),new Promise(s=>{L.Nv.next({callback:o=>sQ(void 0,void 0,void 0,function*(){let r=yield(0,D.xL)(t);yield(0,sY.l)(t.shareId,o);try{let{updatedShare:t}=yield(0,s$.g)(r);i(e("studio.previewDialog.updated")),em.Us.value&&em.Us.next(Object.assign(Object.assign({},t),{hasChanges:!1})),s(t)}catch(t){console.error(t),alert(e("studio.genericError")),i(e("studio.previewDialog.update"))}n(!1)})})})});return s||a.location||d(a),(0,ei.jsx)("button",{className:"flex flex-1 min-w-0 items-center justify-center cursor-pointer w-full h-8 px-2 bg-gradient-to-r enabled:hover:bg-gradient-to-l from-sun-600 to-neon-500 rounded-full disabled:opacity-30 transition-opacity",onClick:e=>sQ(void 0,void 0,void 0,function*(){e.stopPropagation(),yield d(a)}),disabled:!o||s,children:(0,ei.jsx)("div",{className:"text-grey-800 font-bold text-sm truncate",children:t})})};var s1=()=>{let{t:e}=(0,ea.$G)(),t=(0,eQ.Z)(em.Us),[i,s]=(0,es.useState)(!1);if((0,es.useEffect)(()=>{let e=em.Mm.pipe((0,u.T)(1)).subscribe(e=>{e?(D.Do.next(!1),s(!0)):(D.Do.next(!0),s(!1))});return()=>e.unsubscribe()},[]),!i||!t)return null;let n={titleIcon:sC,title:e("studio.previewDialog.shareProject"),description:e("studio.previewDialog.shareDescription"),shareContent:`${window.location.origin}/share/${t.shareId}`,copySuccessMessage:e("studio.previewDialog.shareLinkCopied"),copyButtonLabel:e("studio.previewDialog.copyLink")},o={titleIcon:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M8.12516 16.875L11.8752 3.125M15.2085 6.45833L17.2517 8.62928C17.9765 9.39939 17.9765 10.6006 17.2517 11.3707L15.2085 13.5417M4.79183 13.5417L2.7486 11.3707C2.0238 10.6006 2.02379 9.39939 2.74859 8.62928L4.79183 6.45833" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',title:e("studio.previewDialog.embedProject"),description:e("studio.previewDialog.embedDescription"),shareContent:`<iframe src="${window.location.origin}/share/${t.shareId}" title="Shadowmap Studio"></iframe>`,copySuccessMessage:e("studio.previewDialog.embedLinkCopied"),copyButtonLabel:e("studio.previewDialog.copyHTML")};return(0,ei.jsx)("aside",{className:eD()("top-0 left-0 w-full md:w-80 bg-grey-700 bg-opacity-90 backdrop-filter-map shadow text-white fixed h-full ease-in-out duration-300 transition-transform translate-x-0"),children:(0,ei.jsx)("div",{className:"w-full h-full",children:(0,ei.jsxs)("div",{className:"divide-y divide-white/30 pt-4 flex flex-col h-full",children:[(0,ei.jsxs)("div",{className:"flex flex-col gap-2 px-4 pb-4",children:[(0,ei.jsxs)("button",{className:"flex items-center cursor-pointer w-full h-8 bg-gradient-to-r text-mint-200 hover:border-neon-200 hover:text-neon-200 font-bold text-sm uppercase",onClick:()=>{em.Us.next(void 0)},children:[(0,ei.jsx)("div",{className:"h-4 w-4 mr-2 flex items-center",children:(0,ei.jsx)(ed.Wg,{})}),e("studio.previewDialog.back")]}),(0,ei.jsx)(sq,{}),(0,ei.jsx)("div",{children:(0,ei.jsx)(sJ,{})})]}),t.location&&(0,ei.jsxs)("div",{className:"overflow-y-auto",children:[(0,ei.jsx)("div",{className:"px-4 pt-2 pb-4",children:(0,ei.jsx)(sK,Object.assign({},n))}),(0,ei.jsx)("div",{className:"px-4 pt-2",children:(0,ei.jsx)(sK,Object.assign({},o))})]})]})})})},s0=()=>{let e=(0,eQ.Z)(D.Do);return(0,ei.jsx)("div",{className:eD()("md:hidden absolute inset-0 bg-grey-700/30 backdrop-filter-map",{hidden:!e}),onClick:()=>{D.Do.next(!1)}})},s2=()=>{let[e,t]=(0,es.useState)(!1);return((0,es.useEffect)(()=>{let e=D.dG.subscribe(t);return()=>{e.unsubscribe()}},[]),e)?(0,ei.jsx)("div",{className:"absolute bottom-28 max-w-full px-5",children:(0,ei.jsx)("button",{type:"button",className:"flex items-center justify-center w-[200px] h-8 px-5 border-2 text-mint-200 border-mint-200 enabled:bg-grey-800/90 enabled:hover:text-neon-200 enabled:hover:border-neon-200 enabled:hover:bg-grey-800 disabled:opacity-30 transition-opacity text-sm leading-4 font-bold rounded-full",onClick:()=>{D.dG.next(!1),(0,el.rA)()&&D.Do.next(!0)},children:(0,N.t)("studio.customShapes.cancel")})}):null},s5=()=>{let e=(0,eQ.Z)(D.Zr.pipe((0,_.U)(e=>e.length)),0),t=(0,eQ.Z)(ep.UW.pipe((0,_.U)(e=>e===ep.BS.Analytics))),i=(0,eQ.Z)(D.Mg);return t&&i&&0!==e?(0,ei.jsxs)("div",{className:"fixed bottom-[36px] left-1/2 transform -translate-x-1/2 z-50 px-4 pt-2 py-4 bg-white bg-opacity-80 backdrop-blur-[5px] rounded-2xl w-[360px]",style:{boxShadow:"0px 2px 2px 0px rgba(0, 0, 0, 0.10)"},children:[(0,ei.jsxs)("div",{className:"flex flex-row justify-between text-[16px] text-grey-800 items-center",children:[(0,ei.jsx)("div",{className:"mt-[5px]",children:"Annual PV panel yield"}),(0,ei.jsxs)("div",{children:[(0,ei.jsx)("span",{className:"font-bold text-[24px]",children:Math.round(i.total/1e3).toLocaleString()})," ","kWh"]})]}),(0,ei.jsxs)("div",{className:"text-xs text-grey-500",children:[e," ",1===e?"Panel":"Panels"]})]}):null},s3=i(2516);let s4=()=>!!window.google&&!!window.google.accounts&&!!window.google.accounts.id;var s8=i(60564);class s9 extends es.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,t){let i=s8.Tb(e,{contexts:{react:{componentStack:t.componentStack}},tags:{section:"react"}});P.n.onErrorScreenShow(i),this.setState({eventId:i})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:(0,ei.jsx)(s7,{eventId:this.state.eventId}):this.props.children}}let s7=({eventId:e})=>{let{t}=(0,ea.$G)();return(0,ei.jsx)("div",{className:"flex items-center justify-center min-h-screen text-black bg-white w-full select-and-touch-all",children:(0,ei.jsxs)("div",{className:"max-w-md mx-auto text-center",children:[(0,ei.jsx)("h2",{className:"text-2xl font-bold mb-4",children:t("errorBoundary.title")}),(0,ei.jsx)("p",{className:"mb-6",children:t("errorBoundary.message")}),(0,ei.jsx)("button",{onClick:()=>window.location.reload(),className:"hover:bg-shadowmap-yellow-hover bg-shadowmap-yellow font-bold py-2 px-4 rounded-full text-black",children:t("errorBoundary.reloadButton")}),e&&(0,ei.jsx)("p",{className:"text-xs text-gray-500 mt-4",children:t("errorBoundary.errorId",{eventId:e})})]})})};var s6=()=>{let{t:e}=(0,ea.$G)(),t=(0,eQ.Z)(e1.Yy),i=(0,eQ.Z)(L.R9);return t&&i?(0,ei.jsxs)("div",{className:"map-preview-border text-black",children:[(0,ei.jsx)("div",{className:"absolute top-[-1px] left-[-1px] w-[calc(100%+2px)] flex flex-row justify-center",children:(0,ei.jsxs)("div",{className:"flex flex-row justify-center items-center gap-6 text-[14px] max-w-full bg-shadowmap-yellow pointer-events-auto sm:rounded-b-[16px] w-full sm:w-auto p-[2px_2px_9px_2px] sm:p-[6px_10px_9px_15px]",children:[(0,ei.jsx)("div",{children:e("google3DPreview.previewMode")}),(0,ei.jsxs)("div",{className:"flex-shrink-0 font-bold flex flex-row items-center gap-1 cursor-pointer",onClick:()=>{e1.Yy.next(!1)},children:[(0,ei.jsx)("div",{children:e("google3DPreview.close")}),(0,ei.jsx)(tc.Z,{className:"w-6 h-6"})]})]})}),(0,ei.jsx)("div",{className:"absolute bottom-[70px] md:bottom-[12px] left-0 w-full flex flex-row justify-center",children:(0,ei.jsxs)("div",{className:"flex flex-col md:flex-row justify-center items-center gap-[14px] text-[12px] max-w-full bg-shadowmap-yellow pointer-events-auto rounded-[24px] md:rounded-full p-4 md:p-[10px_10px_10px_24px]",onClick:()=>{P.n.onGooglePreviewUnlockClick(),(0,eg.si)({roles:i,subscription:ef.K.STUDIO_PROJECT,trigger:"google_3d_preview"})},children:[(0,ei.jsx)("div",{className:"max-w-[230px] leading-[1.1] text-center md:text-left",children:(0,ei.jsx)(ea.cC,{i18nKey:"google3DPreview.unlockMessage",components:{b:(0,ei.jsx)("strong",{})}})}),(0,ei.jsxs)("div",{className:"h-[46px] w-[230px] md:w-auto max-w-full flex-shrink-0 font-bold flex flex-row items-center justify-center gap-[5px] cursor-pointer bg-black rounded-full pl-[22px] pr-[32px]",children:[(0,ei.jsx)(ed.mB,{className:"w-4 h-4 text-shadowmap-yellow"}),(0,ei.jsx)("div",{className:"text-[16px] text-white leading-[1.1] text-center",children:e("google3DPreview.unlockButton")})]})]})})]}):null},ne=i(86762),nt=i(96192),ni=i(20397),ns=i(49370);let nn=5*t7.qL;var no=function(e,t,i,s){return new(i||(i=Promise))(function(n,o){function r(e){try{l(s.next(e))}catch(e){o(e)}}function a(e){try{l(s.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(r,a)}l((s=s.apply(e,t||[])).next())})};let nr=Math.PI/6,na=Math.PI/2.05;E.b.init(),L.Kb.next("main"),(0,eS.Z)(),(0,I.Z)(),function(){if(eb){var e,t,i,s;(e=void 0,t=void 0,i=void 0,s=function*(){let e=new URLSearchParams({shareId:eb}),t=yield fetch(`/.netlify/functions/get-share?${e}`,{method:"GET"});if(!t.ok)throw Error("Response for getShare was falsy");return yield t.json()},new(i||(i=Promise))(function(n,o){function r(e){try{l(s.next(e))}catch(e){o(e)}}function a(e){try{l(s.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(r,a)}l((s=s.apply(e,t||[])).next())})).then(e=>{ey.next(e),ev.next(r.Available)})}else ey.next(void 0),ev.next(r.NotFound)}(),(0,Z.QY)(),(0,et.SU)(),(0,j.M)(),C.B.init(),(0,y.cK)(),x.g.init();let nl=(0,ni.R)(window,"DOMContentLoaded").pipe((0,ns.g)(1e3),(0,p.M)(M.Pn,M.sP,Z.Xq)).subscribe(([e,t,i,s])=>{if(!i.isTimeZoneDefined()||!t.areValid()||s.resetTimeToNoonIfTooDark)return;let n=i.dateTime;t.sunrise.toMillis()-nn<n.toMillis()&&n.toMillis()<t.sunset.toMillis()+nn||(L.eE.next({id:(0,k.Z)(),shortText:(0,N.t)("itsDarkToast.text"),longText:(0,N.t)("itsDarkToast.text"),btnText:(0,N.t)("itsDarkToast.buttonLabel"),disappear:!0,cb:()=>{M.TM.next({dateTime:n.set({hour:12,minute:0,second:0,millisecond:0}),source:M.V2.OTHER}),P.n.onTooDarkToastClick(),nl.unsubscribe()}}),P.n.onTooDarkToastShow())}),nd=document.querySelector("#root"),nh=es.createElement(()=>{let e=(0,es.useRef)(null);return(0,es.useEffect)(()=>{e.current&&L.MI.next(e.current)},[e.current]),(0,ei.jsxs)(s9,{children:[(0,ei.jsx)("div",{id:"renderer-container",className:"select-and-touch-none min-h-screen min-w-full outline-none",tabIndex:-1,ref:e}),(0,ei.jsx)(i0,{}),(0,ei.jsx)(tU,{}),(0,ei.jsx)(iZ,{}),(0,ei.jsx)(so,{}),(0,ei.jsx)(sf,{}),(0,ei.jsx)(s2,{}),(0,ei.jsx)(i6,{}),(0,ei.jsx)(s0,{}),(0,ei.jsx)(tB,{}),(0,ei.jsx)(sX,{}),(0,ei.jsx)(s1,{}),(0,ei.jsx)(eE,{}),(0,ei.jsx)(eO,{}),(0,ei.jsx)(to,{}),(0,ei.jsx)(w.ZP,{}),(0,ei.jsx)(s5,{}),(0,ei.jsx)(s6,{}),(0,ei.jsx)(i2.Z,{})]})});nd&&(0,ej.s)(nd).render(nh);let nc=document.querySelector("#google-one-tap-container"),nu=es.createElement(()=>{let e=(0,eQ.Z)(L.l8),t=(0,eQ.Z)(L.T9),i=(0,eQ.Z)(L.R9),s=(0,eQ.Z)(Z.Xq.pipe((0,_.U)(e=>e.capabilities.enableAuth))),n=e=>{var t,i;P.n.onGoogleOneTapPromptClick();let s=e.credential,n=(0,s3.o)(s);(0,eg.ms)({subscription:ef.K.FREE,trigger:"google_one_tap_sign_up",googleOneTapData:{token:s,email:n.email.toLowerCase(),firstName:null!=(t=n.given_name)?t:"",lastName:null!=(i=n.family_name)?i:""}})};return(0,es.useEffect)(()=>{!1===e&&!t&&s&&(null==i?void 0:i.isGuest())&&!T.A&&setTimeout(()=>{if(!s4())return;let e=!(0,el.tq)();window.google.accounts.id.initialize({client_id:window.SHADOWMAP.GOOGLE_AUTH_CLIENT_ID,callback:n,prompt_parent_id:e?"one-tap-anchor":void 0,use_fedcm_for_prompt:!e,auto_select:!1,itp_support:!0,cancel_on_tap_outside:!1}),L.Z$.next(!0),window.google.accounts.id.prompt(e=>{let t=!(e.isNotDisplayed()||e.isSkippedMoment());t&&P.n.onGoogleOneTapPromptShow(),L.Z$.next(t)})},1e3)},[e,t,i,s]),(0,es.useEffect)(()=>{!(null==i?void 0:i.isGuest())&&s4()&&window.google.accounts.id.cancel()},[i]),(0,ei.jsx)("div",{id:"one-tap-anchor",className:"fixed bottom-4 left-1/2 transform -translate-x-1/2 z-[1000]"})});nc&&(0,ej.s)(nc).render(nu),(0,T.I)(),(0,eM.o)(),L.R9.pipe((0,h.P)(),(0,p.M)(L.R9)).subscribe(([e])=>{let t=A.V5.getPlan(),i=A.V5.getProduct(),s=A.V5.getFreeSignup();L.as.next(void 0!==t||s),void 0!==t?(0,eg.si)({roles:e,directPlan:t,trigger:"url_parameter"}):void 0!==i?(0,eg.si)({roles:e,subscription:i,trigger:"url_parameter"}):s&&e.isGuest()&&(0,eg.ms)({subscription:ef.K.FREE}),A.V5.clearPlan(),A.V5.clearProduct(),A.V5.clearFreeSignup()}),(0,ne.Z)(),(0,ex.Z)();let np=e=>L.iw.next(e),nm=e=>L.OJ.next(e),ng=e=>L.nh.next(e),nf=e=>L.di.next(e),nx=e=>S.PG.next(e),nw=(e,t,i,s)=>{if(!e)return void W.next(void 0);W.next({label:t,position:{x:i,y:s}})},nb=e=>ee.next(e),nv=(e,t,i,s,n)=>{let o="azimuth"===e?X:Y;if(t){let e=o.getValue(),t={label:n?n.toFixed(1).replace(".",",")+"\xb0":"",position:{x:null!=i?i:0,y:null!=s?s:0}};((null==e?void 0:e.label)!==t.label||(null==e?void 0:e.position.x)!==t.position.x||(null==e?void 0:e.position.y)!==t.position.y)&&o.next(t)}else o.next(void 0)},ny=(e,t,i)=>{$.next({x:e,y:t,radius:i})},nC=(e,t,i)=>{let n=null==s?void 0:s.get(e);n&&L.Xt.next(Object.assign(Object.assign({},n),{screenX:t,screenY:i}))},nM=()=>{L.Xt.next(void 0)},nS=e=>{let t;switch(e){case l.pV.DESKTOP_HIGH:t=l.pV.DESKTOP_MEDIUM;break;case l.pV.DESKTOP_MEDIUM:t=l.pV.DESKTOP_LOW;break;case l.pV.MOBILE_HIGH:t=l.pV.MOBILE_MEDIUM;break;case l.pV.MOBILE_MEDIUM:t=l.pV.MOBILE_LOW}void 0!==t&&((0,et.I5)("visualQuality",t),P.n.onVisualQualityLoweredAuto(),L.eE.next((0,w.wV)()))},nL=(e,t,i)=>{ep.UW.getValue()!==ep.BS.Analytics&&(0,et.NN)("mapMode")!==l.M$.GOOGLE&&D.SX.next({userBuilding:e,screenX:t,screenY:i})},nT=()=>{D.SX.next(void 0)},nj=(e,t,i)=>{ep.UW.getValue()!==ep.BS.Analytics&&(0,et.NN)("mapMode")!==l.M$.GOOGLE&&D.L3.next({tree:e,screenX:t,screenY:i})},nP=()=>{D.L3.next(void 0)},nE=e=>{L.IX.next(e)};l._F.then(()=>{L.M7.next(!0)}),(0,d.a)([L.MI,S.PG,S.zN,M.TM,M.sP,L.R9,ey,eC,ev,Z.Xq,Z.j2,L.M7,M.Pn,L.Yx,(0,et.ZW)("mapStyle"),(0,et.ZW)("antiAliasing"),(0,et.ZW)("ambientOcclusion"),(0,et.ZW)("elevationModel"),(0,et.ZW)("visualQuality"),(0,et.ZW)("cameraFocalLength"),(0,et.ZW)("floorLevelIndicationState"),(0,et.ZW)("sunVectorVisible"),(0,et.ZW)("defaultBuildingHeight"),(0,et.ZW)("showTrees")]).pipe((0,F.h)(([,,,,,,,,e,,t,i])=>e!==r.Loading&&!0===i&&t),(0,h.P)()).subscribe(([e,t,i,n,o,r,a,x,w,y,C,T,j,E,I,R,V,B,U,H,G,z,W,X])=>{var Y,$,q,J,ee,ei,es,en,eo,er,ea,el,ed,eh,eu;let eg,ef,ex;(0,nt.h)();let ew=m.ou.now();if(y.resetTimeToNoonIfTooDark&&j.areValid()){let e=5*t7.qL;if(j.sunrise.toMillis()-e>n.dateTime.toMillis()||j.sunset.toMillis()+e<n.dateTime.toMillis()){let e=o.dateTime.set({hour:12,minute:0,second:0,millisecond:0});M.TM.next({dateTime:e,source:M.V2.OTHER}),n=M.TM.getValue(),ew=e}}let eb={rendererContainer:e,basemap:I,terrain:B,initialLocation:t,initialDate:n.dateTime.toJSDate(),visualQuality:U,showSunVector:z,activateKeyboardControls:b.V.KEYBOARD_CONTROLS,debugMode:!1,isPanningEnabled:y.capabilities.enablePanning,focalLength:H,showPro3DTiles:!1,panWithLeftMouseButton:!y.capabilities.swapControlsMouseButtons,floorIndication:G.enabled,floorHeight:G.floorHeight,antiAliasing:R?"smaa":"disabled",ssao:V,buildingPlaceholderBlueprint:A.V5.buildingPlaceholderBlueprint(),limitCameraPositionToRadius:y.limitCameraToRadius?50:void 0,lang:null!=(Y=N.ZP.resolvedLanguage)?Y:"en",defaultBuildingHeight:W,initialAutoRotation:y.initialAutoRotation,onAttributionChanged:np,onAzimuthalAngleChanged:nm,onLoadingChanged:ng,onTerrainVisibilityChanged:nf,onLocationChanged:nx,onFrameRateTooLow:nS,onShowGastronomy:nC,onHideGastronomy:nM,onShowBuildingOverlayMenu:nL,onHideBuildingOverlayMenu:nT,onShowTreeOverlayMenu:nj,onHideTreeOverlayMenu:nP,onSunHUDPathHover:nw,onSunHUDPathClick:nb,onSunHUDLabelChange:nv,onSunHUDPositionChange:ny,onSunHUDInteraction:()=>{K()},onSunHUDSphereStateChange:e=>Q.next(e),onStudioDrawingLabelChange:nE,onDateChanged:(e,t)=>{t?(0,M.UX)(m.ou.fromJSDate(e)):M.TM.next({dateTime:m.ou.fromJSDate(e),source:M.V2.OTHER})},onGoogle3DDataAvailability:e=>{},showHQTreesFree:y.capabilities.enableHQTrees&&X,showHQTreesPaid:y.capabilities.enableHQTrees&&X&&r.isAllowedToUseExplorer(),showGlobalTrees:y.capabilities.enableGlobalTrees&&X,highlightBuilding:i===S.ZZ.URL&&y.highlightBuilding,compassArrowDirection:E,canUseAnalytics:y.capabilities.enableAnalytics};if(a)switch(a.version){case 1:{let e=null!=($=a.lat)?$:A.V5.getLat(),t=null!=(q=a.lng)?q:A.V5.getLng(),i=A.V5.getZoom()||17,s=A.V5.getAzimuth()||0,n=A.V5.getPolar()||Math.PI/4;eb.initialLocation=new l.Y(e,t,i,s,n);break}case 2:{let e=a.share,i=new Date(e.date);M.TM.next({dateTime:m.ou.fromJSDate(i),source:M.V2.OTHER});let{lat:s,lng:n,zoom:o,azimuth:r,polar:d}=e.location;eb.initialLocation=new l.Y(s,n,o,r,d),eb.initialDate=new Date(e.date),eb.basemap=e.appState.mapStyle,eb.showSunVector=e.appState.sunVectorVisible,eb.floorIndication=null!=(J=e.appState.floorLevelIndicationState.enabled)&&J,eb.floorHeight=null!=(ee=e.appState.floorLevelIndicationState.floorHeight)?ee:Z._8.floorLevelIndicationState.floorHeight,eb.defaultBuildingHeight=null!=(ei=e.appState.defaultBuildingHeight)?ei:Z._8.defaultBuildingHeight,eb.terrain=e.appState.elevationModel,eb.focalLength=e.appState.cameraFocalLength,eb.showGlobalTrees=!0,eb.showHQTreesPaid=!0,eb.showHQTreesFree=!0,(0,et.I5)("mapStyle",e.appState.mapStyle),(0,et.I5)("showTrees",null==(es=e.appState.showTrees)||es),(0,et.I5)("floorLevelIndicationState",null!=(en=e.appState.floorLevelIndicationState)?en:Z._8.floorLevelIndicationState),(0,et.I5)("defaultBuildingHeight",null!=(eo=e.appState.defaultBuildingHeight)?eo:Z._8.defaultBuildingHeight),(0,et.I5)("sunVectorVisible",e.appState.sunVectorVisible),(0,et.I5)("elevationModel",e.appState.elevationModel),(0,et.I5)("cameraFocalLength",e.appState.cameraFocalLength),(0,et.I5)("sunPathEnabled",null==(er=e.appState.sunPathEnabled)||er),(0,et.I5)("sunPathLocked",null!=(ea=e.appState.sunPathLocked)&&ea),(0,et.I5)("sunPathLockLocation",null!=(el=e.appState.sunPathLockLocation)?el:{lat:t.lat,lng:t.lng}),(0,et.I5)("autoPlayTime",null!=(ed=e.appState.autoPlayTime)&&ed),(0,et.I5)("mapMode",null!=(eh=e.appState.mapMode)?eh:l.M$.DEFAULT),(0,et.I5)("autoRotate",null!=(eu=e.appState.autoRotate)&&eu);break}default:throw Error(`Unknown share version: ${a.version}`)}let ev=(0,l.ZR)(eb);if(ev.showSunVector(eb.showSunVector),P.Y.subscribe(e=>{ev.toggleDemoRegionBorder(!e)}),a){let e=ev.createUsermodelManager();ev.setUsermodelGroup(e.usermodelGroup);let t=new Map(a.modelUrls),i=new Map;for(let e of a.project.buildings)i.set(e.buildingId,e);L.nh.pipe((0,F.h)(e=>!0===e),(0,h.P)()).subscribe(()=>no(void 0,void 0,void 0,function*(){L.nh.pipe((0,F.h)(e=>!1===e),(0,h.P)()).subscribe(()=>no(void 0,void 0,void 0,function*(){var s,n,o;L.nh.next(!0);let r=[];for(let i of a.project.models){if(void 0===i.id)continue;let s=t.get(i.id);if(s){let t=e.loadUserModel(i,s);r.push(t)}}r.push(ev.setUserBuildings(i)),r.push(ev.setUserTrees(null!=(s=a.project.treeOverrides)?s:[])),r.push(ev.setUserPrefabs(null!=(n=a.project.prefabs)?n:[])),r.push(ev.setUserShapes(null!=(o=a.project.shapes)?o:[])),Promise.all(r).then(()=>{L.nh.next(!1)})}))}));let s=t=>{requestAnimationFrame(s),e.setTime(t/1e3)};requestAnimationFrame(s)}L.kY.subscribe(e=>{switch(e){case"zoom-in":ev.zoomIn();break;case"zoom-out":ev.zoomOut();break;case"reset-north":ev.resetNorth()}}),(0,d.a)([(0,et.ZW)("firstPersonView"),L.rE,L.nb]).subscribe(([e,t,i])=>{t&&i&&(e?ev.toggleFirstPersonView(!0,t,i):ev.toggleFirstPersonView(!1))}),(0,et.hu)("autoRotate",e=>ev.autoRotate(e),!0),(0,et.hu)("sunVectorVisible",e=>ev.showSunVector(e)),(0,et.hu)("visualQuality",e=>ev.setVisualQuality(e)),(0,et.hu)("mapStyle",e=>{"map"===e&&(e="map-free"),ev.changeBasemap(e)},!0),(0,et.hu)("elevationModel",e=>ev.changeTerrain(e)),(0,et.hu)("antiAliasing",e=>ev.setAntiAliasing(e?"smaa":"disabled")),(0,et.hu)("ambientOcclusion",e=>ev.setSSAO(e)),(0,et.hu)("cameraFocalLength",e=>ev.setFocalLength(e));let ey=eT()(e=>ev.setFloorIndication(e.enabled,e.floorHeight||(0,et.Lu)("floorLevelIndicationState").floorHeight),500,{trailing:!0,leading:!0});(0,et.hu)("floorLevelIndicationState",e=>ey(e)),(0,et.hu)("sunPathEnabled",e=>{ev.toggleSunHUD(e)},!0);let eC=()=>{let e=(0,et.NN)("sunPathLocked"),i=(0,et.NN)("sunPathLockLocation");if(y.lockSunPathToInitialLocation)return void ev.toggleSunHUDLock(e,t.lat,t.lng);e&&i?ev.toggleSunHUDLock(e,i.lat,i.lng):ev.toggleSunHUDLock(e)};(0,et.hu)("sunPathLocked",()=>no(void 0,void 0,void 0,function*(){eC()}),!0),(0,et.hu)("sunPathLockLocation",()=>no(void 0,void 0,void 0,function*(){eC()}),!0),(0,et.hu)("mapMode",e=>ev.setMapMode(e),!0);let eM=eT()(e=>ev.setDefaultBuildingHeight(e),500,{trailing:!0,leading:!0});if((0,et.hu)("defaultBuildingHeight",e=>eM(e)),ev.onTerrainChanged(e=>{(0,et.I5)("elevationModel",e);let t=ec[e];L.eE.next({id:(0,k.Z)(),shortText:`Elevation model was switched to ${t} `,longText:`Elevation model was switched to ${t} `,disappear:!0})}),y.capabilities.enableAuth){let e=new c.X(!0),t=!0,i=!0;ev.onTreeRegionStatusChanged(s=>{e.value!==s&&(s?(i=(0,et.NN)("showTrees"),(0,et.I5)("showTrees",t)):(t=(0,et.NN)("showTrees"),(0,et.I5)("showTrees",i)),e.next(s))})}(0,et.ZW)("showTrees").subscribe(e=>{ev.toggleGlobalTrees(y.capabilities.enableGlobalTrees&&e),ev.toggleHQTrees(y.capabilities.enableHQTrees&&e,y.capabilities.enableHQTrees&&e)}),(0,d.a)([L.R9,Z.Xq]).subscribe(([e,t])=>{let i=e.isAllowedToUseExplorer()||t.capabilities.unlockEverything;ev.setShowPro3DTiles(i)}),(0,d.a)([L.R9,Z.Xq,e1.Yy]).subscribe(([e,t,i])=>{if(a)return void ev.setMaxPolarAngle(x.isAllowedToUseExplorer()?na:nr);let s=e.isAllowedToUseExplorer()||t.capabilities.unlockEverything||i;ev.setMaxPolarAngle(s?na:nr)}),requestAnimationFrame(function e(t){requestAnimationFrame(e),f.Vx(t),null==ef||ef.setTime(t/1e3)}),L.Nv.subscribe(({callback:e})=>{ev.requestScreenshot(e)}),M.TM.pipe((0,u.T)(1)).subscribe(({dateTime:e})=>{ew=e,ev.setDate(e.toJSDate())});let eS=(e,t)=>{let i=ew.set({hour:12,minute:0,second:0,millisecond:0}).toJSDate(),s=g.getTimes(i,e,t).sunrise.getTime()-18e5;null==eg||eg.stop(),eg=new f.kX({t:s}).to({t:ew.toMillis()},3e3).onUpdate(({t:e})=>{M.TM.next({dateTime:m.ou.fromMillis(e),source:M.V2.LOCATION_ANIMATION})}).easing(f.oY.Quadratic.Out).start()};S.qi.subscribe(({location:{lat:e,lng:t,decimalZoom:i,azimuth:s,polar:n},dropPin:o,animate:r=!0,animatePosition:a=!1,onlyZoomIn:l=!1,positionThreshold:d,resetRotation:h=!0,highlightBuilding:c=!1})=>{ev.setLocation({lng:t,lat:e,zoom:i,azimuth:s,polar:n,dropPin:o,animateRotation:r,animatePosition:a,animateZoom:a,onlyZoomIn:l,positionThreshold:d,resetRotation:h,duration:a?1e3:1500,easing:a?f.oY.Cubic.InOut:f.oY.Sinusoidal.InOut}),r&&!a&&eS(e,t),c&&y.highlightBuilding&&ev.updateHighlightedBuilding(e,t)}),S.MV.subscribe(e=>{e&&ev.resetHighlightedBuilding()}),y.enableInitialDayTimelapse&&eS(t.lat,t.lng),S.bq.subscribe(({visible:e})=>{ev.showLocationPin(e,!1)}),S.Em.subscribe(e=>{var t;ev.updateLocationOrb(null!=(t=null==e?void 0:e.visible)&&t,null==e?void 0:e.location,null==e?void 0:e.accuracy)}),y.capabilities.enableGastronomies&&(function(){return v(this,void 0,void 0,function*(){let e=yield v(void 0,void 0,void 0,function*(){let e=yield fetch("/.netlify/functions/gastronomies",{method:"GET"});if(!e.ok)throw Error("Response for gastronomies was falsy");return yield e.json()}),t=new Map;return e.forEach(e=>{t.set(e.geoJson[0].id.toString(),e)}),{data:t}})})().then(({data:e})=>{s=e;let t=Array.from(e.values()).map(e=>e.geoJson);ev.setGastronomies(t)}).catch(console.error),a||(D.nj.subscribe(e=>{ev.setUserBuildings(e)}),D.Vi.pipe((0,_.U)(e=>{var t;return null!=(t=null==e?void 0:e.prefabs)?t:[]})).subscribe(e=>{ev.setUserPrefabs(e)}),D.uy.subscribe(e=>{ev.setUserTrees(e)}),D.c_.subscribe(e=>{ev.setUserShapes(e)}),D.Zr.subscribe(e=>{ev.setUserSolarPanels(e)})),L.bS.subscribe(e=>{"reset-selection"===e&&ev.studioClearSelected()});let eL=A.V5.modelShareId();eL&&no(void 0,void 0,void 0,function*(){var e,t,i,s;let{usermodel:n,url:o}=yield(e=void 0,t=void 0,i=void 0,s=function*(){let e=new URLSearchParams({shareId:eL}),t=yield fetch(`/.netlify/functions/usermodel-from-share?${e}`,{method:"GET"});if(!t.ok)throw Error("Response for getUserModelFromShare was falsy");return yield t.json()},new(i||(i=Promise))(function(n,o){function r(e){try{l(s.next(e))}catch(e){o(e)}}function a(e){try{l(s.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(r,a)}l((s=s.apply(e,t||[])).next())}));ev.setLocation({lng:n.lng,lat:n.lat,zoom:17});let r=ev.createUsermodelManager();ev.setUsermodelGroup(r.usermodelGroup);let a=yield r.loadUserModel(n,o);if(a.changedHeight){let e=(0,N.t)("studio.modelUpload.changedHeightMessage",{changedHeight:a.changedHeight});L.eE.next({id:(0,k.Z)(),shortText:e,longText:e,disappear:!0})}}),(0,d.a)([em.Us,Z.Xq]).subscribe(([e,t])=>{ev.setStudioMode(void 0===e&&t.capabilities.enableStudio)}),D.NH.subscribe(e=>{!a&&(ef&&(ef.inactive=!0),ef=ev.createUsermodelManager(),ev.setUsermodelGroup(ef.usermodelGroup),e&&(e.models.forEach(e=>{e.status="pending"}),e.shapes.forEach(e=>{e.status="pending"})))}),D.G2.pipe((0,p.M)(D.Vi)).subscribe(([e,t])=>no(void 0,void 0,void 0,function*(){if(e&&t){let i=!1;for(let t of e)switch(t.status){case"pending":{t.status="loading";let{url:e}=yield O(t);try{let i=ef;if(i){if(yield i.loadUserModel(t,e),i.inactive)return;t.status="visible"}}catch(e){t.status="error"}finally{i=!0}break}case"deleted":null==ef||ef.remove(t),e.delete(t);break;case"selecting":case"selectingAndJumpingToLocation":{if("selectingAndJumpingToLocation"===t.status){let{lat:e,lng:i}=t,s=new l.Y(e,i,17);S.qi.next({location:s,dropPin:!1,animate:!1,onlyZoomIn:!0})}let e=null==ef?void 0:ef.getLoadedModel(t);if(e)ev.setStudioSelectedModel(e),t.status="visible";else{let{url:e}=yield O(t);try{if(t.status="loading",ef){let i=yield ef.loadUserModel(t,e);if(i.changedHeight){let e=(0,N.t)("studio.modelUpload.changedHeightMessage",{changedHeight:i.changedHeight});L.eE.next({id:(0,k.Z)(),shortText:e,longText:e,disappear:!0})}ev.setStudioSelectedModel(i.model),t.status="visible"}else throw Error("usermodelManager is undefined")}catch(e){t.status="error",console.error(e)}}i=!0}}for(let t of e)if("pending"===t.status)throw Error(`model has pending status before reinserting -> infinite loop ${JSON.stringify(t)}`);i&&D.Vi.next(Object.assign({},t))}})),D.fK.subscribe(e=>{ev.setStudioTransformControlsMode(e[0],e[1])}),D.Xi.subscribe(e=>{ev.setSelectedModelAttributes(e,(e,t)=>{null==ef||ef.positionModel(e,t)})}),D.E3.subscribe(e=>{e&&ex!==e.id&&(ex=e.id,ev.setStudioSelectedPrefab(e))}),D.TX.subscribe(e=>{if(!e)return;let{prefab:t,action:i}=e;if("select"===i)ev.setStudioSelectedPrefab(t);else if("selectAndGoTo"===i){let e=new l.Y(t.lat,t.lng,20);S.qi.next({location:e,dropPin:!1,animate:!1,onlyZoomIn:!0}),ev.setStudioSelectedPrefab(t)}}),D.ck.subscribe(e=>{if(!e)return;let{shape:t,action:i}=e;if("select"===i)ev.setStudioSelectedShape(t);else if("selectAndGoTo"===i){let e=new l.Y(t.lat,t.lng,17);S.qi.next({location:e,dropPin:!1,animate:!1,onlyZoomIn:!0}),ev.setStudioSelectedShape(t)}}),D.D$.subscribe(e=>{if(!e)return;let{solarPanel:t,action:i}=e;if("select"===i)ev.setStudioSelectedSolarPanel(t);else if("selectAndGoTo"===i){let e=new l.Y(t.lat,t.lng,17);S.qi.next({location:e,dropPin:!1,animate:!1,onlyZoomIn:!0}),ev.setStudioSelectedSolarPanel(t)}}),ev.onSelectedModelChanged(e=>{(0,D.$4)(e)}),ev.onSelectedShapeChanged(e=>{(0,D.r9)(e)}),ev.onSelectedPrefabChanged(e=>{(0,D.xR)(e)}),ev.onSelectedBuildingChanged(e=>{(0,D.A$)(e)}),ev.onSelectedTreeChanged(e=>{(0,D.hU)(e)}),ev.onSelectedSolarPanelChanged(e=>{(0,D.SF)(e)}),ev.addCustomShapeCallback(e=>{if(e){let t=D.Vi.value;t&&(t.shapes||(t.shapes=[]),e.name=(0,D.t_)(),e.createdAt=new Date,e.status="pending",D.Vi.next(Object.assign(Object.assign({},t),{shapes:[...t.shapes,e],hasChanges:!0})),D.dG.next(!1))}}),ev.onAccumulatedShadowsClick(e=>{JSON.stringify(e)!==JSON.stringify(ep.IR.value)&&ep.IR.next(e)}),ev.onMonthlyAnalyticsUpdate(e=>{ep.Q_.next(e)}),ev.onAnalyticsMagnifierVisible(e=>{ep.UH.next(e)}),ep.RH.subscribe(e=>{ev.setShadowAccumulationRange(e[0],e[1])}),ev.onAccumulatedShadowsRecalculated(e=>{ep.TV.next(e)}),(0,et.hu)("analyticsEnabled",e=>{ev.toggleAccumulatedShadows(e)},!0),D.NB.subscribe(({building:e,jumpToLocation:t})=>{if(e){let{lat:i,lng:s}=e;if(t){let e=new l.Y(i,s,17);S.qi.next({location:e,dropPin:!1,animate:!1,onlyZoomIn:!0})}ev.selectBuilding(e)}}),D.up.subscribe(({tree:e,jumpToLocation:t})=>{if(e){let{lat:i,lng:s}=e;if(t){let e=new l.Y(i,s,17);S.qi.next({location:e,dropPin:!1,animate:!1,onlyZoomIn:!0})}ev.selectTree(e)}}),D.dG.subscribe(e=>{ev.setShapeDrawingMode(e)}),D.ml.subscribe(e=>{ev.toggleCrosshair(e)}),y.showInitialLocationPin&&ev.showLocationPin(!0,!1),ev.onSolarPanelAnalyticsChanged(e=>{D.Mg.next(e)}),M.kd.subscribe(e=>{ev.setSunHUDSphereState(e)}),y.initialAnalyticsEnabled&&ep.UW.next(ep.BS.Analytics),y.capabilities.enableAuth&&setTimeout(()=>{fetch("/google-3d-tiles/SolarAPIHighArea.json").then(e=>no(void 0,void 0,void 0,function*(){if(!e.ok)return void console.error("Failed to fetch Google 3D coverage JSON",e.statusText);let t=yield e.json();e1.fg.next(t)}))},5e3),e1.Yy.subscribe(e=>{ev.toggleGoogle3DPreviewMode(e)}),a&&ev.setSunHUDSolsticeInteractivity(x.isAllowedToUseExplorer())})},61381:function(e,t,i){i.d(t,{I:function(){return n}});var s=i(66704);let n=e=>{var t,i,n,o;return t=void 0,i=void 0,n=void 0,o=function*(){let t=yield s.g.token();if(!t)throw Error("No token present to make request");let i=JSON.stringify({projectId:e}),n=yield fetch("/.netlify/functions/studio-project-share",{method:"POST",body:i,headers:{Authorization:`Bearer ${t}`}});if(!n.ok)throw Error((yield n.text()));return n.json()},new(n||(n=Promise))(function(e,s){function r(e){try{l(o.next(e))}catch(e){s(e)}}function a(e){try{l(o.throw(e))}catch(e){s(e)}}function l(t){var i;t.done?e(t.value):((i=t.value)instanceof n?i:new n(function(e){e(i)})).then(r,a)}l((o=o.apply(t,i||[])).next())})}},35041:function(e,t,i){i.d(t,{$:function(){return a},Z:function(){return d}});var s=i(84100),n=i(97160),o=i(78196),r=i(46366);let a="activeStudioProject",l=localStorage.getItem(a);function d(){if(!l||(0,n.tq)())return;let e=s.ic.pipe((0,o.V)(r.Xq)).subscribe(([t,i])=>{if(i.capabilities.enableStudio&&(null==t?void 0:t.length)){let i=t.find(e=>e.id===l);i&&(s.Vi.next(Object.assign(Object.assign({},i),{hasChanges:!1})),e.unsubscribe())}})}},58017:function(e,t,i){i.d(t,{g:function(){return n}});var s=i(66704);let n=e=>{var t,i,n,o;return t=void 0,i=void 0,n=void 0,o=function*(){let t=yield s.g.token();if(!t)throw Error("No token present to make request");let i=JSON.stringify({share:(({shareId:e,projectId:t,location:i,date:s,appState:n})=>{let{lat:o,lng:r,decimalZoom:a,azimuth:l,polar:d}=i||{};return{shareId:e,projectId:t,location:i?{lat:o,lng:r,zoom:a,azimuth:l,polar:d}:null,date:s,appState:n}})(e)}),n=yield fetch("/.netlify/functions/update-studio-project-share",{method:"POST",body:i,headers:{Authorization:`Bearer ${t}`}});if(!n.ok)throw Error((yield n.text()));return n.json()},new(n||(n=Promise))(function(e,s){function r(e){try{l(o.next(e))}catch(e){s(e)}}function a(e){try{l(o.throw(e))}catch(e){s(e)}}function l(t){var i;t.done?e(t.value):((i=t.value)instanceof n?i:new n(function(e){e(i)})).then(r,a)}l((o=o.apply(t,i||[])).next())})}},79121:function(e,t,i){i.d(t,{BS:function(){return n},Gf:function(){return a},IR:function(){return l},Q_:function(){return d},RH:function(){return c},TV:function(){return u},UH:function(){return p},UW:function(){return r}});var s,n,o=i(14229);(s=n||(n={}))[s.Default=0]="Default",s[s.Analytics=1]="Analytics";let r=new o.X(n.Default),a=new o.X(!1),l=new o.X({x:0,y:0,isAccessible:!1,isReady:!1,isCrosshairVisible:!1,energy:0,maxEnergy:0,maxEnergyAtNormal:0,time:0,maxTime:0,timeInDaylightFraction:0}),d=new o.X([]),h=new Date().getFullYear(),c=new o.X([new Date(Date.UTC(h,0,1)).getTime(),new Date(Date.UTC(h+1,0,1)).getTime()]),u=new o.X(0),p=new o.X(!1)},46366:function(e,t,i){i.d(t,{Gn:function(){return m},H5:function(){return n},MG:function(){return f},QY:function(){return x},Xq:function(){return p},_8:function(){return h},j2:function(){return g}});var s,n,o=i(57155),r=i(14229),a=i(16433),l=i(70846),d=i(89399);let h={mapStyle:"map",visualQuality:d.V5.getInitialVisualQuality(),autoRotate:!1,firstPersonView:!1,cameraFocalLength:29,sunVectorVisible:!0,hideUI:!1,antiAliasing:!1,ambientOcclusion:!1,floorLevelIndicationState:{enabled:!1,floorHeight:3},elevationModel:"nextzen",sunPathEnabled:!0,sunPathLocked:!1,sunPathLockLocation:{lat:0,lng:0},analyticsEnabled:!1,mapMode:a.M$.DEFAULT,defaultBuildingHeight:6,showTrees:!0,autoPlayTime:!1};(s=n||(n={}))[s.Disabled=0]="Disabled",s[s.Anonymous=1]="Anonymous",s[s.Full=2]="Full";let c={capabilities:{canChooseDate:!0,canSearchLocation:!0,showFullscreenButton:!0,showUpgradeButton:!1,showMapStyle:!0,showElevationModel:!0,showCoordinateInput:!0,enableAnalytics:!0,enableStudio:!0,enableDemo:!0,enablePanning:!0,swapControlsMouseButtons:!1,enableAuth:!0,unlockEverything:!1,enableFeedbackForm:!0,enableNewsletterForm:!0,showShareButton:!0,showSettingsButton:!0,showInfoButton:!0,trackingLevel:n.Full,enableCurrentLocationButton:!0,enableHQTrees:!0,enableGlobalTrees:!0,showFloorLevelToggle:!0,showDefaultBuildingHeight:!0,showAntiAliasing:!0,showAmbientOcclusion:!0,showSettingsFeedback:!1,showFirstPersonView:!0,showFocalLength:!0,allowChangeSunPathLock:!0,showHideUI:!0,showAutoRotate:!0,enableGastronomies:!0,showTreesToggle:!0,showAutoPlayTime:!1},theme:{name:"default",gradient:"from-[#F8F991] to-[#FFCD00]",hoverGradient:"hover:from-sun-100 hover:to-sun-100",shadow:"shadow-sun-glow",hoverShadow:"hover:shadow-sun-glow-hover",toggleShadow:"shadow-sun-glow-toggle",actionColor:"text-neon-400",textColor:"text-grey-800",focusInputColor:"focus:ring-neon-300",zoomButtonsRadius:"full"},infoExplanationDateTimeImageURL:"img/explanation_top_panel_{lang}_v2.png",infoExplanationButtonsImageURL:"img/explanation_bottom_panel_{lang}.png",updateURLParams:!0,appState:h,limitCameraToRadius:!1,infoButtonPosition:"top",bottomButtonsPosition:"right",showLogo:!0,hideUIWithSettingsOpen:!1,enableIntroModal:!0,phantomLocks:{},showInitialLocationPin:!1,showWeatherWidget:!0,initialZoomFallback:15,enableInitialDayTimelapse:!1,resetTimeToNoonIfTooDark:!1,initialAutoRotation:!1,showFastMapModeSelector:!1,highlightBuilding:!1,initialAnalyticsEnabled:!1,lockSunPathToInitialLocation:!1},u={default:c,studioShare:Object.assign(Object.assign({},c),{capabilities:Object.assign(Object.assign({},c.capabilities),{canSearchLocation:!1,showFullscreenButton:!1,showMapStyle:!1,showElevationModel:!1,enableAuth:!1,enableAnalytics:!0,enableStudio:!1,enableDemo:!1,swapControlsMouseButtons:!0,unlockEverything:!0,enableFeedbackForm:!1,enableNewsletterForm:!1,showShareButton:!1,trackingLevel:n.Anonymous,enableCurrentLocationButton:!1,enableHQTrees:!0,enableGlobalTrees:!0,showFloorLevelToggle:!1,showDefaultBuildingHeight:!1,showAntiAliasing:!1,showAmbientOcclusion:!1,enableGastronomies:!1,showSettingsFeedback:!0,showCoordinateInput:!1,showFirstPersonView:!1,showFocalLength:!1,showTreesToggle:!1,showAutoPlayTime:!0,allowChangeSunPathLock:!1}),infoExplanationDateTimeImageURL:"img/explanation_top_panel_share_{lang}.png",infoExplanationButtonsImageURL:"img/explanation_bottom_panel_promo.png",updateURLParams:!1,appState:Object.assign(Object.assign({},h),{sunPathEnabled:!1}),infoButtonPosition:"bottom",showWeatherWidget:!1,limitCameraToRadius:!0}),"willhaben-immoaddetail":Object.assign(Object.assign({},c),{language:"de",capabilities:Object.assign(Object.assign({},c.capabilities),{canChooseDate:!0,canSearchLocation:!1,showFullscreenButton:!0,showUpgradeButton:!1,showMapStyle:!1,showElevationModel:!1,showCoordinateInput:!1,enableAnalytics:!1,enableStudio:!1,enableDemo:!1,enablePanning:!0,swapControlsMouseButtons:!0,enableAuth:!1,unlockEverything:!0,enableFeedbackForm:!1,enableNewsletterForm:!1,showShareButton:!1,showSettingsButton:!0,showInfoButton:!0,trackingLevel:n.Anonymous,enableCurrentLocationButton:!1,enableHQTrees:!0,enableGlobalTrees:!0,showFloorLevelToggle:!0,showDefaultBuildingHeight:!1,showAntiAliasing:!1,showAmbientOcclusion:!1,showSettingsFeedback:!0,showFirstPersonView:!1,showFocalLength:!1,allowChangeSunPathLock:!1,showHideUI:!1,enableGastronomies:!1}),theme:{name:"willhaben",gradient:"from-[#00A4E8] to-[#00A4E8]",hoverGradient:"hover:from-[#005b81] hover:to-[#005b81]",shadow:"shadow-blue-glow",hoverShadow:"hover:shadow-blue-glow-hover",toggleShadow:"shadow-blue-glow-toggle",actionColor:"text-mint-200",textColor:"text-white",focusInputColor:"focus:ring-mint-300",zoomButtonsRadius:"full"},infoExplanationDateTimeImageURL:"img/explanation_top_panel_willhaben.png",infoExplanationButtonsImageURL:"img/explanation_bottom_panel_promo.png",updateURLParams:!1,appState:Object.assign(Object.assign({},h),{floorLevelIndicationState:{enabled:!0,floorHeight:3},showTrees:!0,sunPathLocked:!0}),infoButtonPosition:"bottom",limitCameraToRadius:!0,showInitialLocationPin:!0,showWeatherWidget:!1,initialZoomFallback:19,enableInitialDayTimelapse:!0,resetTimeToNoonIfTooDark:!0,lockSunPathToInitialLocation:!0,highlightBuilding:!0}),"willhaben-tenantprofile":Object.assign(Object.assign({},c),{language:"de",capabilities:Object.assign(Object.assign({},c.capabilities),{canChooseDate:!0,canSearchLocation:!0,showFullscreenButton:!0,showUpgradeButton:!1,showMapStyle:!1,showElevationModel:!1,showCoordinateInput:!0,enableAnalytics:!1,enableStudio:!1,enableDemo:!1,enablePanning:!0,swapControlsMouseButtons:!1,enableAuth:!1,unlockEverything:!0,enableFeedbackForm:!1,enableNewsletterForm:!1,showShareButton:!1,showSettingsButton:!0,showInfoButton:!0,trackingLevel:n.Anonymous,enableCurrentLocationButton:!1,enableHQTrees:!0,enableGlobalTrees:!0,showFloorLevelToggle:!0,showDefaultBuildingHeight:!1,showAntiAliasing:!1,showAmbientOcclusion:!1,showSettingsFeedback:!0,showFirstPersonView:!1,showFocalLength:!1,allowChangeSunPathLock:!1,showHideUI:!1,enableGastronomies:!1}),theme:{name:"willhaben",gradient:"from-[#00A4E8] to-[#00A4E8]",hoverGradient:"hover:from-[#005b81] hover:to-[#005b81]",shadow:"shadow-blue-glow",hoverShadow:"hover:shadow-blue-glow-hover",toggleShadow:"shadow-blue-glow-toggle",actionColor:"text-mint-200",textColor:"text-white",focusInputColor:"focus:ring-mint-300",zoomButtonsRadius:"full"},infoExplanationDateTimeImageURL:"img/explanation_top_panel_willhaben.png",infoExplanationButtonsImageURL:"img/explanation_bottom_panel_promo.png",updateURLParams:!1,appState:Object.assign(Object.assign({},h),{sunVectorVisible:!0,floorLevelIndicationState:Object.assign(Object.assign({},h.floorLevelIndicationState),{enabled:!0}),showTrees:!0}),infoButtonPosition:"top",locationSearchCountryCode:"AT",showWeatherWidget:!1,enableInitialDayTimelapse:!0,resetTimeToNoonIfTooDark:!0,highlightBuilding:!0}),"willhaben-immocontent":Object.assign(Object.assign({},c),{language:"de",capabilities:Object.assign(Object.assign({},c.capabilities),{canChooseDate:!0,canSearchLocation:!0,showFullscreenButton:!0,showUpgradeButton:!1,showMapStyle:!0,showElevationModel:!1,showCoordinateInput:!1,enableAnalytics:!0,enableStudio:!1,enableDemo:!1,enablePanning:!0,swapControlsMouseButtons:!1,enableAuth:!1,unlockEverything:!0,enableFeedbackForm:!1,enableNewsletterForm:!1,showShareButton:!1,showSettingsButton:!0,showInfoButton:!0,trackingLevel:n.Anonymous,enableCurrentLocationButton:!1,enableHQTrees:!0,enableGlobalTrees:!0,showFloorLevelToggle:!0,showDefaultBuildingHeight:!1,showAntiAliasing:!1,showAmbientOcclusion:!1,showSettingsFeedback:!0,showFirstPersonView:!1,showFocalLength:!1,allowChangeSunPathLock:!0,showHideUI:!1,showAutoRotate:!1,enableGastronomies:!1}),theme:{name:"willhaben-immocontent",gradient:"from-[#00A4E8] to-[#00A4E8]",hoverGradient:"hover:from-[#005b81] hover:to-[#005b81]",shadow:"shadow-blue-glow",hoverShadow:"hover:shadow-blue-glow-hover",toggleShadow:"shadow-blue-glow-toggle",actionColor:"text-mint-200",textColor:"text-white",focusInputColor:"focus:ring-mint-300",zoomButtonsRadius:"full"},infoExplanationDateTimeImageURL:"img/explanation_top_panel_willhaben.png",infoExplanationButtonsImageURL:"img/explanation_bottom_panel_promo.png",updateURLParams:!1,appState:Object.assign(Object.assign({},h),{floorLevelIndicationState:Object.assign(Object.assign({},h.floorLevelIndicationState),{enabled:!0}),showTrees:!0}),infoButtonPosition:"top",locationSearchCountryCode:"AT",phantomLocks:{mapMode:!0,floorLevelIndication:!0,analytics:!0,dateSlider:!0,calendar:!0},showWeatherWidget:!1,enableInitialDayTimelapse:!0,resetTimeToNoonIfTooDark:!0,highlightBuilding:!0}),plentify:Object.assign(Object.assign({},c),{language:"en",capabilities:Object.assign(Object.assign({},c.capabilities),{canChooseDate:!0,canSearchLocation:!1,showFullscreenButton:!0,showUpgradeButton:!1,showMapStyle:!1,showElevationModel:!1,showCoordinateInput:!1,enableAnalytics:!0,enableStudio:!1,enableDemo:!1,enablePanning:!0,swapControlsMouseButtons:!0,enableAuth:!1,unlockEverything:!0,enableFeedbackForm:!1,enableNewsletterForm:!1,showShareButton:!1,showSettingsButton:!1,showInfoButton:!1,trackingLevel:n.Anonymous,enableCurrentLocationButton:!1,enableHQTrees:!0,enableGlobalTrees:!0,showFloorLevelToggle:!0,showDefaultBuildingHeight:!0,showAntiAliasing:!0,showAmbientOcclusion:!0,showSettingsFeedback:!1,showFirstPersonView:!0,showFocalLength:!0,allowChangeSunPathLock:!1,showHideUI:!0,enableGastronomies:!1}),infoExplanationDateTimeImageURL:"img/explanation_top_panel_promo.png",infoExplanationButtonsImageURL:"img/explanation_bottom_panel_promo.png",updateURLParams:!1,appState:Object.assign(Object.assign({},h),{mapMode:a.M$.GOOGLE,floorLevelIndicationState:Object.assign(Object.assign({},h.floorLevelIndicationState),{enabled:!0}),sunPathLocked:!0}),limitCameraToRadius:!0,infoButtonPosition:"bottom",showInitialLocationPin:!0,showWeatherWidget:!1,initialZoomFallback:19,enableInitialDayTimelapse:!0,resetTimeToNoonIfTooDark:!0,lockSunPathToInitialLocation:!0,highlightBuilding:!0}),neho:Object.assign(Object.assign({},c),{capabilities:Object.assign(Object.assign({},c.capabilities),{canChooseDate:!0,canSearchLocation:!1,showFullscreenButton:!0,showUpgradeButton:!1,showMapStyle:!1,showElevationModel:!1,showCoordinateInput:!1,enableAnalytics:!1,enableStudio:!1,enableDemo:!1,enablePanning:!0,swapControlsMouseButtons:!0,enableAuth:!1,unlockEverything:!0,enableFeedbackForm:!1,enableNewsletterForm:!1,showShareButton:!1,showSettingsButton:!0,showInfoButton:!0,trackingLevel:n.Anonymous,enableCurrentLocationButton:!1,enableHQTrees:!0,enableGlobalTrees:!0,showFloorLevelToggle:!0,showDefaultBuildingHeight:!0,showAntiAliasing:!0,showAmbientOcclusion:!0,showSettingsFeedback:!1,showFirstPersonView:!0,showFocalLength:!0,allowChangeSunPathLock:!1,showHideUI:!0,enableGastronomies:!1}),infoExplanationDateTimeImageURL:"img/explanation_top_panel_promo.png",infoExplanationButtonsImageURL:"img/explanation_bottom_panel_promo.png",updateURLParams:!1,appState:Object.assign(Object.assign({},h),{floorLevelIndicationState:Object.assign(Object.assign({},h.floorLevelIndicationState),{enabled:!0}),showTrees:!0,sunPathLocked:!0}),limitCameraToRadius:!0,infoButtonPosition:"bottom",showInitialLocationPin:!0,showWeatherWidget:!1,initialZoomFallback:19,enableInitialDayTimelapse:!0,resetTimeToNoonIfTooDark:!0,lockSunPathToInitialLocation:!0,highlightBuilding:!0}),vonpoll:Object.assign(Object.assign({},c),{capabilities:Object.assign(Object.assign({},c.capabilities),{canSearchLocation:!1,unlockEverything:!0,enableAnalytics:!1,enableAuth:!1,enableStudio:!1,showFullscreenButton:!1,trackingLevel:n.Anonymous,showMapStyle:!1,showShareButton:!1,showElevationModel:!1,enableFeedbackForm:!1,enableNewsletterForm:!1,showFirstPersonView:!1,showAntiAliasing:!1,showAmbientOcclusion:!1,showFocalLength:!1,enableGastronomies:!1,swapControlsMouseButtons:!0,enableDemo:!1,allowChangeSunPathLock:!1}),theme:{name:"vonpoll",gradient:"from-[#4E73F4] to-[#4E73F4]",hoverGradient:"hover:from-[#005b81] hover:to-[#005b81]",shadow:"shadow-blue-glow",hoverShadow:"hover:shadow-none",toggleShadow:"shadow-blue-glow-toggle",actionColor:"text-white",textColor:"text-white",focusInputColor:"focus:ring-white",zoomButtonsRadius:"[4px]"},infoExplanationDateTimeImageURL:"img/explanation_top_panel_vonpoll.png",infoExplanationButtonsImageURL:"img/explanation_bottom_panel_promo.png",updateURLParams:!1,appState:Object.assign(Object.assign({},h),{floorLevelIndicationState:Object.assign(Object.assign({},h.floorLevelIndicationState),{enabled:!0}),showTrees:!0,sunPathLocked:!0}),infoButtonPosition:"bottom",bottomButtonsPosition:"left",showLogo:!0,hideUIWithSettingsOpen:!0,enableIntroModal:!1,language:"de",showInitialLocationPin:!0,showWeatherWidget:!1,initialZoomFallback:19,enableInitialDayTimelapse:!0,resetTimeToNoonIfTooDark:!0,limitCameraToRadius:!0,highlightBuilding:!0}),"vonpoll-partner":Object.assign(Object.assign({},c),{capabilities:Object.assign(Object.assign({},c.capabilities),{canSearchLocation:!0,unlockEverything:!0,enableAnalytics:!1,enableAuth:!1,enableStudio:!1,showFullscreenButton:!1,trackingLevel:n.Anonymous,showMapStyle:!1,showShareButton:!1,showElevationModel:!1,enableFeedbackForm:!1,enableNewsletterForm:!1,showFirstPersonView:!1,showAntiAliasing:!1,showAmbientOcclusion:!1,showFocalLength:!1,enableGastronomies:!1,swapControlsMouseButtons:!1,enableDemo:!1,allowChangeSunPathLock:!1}),theme:{name:"vonpoll",gradient:"from-[#4E73F4] to-[#4E73F4]",hoverGradient:"hover:from-[#005b81] hover:to-[#005b81]",shadow:"shadow-blue-glow",hoverShadow:"hover:shadow-none",toggleShadow:"shadow-blue-glow-toggle",actionColor:"text-white",textColor:"text-white",focusInputColor:"focus:ring-white",zoomButtonsRadius:"[4px]"},infoExplanationDateTimeImageURL:"img/explanation_top_panel_vonpoll.png",infoExplanationButtonsImageURL:"img/explanation_bottom_panel_promo.png",updateURLParams:!1,appState:Object.assign(Object.assign({},h),{floorLevelIndicationState:Object.assign(Object.assign({},h.floorLevelIndicationState),{enabled:!0}),showTrees:!0}),infoButtonPosition:"bottom",bottomButtonsPosition:"right",showLogo:!0,hideUIWithSettingsOpen:!1,enableIntroModal:!1,language:"de",showInitialLocationPin:!0,showWeatherWidget:!1,initialZoomFallback:19,enableInitialDayTimelapse:!0,resetTimeToNoonIfTooDark:!0,highlightBuilding:!0}),lystio:Object.assign(Object.assign({},c),{capabilities:Object.assign(Object.assign({},c.capabilities),{canSearchLocation:!1,unlockEverything:!0,enableAnalytics:!1,enableAuth:!1,enableStudio:!1,showFullscreenButton:!1,trackingLevel:n.Anonymous,showMapStyle:!1,showShareButton:!1,showElevationModel:!1,enableFeedbackForm:!1,enableNewsletterForm:!1,showFirstPersonView:!1,showAntiAliasing:!1,showAmbientOcclusion:!1,showFocalLength:!1,enableGastronomies:!1,swapControlsMouseButtons:!0,enableDemo:!1,allowChangeSunPathLock:!1}),theme:{name:"lystio",gradient:"from-[#A540F3] to-[#A540F3]",hoverGradient:"hover:from-[#7f4ca7] hover:to-[#7f4ca7]",shadow:"shadow-blue-glow",hoverShadow:"hover:shadow-none",toggleShadow:"shadow-blue-glow-toggle",actionColor:"text-white",textColor:"text-white",focusInputColor:"focus:ring-white",zoomButtonsRadius:"[8px]"},updateURLParams:!1,appState:Object.assign(Object.assign({},h),{floorLevelIndicationState:{enabled:!0,floorHeight:3},showTrees:!0,sunPathLocked:!0}),enableIntroModal:!0,showInitialLocationPin:!0,showWeatherWidget:!1,infoButtonPosition:"bottom",initialZoomFallback:19,enableInitialDayTimelapse:!0,resetTimeToNoonIfTooDark:!0,limitCameraToRadius:!0,lockSunPathToInitialLocation:!0,highlightBuilding:!0}),"lystio-teaser":Object.assign(Object.assign({},c),{capabilities:Object.assign(Object.assign({},c.capabilities),{canSearchLocation:!1,unlockEverything:!0,enableAnalytics:!0,enableAuth:!1,enableStudio:!1,showFullscreenButton:!0,trackingLevel:n.Anonymous,showMapStyle:!0,showDefaultBuildingHeight:!1,showHideUI:!1,showCoordinateInput:!1,showShareButton:!0,showElevationModel:!1,enableFeedbackForm:!1,enableNewsletterForm:!1,showFirstPersonView:!1,showAntiAliasing:!1,showAmbientOcclusion:!1,showFocalLength:!1,enableGastronomies:!1,swapControlsMouseButtons:!0,showAutoRotate:!1,enableDemo:!1,allowChangeSunPathLock:!1}),theme:{name:"lystio-teaser",gradient:"from-[#A540F3] to-[#A540F3]",hoverGradient:"hover:from-[#7f4ca7] hover:to-[#7f4ca7]",shadow:"shadow-blue-glow",hoverShadow:"hover:shadow-none",toggleShadow:"shadow-blue-glow-toggle",actionColor:"text-white",textColor:"text-white",focusInputColor:"focus:ring-white",zoomButtonsRadius:"[8px]"},updateURLParams:!1,appState:Object.assign(Object.assign({},h),{floorLevelIndicationState:{enabled:!0,floorHeight:3},showTrees:!0,sunPathLocked:!0}),phantomLocks:{mapMode:!0,floorLevelIndication:!1,analytics:!0,dateSlider:!0,calendar:!0},enableIntroModal:!0,showInitialLocationPin:!0,showWeatherWidget:!1,infoButtonPosition:"bottom",initialZoomFallback:19,enableInitialDayTimelapse:!0,resetTimeToNoonIfTooDark:!0,limitCameraToRadius:!0,lockSunPathToInitialLocation:!0,highlightBuilding:!0}),"lystio-preview":Object.assign(Object.assign({},c),{capabilities:Object.assign(Object.assign({},c.capabilities),{canSearchLocation:!1,unlockEverything:!0,enableAnalytics:!1,enableAuth:!1,enableStudio:!1,showFullscreenButton:!0,showSettingsButton:!1,trackingLevel:n.Anonymous,showMapStyle:!1,showShareButton:!1,showElevationModel:!1,enableFeedbackForm:!1,enableNewsletterForm:!1,showFirstPersonView:!1,showAntiAliasing:!1,showAmbientOcclusion:!1,showFocalLength:!1,enableGastronomies:!1,swapControlsMouseButtons:!0,enableDemo:!1,allowChangeSunPathLock:!1}),theme:{name:"lystio",gradient:"from-[#A540F3] to-[#A540F3]",hoverGradient:"hover:from-[#7f4ca7] hover:to-[#7f4ca7]",shadow:"shadow-blue-glow",hoverShadow:"hover:shadow-none",toggleShadow:"shadow-blue-glow-toggle",actionColor:"text-white",textColor:"text-white",focusInputColor:"focus:ring-white",zoomButtonsRadius:"[8px]"},updateURLParams:!1,appState:Object.assign(Object.assign({},h),{floorLevelIndicationState:{enabled:!0,floorHeight:3},showTrees:!0,hideUI:!0,autoRotate:!0,sunPathEnabled:!1,sunPathLocked:!0}),enableIntroModal:!0,showInitialLocationPin:!0,showWeatherWidget:!1,infoButtonPosition:"bottom",initialZoomFallback:19,enableInitialDayTimelapse:!0,resetTimeToNoonIfTooDark:!0,limitCameraToRadius:!0,lockSunPathToInitialLocation:!0,highlightBuilding:!0}),"lystio-analytics":Object.assign(Object.assign({},c),{capabilities:Object.assign(Object.assign({},c.capabilities),{canSearchLocation:!1,unlockEverything:!0,enableAnalytics:!0,enableAuth:!1,enableStudio:!1,showFullscreenButton:!1,trackingLevel:n.Anonymous,showMapStyle:!1,showShareButton:!1,showElevationModel:!1,enableFeedbackForm:!1,enableNewsletterForm:!1,showFirstPersonView:!1,showAntiAliasing:!1,showAmbientOcclusion:!1,showFocalLength:!1,enableGastronomies:!1,swapControlsMouseButtons:!0,enableDemo:!1,allowChangeSunPathLock:!1}),theme:{name:"lystio",gradient:"from-[#A540F3] to-[#A540F3]",hoverGradient:"hover:from-[#7f4ca7] hover:to-[#7f4ca7]",shadow:"shadow-blue-glow",hoverShadow:"hover:shadow-none",toggleShadow:"shadow-blue-glow-toggle",actionColor:"text-white",textColor:"text-white",focusInputColor:"focus:ring-white",zoomButtonsRadius:"[8px]"},updateURLParams:!1,appState:Object.assign(Object.assign({},h),{floorLevelIndicationState:{enabled:!0,floorHeight:3},showTrees:!0,sunPathLocked:!0}),enableIntroModal:!0,showInitialLocationPin:!0,showWeatherWidget:!1,infoButtonPosition:"bottom",initialZoomFallback:19,enableInitialDayTimelapse:!0,resetTimeToNoonIfTooDark:!0,limitCameraToRadius:!0,initialAnalyticsEnabled:!0,lockSunPathToInitialLocation:!0}),realitiq:Object.assign(Object.assign({},c),{capabilities:Object.assign(Object.assign({},c.capabilities),{canSearchLocation:!1,unlockEverything:!0,enableAnalytics:!1,enableAuth:!1,enableStudio:!1,showFullscreenButton:!1,trackingLevel:n.Anonymous,showMapStyle:!1,showShareButton:!1,showElevationModel:!1,enableFeedbackForm:!1,enableNewsletterForm:!1,showFirstPersonView:!1,showAntiAliasing:!1,showAmbientOcclusion:!1,showFocalLength:!1,enableGastronomies:!1,swapControlsMouseButtons:!0,enableDemo:!1,allowChangeSunPathLock:!1}),updateURLParams:!1,appState:Object.assign(Object.assign({},h),{floorLevelIndicationState:{enabled:!0,floorHeight:3},showTrees:!0,sunPathLocked:!0}),limitCameraToRadius:!0,enableIntroModal:!1,showInitialLocationPin:!0,showWeatherWidget:!1,infoButtonPosition:"bottom",initialZoomFallback:19,enableInitialDayTimelapse:!0,resetTimeToNoonIfTooDark:!0,lockSunPathToInitialLocation:!0,highlightBuilding:!0}),masterkey:Object.assign(Object.assign({},c),{capabilities:Object.assign(Object.assign({},c.capabilities),{canSearchLocation:!1,unlockEverything:!0,enableAnalytics:!0,enableAuth:!1,enableStudio:!1,showFullscreenButton:!0,trackingLevel:n.Anonymous,showMapStyle:!0,showDefaultBuildingHeight:!1,showHideUI:!1,showCoordinateInput:!1,showShareButton:!0,showElevationModel:!1,enableFeedbackForm:!1,enableNewsletterForm:!1,showFirstPersonView:!1,showAntiAliasing:!1,showAmbientOcclusion:!1,showFocalLength:!1,enableGastronomies:!1,swapControlsMouseButtons:!0,showAutoRotate:!1,enableDemo:!1,allowChangeSunPathLock:!1}),updateURLParams:!1,appState:Object.assign(Object.assign({},h),{floorLevelIndicationState:{enabled:!0,floorHeight:3},showTrees:!0,sunPathLocked:!0}),phantomLocks:{mapMode:!0,floorLevelIndication:!1,analytics:!0,dateSlider:!0,calendar:!0},limitCameraToRadius:!0,enableIntroModal:!0,showInitialLocationPin:!0,showWeatherWidget:!1,infoButtonPosition:"bottom",initialZoomFallback:19,enableInitialDayTimelapse:!0,resetTimeToNoonIfTooDark:!0,initialAutoRotation:!0,lockSunPathToInitialLocation:!0,highlightBuilding:!0}),oliverroad:Object.assign(Object.assign({},c),{capabilities:Object.assign(Object.assign({},c.capabilities),{canSearchLocation:!1,unlockEverything:!0,enableAnalytics:!1,enableAuth:!1,enableStudio:!1,showFullscreenButton:!1,trackingLevel:n.Anonymous,showMapStyle:!1,showShareButton:!1,showElevationModel:!1,enableFeedbackForm:!1,enableNewsletterForm:!1,showFirstPersonView:!1,showAntiAliasing:!1,showAmbientOcclusion:!1,showFocalLength:!1,enableGastronomies:!1,swapControlsMouseButtons:!0,enableDemo:!1,showCoordinateInput:!1,allowChangeSunPathLock:!1}),updateURLParams:!1,appState:Object.assign(Object.assign({},h),{floorLevelIndicationState:{enabled:!0,floorHeight:3},mapMode:a.M$.GOOGLE,sunPathLocked:!0}),limitCameraToRadius:!0,enableIntroModal:!1,showInitialLocationPin:!0,showWeatherWidget:!1,infoButtonPosition:"bottom",initialZoomFallback:19,enableInitialDayTimelapse:!0,resetTimeToNoonIfTooDark:!0,showFastMapModeSelector:!0,lockSunPathToInitialLocation:!0,highlightBuilding:!0}),detekt:Object.assign(Object.assign({},c),{capabilities:Object.assign(Object.assign({},c.capabilities),{canSearchLocation:!1,unlockEverything:!0,enableAnalytics:!1,enableAuth:!1,enableStudio:!1,showFullscreenButton:!1,trackingLevel:n.Anonymous,showMapStyle:!1,showShareButton:!1,showElevationModel:!1,enableFeedbackForm:!1,enableNewsletterForm:!1,showFirstPersonView:!1,showAntiAliasing:!1,showAmbientOcclusion:!1,showFocalLength:!1,enableGastronomies:!1,swapControlsMouseButtons:!0,enableDemo:!1,showCoordinateInput:!1,allowChangeSunPathLock:!1}),updateURLParams:!1,appState:Object.assign(Object.assign({},h),{floorLevelIndicationState:{enabled:!0,floorHeight:3},sunPathLocked:!0}),limitCameraToRadius:!0,enableIntroModal:!0,showInitialLocationPin:!0,showWeatherWidget:!1,infoButtonPosition:"bottom",initialZoomFallback:19,enableInitialDayTimelapse:!0,resetTimeToNoonIfTooDark:!0,lockSunPathToInitialLocation:!0,highlightBuilding:!0}),dahler:Object.assign(Object.assign({},c),{capabilities:Object.assign(Object.assign({},c.capabilities),{canSearchLocation:!1,unlockEverything:!0,enableAnalytics:!0,enableAuth:!1,enableStudio:!1,showFullscreenButton:!1,trackingLevel:n.Anonymous,showMapStyle:!1,showShareButton:!1,showElevationModel:!1,enableFeedbackForm:!1,enableNewsletterForm:!1,showFirstPersonView:!1,showAntiAliasing:!1,showAmbientOcclusion:!1,showFocalLength:!1,enableGastronomies:!1,swapControlsMouseButtons:!0,enableDemo:!1,showCoordinateInput:!1,allowChangeSunPathLock:!1}),updateURLParams:!1,appState:Object.assign(Object.assign({},h),{floorLevelIndicationState:{enabled:!0,floorHeight:3},sunPathLocked:!0}),limitCameraToRadius:!0,enableIntroModal:!0,showInitialLocationPin:!0,showWeatherWidget:!1,infoButtonPosition:"bottom",initialZoomFallback:19,enableInitialDayTimelapse:!0,resetTimeToNoonIfTooDark:!0,lockSunPathToInitialLocation:!0,initialAutoRotation:!0,highlightBuilding:!0}),immounited:Object.assign(Object.assign({},c),{capabilities:Object.assign(Object.assign({},c.capabilities),{canSearchLocation:!1,unlockEverything:!0,enableAnalytics:!0,enableAuth:!1,enableStudio:!1,showFullscreenButton:!1,trackingLevel:n.Anonymous,showMapStyle:!1,showShareButton:!1,showElevationModel:!1,enableFeedbackForm:!1,enableNewsletterForm:!1,showFirstPersonView:!1,showAntiAliasing:!1,showAmbientOcclusion:!1,showFocalLength:!1,enableGastronomies:!1,swapControlsMouseButtons:!0,enableDemo:!1,showCoordinateInput:!1,allowChangeSunPathLock:!1}),updateURLParams:!1,appState:Object.assign(Object.assign({},h),{floorLevelIndicationState:{enabled:!0,floorHeight:3},sunPathLocked:!0}),limitCameraToRadius:!0,enableIntroModal:!0,showInitialLocationPin:!0,showWeatherWidget:!1,infoButtonPosition:"bottom",initialZoomFallback:19,enableInitialDayTimelapse:!0,resetTimeToNoonIfTooDark:!0,lockSunPathToInitialLocation:!0,highlightBuilding:!0}),koengeter:Object.assign(Object.assign({},c),{capabilities:Object.assign(Object.assign({},c.capabilities),{canSearchLocation:!1,unlockEverything:!0,enableAnalytics:!1,enableAuth:!1,enableStudio:!1,showFullscreenButton:!1,trackingLevel:n.Anonymous,showMapStyle:!1,showShareButton:!1,showElevationModel:!1,enableFeedbackForm:!1,enableNewsletterForm:!1,showFirstPersonView:!1,showAntiAliasing:!1,showAmbientOcclusion:!1,showFocalLength:!1,enableGastronomies:!1,swapControlsMouseButtons:!0,enableDemo:!1,showCoordinateInput:!1,allowChangeSunPathLock:!1}),updateURLParams:!1,appState:Object.assign(Object.assign({},h),{floorLevelIndicationState:{enabled:!0,floorHeight:3},mapMode:a.M$.GOOGLE,sunPathLocked:!0}),limitCameraToRadius:!0,enableIntroModal:!1,showInitialLocationPin:!0,showWeatherWidget:!1,infoButtonPosition:"bottom",initialZoomFallback:19,enableInitialDayTimelapse:!0,resetTimeToNoonIfTooDark:!0,showFastMapModeSelector:!0,lockSunPathToInitialLocation:!0})},p=new r.X(c),m=new r.X("default"),g=new r.X(!1);function f(e){let[t,i]=(0,l.useState)(e(p.value));return(0,l.useEffect)(()=>{let t=p.subscribe(t=>{i(e(t))});return()=>t.unsubscribe()},[]),t}let x=()=>{var e;let t=d.V5.getConfigName(),i=null!=(e=u[t])?e:c;return p.next(i),m.next(t),g.next(!0),i.language&&o.ZP.changeLanguage(i.language),document.body.setAttribute("data-theme",i.theme.name),i}},57364:function(e,t,i){i.d(t,{I5:function(){return w},Lu:function(){return p},NN:function(){return b},SU:function(){return m},W5:function(){return v},ZW:function(){return g},gX:function(){return C},hu:function(){return x},mX:function(){return y},mr:function(){return f}});var s=i(14229),n=i(6925),o=i(82072),r=i(73206),a=i(89399),l=i(70846),d=i(46366);let h=Object.keys(d._8),c=h.reduce((e,t)=>{let i=d._8[t];return Object.assign(Object.assign({},e),{[t]:new s.X(i)})},{}),u=new s.X(void 0);function p(e){return u.value[e]}function m(){let e,t=d.Xq.value.appState;u.next(t);let i=d.Xq.value.updateURLParams?Object.assign(Object.assign({},e=d.Xq.value.appState),{mapStyle:a.V5.getBasemap()||e.mapStyle,visualQuality:a.V5.getVisualQuality()||e.visualQuality,cameraFocalLength:a.V5.getFocalLength()||e.cameraFocalLength,autoRotate:a.V5.getAutoRotate(),antiAliasing:a.V5.getAntiAliasing(),ambientOcclusion:a.V5.getSSAO(),floorLevelIndicationState:Object.assign({floorHeight:e.floorLevelIndicationState.floorHeight},a.V5.getFloorIndicationState()),elevationModel:a.V5.getElevationModel()||e.elevationModel,sunPathEnabled:a.V5.getSunPathEnabled(),autoPlayTime:a.V5.getAutoPlayTime()}):t;for(let e in i)c[e].next(i[e])}function g(e){return c[e]}function f(e){let[t,i]=(0,l.useState)(u.value[e]);return(0,l.useEffect)(()=>{let t=x(e,i,!0);return()=>t.unsubscribe()},[]),[t,(0,l.useCallback)(t=>{i(t),w(e,t)},[])]}function x(e,t,i=!1){return c[e].pipe((0,n.x)(),(0,o.T)(+!i)).subscribe(t)}function w(e,t){c[e].next(t)}function b(e){return c[e].value}function v(){return h.reduce((e,t)=>Object.assign(Object.assign({},e),{[t]:b(t)}),{})}let y=(e,t=[])=>{for(let i in e){if(t.includes(i))continue;let s=e[i],n=c[i];n&&void 0!==s&&n.next(s)}};function C(e){let t=Object.values(c);(0,r.T)(...t).subscribe(()=>{e(v())})}},67068:function(e,t,i){i.d(t,{E0:function(){return E},Pn:function(){return A},TM:function(){return M},UX:function(){return I},V2:function(){return n},as:function(){return T},fG:function(){return k},kd:function(){return O},kp:function(){return P},nM:function(){return S},sP:function(){return L}});var s,n,o=i(88635),r=i(16433),a=i(47386),l=i(14229),d=i(13826),h=i(56009),c=i(6925),u=i(78196),p=i(9521),m=i(12916),g=i(72867),f=i(33012),x=i(23904),w=i(89399),b=i(48383),v=i(14737),y=i(18261);(s=n||(n={})).PLAY="PLAY",s.TIME_SLIDER="TIME_SLIDER",s.DATE_SLIDER="DATE_SLIDER",s.OTHER="OTHER",s.LOCATION_ANIMATION="LOCATION_ANIMATION";let C=w.V5.getDate()||a.ou.now(),M=new l.X({dateTime:C,source:n.OTHER}),S=b.As.pipe((0,h.U)(r.Wy.fromMapLocation),(0,h.U)(e=>{try{let t=o.getFuzzyTimezoneFromTile([e.x,e.y,e.zoom]);if("string"==typeof t)return t;return f.I}catch(e){return f.I}}),(0,c.x)()),L=M.pipe((0,u.V)(S),(0,h.U)(([e,t])=>new g.I(e.dateTime,t))),T=M.pipe((0,p.P)(e=>(0,d.F)(2e3),{leading:!1,trailing:!0})),j=S.pipe((0,h.U)(e=>e===f.I?"UTC":e)),P=L.pipe((0,h.U)(y.ph)),E=L.pipe((0,h.U)(y.Wo)),A=L.pipe((0,c.x)((e,t)=>e.equals(t)),(0,u.V)(b.zc),(0,h.U)(([e,t])=>m.getTimes(e.dateTime.set({hour:12,minute:0,second:0,millisecond:0}).toJSDate(),t.lat,t.lng)),(0,u.V)(j),(0,h.U)(([e,t])=>x.b.fromTimes(e,t))),D=new l.X(void 0),O=new l.X(!1);function k(e){let t=M.getValue().dateTime.ordinal,i=e.ordinal,s=D.getValue();s&&s.stop();let o=M.getValue().dateTime.toJSDate();D.next(new v.kX({day:0}).to({day:i-t},500).easing(v.oY.Quadratic.Out).onUpdate(({day:e})=>{let t=a.ou.fromJSDate(o).plus({days:Math.floor(e)});M.next({dateTime:t,source:n.OTHER})}).start())}function I(e){let t=M.getValue().dateTime.year,i=e.year,s=M.getValue().dateTime.ordinal,o=e.ordinal,r=M.getValue().dateTime.toMillis()-a.ou.fromJSDate(M.getValue().dateTime.toJSDate()).set({hour:0,minute:0,second:0,millisecond:0}).toMillis(),l=e.toMillis()-a.ou.fromJSDate(e.toJSDate()).set({hour:0,minute:0,second:0,millisecond:0}).toMillis(),d=D.getValue();d&&d.stop();let h=M.getValue().dateTime.toJSDate();D.next(new v.kX({year:0,day:0,time:0}).to({year:i-t,day:o-s,time:l-r},500).easing(v.oY.Quadratic.Out).onUpdate(({year:e,day:t,time:i})=>{let s=a.ou.fromJSDate(new Date(+h+i)).plus({days:Math.floor(t),years:Math.floor(e)});M.next({dateTime:s,source:n.OTHER})}).onComplete(()=>{M.next({dateTime:e,source:n.OTHER})}).start())}},5906:function(e,t,i){i.d(t,{QA:function(){return h},Yy:function(){return d},cn:function(){return m},fg:function(){return c},k4:function(){return g},nA:function(){return p},s6:function(){return u}});var s=i(14229),n=i(56354),o=i(53205),r=i(15715),a=i(57364),l=i(16433);let d=new s.X(!1),h=new s.X(!1),c=new s.X(null),u=new s.X(!1);(0,n.a)([h,o.a7,(0,a.ZW)("mapMode"),o.R9]).subscribe(([e,t,i,s])=>{!e||localStorage.getItem("hideGoogle3DTooltip")||t||i===l.M$.GOOGLE||(null==s?void 0:s.isAllowedToUseStudio())?u.next(!1):u.next(!0)}),d.subscribe(e=>{e&&(p(),r.n.onGooglePreviewOpen())});let p=()=>{localStorage.setItem("hideGoogle3DTooltip","true"),u.next(!1)},m=()=>+(localStorage.getItem("google3DPreviewDialogVersion")||"0")>=1,g=()=>{localStorage.setItem("google3DPreviewDialogVersion","1")}},48383:function(e,t,i){i.d(t,{As:function(){return S},Em:function(){return A},It:function(){return j},MV:function(){return I},PG:function(){return v},RU:function(){return O},Vr:function(){return M},ZZ:function(){return n},bq:function(){return E},nl:function(){return k},oI:function(){return b},qi:function(){return P},tY:function(){return D},x:function(){return T},zN:function(){return y},zc:function(){return L}});var s,n,o=i(16433),r=i(7504),a=i(14229),l=i(13826),d=i(26876),h=i(82072),c=i(9521),u=i(56009),p=i(49419),m=i(15715),g=i(89399),f=i(46366),x=i(53205);let w={enableHighAccuracy:!1,timeout:5e3,maximumAge:1/0},b=(e=16)=>new Promise((t,i)=>{navigator.geolocation.getCurrentPosition(i=>{let s=parseFloat(i.coords.latitude.toFixed(6)),n=parseFloat(i.coords.longitude.toFixed(6));t(new o.Y(s,n,e))},e=>{i(e)},w)});(s=n||(n={}))[s.URL=0]="URL",s[s.Geolocation=1]="Geolocation",s[s.IP=2]="IP",s[s.Fallback=3]="Fallback";let v=new r.t(1),y=new r.t(1),C=v.pipe((0,h.T)(1)),M=new a.X(null);f.Xq.pipe((0,h.T)(1)).subscribe(e=>{var t,i,s,r,a;(t=e.initialZoomFallback,i=void 0,s=void 0,r=void 0,a=function*(){let e=g.V5.getLng(),i=g.V5.getLat();window.decodedLat.startsWith("$")||window.decodedLng.startsWith("$")||(i=+window.decodedLat,e=+window.decodedLng);let s=g.V5.getZoom(),r=g.V5.getAzimuth(),a=g.V5.getPolar();if(e&&i)return{mapLocation:new o.Y(i,e,s||t,r,a),source:n.URL};try{if(p.md){let e=yield p.md.requestLocation().catch(console.warn);if(null==e?void 0:e.success)return{mapLocation:new o.Y(e.body.lat,e.body.lng,t),source:n.Geolocation}}if(navigator.permissions){let e=yield navigator.permissions.query({name:"geolocation"}).catch(console.error);if(e&&(null==e?void 0:e.state)==="granted"){let e=yield b(t);return m.n.onLoadPageFromCurrentLocation(),{mapLocation:e,source:n.Geolocation}}}}catch(e){console.error(e)}try{let e=x.$l.getValue();if(e&&void 0!==e.latitude&&void 0!==e.longitude)return{mapLocation:new o.Y(e.latitude,e.longitude,t),source:n.IP}}catch(e){console.error(e)}return{mapLocation:new o.Y(48.2084,16.3735,15),source:n.Fallback}},new(r||(r=Promise))(function(e,t){function n(e){try{l(a.next(e))}catch(e){t(e)}}function o(e){try{l(a.throw(e))}catch(e){t(e)}}function l(t){var i;t.done?e(t.value):((i=t.value)instanceof r?i:new r(function(e){e(i)})).then(n,o)}l((a=a.apply(i,s||[])).next())})).then(({mapLocation:e,source:t})=>{v.next(e),y.next(t),M.next(e)}).catch(console.error)});let S=v.pipe((0,c.P)(e=>(0,l.F)(300),{leading:!1,trailing:!0})),L=S.pipe((0,u.U)(e=>({lng:e.lng,lat:e.lat}))),T=C.pipe((0,c.P)(e=>(0,l.F)(300),{leading:!1,trailing:!0})),j=v.pipe((0,c.P)(e=>(0,l.F)(2e3),{leading:!1,trailing:!0})),P=new d.x,E=new d.x,A=new a.X(void 0),D=new a.X(!1),O=new a.X(!1),k=new a.X({data:null,isEmpty:!0,lat:0,lng:0,timestamp:0}),I=new d.x},53205:function(e,t,i){i.d(t,{$l:function(){return Y},Bk:function(){return U},Br:function(){return L},IX:function(){return H},Jt:function(){return M},Kb:function(){return Z},M7:function(){return z},MI:function(){return g},Nt:function(){return $},Nv:function(){return B},OJ:function(){return k},Qs:function(){return P},R9:function(){return A},RZ:function(){return I},T9:function(){return v},Xt:function(){return y},Yx:function(){return X},Z$:function(){return Q},a7:function(){return q},as:function(){return F},bS:function(){return T},dO:function(){return G},di:function(){return V},eE:function(){return O},gR:function(){return E},iw:function(){return N},jR:function(){return C},kY:function(){return S},l8:function(){return W},mJ:function(){return j},nb:function(){return x},nh:function(){return R},rE:function(){return f},s_:function(){return b},tl:function(){return _},y7:function(){return w},yX:function(){return D}});var s,n,o,r=i(26876),a=i(14229),l=i(7504),d=i(12585),h=i(56009),c=i(6925),u=i(86401),p=i(89399),m=i(23183);let g=new r.x,f=new a.X(void 0),x=new a.X(void 0),w=new l.t,b=w.asObservable(),v=new a.X(!1),y=new r.x,C=y.asObservable(),M=new a.X(!1),S=new l.t,L=new r.x,T=new r.x,j=new l.t,P=j.asObservable(),E=j.pipe((0,d.E)(e=>null==e?void 0:e.id)),A=j.pipe((0,h.U)(e=>{var t;return u.G.fromAppMetadata(null==(t=null==e?void 0:e.app_metadata)?void 0:t.roles)}),(0,c.x)((e,t)=>e.equals(t))),D=new a.X(null),O=new r.x,k=new a.X(0),I=new l.t,N=new l.t,_=N.asObservable(),R=new a.X(!1),V=new a.X(!1),B=new r.x,U=()=>new Promise(e=>{B.next({callback:t=>{e(t)}})}),F=new r.x,Z=new a.X("main"),H=new a.X({isVisible:!1}),G=new l.t,z=new a.X(!1),W=new a.X(!0),X=new a.X(p.V5.getCompassArrowDirection()),Y=new a.X((0,m.Z)()),$=new a.X((null==(o=null==(n=null==(s=Y.value)?void 0:s.country)?void 0:n.code)?void 0:o.toLowerCase())==="us"?"imperial":"metric"),Q=new a.X(!1),q=new a.X(!1)},84100:function(e,t,i){i.d(t,{$4:function(){return ed},A$:function(){return el},B1:function(){return eA},BU:function(){return eM},D$:function(){return ey},Do:function(){return N},E3:function(){return eo},F7:function(){return ej},G2:function(){return $},JD:function(){return eS},Kw:function(){return Z},L3:function(){return X},LP:function(){return V},Lo:function(){return eD},Mg:function(){return em},NB:function(){return ee},NH:function(){return G},Qq:function(){return W},SF:function(){return ep},SH:function(){return R},SX:function(){return z},TX:function(){return eb},UI:function(){return ek},Vi:function(){return B},Xi:function(){return es},Y9:function(){return eC},Zr:function(){return K},c_:function(){return Q},ck:function(){return ev},dG:function(){return ex},fK:function(){return eg},fZ:function(){return ei},fn:function(){return er},hU:function(){return eu},ic:function(){return _},ml:function(){return ew},nJ:function(){return ef},nj:function(){return Y},pi:function(){return U},qW:function(){return eT},r9:function(){return eh},rB:function(){return en},ry:function(){return H},sT:function(){return ea},t_:function(){return eP},up:function(){return et},uy:function(){return q},wD:function(){return J},ws:function(){return F},xL:function(){return eO},xR:function(){return ec}});var s=i(16433),n=i(14229),o=i(26876),r=i(25363),a=i(45666),l=i(56071),d=i(56354),h=i(84942),c=i(56009),u=i(6925),p=i(79121),m=i(20694),g=i(48383),f=i(53205),x=i(61381),w=i(56972),b=i(57155),v=i(97160),y=i(15715),C=i(67068),M=i(57364),S=i(58017),L=i(52444),T=i(3665),j=i(33578),P=i(49419),E=i(18320),A=i(46366),D=i(950),O=i(412),k=i(81275),I=function(e,t,i,s){return new(i||(i=Promise))(function(n,o){function r(e){try{l(s.next(e))}catch(e){o(e)}}function a(e){try{l(s.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(r,a)}l((s=s.apply(e,t||[])).next())})};let N=new n.X(!1),_=new n.X(void 0),R=new n.X(void 0),V=new n.X(!1),B=new n.X(void 0),U=B.pipe((0,c.U)(e=>!!e)),F=f.R9.pipe((0,c.U)(e=>!e.isAllowedToUseStudio())),Z=new n.X(!1),H=new n.X(!1),G=B.pipe((0,u.x)((e,t)=>(null==e?void 0:e.id)===(null==t?void 0:t.id))),z=new o.x,W=z.asObservable(),X=new n.X(void 0),Y=B.pipe((0,u.x)((e,t)=>(null==e?void 0:e.buildings)===(null==t?void 0:t.buildings)),(0,c.U)(e=>{let t=new Map;return null==e||e.buildings.forEach(e=>{t.set(e.buildingId,e)}),t})),$=B.pipe((0,u.x)((e,t)=>(null==e?void 0:e.models)===(null==t?void 0:t.models)),(0,c.U)(e=>{let t=new Set;return null==e||e.models.forEach(e=>{t.add(e)}),t})),Q=B.pipe((0,u.x)((e,t)=>(null==e?void 0:e.shapes)===(null==t?void 0:t.shapes)),(0,c.U)(e=>{var t;return null!=(t=null==e?void 0:e.shapes)?t:[]})),q=B.pipe((0,u.x)((e,t)=>(null==e?void 0:e.treeOverrides)===(null==t?void 0:t.treeOverrides)),(0,c.U)(e=>{var t;return null!=(t=null==e?void 0:e.treeOverrides)?t:[]})),K=B.pipe((0,u.x)((e,t)=>(null==e?void 0:e.solarPanels)===(null==t?void 0:t.solarPanels)),(0,c.U)(e=>{var t;return null!=(t=null==e?void 0:e.solarPanels)?t:[]})),J=B.pipe((0,c.U)(e=>{var t;return null!=(t=null==e?void 0:e.hasChanges)&&t})),ee=new o.x,et=new o.x,ei=new o.x,es=new n.X(void 0),en=new n.X(void 0),eo=new n.X(void 0),er=new n.X(void 0),ea=new n.X(void 0),el=e=>{ei.next(e),es.next(void 0),en.next(void 0),eo.next(void 0),er.next(void 0),ea.next(void 0)},ed=e=>{ei.next(void 0),es.next(e),en.next(void 0),eo.next(void 0),er.next(void 0),ea.next(void 0)},eh=e=>{ei.next(void 0),es.next(void 0),en.next(e),eo.next(void 0),er.next(void 0),ea.next(void 0)},ec=e=>{ei.next(void 0),es.next(void 0),en.next(void 0),eo.next(e),er.next(void 0),ea.next(void 0)},eu=e=>{ei.next(void 0),es.next(void 0),en.next(void 0),eo.next(void 0),er.next(e),ea.next(void 0)},ep=e=>{ei.next(void 0),es.next(void 0),en.next(void 0),eo.next(void 0),er.next(void 0),ea.next(e)},em=new n.X({total:0,average:0}),eg=new n.X(["translate","local"]),ef=new n.X(void 0),ex=new n.X(!1),ew=new n.X(!1),eb=new n.X(void 0),ev=new n.X(void 0),ey=new n.X(void 0);function eC(e,t=!0){let i=JSON.parse(JSON.stringify(e));R.next(i),V.next(!0),(0,h.G)().then(e=>{var n;if((null==(n=R.value)?void 0:n.id)!==i.id)return;_.next(e);let o=e.find(e=>e.id===i.id);o?(B.next(Object.assign(Object.assign({},o),{hasChanges:!1})),y.n.onStudioProjectOpen(!!o.isFree),t&&function(e){let t=(e=>{let t=(0,m.k)(e);return void 0!==t.lat&&void 0!==t.lng?{lat:t.lat,lng:t.lng}:e.initialLocation})(e);t&&g.qi.next({location:new s.Y(t.lat,t.lng,p.UW.value===p.BS.Default?17:window.innerWidth<768?18:19),dropPin:!1,animate:!1})}(o)):eM(),V.next(!1)})}function eM(){B.next(void 0),R.next(void 0),V.next(!1),ew.next(!1)}function eS(e){return I(this,void 0,void 0,function*(){let t=B.getValue();if(t){H.next(!0);let i=!!(null==e?void 0:e.isGuest()),s=null==e?void 0:e.isAllowedToUseStudio();if(i){(0,D.ms)({subscription:O.K.FREE,trigger:"studio_project_share_button"}),H.next(!1);return}if(navigator.share&&(0,v.tq)()){let e=yield ek(t,!1);e&&(yield eL(e)),H.next(!1)}else{let e=yield(0,r.z)(J),i=()=>I(this,void 0,void 0,function*(){let e=yield(0,x.I)(t.id);s?E.Us.next(Object.assign(Object.assign({},null==e?void 0:e.share),{hasChanges:!1})):yield eL(t)});e?(yield I(void 0,void 0,void 0,function*(){return new Promise(e=>{f.y7.next({modal:T.o.UNSAVED_SHARE_PROJECT_CHANGES,opts:{onConfirm:()=>I(void 0,void 0,void 0,function*(){Z.next(!0);let t=yield ek(B.getValue(),!1);if(Z.next(!1),!t){H.next(!1),e(!1);return}B.next(Object.assign(Object.assign({},t),{hasChanges:!1}));let i=(0,b.t)("studio.unsavedChangesDialog.share.toastText");f.eE.next({id:(0,w.Z)(),shortText:i,longText:i,disappear:!0}),e(!0)}),onCancel:()=>{H.next(!1),e(!1)}}})})}))&&(yield i()):yield i()}H.next(!1);return}let[i,s]=yield Promise.all([(0,r.z)(g.PG),(0,r.z)(C.sP)]),n=window.location.href;"default"!==A.Gn.getValue()&&(n=`https://app.shadowmap.org/?lat=${i.lat.toFixed(5)}&lng=${i.lng.toFixed(5)}&zoom=${i.decimalZoom.toFixed(2)}&azimuth=${i.azimuth.toFixed(5)}&polar=${i.polar.toFixed(5)}&time=${s.dateTime.toMillis()}`);let o=(0,b.t)("nativeLocationShareDialog.title"),a=(0,b.t)("nativeLocationShareDialog.text");if(j.Z.isNativeAndroid&&P.md){y.n.onLocationShareClick(),P.md.requestShare(o,a,window.location.href);return}if(navigator.share&&(0,v.tq)()){try{navigator.share({text:a,title:o,url:n}),y.n.onLocationShareClick()}catch(e){console.log("Could not share url or user cancelled sharing.",e)}return}y.n.onLocationShareClick(),f.y7.next({modal:T.o.LOCATION_SHARE,opts:{url:n}})})}function eL(e){return I(this,void 0,void 0,function*(){let t=yield(0,x.I)(e.id);e.shareId=t.share.shareId;let i=yield(0,f.Bk)();yield(0,k.l)(t.share.shareId,i);let s=yield eO(t.share),{updatedShare:n}=yield(0,S.g)(s),o=`${window.location.origin}/share/${n.shareId}`;if(navigator.share&&(0,v.tq)())try{yield navigator.share({title:e.name,url:o})}catch(e){console.error(e)}else f.y7.next({modal:T.o.LOCATION_SHARE,opts:{url:o,isStudioProject:!0}})})}function eT(e){var t,i,n;return I(this,void 0,void 0,function*(){let o=yield(0,r.z)(g.PG),a=s.wz.find(t=>t.name===e),l=null!=(t=null==a?void 0:a.dimensions)?t:{x:1,y:1,z:1},d=null!=(i=null==a?void 0:a.initialHeight)?i:15,h=null!=(n=null==a?void 0:a.initialOffsetFromGround)?n:0,c={id:(0,w.Z)(),type:e,name:eE(e),lat:o.lat,lng:o.lng,offsetFromGround:h,rotationX:0,rotationY:0,rotationZ:0,scaleX:d*l.x/l.z,scaleY:d*l.y/l.z,scaleZ:d,hidden:!1,createdAt:new Date};B.next(Object.assign(Object.assign({},B.value),{prefabs:[...B.value.prefabs,c],hasChanges:!0})),eo.next(c)})}function ej(e){return I(this,void 0,void 0,function*(){let t=Object.assign(Object.assign({},e),{id:(0,w.Z)(),name:eE(e.type),hidden:!1,createdAt:new Date});return B.next(Object.assign(Object.assign({},B.value),{prefabs:[...B.value.prefabs,t],hasChanges:!0})),t})}function eP(){var e,t;let i=(null!=(t=null==(e=B.value)?void 0:e.shapes)?t:[]).map(e=>e.name),s=1;for(;i.includes(s.toString());)s++;return s.toString()}function eE(e){var t,i;let s=(null!=(i=null==(t=B.value)?void 0:t.prefabs)?i:[]).filter(t=>t.type===e).map(e=>e.name),n=1;for(;s.includes(n.toString());)n++;return n.toString()}function eA(e){return I(this,void 0,void 0,function*(){let t=Object.assign(Object.assign({},e),{id:(0,w.Z)(),name:eP(),createdAt:new Date,status:"pending"});return B.next(Object.assign(Object.assign({},B.value),{shapes:[...B.value.shapes,t],hasChanges:!0})),t})}function eD(e){return I(this,void 0,void 0,function*(){let t=B.value;if(t){let i=t.models.find(t=>t.id===e);if(i){let e=Object.assign(Object.assign({},i),{id:(0,w.Z)(),status:"selecting"});B.next(Object.assign(Object.assign({},t),{models:[...t.models,e],hasChanges:!0}))}}})}function eO(e){return I(this,void 0,void 0,function*(){return new Promise(t=>{g.PG.pipe((0,a.P)(),(0,l.M)(C.TM,(0,M.ZW)("mapStyle"),(0,M.ZW)("showTrees"),(0,M.ZW)("floorLevelIndicationState"),(0,M.ZW)("defaultBuildingHeight"),(0,M.ZW)("autoRotate"),(0,M.ZW)("cameraFocalLength"),(0,M.ZW)("sunVectorVisible"),(0,M.ZW)("elevationModel"),(0,M.ZW)("sunPathEnabled"),(0,M.ZW)("sunPathLocked"),(0,M.ZW)("sunPathLockLocation"),(0,M.ZW)("mapMode"),(0,M.ZW)("autoPlayTime"))).subscribe(([i,s,n,o,r,a,l,d,h,c,u,p,m,g,f])=>I(this,void 0,void 0,function*(){let x=s.dateTime.toISO();t(Object.assign(Object.assign({},e),{location:i,date:x,appState:{mapStyle:n,showTrees:o,floorLevelIndicationState:r,defaultBuildingHeight:a,elevationModel:c,autoRotate:l,cameraFocalLength:d,autoPlayTime:f,sunPathEnabled:u,sunPathLocked:p,sunPathLockLocation:m,sunVectorVisible:h,mapMode:g}}))}))})})}function ek(e,t){return I(this,void 0,void 0,function*(){try{let{updatedProject:i,isConflict:s}=yield(0,L.f)(e,!1);if(s)return void f.y7.next({modal:T.o.PROJECT_CONFLICT,opts:{closeAfterSave:t}});let n=yield _.value,o=null==n?void 0:n.map(t=>t.id===e.id?i:t);return _.next(o),B.next(Object.assign(Object.assign({},i),{hasChanges:!1})),y.n.onStudioProjectSave(!!e.isFree),i}catch(e){console.error(e),alert((0,b.t)("studio.genericError"))}})}(0,d.a)([ef,B]).pipe((0,u.x)()).subscribe(([e,t])=>{var i;"prefabs"===e?0===(null!=(i=null==t?void 0:t.prefabs.length)?i:0)&&ew.next(!0):ew.next(!1)}),ef.subscribe(e=>{e&&y.n.onStudioQuickActionClick(e)}),W.pipe((0,c.U)(e=>{var t;return null==(t=null==e?void 0:e.userBuilding)?void 0:t.buildingId}),(0,u.x)()).subscribe(e=>{e&&y.n.onStudioBuildingSelect()}),X.pipe((0,u.x)((e,t)=>(null==e?void 0:e.tree.lat)===(null==t?void 0:t.tree.lat)&&(null==e?void 0:e.tree.lng)===(null==t?void 0:t.tree.lng)),(0,u.x)()).subscribe(e=>{(null==e?void 0:e.tree)&&y.n.onStudioTreeSelect()})},18320:function(e,t,i){let s;i.d(t,{IN:function(){return x},Mm:function(){return f},Us:function(){return g}});var n=i(14229),o=i(6925),r=i(56009),a=i(56071),l=i(57364),d=i(81098),h=i(48383),c=i(67068),u=i(16433),p=i(47386),m=i(79121);let g=new n.X(void 0),f=g.pipe((0,o.x)((e,t)=>(null==e?void 0:e.shareId)===(null==t?void 0:t.shareId)));g.subscribe(e=>{e&&(m.UW.next(m.BS.Default),(0,l.I5)("hideUI",!1),(0,l.I5)("firstPersonView",!1))});let x=g.pipe((0,r.U)(e=>{var t;return null!=(t=null==e?void 0:e.hasChanges)&&t})),w=new n.X(void 0),b=new n.X(void 0),v=e=>{e.hasChanges||g.next(Object.assign(Object.assign({},e),{hasChanges:!0}))};h.x.pipe((0,a.M)(g)).subscribe(([e,t])=>{e!==(null==t?void 0:t.location)&&t&&v(t)}),c.TM.pipe((0,a.M)(g)).subscribe(([e,t])=>{t&&e.dateTime.toISO()!==t.date&&v(t)}),(0,l.gX)(e=>{let t=g.value;t&&JSON.stringify(e)!==JSON.stringify(t.appState)&&v(t)}),f.pipe((0,a.M)(h.PG,c.TM)).subscribe(([e,t,i])=>{e?(s=(0,l.W5)(),w.next(t),b.next(i),d.IP.next(!1),y(e)):((0,l.mX)(s),w.value&&h.qi.next({location:w.value,dropPin:!1,animate:!1}),b.value&&c.TM.next(b.value),d.IP.next(!0))});let y=e=>{if(e.location){let{lat:t,lng:i,zoom:s,azimuth:n,polar:o}=e.location,r=new u.Y(t,i,s,n,o);h.qi.next({location:r,dropPin:!1,animate:!1})}if(e.date){let t=p.ou.fromISO(e.date);c.TM.next({dateTime:t,source:c.V2.OTHER})}e.appState&&(0,l.mX)(e.appState,["defaultBuildingHeight"])}},53804:function(e,t,i){i.d(t,{A:function(){return l},I:function(){return d}});var s=i(3665),n=i(53205);let o={recovery:s.o.SET_PASSWORD,confirmation:s.o.CONFIRM_EMAIL,invite:s.o.INVITE},r=(document.location.hash||"").replace(/^#\/?/,""),a=r&&r.match(/(confirmation|recovery|invite)_token=([^&]+)/),l=!!a,d=()=>{setTimeout(()=>void(a&&(n.y7.next({modal:o[a[1]],opts:{token:a[2]}}),document.location.hash="")),2e3)}},81098:function(e,t,i){i.d(t,{IP:function(){return f},mw:function(){return g}});var s=i(61579),n=i(14229),o=i(56354),r=i(43458),a=i(67068),l=i(48383),d=i(89399),h=i(16433),c=i(57364),u=i(46366),p=i(53205);let m=l.PG.pipe((0,r.b)(500)),g=a.TM.pipe((0,r.b)(500)),f=new n.X(!0);(0,o.a)([f,m,g,u.Xq,p.Z$,(0,c.ZW)("mapStyle"),(0,c.ZW)("cameraFocalLength"),(0,c.ZW)("elevationModel"),(0,c.ZW)("floorLevelIndicationState"),(0,c.ZW)("antiAliasing"),(0,c.ZW)("ambientOcclusion"),(0,c.ZW)("visualQuality"),(0,c.ZW)("sunVectorVisible"),(0,c.ZW)("autoRotate"),(0,c.ZW)("sunPathEnabled")]).pipe((0,r.b)(500)).subscribe(([e,{lat:t,lng:i,decimalZoom:n,azimuth:o,polar:r},{dateTime:a},l,c,u,p,m,g,f,b,y,C,M,S])=>{if(!e||!l.updateURLParams||c)return;let L=s.parse(location.search);L.vq=(e=>{switch(e){case h.pV.DESKTOP_LOW:case h.pV.MOBILE_LOW:return 1;case h.pV.DESKTOP_MEDIUM:case h.pV.MOBILE_MEDIUM:break;case h.pV.DESKTOP_HIGH:case h.pV.MOBILE_HIGH:return 3}return 2})(y).toString(),f?L.aa="true":delete L.aa,b?L.ssao="true":delete L.ssao,C?w(d.nH):x(d.nH),M?w(d.nW):x(d.nW),L.zoom=null==n?void 0:n.toFixed(2),L.lng=null==i?void 0:i.toFixed(5),L.lat=null==t?void 0:t.toFixed(5),L.azimuth=null==o?void 0:o.toFixed(5),L.polar=null==r?void 0:r.toFixed(5),L.time=null==a?void 0:a.toMillis().toString(),L.basemap=u,L.elevation=m,L.f=p.toFixed(1),L.hud=S?"true":"false",g.enabled?L.floor=g.floorHeight.toFixed(1):delete L.floor;let T=new URL(window.location.href),j=`${T.origin}${T.pathname}?${s.stringify(L,{sort:v})}${location.hash}`;history.pushState(null,"",j)});let x=e=>{let t=s.parse(location.search);delete t[e];let i=new URL(window.location.href),n=`${i.origin}${i.pathname}?${s.stringify(t)}${location.hash}`;history.replaceState(null,"",n)},w=e=>{let t=s.parse(location.search);t[e]="";let i=new URL(window.location.href),n=`${i.origin}${i.pathname}?${s.stringify(t)}${location.hash}`;history.replaceState(null,"",n)},b=["zoom","lng","lat"],v=(e,t)=>b.indexOf(t)-b.indexOf(e)},44987:function(e,t,i){i.d(t,{sb:function(){return s},uZ:function(){return n},wT:function(){return o},xG:function(){return r}});let s=e=>{let t=document.querySelector(e);if(!t)throw Error(`Could not find element [${e}]`);return t},n=(e,t,i)=>Math.min(Math.max(i,e),t),o=(e,t)=>{if(t>=0)return e;let i=["springEquinox","summerSolstice","autumnEquinox","winterSolstice"];return i[(i.indexOf(e)+2)%i.length]},r=({value:e,isValueInCents:t=!0,decimalDigits:i,currencyCode:s,currencySymbol:n})=>{let o=i>1&&t?e/Math.pow(10,i):e,r=o%1!=0,a=new Intl.NumberFormat(void 0,{style:"currency",currency:s,minimumFractionDigits:r?i:0,maximumFractionDigits:i}).formatToParts(o);if(void 0!==n)for(let e of a)"currency"===e.type&&(e.value=n);return a.map(e=>e.value).join("")}},27841:function(e,t,i){var s,n;function o(e){return e===s.EXPLORER||e===s.HOME_YEARLY||e===s.STUDIO_PROJECTS_YEARLY}i.d(t,{tJ:function(){return s},ut:function(){return o}}),(n=s||(s={})).EXPLORER="EXPLORER",n.HOME_MONTHLY="HOME_MONTHLY",n.HOME_YEARLY="HOME_YEARLY",n.STUDIO_PROJECTS_YEARLY="STUDIO_PROJECTS_YEARLY",n.STUDIO_PROJECTS_MONTHLY="STUDIO_PROJECTS_MONTHLY"},39660:function(e,t,i){i.d(t,{G:function(){return o}});var s=i(38005),n=i(89580);class o{constructor({radius:e,height:t,roof:i},n){let o=i?.radius||e+1,r=i?.height||0;this.createHouse(e,t,n),i&&this.createRoof(o,r,t,n),this.group=new s.Group,this.group.add(...[this.houseMesh,this.roofMesh].filter(Boolean))}createHouse(e,t,i){this.houseGeometry=new s.CylinderGeometry(e,e,2*t,32,1,!1),this.houseMaterial=new n.Um(new s.Color(0xeeeeee),new s.Color(0xffffff)),this.houseMesh=new s.Mesh(this.houseGeometry,this.houseMaterial),this.houseGeometry.rotateX(Math.PI/2),this.houseMesh.castShadow=!0,this.houseMesh.receiveShadow=!0,this.houseMesh.visible=!0,this.houseMesh.position.copy(i)}createRoof(e,t,i,o){this.roofGeometry=new s.ConeGeometry(e,t,50,20,!0),this.roofMaterial=new n.Um(new s.Color(0xa13c3c),new s.Color(0xffffff)),this.roofMesh=new s.Mesh(this.roofGeometry,this.roofMaterial),this.roofGeometry.rotateX(Math.PI/2),this.roofMesh.castShadow=!0,this.roofMesh.receiveShadow=!0,this.roofMesh.visible=!0,this.roofMesh.position.copy(o).add(new s.Vector3(0,0,i+t/2))}getBuilding(){return this.group}}},22958:function(e,t,i){i.d(t,{Z:function(){return o}});var s=i(38005),n=i(330);class o extends s.Mesh{constructor(){let e=new s.MeshBasicMaterial({color:0xffffff,depthTest:!1,depthWrite:!1,toneMapped:!1}),t=new s.BoxGeometry(10,.5,.25),i=t.clone();i.translate(-6,0,0);let o=t.clone();o.translate(6,0,0);let r=t.clone();r.rotateZ(Math.PI/2),r.translate(0,6,0);let a=t.clone();a.rotateZ(Math.PI/2),a.translate(0,-6,0),super((0,n.n4)([i,o,r,a]),e),this.renderOrder=10}updateScale(e){let t=e.position.length()/350;this.scale.set(t,t,t)}}},52264:function(e,t,i){i.d(t,{Z:function(){return s}});class s{constructor(e){this.element=e,this.sunHUDPointer=!1,this.sunHUDGrab=!1,this.sunHUDGrabbing=!1,this.analyticsPointer=!1,this.firstPersonGrab=!1,this.firstPersonGrabbing=!1}setSunHUDPointer(e){this.sunHUDPointer=e,this.updateCursor()}setSunHUDGrab(e){this.sunHUDGrab=e,this.updateCursor()}setSunHUDGrabbing(e){this.sunHUDGrabbing=e,this.updateCursor()}setAnalyticsPointer(e){this.analyticsPointer=e,this.updateCursor()}setFirstPersonState(e,t){this.firstPersonGrab=e,this.firstPersonGrabbing=t,this.updateCursor()}updateCursor(){this.sunHUDGrabbing?this.element.style.cursor="grabbing":this.sunHUDGrab?this.element.style.cursor="grab":this.sunHUDPointer||this.analyticsPointer?this.element.style.cursor="pointer":this.firstPersonGrabbing?this.element.style.cursor="grabbing":this.firstPersonGrab?this.element.style.cursor="grab":this.element.style.cursor="auto"}}},93238:function(e,t,i){i.d(t,{T:function(){return n}});var s=i(60564);let n=Object.freeze({message:e=>{console.error(e),(0,s.uT)(e)},exception:(e,t)=>{console.error(e),(0,s.Tb)(t)}})},46620:function(e,t,i){i.d(t,{Z:function(){return n}});var s=i(38005);class n{constructor(){this.group=new s.Group,this.elevationOffset=0}updateElevation(e,t){if(!this.group.visible)return;let i=void 0!==t?t:e.pickElevationAtXY(this.group.position);this.group.position.z=i+this.elevationOffset}}},94435:function(e,t,i){i.d(t,{e:function(){return n},n:function(){return r}});var s,n,o=i(58424);(s=n||(n={})).IDLE="IDLE",s.LOADING="LOADING",s.FINISHED="FINISHED",s.ABORTED="ABORTED",s.DISPOSED="DISPOSED";class r{constructor(e,t){this.index=e,this.layer=t,this.state=n.IDLE,this.position=o.Z.TMSToMeters({x:e.x+.5,y:e.y+.5},e.zoom)}}},18975:function(e,t,i){i.d(t,{Z:function(){return o}});var s=i(38005),n=i(87187);class o{constructor({analyticsPass:e,renderer:t,controls:i,cursorManager:o,calculateAnalyticsMonths:r,stopAnalyticsMonths:a,onSceneUpdated:l,onCrosshairChange:d}){this.analyticsEnabled=!1,this.emitter=new n.Z,this.accumTextureHoverPositionChanged=!1,this.accumTextureClickPositionPixels=new s.Vector2(0,0),this.accumTextureClickPosition=new s.Vector2(0,0),this.accumTextureHoverPosition=new s.Vector2(0,0),this.accumTextureContinuousSampling=!1,this.monthlyNeedsUpdate=!1,this.touchDownTimestamp=0,this.isMagnifierVisible=!1,this.lastTotalSampleTimestamp=0,this.lastMonthlyStartTimestamp=0,this.isHighQuality=!1,this.isLastSampleHighQuality=!1,this.controls=i,this.analyticsPass=e,this.cursorManager=o,this.calculateAnalyticsMonths=r,this.stopAnalyticsMonths=a,this.onSceneUpdated=l,this.onCrosshairChange=d,this.analyticsPass.emitter.on("qualityChanged",e=>{this.isHighQuality=e});let h=null,c=(e,i)=>{if(this.analyticsEnabled){this.accumTextureHoverPositionChanged=!0;let s=e/t.domElement.clientWidth,n=1-i/t.domElement.clientHeight;this.accumTextureHoverPosition.set(s,n)}else this.cursorManager.setAnalyticsPointer(!1);let n=new s.Vector2(e,i);h&&h.distanceTo(n)>=1&&this.resetTooltip()},u=(e,i)=>{if(!this.analyticsEnabled)return;let s=null;!this.accumTextureContinuousSampling&&window.innerWidth<640&&i<310&&(s={offsetX:e,offsetY:i},i+=310-i),s&&this.onCrosshairChange(s.offsetX,s.offsetY,!0);let n=e/t.domElement.clientWidth,o=1-i/t.domElement.clientHeight;this.accumTextureClickPosition.set(n,o),this.accumTextureClickPositionPixels.set(e,i),this.accumTextureContinuousSampling=!0,this.monthlyNeedsUpdate=!0};t.domElement.addEventListener("mousedown",e=>{h=new s.Vector2(e.offsetX,e.offsetY)}),t.domElement.addEventListener("mouseup",e=>{let t=new s.Vector2(e.offsetX,e.offsetY);h&&1>h.distanceTo(t)&&u(e.offsetX,e.offsetY),h=null}),t.domElement.addEventListener("mousemove",e=>c(e.offsetX,e.offsetY)),t.domElement.addEventListener("wheel",e=>{this.resetTooltip()}),t.domElement.addEventListener("touchend",e=>{let t=new s.Vector2(e.changedTouches[0].clientX,e.changedTouches[0].clientY);h&&3>h.distanceTo(t)||this.isMagnifierVisible?u(e.changedTouches[0].clientX,e.changedTouches[0].clientY):this.onSceneUpdated(),this.touchDownTimestamp=0,this.isMagnifierVisible=!1}),t.domElement.addEventListener("touchstart",e=>{let i=e.touches[0].clientX/t.domElement.clientWidth,n=1-e.touches[0].clientY/t.domElement.clientHeight;h=new s.Vector2(e.touches[0].clientX,e.touches[0].clientY),this.analyticsPass.accumMagnifierPosition.set(i,n),this.touchDownTimestamp=Date.now()}),t.domElement.addEventListener("touchmove",e=>{let i=e.touches[0].clientX/t.domElement.clientWidth,n=1-e.touches[0].clientY/t.domElement.clientHeight,o=new s.Vector2(e.touches[0].clientX,e.touches[0].clientY);this.analyticsPass.accumMagnifierPosition.set(i,n),h&&o.distanceTo(h)>=3&&!this.isMagnifierVisible&&(this.touchDownTimestamp=Date.now(),this.resetTooltip())})}onAnalyticsToggle(e){e||this.resetTooltip(),this.analyticsEnabled=e}resetTooltip(){this.analyticsEnabled&&(this.emitter.emit("pointerSampled",[{x:0,y:0,isAccessible:!1,isReady:!1,energy:0,maxEnergy:0,maxEnergyAtNormal:0,isCrosshairVisible:!1,time:0,maxTime:0,timeInDaylightFraction:0}]),this.emitter.emit("monthlyPointerSampled",[[]]),this.accumTextureContinuousSampling=!1,this.monthlyNeedsUpdate=!1,this.stopAnalyticsMonths(),this.onCrosshairChange(0,0,!1))}resetMonthly(){this.stopAnalyticsMonths(),this.monthlyNeedsUpdate=!1,this.emitter.emit("monthlyPointerSampled",[[]])}onRender(){let e=this.touchDownTimestamp>0&&Date.now()-this.touchDownTimestamp>400||this.isMagnifierVisible;if(this.analyticsPass.accumMagnifierVisible=e,this.emitter.emit("magnifierVisible",[e]),e&&(this.isMagnifierVisible=!0,this.onSceneUpdated()),this.controls.toggleTouchControls(!e),this.accumTextureContinuousSampling){let e=this.accumTextureClickPositionPixels.x,t=this.accumTextureClickPositionPixels.y,i=Date.now();this.isHighQuality?this.analyticsPass.sampleTexture(this.accumTextureClickPosition.x,this.accumTextureClickPosition.y).then(s=>{this.accumTextureContinuousSampling&&i>this.lastTotalSampleTimestamp&&this.isHighQuality&&(this.emitter.emit("pointerSampled",[{...s,isCrosshairVisible:!0,x:e,y:t,isAccessible:!0}]),this.isLastSampleHighQuality=!0,this.lastTotalSampleTimestamp=i)}):(this.emitter.emit("pointerSampled",[{x:this.accumTextureClickPositionPixels.x,y:this.accumTextureClickPositionPixels.y,isAccessible:!0,isReady:!1,energy:0,maxEnergy:0,maxEnergyAtNormal:0,isCrosshairVisible:!0,time:0,maxTime:0,timeInDaylightFraction:0}]),this.isLastSampleHighQuality=!1,this.lastTotalSampleTimestamp=i)}if(this.monthlyNeedsUpdate&&this.isHighQuality&&this.isLastSampleHighQuality){let e=Date.now();this.lastMonthlyStartTimestamp=Date.now(),this.emitter.emit("monthlyPointerSampled",[[]]),this.calculateAnalyticsMonths(this.accumTextureClickPosition.x,this.accumTextureClickPosition.y,t=>{e===this.lastMonthlyStartTimestamp&&this.emitter.emit("monthlyPointerSampled",[t.map(e=>({...e,x:0,y:0,isCrosshairVisible:!0}))])}),this.monthlyNeedsUpdate=!1}this.accumTextureHoverPositionChanged&&(this.analyticsPass.sampleTexture(this.accumTextureHoverPosition.x,this.accumTextureHoverPosition.y).then(e=>{this.cursorManager.setAnalyticsPointer(e.isAccessible)}),this.accumTextureHoverPositionChanged=!1)}}},13848:function(e,t,i){i.d(t,{Z:function(){return n}});class s{constructor(e){this.arrayBuffer=new ArrayBuffer(e),this.float32Array=new Float32Array(this.arrayBuffer),this.uint8Array=new Uint8Array(this.arrayBuffer),this.uint16Array=new Uint16Array(this.arrayBuffer)}}class n{constructor(e,t){this.pixelPackBuffers=[],this.arrayBuffers=[],this.renderer=e,this.gl=e.getContext(),this.bufferSize=t;for(let e=0;e<24;e++)this.arrayBuffers.push(new s(t)),this.pixelPackBuffers.push(this.createPixelPackBuffer())}createPixelPackBuffer(){let e=this.gl.createBuffer();return this.gl.bindBuffer(this.gl.PIXEL_PACK_BUFFER,e),this.gl.bufferData(this.gl.PIXEL_PACK_BUFFER,this.bufferSize,this.gl.DYNAMIC_READ),this.gl.bindBuffer(this.gl.PIXEL_PACK_BUFFER,null),e}getNextPixelPackBuffer(){let e=this.pixelPackBuffers.shift();return this.pixelPackBuffers.push(e),e}getNextArrayBuffer(){let e=this.arrayBuffers.shift();return this.arrayBuffers.push(e),e}async readColorAttachmentRect(e,t,i,s,n,o=1,r=1){let a=this.getNextPixelPackBuffer(),l=this.getNextArrayBuffer(),d="FLOAT"===i?l.float32Array:l.uint8Array;return this.renderer.setRenderTarget(e),this.gl.readBuffer(this.gl.COLOR_ATTACHMENT0),this.gl.bindBuffer(this.gl.PIXEL_PACK_BUFFER,a),this.gl.readPixels(s,n,o,r,this.gl[t],this.gl[i],0),this.gl.bindBuffer(this.gl.PIXEL_PACK_BUFFER,null),await this.fence(),this.gl.bindBuffer(this.gl.PIXEL_PACK_BUFFER,a),this.gl.getBufferSubData(this.gl.PIXEL_PACK_BUFFER,0,d),this.gl.bindBuffer(this.gl.PIXEL_PACK_BUFFER,null),l}async fence(){return new Promise(e=>{let t=this.gl.fenceSync(this.gl.SYNC_GPU_COMMANDS_COMPLETE,0);this.gl.flush();let i=()=>{this.gl.getSyncParameter(t,this.gl.SYNC_STATUS)==this.gl.SIGNALED?(this.gl.deleteSync(t),e()):setTimeout(i,1)};setTimeout(i,1)})}destroy(){for(let e of this.pixelPackBuffers)this.gl.deleteBuffer(e)}}},40332:function(e,t,i){i.d(t,{Z:function(){return a}});var s=i(38005);class n{constructor(e){this.id=e,this.weight=0,this.directWeight=0}}function o(e){let t=2*Math.PI;return(e%t+t)%t}class r{constructor(){this.buckets=new Map,this.bucketsArray=[],this.bucketsShuffledArray=[],this.minStep=s.MathUtils.degToRad(1),this.totalWeight=0,this.totalDirectWeight=0}setStepSize(e){this.minStep=e}insert({altitude:e,azimuth:t,weight:i,directWeight:s}){let o=this.encodeDirection(e,t),r=this.buckets.get(o);r||(r=new n(o),this.buckets.set(o,r),this.bucketsArray.push(r)),r.weight+=i,r.directWeight+=s,this.totalWeight+=i,this.totalDirectWeight+=s}get bucketCount(){return this.buckets.size}sort(){this.bucketsArray.sort((e,t)=>t.weight-e.weight)}shuffle(){this.bucketsShuffledArray=this.bucketsArray.slice();var e=this.bucketsShuffledArray;for(let t=e.length-1;t>0;t--){let i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}}getNthBucket(e){let t=this.bucketsArray[e],[i,s]=this.decodeDirectionId(t.id);return{altitude:i,azimuth:s,weight:t.weight,directWeight:t.directWeight}}getNthShuffledBucket(e){let t=this.bucketsShuffledArray[e],[i,s]=this.decodeDirectionId(t.id);return{altitude:i,azimuth:s,weight:t.weight,directWeight:t.directWeight}}get totalBucketWeight(){return this.totalWeight}get totalDirectBucketWeight(){return this.totalDirectWeight}clear(){this.buckets.clear(),this.bucketsArray.length=0,this.bucketsShuffledArray.length=0,this.totalWeight=0,this.totalDirectWeight=0}encodeDirection(e,t){e<0&&(e=0),e=o(e),t=o(t);let i=Math.floor(e/this.minStep),n=Math.abs(Math.cos((i+.5)*this.minStep)),r=s.MathUtils.clamp(this.minStep/n,0,2*Math.PI),a=Math.floor(t/r);return Number(BigInt(i)<<BigInt(32)|BigInt(a))}decodeDirectionId(e){let t=BigInt(e)>>BigInt(32),i=BigInt(e)&BigInt(0xffffffff),n=(Number(t)+.5)*this.minStep,o=Math.cos(n),r=s.MathUtils.clamp(this.minStep/o,0,2*Math.PI);return[n,(Number(i)+.5)*r]}}class a{constructor(){this.lat=0,this.lng=0}getInstance(e,t){let i=!1;return this.buckets||(this.buckets=new r,i=!0),(Math.abs(this.lat-e)>.1||Math.abs(this.lng-t)>.1)&&(this.lat=e,this.lng=t,this.buckets.clear(),i=!0),{instance:this.buckets,isNew:i}}reset(){this.buckets=void 0}}},63116:function(e,t,i){async function s(e){return new Promise((t,i)=>{let s=new Image;s.onload=()=>{t(s)},s.onerror=i,s.src=e})}i.d(t,{Z:function(){return n}});class n{constructor(){this.monthlyGUIImageData=[],this.monthlyGHIBounds=[-180,-60,180,70],this.onLoadPromise=this.load()}async load(){let e=document.createElement("canvas"),t=e.getContext("2d",{willReadFrequently:!0}),i=[];for(let n=0;n<12;n++){let o=s(`analytics/ghi_monthly/${n+1}.png`);o.then(i=>{e.width=i.width,e.height=i.height,t.drawImage(i,0,0),this.monthlyGUIImageData[n]=t.getImageData(0,0,i.width,i.height)}),i.push(o)}await Promise.all(i)}getMonthlyIrradiancePerDay(e,t,i){t>180&&(t-=360);let s=(t-this.monthlyGHIBounds[0])/(this.monthlyGHIBounds[2]-this.monthlyGHIBounds[0]),n=1-(e-this.monthlyGHIBounds[1])/(this.monthlyGHIBounds[3]-this.monthlyGHIBounds[1]);if(s<0||s>1||n<0||n>1)return{irradiance:0,diffuseToGlobalRatio:0};let o=new Date(i).getUTCMonth(),r=this.monthlyGUIImageData[o],a=Math.floor(s*r.width),l=(Math.floor(n*r.height)*r.width+a)*4,d=r.data[l],h=r.data[l+1];return{irradiance:(d+h/256+r.data[l+2]/65536)*50,diffuseToGlobalRatio:r.data[l+3]/255}}getMonthlyIrradianceFromTo(e,t,i,s){t>180&&(t-=360);let n=(t-this.monthlyGHIBounds[0])/(this.monthlyGHIBounds[2]-this.monthlyGHIBounds[0]),o=1-(e-this.monthlyGHIBounds[1])/(this.monthlyGHIBounds[3]-this.monthlyGHIBounds[1]);if(n<0||n>1||o<0||o>1)return 0;let r=0;for(;i<s;){let n=new Date(i).getUTCMonth(),o=new Date(Date.UTC(new Date(i).getUTCFullYear(),n+1,1)).getTime()-i;o=Math.min(o,s-i),r+=this.getMonthlyIrradiancePerDay(e,t,i).irradiance*o/864e5,i+=o}return r}}},18783:function(e,t,i){i.d(t,{Z:function(){return n}});var s=i(38005);function n(e,t,i){e.position.set(0,0,0),e.lookAt(e.parent.localToWorld(e.position.clone().add(t))),e.updateMatrixWorld();let n=i.map(t=>t.clone().applyMatrix4(e.matrixWorldInverse)),o=new s.Box3;for(let e of(o.makeEmpty(),n))o.expandByPoint(e);let r=o.getCenter(new s.Vector3),a=o.getSize(new s.Vector3),l=new s.Vector3(r.x,r.y,r.z).clone().applyMatrix4(e.matrix.clone()),d=Math.max(a.x,a.y,.1);e.left=-d/2,e.right=d/2,e.top=d/2,e.bottom=-d/2,e.near=-a.z/2-5e4,e.far=a.z/2+1,e.updateProjectionMatrix(),e.position.copy(l),e.lookAt(e.parent.localToWorld(l.clone().add(t))),e.updateMatrixWorld()}},78775:function(e,t,i){i.d(t,{Z:function(){return n}});var s=i(4150);class n extends s.w2{constructor(){super(...arguments),this.needsSwap=!1}render(e){e.clearDepth()}}},62303:function(e,t,i){i.d(t,{Z:function(){return n}});var s=i(4150);class n extends s.w2{constructor(e){super(),this.needsSwap=!1,this.fn=e}render(){this.fn()}}},86848:function(e,t,i){i.d(t,{Z:function(){return r}});var s=i(4150),n=i(38005),o=i(20270);class r extends s.w2{constructor(e,t,i){super(),this.materialOverrides=new Map,this.scene=e,this.camera=t,this.renderTarget=new n.WebGLRenderTarget(i,i,{minFilter:n.NearestFilter,magFilter:n.NearestFilter,depthBuffer:!0,depthTexture:new n.DepthTexture(i,i,n.FloatType)}),this.depthMaterial=new n.MeshDepthMaterial({depthPacking:o.z81})}getDepthTexture(){return this.renderTarget.depthTexture}initMaterialOverrides(){this.materialOverrides=this.setSceneMaterialsToDepthMaterial(this.scene)}resetMaterialOverrides(){this.restoreSceneMaterials(this.materialOverrides)}compute(e){this.scene.matrixWorldAutoUpdate=!1,e.setRenderTarget(this.renderTarget),e.clear(!0,!0),e.render(this.scene,this.camera),this.scene.matrixWorldAutoUpdate=!0}setSceneMaterialsToDepthMaterial(e){let t=new Map;return e.traverse(e=>{e instanceof n.Mesh&&(e.userData.depthMaterial?(t.set(e,e.material),e.material=e.userData.depthMaterial):e.customDepthMaterial?(t.set(e,e.material),e.material=e.customDepthMaterial):(t.set(e,e.material),e.material=this.depthMaterial))}),t}restoreSceneMaterials(e){for(let[t,i]of e.entries())t.material=i}}},89580:function(e,t,i){i.d(t,{IU:function(){return r},R_:function(){return l},Um:function(){return o},bg:function(){return a}});var s=i(38005);let n=(e,t,i,n)=>{let o=new Uint8Array(16384);for(let s=0;s<64;s++){let r=64*s*4,a=64-s>8?e:i,l=64-s>8?t:n;for(let e=0;e<64;e++){let t=r+4*e;o[t]=255*a.r,o[t+1]=255*a.g,o[t+2]=255*a.b,o[t+3]=255*l}}let r=new s.DataTexture(o,64,64);return r.wrapS=r.wrapT=s.RepeatWrapping,r.minFilter=s.LinearMipmapLinearFilter,r.magFilter=s.LinearFilter,r.anisotropy=16,r.encoding=s.sRGBEncoding,r.generateMipmaps=!0,r.needsUpdate=!0,r};class o extends s.ShaderMaterial{constructor(e,t){super({name:"BuildingsMaterial",uniforms:s.UniformsUtils.merge([s.UniformsUtils.clone(s.ShaderLib.phong.uniforms),{shininess:{value:150},map:{value:n(e,1,t,1)}}]),defines:{USE_MAP:"",MAP_UV:"uv"},vertexShader:s.ShaderLib.phong.vertexShader,fragmentShader:s.ShaderLib.phong.fragmentShader,lights:!0,fog:!0,toneMapped:!0,shadowSide:s.FrontSide,side:s.FrontSide})}updateColors(e,t){let i=n(e,1,t,1);this.uniforms.map.value.dispose(),this.uniforms.map.value=i}dispose(){super.dispose(),this.uniforms.map.value.dispose()}}class r extends s.ShaderMaterial{constructor(e,t,i){super({name:"Tile3DBuildingMaterial",uniforms:s.UniformsUtils.merge([s.UniformsUtils.clone(s.ShaderLib.phong.uniforms),{shininess:{value:150},map:{value:null},floorHeight:{value:3}}]),defines:{USE_MAP:"",MAP_UV:"uv"},vertexShader:s.ShaderLib.phong.vertexShader,fragmentShader:s.ShaderLib.phong.fragmentShader,lights:!0,fog:!0,toneMapped:!0,shadowSide:s.FrontSide,side:s.FrontSide,vertexColors:!0}),this.lineColor=e,this.updateFloorIndication(t,i),this.onBeforeCompile=e=>{e.fragmentShader=e.fragmentShader.replace("#include <normal_pars_fragment>",`varying vec3 vNormal;
                varying mat4 vModelMatrix;
                varying vec3 vPosition;
                varying vec3 vModelNormal;
                uniform float floorHeight;`),e.fragmentShader=e.fragmentShader.replace("#include <map_fragment>",""),e.fragmentShader=e.fragmentShader.replace("#include <color_fragment>",`#if defined( USE_COLOR_ALPHA )
                diffuseColor *= vColor;
                #elif defined( USE_COLOR )
                diffuseColor.rgb *= vColor;
                #endif
                diffuseColor.rgb = pow(diffuseColor.rgb, vec3(2.2)); // apply gamma to vertex colors
                float angle = dot(vec3(vModelMatrix * vec4(vModelNormal, 0)), vec3(0, 0, 1));
                vec2 sideUV = angle < 0.05 ? vec2(0.5, vPosition.z / floorHeight) : vec2(0.5);
                vec4 floorSample = texture2D(map, sideUV);
                diffuseColor.rgb = mix(diffuseColor.rgb, floorSample.rgb, floorSample.a);`),e.vertexShader=e.vertexShader.replace("#include <normal_pars_vertex>",`varying vec3 vNormal;
                varying vec3 vModelNormal;
                varying mat4 vModelMatrix;
                varying vec3 vPosition;
                attribute float _batchid;
                attribute float visibility;`),e.vertexShader=e.vertexShader.replace("#include <normal_vertex>",`vNormal = normalize(transformedNormal);
                vModelNormal = normalize(normal);
                vModelMatrix = modelMatrix;
                mat4 modelMatrixNoTranslation = modelMatrix;
                modelMatrixNoTranslation[3][0] = 0.0;
                modelMatrixNoTranslation[3][1] = 0.0;
                modelMatrixNoTranslation[3][2] = 0.0;
                float scaleX = length(vec3(modelMatrix[0][0], modelMatrix[0][1], modelMatrix[0][2]));
                float scaleY = length(vec3(modelMatrix[1][0], modelMatrix[1][1], modelMatrix[1][2]));
                float scaleZ = length(vec3(modelMatrix[2][0], modelMatrix[2][1], modelMatrix[2][2]));
                vPosition = vec3(modelMatrixNoTranslation * vec4(position, 1)) / vec3(scaleX, scaleY, scaleZ);`),e.vertexShader=e.vertexShader.replace("#include <project_vertex>",`#include <project_vertex>
                if (visibility == 0.0) {
                    gl_Position = vec4(2.0, 2.0, 2.0, 1.0);
                }`)}}updateFloorIndication(e,t){let i=this.lineColor&&e?n(this.lineColor,0,this.lineColor,1):n(new s.Color,0,new s.Color,0);this.uniforms.map.value?.dispose(),this.uniforms.map.value=i,this.uniforms.floorHeight.value=t}dispose(){super.dispose(),this.uniforms.map.value?.dispose()}}class a extends s.MeshDepthMaterial{constructor(){super({name:"Tile3DBuildingDepthMaterial",depthPacking:s.RGBADepthPacking,side:s.FrontSide}),this.onBeforeCompile=e=>{e.vertexShader=e.vertexShader.replace("void main() {",`attribute float visibility;
                void main() {
                if (visibility == 0.0) {
                    gl_Position = vec4(2.0, 2.0, 2.0, 1.0);
                    return;
                }`)}}}class l extends s.MeshNormalMaterial{constructor(){super({name:"Tile3DBuildingDepthMaterial",side:s.FrontSide}),this.onBeforeCompile=e=>{e.vertexShader=e.vertexShader.replace("void main() {",`attribute float visibility;
                void main() {
                if (visibility == 0.0) {
                    gl_Position = vec4(2.0, 2.0, 2.0, 1.0);
                    return;
                }`)}}}},73089:function(e,t,i){i.d(t,{Z:function(){return o}});var s=i(38005),n=i(87187);class o{constructor(e){this.state={floorIndication:!1,floorHeight:0,color:new s.Color(0),lineColor:new s.Color(0)},this.emitter=new n.Z,this.state={...e}}update(e){Object.assign(this.state,e),this.emitter.emit("update")}getState(){return this.state}}},17102:function(e,t,i){i.d(t,{k:function(){return n}});var s=i(66490);class n extends s.I{calculateError(e){let t=e.cached,i=t.inFrustum,s=this.cameras,n=this.cameraInfo,o=t.boundingVolume,r=-1/0,a=1/0;for(let t=0,l=s.length;t<l;t++){let s;if(!i[t])continue;let l=n[t],d=l.invScale;if(l.isOrthographic){let t=l.pixelSize;s=e.geometricError/(t*d),a=Math.min(a,o.distanceToPoint(l.position)*d)}else{let t=o.distanceToPoint(l.position)*d,i=l.sseDenominator;s=e.geometricError/(t*i),a=Math.min(a,t)}r=Math.max(r,s)}e.__distanceFromCamera=a,e.__error=r}}},26022:function(e,t,i){var s,n;i.d(t,{Cx:function(){return x},Ds:function(){return a},Ex:function(){return b},FT:function(){return g},Fn:function(){return p},Li:function(){return f},M$:function(){return s},OB:function(){return d},Q8:function(){return o},RS:function(){return w},YX:function(){return u},Zo:function(){return m},cQ:function(){return c},d8:function(){return h},sv:function(){return l},xA:function(){return v},y7:function(){return r}});let o=!0,r=!0,a=13,l=1,d=2,h=1e6,c=15,u=1,p=.01,m=18,g=1,f=500,x=.01,w=100,b=5,v="createImageBitmap"in window;(n=s||(s={}))[n.DEFAULT=0]="DEFAULT",n[n.GOOGLE=1]="GOOGLE"},16433:function(e,t,i){let s;i.d(t,{M$:function(){return D.M$},Y:function(){return sX.Y},BY:function(){return w},wz:function(){return iA},d8:function(){return iD},_F:function(){return s$},ZR:function(){return sY},Wy:function(){return eV.W},pV:function(){return u},kr:function(){return sW.kr},Xh:function(){return e9}});var n,o,r,a,l,d,h,c,u,p,m,g,f,x,w,b,v,y,C=i(14737),M=i(23468),S=i(38005),L=i(40493),T=i(39660);let j={Self:'<a href="https://shadowmap.org/" target="_blank">Shadowmap</a>',StadiaMaps:'<a rel="noopener noreferrer" href="https://www.stadiamaps.com/" target="_blank">Stadia Maps</a>',Thunderforest:'Maps <a rel="noopener noreferrer" href="https://www.thunderforest.com" target="_blank">Thunderforest</a>',OpenStreetMap:'<a rel="noopener noreferrer" href="https://openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors',Nextzen:'<a rel="noopener noreferrer" href="https://www.nextzen.org" target="_blank">Nextzen</a>',Mapbox:'<a rel="noopener noreferrer" href="https://www.mapbox.com/" target="_blank">Mapbox</a>',StadtWien:'<a rel="noopener noreferrer" href="https://data.wien.gv.at" target="_blank">Stadt Wien</a>',MadridCityCouncil:'<a rel="noopener noreferrer" href="https://datos.madrid.es" target="_blank">Ayuntamiento de Madrid</a>',MairieDeParis:'<a rel="noopener noreferrer" href="https://opendata.paris.fr" target="_blank">Mairie de Paris</a>',BavariaSurveyingAdministration:'<a rel="noopener noreferrer" href="https://www.geodaten.bayern.de" target="_blank">Bayerische Vermessungsverwaltung</a>',JapanPlateau:`<a rel="noopener noreferrer" href="https://www.geospatial.jp/ckan/dataset/plateau-tokyo23ku-2022" target="_blank"></a>`,Esri:'<a rel="noopener noreferrer" href="https://www.esri.com" target="_blank">Airbus DS, USGS, NGA, NASA, CGIAR, GEBCO, N Robinson, NCEAS, NLS, OS, NMA, Geodatastyrelsen and the GIS User Community, Powered by Esri</a>',Berlin:`<a rel="noopener noreferrer" href="https://www.businesslocationcenter.de/berlin3d-downloadportal" target="_blank">Berlin Partner f\xfcr Wirtschaft und Technologie GmbH</a>`,GlobalSolarGIS:'<a rel="noopener noreferrer" href="https://globalsolaratlas.info" target="_blank">Global Solar Atlas 2.0, Solargis s.r.o., World Bank Group, Energy Sector Management Assistance Program (ESMAP)</a>',MapTiler:'<a rel="noopener noreferrer" href="https://www.maptiler.com/copyright/" target="_blank">MapTiler</a>',Microsoft:'Data from <a rel="noopener noreferrer" href="https://www.microsoft.com/en-us/" target="_blank">Microsoft</a>',EsriCommunityMaps:'<a rel="noopener noreferrer" href="https://communitymaps.arcgis.com/home/" target="_blank">Esri Community Maps contributors</a>',GoogleOpenBuildings:'<a rel="noopener noreferrer" href="https://arxiv.org/abs/2107.12283" target="_blank">Google Open Buildings</a>',USGS:'<a rel="noopener noreferrer" href="https://www.usgs.gov/3d-elevation-program" target="_blank">USGS 3D Elevation Program Digital Elevation Program</a>',Overture:'<a rel="noopener noreferrer" href="https://overturemaps.org/" target="_blank">Overture Maps Foundation</a>',OvertureML:'Data from <a rel="noopener noreferrer" href="https://www.microsoft.com/en-us/" target="_blank">Microsoft</a> & <a rel="noopener noreferrer" href="https://arxiv.org/abs/2107.12283" target="_blank">Google</a>'};var P=i(46443);let E=Object.freeze({nextzen:{tileUrl:new P.I(`https://tile.nextzen.org/tilezen/vector/v1/256/all/{z}/{x}/{y}.mvt?api_key=${window.SHADOWMAP.NEXTZEN_API_KEY}`),layerName:"buildings",attributions:[j.Nextzen]},mapbox:{tileUrl:new P.I(`https://api.mapbox.com/v4/mapbox.mapbox-streets-v8/{z}/{x}/{y}.mvt?access_token=${window.SHADOWMAP.MAPBOX_TOKEN}`),layerName:"building",attributions:[j.Mapbox]},stadiamaps:{tileUrl:new P.I("https://tiles.stadiamaps.com/data/openmaptiles/{z}/{x}/{y}.pbf"),layerName:"building",attributions:[j.StadiaMaps]},overture:{tileUrl:new P.I("https://vector-tiles-world.shadowmap.org/overture/2025-08-20.1/{z}/{x}/{y}.mvt"),layerName:"building",attributions:[j.OpenStreetMap,j.Overture,j.OvertureML]}}),A=Object.freeze({satellite:{tileUrl:new P.I("https://tiles.stadiamaps.com/tiles/alidade_satellite/{z}/{x}/{y}.png"),encoding:S.sRGBEncoding,attributions:[j.MapTiler],specular:new S.Color(0xffffff),shininess:.5,buildingsColor:new S.Color(0xeeeeee),buildingsLineColor:new S.Color(0xaaaaaa),exposure:.5,is256:!0},map:{tileUrl:new P.I(`https://api.maptiler.com/maps/fb7bae82-6759-4d5a-a6cf-969639f61171/{z}/{x}/{y}.png?key=${window.SHADOWMAP.MAPTILER_API_KEY}`),encoding:S.sRGBEncoding,attributions:[j.MapTiler],specular:new S.Color(394758),shininess:50,buildingsColor:new S.Color(0xeeeeee),buildingsLineColor:new S.Color(0xaaaaaa),exposure:1},"map-free":{tileUrl:new P.I("https://tiles.stadiamaps.com/styles/alidade_bright/{z}/{x}/{y}@2x.png"),encoding:S.sRGBEncoding,attributions:[j.StadiaMaps],specular:new S.Color(394758),shininess:50,buildingsColor:new S.Color(0xeeeeee),buildingsLineColor:new S.Color(0xaaaaaa),exposure:.7},outdoor:{tileUrl:new P.I("https://tiles.stadiamaps.com/tiles/outdoors/{z}/{x}/{y}@2x.png"),encoding:S.sRGBEncoding,attributions:[j.MapTiler],specular:new S.Color(0xffffff),shininess:.5,buildingsColor:new S.Color(0xeeeeee),buildingsLineColor:new S.Color(0xaaaaaa),exposure:1}});var D=i(26022),O=i(34105),k=i(1094),I=i(22069);let N=function(e,t){this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new S.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.zoomToCursor=!1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.disableAutoRotateOnInteraction=!1,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:S.MOUSE.ROTATE,MIDDLE:S.MOUSE.DOLLY,RIGHT:S.MOUSE.PAN},this.touches={ONE:S.TOUCH.ROTATE,TWO:S.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return c.phi},this.getAzimuthalAngle=function(){return c.theta},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(s),D.stop(),i.dispatchEvent(r),i.update(),l=a.NONE},this.tweenAnglesTo=function(e,t,s,n,o){let d;if(l!==a.NONE)return!1;let h=e-c.phi,u=((d=((d=t-c.theta)+Math.PI)%(2*Math.PI))<=0&&(d+=2*Math.PI),d-=Math.PI);N=0,_=0;let p=0;return D.stop(),i.dispatchEvent(r),D=new C.kX({progress:0}).to({progress:1},s).onUpdate(({progress:e})=>{N+=(e-p)*h,_+=(e-p)*u,p=e}).onComplete(()=>{o&&o()}).easing(n||C.oY.Sinusoidal.InOut).start(),!0},this.setDisableAutoRotateOnInteraction=function(e){this.disableAutoRotateOnInteraction=e},this.setPolarAngle=function(e){u.phi=e-c.phi,m=!0},this.setAzimuthAngle=function(e){u.theta=e-c.theta,p=!0},this.toggleTouchControls=function(e){h=e,e||eo(void 0)},this.stopTween=function(){D.stop()},this.update=function(){let t=new S.Vector3,n=new S.Quaternion().setFromUnitVectors(e.up,new S.Vector3(0,1,0)),o=n.clone().invert(),r=new S.Vector3,h=new S.Quaternion;return function(){let e=i.object.position;t.copy(e).sub(i.target),t.applyQuaternion(n),c.setFromVector3(t),l!==a.NONE&&i.autoRotate&&i.disableAutoRotateOnInteraction&&(i.autoRotate=!1,i.disableAutoRotateOnInteraction=!1),l===a.NONE&&(c.theta+=_,c.phi+=N,_=0,N=0),i.autoRotate&&l===a.NONE&&(c.theta-=2*Math.PI/60/60*i.autoRotateSpeed),i.enableDamping&&!p?c.theta+=u.theta*i.dampingFactor:c.theta+=u.theta,i.enableDamping&&!m?c.phi+=u.phi*i.dampingFactor:c.phi+=u.phi,c.theta=Math.max(i.minAzimuthAngle,Math.min(i.maxAzimuthAngle,c.theta)),c.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,c.phi)),c.makeSafe();let b=c.radius;return c.radius*=g,c.radius=Math.max(i.minDistance,Math.min(i.maxDistance,c.radius)),!0===i.enableDamping?i.target.addScaledVector(f,i.dampingFactor):i.target.add(f),i.zoomToCursor&&!H&&(i.object.isPerspectiveCamera?i.target.lerp(A,1-c.radius/b):i.object.isOrthographicCamera&&i.target.lerp(A,1-w)),t.setFromSpherical(c),t.applyQuaternion(o),e.copy(i.target).add(t),i.object.lookAt(i.target),!0===i.enableDamping?f.multiplyScalar(1-i.dampingFactor):f.set(0,0,0),p?(p=!1,u.theta=0):u.theta*=1-i.dampingFactor,m?(m=!1,u.phi=0):u.phi*=1-i.dampingFactor,g=1,!!(x||r.distanceToSquared(i.object.position)>d||8*(1-h.dot(i.object.quaternion))>d)&&(i.dispatchEvent(s),r.copy(i.object.position),h.copy(i.object.quaternion),x=!1,w=1,!0)}}(),this.restoreCameraPosition=function(){let t=new S.Vector3,s=new S.Quaternion().setFromUnitVectors(e.up,new S.Vector3(0,1,0)),n=s.clone().invert();return function(){let e=i.object.position;t.copy(e).sub(i.target),t.applyQuaternion(s),t.setFromSpherical(c),t.applyQuaternion(n),e.copy(i.target).add(t),i.object.lookAt(i.target)}}(),this.dispose=function(){D.stop(),i.domElement.removeEventListener("contextmenu",em,!1),i.domElement.removeEventListener("mousedown",er,!1),i.domElement.removeEventListener("wheel",ed,!1),i.domElement.removeEventListener("touchstart",ec,!1),i.domElement.removeEventListener("touchend",ep,!1),i.domElement.removeEventListener("touchmove",eu,!1),document.removeEventListener("mousemove",ea,!1),document.removeEventListener("mouseup",el,!1),window.removeEventListener("keydown",eh,!1)};let i=this,s={type:"change"},n={type:"start"},o={type:"end"},r={type:"interaction"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},l=a.NONE,d=.1,h=!0,c=new S.Spherical,u=new S.Spherical,p=!1,m=!1,g=1,f=new S.Vector3,x=!1,w=1,b=new S.Vector2,v=new S.Vector2,y=new S.Vector2,M=new S.Vector2,L=new S.Vector2,T=new S.Vector2,j=new S.Vector2,P=new S.Vector2,E=new S.Vector2,A=new S.Vector3,D=new C.kX({}),N=0,_=0,R=!1,V=new S.Vector2,B=new S.Vector2,U=0,F=0,Z=!1,H=!1;function G(){return Math.pow(.95,i.zoomSpeed)}function z(e){u.theta-=e}this.resetSphericalDelta=function(){u.theta=0,u.phi=0};let W=function(){let e=new S.Vector3;return function(t,i){e.setFromMatrixColumn(i,0),e.multiplyScalar(-t),f.add(e)}}(),X=function(){let e=new S.Vector3;return function(t,s){!0===i.screenSpacePanning?e.setFromMatrixColumn(s,1):(e.setFromMatrixColumn(s,0),e.crossVectors(i.object.up,e)),e.multiplyScalar(t),f.add(e)}}(),Y=function(){let e=new S.Vector3;return function(t,s){let n=i.domElement===document?i.domElement.body:i.domElement;if(i.object.isPerspectiveCamera){let o=i.object.position;e.copy(o).sub(i.target);let r=e.length();W(2*t*(r*=Math.tan(i.object.fov/2*Math.PI/180))/n.clientHeight,i.object.matrix),X(2*s*r/n.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(W(t*(i.object.right-i.object.left)/i.object.zoom/n.clientWidth,i.object.matrix),X(s*(i.object.top-i.object.bottom)/i.object.zoom/n.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function $(e){i.object.isPerspectiveCamera?g/=e:i.object.isOrthographicCamera?(w=i.object.zoom,i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom*e)),w/=i.object.zoom,i.object.updateProjectionMatrix(),x=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function Q(e){i.object.isPerspectiveCamera?g*=e:i.object.isOrthographicCamera?(w=i.object.zoom,i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/e)),w/=i.object.zoom,i.object.updateProjectionMatrix(),x=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function q(e){b.set(e.clientX,e.clientY)}function K(e){M.set(e.clientX,e.clientY)}this.dollyIn=function(e){$(e),i.update()},this.dollyOut=function(e){Q(e),i.update()};let J=function(){let e=new S.Vector3,t=new S.Vector3;return function(s){let n=i.domElement===document?i.domElement.body:i.domElement;if(i.object.isPerspectiveCamera){e.set(s.clientX/n.clientWidth*2-1,-(2*(s.clientY/n.clientHeight))+1,.5),e.unproject(i.object),e.sub(i.object.position).normalize();let o=t.copy(i.target).sub(i.object.position).dot(i.object.up)/e.dot(i.object.up);A.copy(i.object.position).add(e.multiplyScalar(o))}else if(i.object.isOrthographicCamera){e.set(s.clientX/n.clientWidth*2-1,-(2*(s.clientY/n.clientHeight))+1,(i.object.near+i.object.far)/(i.object.near-i.object.far)),e.unproject(i.object),t.set(0,0,-1).applyQuaternion(i.object.quaternion);let o=-e.dot(i.object.up)/t.dot(i.object.up);A.copy(e).add(t.multiplyScalar(o))}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type.")}}();function ee(e){if(1==e.touches.length)M.set(e.touches[0].pageX,e.touches[0].pageY);else{let t=.5*(e.touches[0].pageX+e.touches[1].pageX),i=.5*(e.touches[0].pageY+e.touches[1].pageY);M.set(t,i)}}let et=new O.y,ei=new k.Z,es=new I.Z;function en(e){if(1==e.touches.length)L.set(e.touches[0].pageX,e.touches[0].pageY);else{let t=.5*(e.touches[0].pageX+e.touches[1].pageX),i=.5*(e.touches[0].pageY+e.touches[1].pageY);L.set(t,i)}T.subVectors(L,M).multiplyScalar(i.panSpeed),Y(T.x,T.y),M.copy(L)}function eo(e){et.reset(),ei.reset(),es.reset()}function er(e){if(!1!==i.enabled){switch(e.preventDefault(),i.domElement.focus?i.domElement.focus({preventScroll:!0}):window.focus(),e.button){case 0:switch(i.mouseButtons.LEFT){case S.MOUSE.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===i.enablePan)return;K(e),D.stop(),i.dispatchEvent(r),l=a.PAN}else{if(!1===i.enableRotate)return;q(e),D.stop(),i.dispatchEvent(r),l=a.ROTATE}break;case S.MOUSE.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===i.enableRotate)return;q(e),D.stop(),i.dispatchEvent(r),l=a.ROTATE}else{if(!1===i.enablePan)return;K(e),D.stop(),i.dispatchEvent(r),l=a.PAN}break;default:l=a.NONE}break;case 1:if(i.mouseButtons.MIDDLE===S.MOUSE.DOLLY){if(!1===i.enableZoom)return;j.set(e.clientX,e.clientY),D.stop(),i.dispatchEvent(r),l=a.DOLLY}else l=a.NONE;break;case 2:switch(i.mouseButtons.RIGHT){case S.MOUSE.ROTATE:if(!1===i.enableRotate)return;q(e),D.stop(),i.dispatchEvent(r),l=a.ROTATE;break;case S.MOUSE.PAN:if(!1===i.enablePan)return;K(e),D.stop(),i.dispatchEvent(r),l=a.PAN;break;default:l=a.NONE}}l!==a.NONE&&(document.addEventListener("mousemove",ea,!1),document.addEventListener("mouseup",el,!1),i.dispatchEvent(n))}}function ea(e){if(!1!==i.enabled)switch(e.preventDefault(),l){case a.ROTATE:var t;if(!1===i.enableRotate)return;v.set(e.clientX,e.clientY),y.subVectors(v,b).multiplyScalar(i.rotateSpeed);let s=i.domElement===document?i.domElement.body:i.domElement;z(2*Math.PI*y.x/s.clientHeight),t=2*Math.PI*y.y/s.clientHeight,u.phi-=t,b.copy(v),i.update();break;case a.DOLLY:if(!1===i.enableZoom)return;P.set(e.clientX,e.clientY),E.subVectors(P,j),E.y>0?$(G()):E.y<0&&Q(G()),j.copy(P),i.update();break;case a.PAN:if(!1===i.enablePan)return;L.set(e.clientX,e.clientY),T.subVectors(L,M).multiplyScalar(i.panSpeed),Y(T.x,T.y),M.copy(L),i.update()}}function el(e){!1!==i.enabled&&(document.removeEventListener("mousemove",ea,!1),document.removeEventListener("mouseup",el,!1),i.dispatchEvent(o),l=a.NONE)}function ed(e){!1!==i.enabled&&!1!==i.enableZoom&&(l===a.NONE||l===a.ROTATE)&&(e.preventDefault(),e.stopPropagation(),i.dispatchEvent(r),i.dispatchEvent(n),J(e),e.deltaY<0?Q(G()):e.deltaY>0&&$(G()),i.update(),i.dispatchEvent(o))}function eh(e){if(!1!==i.enabled&&!1!==i.enableKeys&&!1!==i.enablePan){let t=!1;switch(e.keyCode){case i.keys.UP:Y(0,i.keyPanSpeed),t=!0;break;case i.keys.BOTTOM:Y(0,-i.keyPanSpeed),t=!0;break;case i.keys.LEFT:Y(i.keyPanSpeed,0),t=!0;break;case i.keys.RIGHT:Y(-i.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),i.update())}}function ec(e){if(!1!==i.enabled&&!1!==h){switch(e.preventDefault(),e.touches.length){case 1:switch(i.touches.ONE){case S.TOUCH.ROTATE:if(!1===i.enableRotate)return;if(1==e.touches.length)b.set(e.touches[0].pageX,e.touches[0].pageY);else{let t=.5*(e.touches[0].pageX+e.touches[1].pageX),i=.5*(e.touches[0].pageY+e.touches[1].pageY);b.set(t,i)}D.stop(),i.dispatchEvent(r),l=a.TOUCH_ROTATE;break;case S.TOUCH.PAN:if(!1===i.enablePan)return;ee(e),1==e.touches.length&&(Z&&F+300>Date.now()?H=!0:R=!0,V.set(e.touches[0].pageX,e.touches[0].pageY),B.copy(V),U=Date.now()),Z=!1,D.stop(),i.dispatchEvent(r),l=a.TOUCH_PAN;break;default:l=a.NONE}break;case 2:switch(i.touches.TWO){case S.TOUCH.DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;i.enableZoom&&function(e){let t=e.touches[0].pageX-e.touches[1].pageX,i=e.touches[0].pageY-e.touches[1].pageY,s=Math.sqrt(t*t+i*i);j.set(0,s)}(e),i.enablePan&&ee(e),D.stop(),i.dispatchEvent(r),l=a.TOUCH_DOLLY_PAN;break;case S.TOUCH.DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;!function(e){if(e.touches.length<2)return;let t=new S.Vector2(e.touches[0].pageX,e.touches[0].pageY),i=new S.Vector2(e.touches[1].pageX,e.touches[1].pageY);et.start(t,i),ei.start(t,i),es.start(t,i)}(e),D.stop(),i.dispatchEvent(r),l=a.TOUCH_DOLLY_ROTATE;break;default:l=a.NONE}break;default:l=a.NONE}l!==a.NONE&&i.dispatchEvent(n)}}function eu(e){if(!1===i.enabled||!1===h)return;e.preventDefault();let s=new S.Vector2(e.touches[0].pageX,e.touches[0].pageY);if(!(R&&3>V.distanceTo(s)))switch(R&&V.distanceTo(s)>5&&(R=!1),l){case a.TOUCH_ROTATE:var n;if(!1===i.enableRotate)return;if(1==e.touches.length)v.set(e.touches[0].pageX,e.touches[0].pageY);else{let t=.5*(e.touches[0].pageX+e.touches[1].pageX),i=.5*(e.touches[0].pageY+e.touches[1].pageY);v.set(t,i)}y.subVectors(v,b).multiplyScalar(i.rotateSpeed);let o=i.domElement===document?i.domElement.body:i.domElement;z(2*Math.PI*y.x/o.clientHeight),n=2*Math.PI*y.y/o.clientHeight,u.phi-=n,b.copy(v),i.update();break;case a.TOUCH_PAN:if(!1===i.enablePan)return;if(H&&1==e.touches.length){let t=e.touches[0].pageY-B.y,i=2**g;i+=-.01*t,g=Math.log2(i),B.set(e.touches[0].pageX,e.touches[0].pageY)}else en(e);i.update();break;case a.TOUCH_DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;i.enableZoom&&function(e){let t=e.touches[0].pageX-e.touches[1].pageX,s=e.touches[0].pageY-e.touches[1].pageY,n=Math.sqrt(t*t+s*s);P.set(0,n),E.set(0,Math.pow(P.y/j.y,i.zoomSpeed)),$(E.y),j.copy(P)}(e),i.enablePan&&en(e),i.update();break;case a.TOUCH_DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;!function(e){var i;if(e.touches.length<2)return;let s=new S.Vector2(e.touches[0].pageX,e.touches[0].pageY),n=new S.Vector2(e.touches[1].pageX,e.touches[1].pageY),o=et.move(s,n);if(o&&(i=6*o.pitchDelta/t.clientHeight,u.phi-=i),et.active)return;let r=ei.move(s,n);r&&z(S.MathUtils.degToRad(r.bearingDelta));let a=es.move(s,n);a&&$(1+a.zoomDelta)}(e),i.update();break;default:l=a.NONE}}function ep(e){!1!==i.enabled&&!1!==h&&(eo(e),H&&(H=!1,Z=!1),R&&(R=!1,F=Date.now(),U+300>Date.now()&&(Z=!0)),i.dispatchEvent(o),l=a.NONE)}function em(e){!1!==i.enabled&&e.preventDefault()}i.domElement.addEventListener("contextmenu",em,!1),i.domElement.addEventListener("mousedown",er,!1),i.domElement.addEventListener("wheel",ed,!1),i.domElement.addEventListener("touchstart",ec,!1),i.domElement.addEventListener("touchend",ep,!1),i.domElement.addEventListener("touchmove",eu,!1),window.addEventListener("keydown",eh,!1),this.update()};N.prototype=Object.create(S.EventDispatcher.prototype),N.prototype.constructor=N,Object.defineProperties(N.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(e){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!e}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(e){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!e}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(e){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!e}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(e){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(e){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(e){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=e}}});let _=function(e,t){N.call(this,e,t)};_.prototype=Object.create(S.EventDispatcher.prototype),_.prototype.constructor=_;class R extends _{static create(e,t){let i=new R(e,t);return i.minDistance=2**(D.Zo-18+1)*30,i.maxDistance=8e6,i.enableDamping=!0,i.dampingFactor=.23,i.rotateSpeed=.65,i.autoRotateSpeed=-.5,i.zoomSpeed=.65,i.enableKeys=!1,i.maxPolarAngle=Math.PI/6,i.keyPanSpeed=1,i.panSpeed=1,i.screenSpacePanning=!1,i}toggleRotation(e){this.rotateSpeed=.65*!!e}static createControlsWithPanning(e,t,i){let s=R.create(e,t);return i?(s.mouseButtons={LEFT:S.MOUSE.PAN,MIDDLE:S.MOUSE.DOLLY,RIGHT:S.MOUSE.ROTATE},s.touches={ONE:S.TOUCH.PAN,TWO:S.TOUCH.DOLLY_ROTATE}):(s.mouseButtons={LEFT:S.MOUSE.ROTATE,MIDDLE:S.MOUSE.DOLLY,RIGHT:S.MOUSE.PAN},s.touches={ONE:S.TOUCH.ROTATE,TWO:S.TOUCH.DOLLY_PAN}),s.enablePan=!0,s.zoomToCursor=!0,s.saveState(),s}static createControlsNoPanning(e,t){let i=R.create(e,t);return i.mouseButtons={LEFT:S.MOUSE.ROTATE,MIDDLE:S.MOUSE.DOLLY,RIGHT:S.MOUSE.ROTATE},i.touches={ONE:S.TOUCH.ROTATE,TWO:S.TOUCH.DOLLY_ROTATE},i.enablePan=!1,i.zoomToCursor=!1,i.saveState(),i}}var V=i(24205),B=i(58424);class U{constructor(e){this.poiGroup=e,this.dracoLoader=new V._,this.dracoLoader.setDecoderPath("../draco/1.4.1/"),this.material=new S.MeshLambertMaterial({name:"StonehengeMaterial",color:new S.Color(6717078)})}async loadPOIs(){let e=(await this.dracoLoader.loadAsync("/citymodels/stonehenge/stonehenge.obj.drc")).clone(),t=this.getMeshForGeometry(e);this.poiGroup.add(t),t.updateMatrixWorld()}getMeshForGeometry(e){e.computeVertexNormals();let t=new S.Mesh(e,this.material);t.scale.set(1.225,1.225,1.225),t.castShadow=!0,t.receiveShadow=!0,t.layers.set(D.sv),t.geometry.computeBoundingBox(),t.geometry.center(),t.geometry.rotateX(Math.PI/2);let i=B.Z.applyMercatorScaleFactor(104.2,51.17898),s=B.Z.latLngToMeters({lat:51.17898,lng:-1.82593});return t.position.set(s.x,s.y,i),t.matrixAutoUpdate=!1,t.updateMatrix(),t}onMapModeChange(e){this.poiGroup.visible=e===D.M$.DEFAULT}}(n=u||(u={}))[n.DESKTOP_LOW=0]="DESKTOP_LOW",n[n.DESKTOP_MEDIUM=1]="DESKTOP_MEDIUM",n[n.DESKTOP_HIGH=2]="DESKTOP_HIGH",n[n.MOBILE_LOW=3]="MOBILE_LOW",n[n.MOBILE_MEDIUM=4]="MOBILE_MEDIUM",n[n.MOBILE_HIGH=5]="MOBILE_HIGH",u.DESKTOP_LOW,u.DESKTOP_MEDIUM,u.DESKTOP_HIGH,u.MOBILE_LOW,u.MOBILE_MEDIUM,u.MOBILE_HIGH;let F={SHADOW_MAP_SIZE:4096,SHADOW_CASCADES:2,SHADOW_CASCADES_LAMBDA:.5,SHADOW_DISTANCE_MIN:120,SHADOW_DISTANCE_FACTOR:4,MAX_PIXEL_RATIO:2,TERRAIN_TILE_GEOMETRY_RESOLUTION:64,TILE_3D_MAX_DISTANCE:1600,TILE_3D_GOOGLE_ERROR_TARGET:50,TILE_3D_GOOGLE_CACHE_MIN_SIZE:2e3,TILE_3D_GOOGLE_CACHE_MAX_SIZE:2200,BUILDING_TILE_MAX_DISTANCE:6e3,TREE_TILE_MAX_DISTANCE:4e3,OSM_TREE_TILE_MAX_DISTANCE:2500,TERRAIN_SUBDIVIDE_DISTANCE:60,TERRAIN_SIMPLIFY_DISTANCE:60,TERRAIN_FALLOFF_DISTANCE_FACTOR:2},Z=Object.freeze({[u.DESKTOP_HIGH]:{SHADOW_MAP_SIZE:4096,SHADOW_CASCADES:3,SHADOW_CASCADES_LAMBDA:.7,SHADOW_DISTANCE_MIN:180,SHADOW_DISTANCE_FACTOR:5,MAX_PIXEL_RATIO:2,TERRAIN_TILE_GEOMETRY_RESOLUTION:64,TILE_3D_MAX_DISTANCE:3e3,TILE_3D_GOOGLE_ERROR_TARGET:35,TILE_3D_GOOGLE_CACHE_MIN_SIZE:3e3,TILE_3D_GOOGLE_CACHE_MAX_SIZE:3e3,BUILDING_TILE_MAX_DISTANCE:7e3,TREE_TILE_MAX_DISTANCE:7e3,OSM_TREE_TILE_MAX_DISTANCE:4e3,TERRAIN_SUBDIVIDE_DISTANCE:80,TERRAIN_SIMPLIFY_DISTANCE:90,TERRAIN_FALLOFF_DISTANCE_FACTOR:1/0},[u.DESKTOP_MEDIUM]:F,[u.DESKTOP_LOW]:{SHADOW_MAP_SIZE:4096,SHADOW_CASCADES:1,SHADOW_CASCADES_LAMBDA:.7,SHADOW_DISTANCE_MIN:70,SHADOW_DISTANCE_FACTOR:2,MAX_PIXEL_RATIO:1,TERRAIN_TILE_GEOMETRY_RESOLUTION:32,TILE_3D_MAX_DISTANCE:1200,TILE_3D_GOOGLE_ERROR_TARGET:35,TILE_3D_GOOGLE_CACHE_MIN_SIZE:1200,TILE_3D_GOOGLE_CACHE_MAX_SIZE:1600,BUILDING_TILE_MAX_DISTANCE:6e3,TREE_TILE_MAX_DISTANCE:3e3,OSM_TREE_TILE_MAX_DISTANCE:1800,TERRAIN_SUBDIVIDE_DISTANCE:40,TERRAIN_SIMPLIFY_DISTANCE:40,TERRAIN_FALLOFF_DISTANCE_FACTOR:1/0},[u.MOBILE_HIGH]:F,[u.MOBILE_MEDIUM]:{SHADOW_MAP_SIZE:4096,SHADOW_CASCADES:1,SHADOW_CASCADES_LAMBDA:.7,SHADOW_DISTANCE_MIN:70,SHADOW_DISTANCE_FACTOR:2,MAX_PIXEL_RATIO:2,TERRAIN_TILE_GEOMETRY_RESOLUTION:32,TILE_3D_MAX_DISTANCE:1200,TILE_3D_GOOGLE_ERROR_TARGET:40,TILE_3D_GOOGLE_CACHE_MIN_SIZE:500,TILE_3D_GOOGLE_CACHE_MAX_SIZE:800,BUILDING_TILE_MAX_DISTANCE:6e3,TREE_TILE_MAX_DISTANCE:3e3,OSM_TREE_TILE_MAX_DISTANCE:1800,TERRAIN_SUBDIVIDE_DISTANCE:40,TERRAIN_SIMPLIFY_DISTANCE:40,TERRAIN_FALLOFF_DISTANCE_FACTOR:1/0},[u.MOBILE_LOW]:{SHADOW_MAP_SIZE:2048,SHADOW_CASCADES:1,SHADOW_CASCADES_LAMBDA:.7,SHADOW_DISTANCE_MIN:70,SHADOW_DISTANCE_FACTOR:2,MAX_PIXEL_RATIO:1,TERRAIN_TILE_GEOMETRY_RESOLUTION:32,TILE_3D_MAX_DISTANCE:1e3,TILE_3D_GOOGLE_ERROR_TARGET:45,TILE_3D_GOOGLE_CACHE_MIN_SIZE:300,TILE_3D_GOOGLE_CACHE_MAX_SIZE:500,BUILDING_TILE_MAX_DISTANCE:4e3,TREE_TILE_MAX_DISTANCE:2500,OSM_TREE_TILE_MAX_DISTANCE:1200,TERRAIN_SUBDIVIDE_DISTANCE:40,TERRAIN_SIMPLIFY_DISTANCE:40,TERRAIN_FALLOFF_DISTANCE_FACTOR:1/0}}),H=new class{constructor(){this.quality=u.DESKTOP_MEDIUM,this.listeners={}}setQuality(e){if(this.quality===e)return;let t=Z[this.quality],i=Z[e];for(let[s,n]of(this.quality=e,Object.entries(this.listeners)))for(let e of n){let n=t[s],o=i[s];n!==o&&e(o)}}subscribe(e,t,i){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t),i&&t(Z[this.quality][e])}unsubscribe(e,t){if(!this.listeners[e])return;let i=this.listeners[e],s=i.indexOf(t);-1!==s&&i.splice(s,1)}get(e){return Z[this.quality][e]}};var G=i(93238);let z=new S.Color(66567),W=new S.Color(4466471),X=new S.Color(5392973),Y=new S.Color(7565941),$=new S.Color(0xe5e6e7),Q=e=>{if(e){if(e.altitudeRatio<.01){s.color.setHex(z.getHex()),s.color.lerp(W,S.MathUtils.smoothstep(e.altitudeRatio,0,.01));return}if(e.altitudeRatio<.02){s.color.setHex(W.getHex()),s.color.lerp(X,S.MathUtils.smoothstep(e.altitudeRatio,.01,.02));return}if(e.altitudeRatio<.05){s.color.setHex(X.getHex()),s.color.lerp(Y,S.MathUtils.smoothstep(e.altitudeRatio,.02,.05));return}if(e.altitudeRatio<.25){s.color.setHex(Y.getHex()),s.color.lerp($,S.MathUtils.smoothstep(e.altitudeRatio,.05,.25));return}s.color.setHex($.getHex())}};var q=i(73879);let K=new S.MeshPhongMaterial({name:"GastronomyMaterial",color:new S.Color(0xf5f76e),shininess:150,flatShading:!0,fog:!0,opacity:.5,transparent:!0,toneMapped:!1}),J=K.clone();J.opacity=.75;let ee=function(e,t,i,s){let n,o,r=new S.Raycaster,a=new S.Layers;a.disableAll(),a.set(D.sv),r.layers=a;let l=new S.Vector2,d=new S.Group,h=new Map;async function c(e){e.forEach(e=>{e.forEach(e=>{e.geometry.coordinates=e.geometry.coordinates.map(e=>e.map(([e,t])=>{let{x:i,y:s}=B.Z.latLngToMeters({lat:t,lng:e});return[i,s]})),e.properties.height=e.properties.height||2.5})}),await Promise.all(e.map(async e=>{let t=await q.y.convert({geoJSON:e,latitude:48,floorHeight:1,excludeBottom:!0,meltIntoGround:!0}),i=new S.BufferGeometry;i.setAttribute("position",new S.Float32BufferAttribute(t.vertices,3)),i.setAttribute("normal",new S.Float32BufferAttribute(t.normals,3)),i.setIndex(new S.Uint32BufferAttribute(t.indices,1)),i.computeBoundingBox();let s=new S.Vector3;s=i.boundingBox.getCenter(s),i.translate(-s.x,-s.y,0);let n=new S.EdgesGeometry(i),o=new S.LineSegments(n,new S.LineBasicMaterial({color:0,linewidth:2})),r=new S.Mesh(i,K);r.layers.set(D.sv),r.name=e[0].id.toString(),r.position.set(s.x,s.y,0),o.position.set(s.x,s.y,0),r.castShadow=!1,r.receiveShadow=!1,r.matrixAutoUpdate=!1,r.updateMatrix(),r.geometry.computeBoundingBox(),h.set(r.name,r),d.add(r,o)}))}function u(e){p();let t=h.get(e);t||G.T.message(`Cannot find gastronomy mesh ${e} for highlighting.`),document.body.style.cursor="pointer",n=e,t.material=J}function p(){document.body.style.cursor=null,o!==n&&(m(n),n=void 0)}function m(e){if(!e)return;let t=h.get(e);t||G.T.message(`Cannot find gastronomy mesh ${p} for clearing the highlighting.`),t.material=K}function g(e){m(o),o=e}return e.addEventListener("mousemove",function(e){l.x=e.clientX/window.innerWidth*2-1,l.y=-(2*(e.clientY/window.innerHeight))+1,r.setFromCamera(l,t);let i=r.intersectObjects(d.children,!0)[0];if(!i)return void p();u(i.object.name)}),e.addEventListener("touchstart",function(e){s(),g(void 0);let t=e.touches[0];t&&(l.x=t.clientX/window.innerWidth*2-1,l.y=-(2*(t.clientY/window.innerHeight))+1)}),e.addEventListener("touchend",function(e){r.setFromCamera(l,t);let n=r.intersectObjects(d.children,!0)[0];if(!n){s(),g(void 0),p();return}let o=n.object.name;g(o),u(o),i(o,(l.x+1)/2*window.innerWidth,(1-l.y)/2*window.innerHeight)}),e.addEventListener("click",function(){let e=r.intersectObjects(d.children,!0)[0];if(!e){s(),g(void 0);return}let t=e.object.name;g(t),u(t),i(t,(l.x+1)/2*window.innerWidth,(1-l.y)/2*window.innerHeight)}),e.addEventListener("mousedown",function(){s(),g(void 0)}),Object.freeze({group:d,load:c,onLocationChange:function(){s(),g(void 0)}})};var et=i(84094),ei=i(18489),es=i(97151);let en=(e,t,i)=>new S.Vector2(S.MathUtils.lerp(e.x,t.x,i.x),S.MathUtils.lerp(e.y,t.y,i.y));(o=p||(p={}))[o.INSIDE=0]="INSIDE",o[o.MIXED=1]="MIXED",o[o.OUTSIDE=2]="OUTSIDE";class eo{constructor({area:e,cells:t,resolution:i}){this.cells=new Map,this.isInitialized=!1,this.area=e,this.resolution=i,this.cellsInput=t}init(){if(this.cellsInput)for(let[e,t]of Object.entries(this.cellsInput))this.cells.set(+e,t);this.computeBounds(),this.cellsInput||this.computeCells(),this.isInitialized=!0}exportCells(){if(!this.isInitialized)throw Error("RegionArea not initialized.");let e={};for(let[t,i]of this.cells.entries())e[t]=i;return JSON.stringify(e)}expandBounds(e){if("Polygon"===e.type)for(let t of e.coordinates[0])this.bounds.expandByPoint(new S.Vector2(t[0],t[1]));else if("MultiPolygon"===e.type)for(let t of e.coordinates)for(let e of t[0])this.bounds.expandByPoint(new S.Vector2(e[0],e[1]))}computeBounds(){if(this.bounds=new S.Box2(new S.Vector2(1/0,1/0),new S.Vector2(-1/0,-1/0)),this.cells.size>0)for(let e of this.cells.values())e.state!==p.OUTSIDE&&this.expandBounds(e.geometry);else this.expandBounds(this.area);this.boundsWithBuffer=new S.Box2(this.bounds.min.clone(),this.bounds.max.clone()),this.boundsWithBuffer.expandByScalar(1e3)}computeCells(){for(let e=0;e<this.resolution;e++)for(let t=0;t<this.resolution;t++){let i=this.computeCell(e,t),s=this.getCellKey(e,t);this.cells.set(s,i)}}computeCell(e,t){let i=new S.Vector2(e,t).multiplyScalar(1/this.resolution),s=new S.Vector2(e+1,t+1).multiplyScalar(1/this.resolution),n=en(this.bounds.min,this.bounds.max,i),o=en(this.bounds.min,this.bounds.max,s),r={type:"Polygon",coordinates:[[[n.x,n.y],[o.x,n.y],[o.x,o.y],[n.x,o.y],[n.x,n.y]]]},a=(0,ei.Z)(r,this.area);if(null===a)return{geometry:null,state:p.OUTSIDE};let l=.01>Math.abs((0,es.Z)(a)-(0,es.Z)(r));return{geometry:a.geometry,state:l?p.INSIDE:p.MIXED}}getCellKey(e,t){return e+t*this.resolution}isPointWithinArea(e){if(!this.isInitialized)throw Error("RegionArea not initialized.");if(e.x<this.bounds.min.x||e.x>this.bounds.max.x||e.y<this.bounds.min.y||e.y>this.bounds.max.y)return!1;let t=this.positionToCellPosition(e),i=this.getCellKey(t.x,t.y),s=this.cells.get(i);return s.state!==p.OUTSIDE&&(s.state===p.INSIDE||(0,et.Z)([e.x,e.y],s.geometry))}isBoundingBoxWithinArea(e,t){if(!this.isInitialized)throw Error("RegionArea not initialized.");let i=this.positionToCellPosition(e),s=this.positionToCellPosition(t);for(let e=i.y;e<=s.y;e++)for(let t=i.x;t<=s.x;t++){let i=this.getCellKey(t,e),s=this.cells.get(i);if(!s||s.state!==p.INSIDE)return!1}return!0}isPointInBufferedBounds(e){if(!this.isInitialized)throw Error("RegionArea not initialized.");return this.boundsWithBuffer.containsPoint(e)}positionToCellPosition(e){let t=(e.x-this.bounds.min.x)/(this.bounds.max.x-this.bounds.min.x),i=(e.y-this.bounds.min.y)/(this.bounds.max.y-this.bounds.min.y);return{x:Math.floor(t*this.resolution),y:Math.floor(i*this.resolution)}}}var er=i(36421),ea=i(49799),el=i(44220),ed=i(40155),eh=i(15577),ec=i(57718),eu=i(50329);let ep={Vienna:new eo({area:er.R[0].Q0,resolution:16}),Tokyo:new eo({area:ea,resolution:16}),Munich:new eo({area:el.R[0].Q0,resolution:16}),Berlin:new eo({area:ed.R[0].Q0,resolution:16}),UAE:new eo({area:eh.R[0].Q0,resolution:16}),SaudiArabia:new eo({area:ec.R[0].Q0,resolution:16}),Australia:new eo({area:eu.R[0].Q0,resolution:8})},em=[{url:"https://building-data.shadowmap.org/vienna_hybrid/tileset.json",regionArea:ep.Vienna,removeFeaturesOutsideArea:!0,colorScheme:{0xcccccc:new S.Color(0xffffff),0xff3333:new S.Color(0xd66565)},lineColor:new S.Color(0xaaaaaa),offsetZ:575,requiresPro:!1,idAttributeName:"Name",idPrefix:"vienna",attributions:[j.StadtWien],disableOSMTrees:!0},{url:"https://building-data.shadowmap.org/tokyo/tileset.json",regionArea:ep.Tokyo,removeFeaturesOutsideArea:!1,colorScheme:{},lineColor:new S.Color(0xaaaaaa),offsetZ:186,requiresPro:!0,idAttributeName:"gml:id",idPrefix:"tokyo",attributions:[j.JapanPlateau],disableOSMTrees:!1},{url:"https://building-data.shadowmap.org/munich/tileset.json",regionArea:ep.Munich,removeFeaturesOutsideArea:!0,colorScheme:{},lineColor:new S.Color(0xaaaaaa),offsetZ:937,requiresPro:!0,idAttributeName:"gml:id",idPrefix:"munich",attributions:[j.BavariaSurveyingAdministration],disableOSMTrees:!1},{url:"https://building-data.shadowmap.org/berlin/tileset.json",regionArea:ep.Berlin,removeFeaturesOutsideArea:!1,colorScheme:{},lineColor:new S.Color(0xaaaaaa),offsetZ:-298,requiresPro:!0,idAttributeName:"gml:id",idPrefix:"berlin",attributions:[j.Berlin],disableOSMTrees:!1}];class eg{static switchPro3DTiles(e){let t=[],i=[];for(let s of Object.values(em))(!s.requiresPro||e)&&(t.push(s.regionArea),i.push(s));this.activeTiles3DAreas=t,this.activeTiles3DSettings=i}}eg.originOffset={x:void 0,y:void 0},eg.activeTiles3DAreas=[],eg.activeTiles3DSettings=[];var ef=i(12916),ex=i(32419);class ew{constructor(e,t,i,s,n,o,r,a){this.dateStart=e,this.dateEnd=t,this.lat=i,this.lng=s,this.group=n,this.visualQualitySettings=o,this.maxTextureSizeOfRenderer=r,this.camera=a,this.maxBrightness=1,this.maxAltitude=0,this.nearHorizonFactor=1,this.shadowsEnabled=!0,this.maxBrightnessLastParams={dayStart:0,lat:0,lng:0},this.lightIntensity=1,this.colorDarkness=new S.Color(0xffffff),this.colorDawn=new S.Color(0xff9641),this.colorNoon=new S.Color(0xffffff),this.color=new S.Color(0xffffff),this.radiusSunEarth=.1,this.csmContainer=new S.Object3D,this.group.add(this.csmContainer),this.initDirectionalLights(),this.update()}getSunDirection(){return this.csm.lightDirection}setDates(e,t){this.dateStart=e,this.dateEnd=t,this.update()}setGeolocation(e,t){this.lat=e,this.lng=t,this.update()}update(){this.updateMaxBrightness(),this.calculateSunPosition(),this.updateDirectionalLights(),this.updateIntensity()}calculateSunPosition(){this.sunPosition=ef.getPosition(this.dateStart,this.lat,this.lng),this.altitude=this.sunPosition.altitude,this.azimuth=this.sunPosition.azimuth,this.altitudeRatio=this.altitude/(.5*Math.PI)}initDirectionalLights(){let e=Math.max(...Object.values(Z).map(e=>e.SHADOW_CASCADES)),t=Math.min(this.visualQualitySettings.get("SHADOW_MAP_SIZE"),this.maxTextureSizeOfRenderer),i=this.visualQualitySettings.get("SHADOW_CASCADES"),s=this.visualQualitySettings.get("SHADOW_CASCADES_LAMBDA");this.csm=new ex.Z({cascades:i,maxCascades:e,mode:"practical",practicalModeLambda:s,shadowMapSize:t,lightDirectionUp:S.Object3D.DEFAULT_UP,camera:this.camera,parent:this.csmContainer,lightIntensity:this.lightIntensity,shadowNormalBias:1.8/t,fade:!0,noLastCascadeCutOff:1===i}),this.visualQualitySettings.subscribe("SHADOW_MAP_SIZE",e=>{let t=Math.min(e,this.maxTextureSizeOfRenderer);this.csm.updateShadowMapSize(t),this.csm.shadowNormalBias=1.8/t,this.csm.updateFrustums(),this.update()},!1),this.visualQualitySettings.subscribe("SHADOW_CASCADES",e=>{this.csm.noLastCascadeCutOff=1===e,this.csm.updateCascades(e),this.update()},!1),this.visualQualitySettings.subscribe("SHADOW_CASCADES_LAMBDA",e=>{this.csm.practicalModeLambda=e,this.csm.updateFrustums(),this.update()},!1)}toggleLighting(e){this.csmContainer.visible=e}toggleShadows(e){this.shadowsEnabled!==e&&(this.shadowsEnabled=e,this.updateIntensity())}updateDirectionalLights(){let e=!0;this.altitudeRatio>=.2?this.color.setHex(this.colorNoon.getHex()):this.altitudeRatio<.2&&this.altitudeRatio>=0?(this.color.setHex(this.colorDawn.getHex()),this.color.lerp(this.colorNoon,S.MathUtils.smoothstep(this.altitudeRatio,0,.2))):this.altitudeRatio<0&&this.altitudeRatio>=-.15?(this.color.setHex(this.colorDarkness.getHex()),this.color.lerp(this.colorDawn,S.MathUtils.smoothstep(this.altitudeRatio,-.15,0))):(e=!1,this.color.setHex(this.colorDarkness.getHex()));for(let t=0;t<this.csm.lights.length;t++){let i=this.csm.lights[t];i.color=this.color,i.visible=e}this.nearHorizonFactor=S.MathUtils.clamp(Math.abs(this.altitudeRatio),0,.2)/.2*.5+.5,this.csm.lightDirection.set(-this.radiusSunEarth*Math.cos(-this.azimuth-.5*Math.PI),-this.radiusSunEarth*Math.sin(-this.azimuth-.5*Math.PI),-this.radiusSunEarth*Math.tan(this.altitude))}updateMaxBrightness(){let e=this.dateEnd.setHours(0,0,0,0);if(this.maxBrightnessLastParams.dayStart===e&&.01>Math.abs(this.maxBrightnessLastParams.lat-this.lat)&&.01>Math.abs(this.maxBrightnessLastParams.lng-this.lng))return;this.maxBrightnessLastParams.dayStart=e,this.maxBrightnessLastParams.lat=this.lat,this.maxBrightnessLastParams.lng=this.lng;let t=ef.getTimes(new Date(this.dateEnd),this.lat,this.lng),i=t.sunrise,s=(t.sunset-i)/11,n=0;for(let e=0;e<12;e++){let t=+i+e*s;n=Math.max(n,ef.getPosition(new Date(t),this.lat,this.lng).altitude)}n=n||1,this.maxBrightness=Math.sin(n),this.maxAltitude=n}updateIntensity(){let e=this.shadowsEnabled?1:1/this.csm.lights.length;for(let t of this.csm.lights)t.intensity=this.lightIntensity/Math.pow(this.maxBrightness,.6)*this.nearHorizonFactor*e;for(let e of this.csm.lights)e.castShadow=this.shadowsEnabled}}var eb=i(50844);class ev{constructor(e,t,i,s){this.cameraPosition=t,this.geometry=new S.CylinderGeometry(.01,.7,40,16,40,!1),this.geometry.clearGroups(),this.geometry.addGroup(0,1/0,0),this.geometry.addGroup(0,1/0,1),this.geometry.addGroup(0,1/0,2),this.baseMaterial=new S.MeshBasicMaterial({color:0xf5f76e,toneMapped:!1,transparent:!1,opacity:.7,fog:!1,depthTest:!0,depthWrite:!1,...eb.a}),this.shadowMaterial=new S.ShadowMaterial({color:2236962,toneMapped:!1,transparent:!1,opacity:1,depthFunc:S.LessEqualDepth,depthTest:!0,depthWrite:!1,...eb.a}),this.depthMaterial=new S.MeshBasicMaterial({transparent:!1,depthTest:!0,depthWrite:!0,colorWrite:!1}),this.mesh=new S.Mesh(this.geometry,[this.baseMaterial,this.shadowMaterial,this.depthMaterial]),this.mesh.frustumCulled=!1,this.geometry.translate(0,20,0),this.geometry.rotateX(Math.PI/2),this.mesh.castShadow=!1,this.mesh.receiveShadow=!0,this.mesh.renderOrder=12,this.mesh.visible=e,this.targetLocation=i.clone(),this.sunDirection=s.clone(),this.calc()}toggleDepthTest(e){this.baseMaterial.depthTest=e,this.shadowMaterial.depthTest=e}getMesh(){return this.mesh}setVisible(e){this.mesh.visible=e}getVisible(){return this.mesh.visible}calc(){let e=this.cameraPosition.distanceTo(this.targetLocation),t=e/1,i=e/200;this.mesh.scale.set(i,i,t),this.mesh.position.copy(this.targetLocation),this.mesh.position.set(this.mesh.position.x,this.mesh.position.y,this.mesh.position.z);let s=this.sunDirection.clone().negate(),n=s.multiplyScalar(t);this.mesh.parent&&this.mesh.lookAt(this.mesh.parent.localToWorld(n.add(this.targetLocation))),[this.baseMaterial.opacity,this.shadowMaterial.opacity]=function(e){if(e.z<-.005)return[0,0];if(e.z<=.001){let t=(e.z- -.005)/.006;return[.7*t,+t]}return[.7,1]}(s)}update(e,t,i){this.mesh.parent&&(this.cameraPosition=this.mesh.parent.worldToLocal(e.clone()),this.targetLocation=this.mesh.parent.worldToLocal(t.clone()),this.sunDirection.copy(i),this.calc())}updateSunDirection(e){this.sunDirection.copy(e),this.calc()}updateCenter(e){this.mesh.parent&&(this.targetLocation=this.mesh.parent.worldToLocal(e.clone()),this.calc())}}var ey=i(92651),eC=i(94435);let eM={STEM:new S.CylinderGeometry(1,1,1,5,1),CROWN:new S.SphereGeometry(1,12,7),STEM_LOW:new S.CylinderGeometry(1,1,1,3,1),CROWN_LOW:new S.SphereGeometry(1,6,3)},eS={STEM:new S.MeshPhongMaterial({name:"TreeStemMaterial",color:3083527,toneMapped:!0,shininess:10}),CROWN:new S.MeshPhongMaterial({name:"TreeCrownMaterial",color:1457927,toneMapped:!0,shininess:10})};var eL=i(75013),eT=i(88635);let ej=(e,t)=>new S.Vector3(-Math.sin(e)*Math.cos(t),-Math.cos(e)*Math.cos(t),Math.sin(t)),eP=(e,t)=>{let i=t.clone().sub(e).normalize();return e.clone().add(i.multiplyScalar(-e.z/i.z))},eE=(e,t,i,s,n,o,r)=>{let a=[];for(let r=0;r<i;r++){let l=S.MathUtils.lerp(e,t,r/(i-1)),d=ef.getPosition(new Date(l),n,o),h=ej(d.azimuth,d.altitude);a.push(h.multiplyScalar(s))}if(!r){let e=new Float32Array(3*i);for(let t=0;t<a.length;t++)e[3*t]=a[t].x,e[3*t+1]=a[t].y,e[3*t+2]=a[t].z;return e}let l=[];for(let e=0;e<a.length;e++){let t=a[e].x,i=a[e].y,s=a[e].z;if(s>0&&l.push(t,i,s),e===a.length-1)continue;let n=a[e+1].x,o=a[e+1].y,r=a[e+1].z;if(s<0&&r>0){let e=eP(new S.Vector3(t,i,s),new S.Vector3(n,o,r));l.push(e.x,e.y,e.z)}else if(s>0&&r<0){let e=eP(new S.Vector3(n,o,r),new S.Vector3(t,i,s));l.push(e.x,e.y,e.z)}}return new Float32Array(l)},eA=(e,t,i)=>{let s,n=B.Z.metersToTMS(e,t);try{s=eT.getFuzzyTimezoneFromTile([Math.floor(n.x),Math.floor(n.y),t])}catch(e){s=Intl.DateTimeFormat().resolvedOptions().timeZone}let o=Intl.DateTimeFormat(["en-US"],{timeZone:s,timeZoneName:"longOffset"}).format(i).split(" ")[1].slice(3)||"+0",r=60*parseInt(o.split(":")[0])*6e4;return o.includes(":")&&(r+=60*parseInt(o.split(":")[1])*1e3),new Date(i.getTime()+r)},eD=(e,t,i,s)=>{let n=new Intl.DateTimeFormat([new Intl.DateTimeFormat(void 0,{hour:"numeric"}).resolvedOptions().hour12?"en-US":"en-GB"],{timeZone:"UTC",hour:"numeric",minute:"numeric"}).format(t).split(" ");if(e.updateGeometry(i.geometry,n[0]),n.length>1){e.updateGeometry(s.geometry,n[1]);let t=i.geometry.getAttribute("position").array,o=s.geometry.getAttribute("position").array,r=i.geometry.getAttribute("uv").array,a=s.geometry.getAttribute("uv").array,l=i.geometry.getIndex().array,d=s.geometry.getIndex().array,h=new Float32Array(t.length+o.length);h.set(t,0),h.set(o,t.length);for(let e=t.length;e<h.length;e+=3)h[e]*=.6,h[e+1]=.6*h[e+1]-.8;let c=new Float32Array(r.length+a.length);c.set(r,0),c.set(a,r.length);let u=new Uint32Array(l.length+d.length);u.set(l,0),u.set(d,l.length);for(let e=l.length;e<u.length;e++)u[e]+=t.length/3;i.geometry.deleteAttribute("position"),i.geometry.deleteAttribute("uv"),i.geometry.deleteAttribute("index"),i.geometry.setAttribute("position",new S.BufferAttribute(h,3)),i.geometry.setAttribute("uv",new S.BufferAttribute(c,2)),i.geometry.setIndex(new S.BufferAttribute(u,1))}};function eO({lat:e,lng:t}){return`${e.toFixed(8)}_${t.toFixed(8)}`}class ek extends S.InstancedMesh{constructor(e,t,i){super(e,t,i),this.layers.enable(D.sv),this.layers.enable(D.OB),this.receiveShadow=!0,this.castShadow=!0,this.frustumCulled=!0}getInstanceMesh(e){let t=new S.Mesh(this.geometry,ek.noColorMaterial);return t.matrixAutoUpdate=!1,this.getMatrixAt(e,t.matrix),this.add(t),t}}ek.noColorMaterial=new S.MeshBasicMaterial({color:0,colorWrite:!1,depthWrite:!1});class eI extends S.Object3D{constructor(){super(...arguments),this.stems=[],this.crowns=[]}setTrees(e,t){for(let i of(this.stems=e,this.crowns=t,this.children))i instanceof S.InstancedMesh&&i.dispose();this.clear();let i=new ek(eM.STEM,eS.STEM,e.length),s=new ek(eM.CROWN,eS.CROWN,t.length);for(let t=0;t<e.length;t++)i.setMatrixAt(t,e[t].matrix);for(let e=0;e<t.length;e++)s.setMatrixAt(e,t[e].matrix);this.add(i),this.add(s),this.setupMesh(i),this.setupMesh(s)}getTreeByInstanceId(e){return this.stems[e]}getInstanceOutlineMesh(e){let t=new S.Object3D;return t.add(this.children[0].getInstanceMesh(e)),t.add(this.children[1].getInstanceMesh(e)),this.add(t),t}setupMesh(e){e.castShadow=!0,e.receiveShadow=!0,e.layers.enable(D.sv),e.layers.enable(D.OB),e.frustumCulled=!0,e.matrixAutoUpdate=!1,e.updateMatrix(),this.add(e),e.computeBoundingBox()}}class eN extends eL.d{constructor(e,t,i,s){super(e,s,i),this.config=t,this.stems=[],this.crowns=[],this.containers=[],this.tileCenterElevation=0,this.treeIdToInstance=new Map,this.initGroup(),this.group.name=`TreeTile ${e.x} ${e.y} ${e.zoom}`}async load(){this.state=eC.e.LOADING,this.state=await this.doLoad(),this.state===eC.e.ABORTED&&this.dispose()}async doLoad(){if(!this.data)try{let e=this.config.tileUrl.generate(this.index),t=await fetch(e,{mode:"cors",cache:"force-cache"});this.data=await t.json()}catch(e){return eC.e.ABORTED}if(0===this.data.length)return eC.e.FINISHED;let e=B.Z.getMercatorScaleFactor(this.data[0].geometry.coordinates[1]),t=new S.Matrix4,i=this.position,s=new S.Vector3,n=new S.Euler(Math.PI/2,0,0),o=new S.Vector3,r=new S.Quaternion;r.setFromEuler(n),this.tileCenterElevation=this.layer.mapView.pickElevationAtXY(this.position,eN.ZOOM_LEVEL);let a=[],l=[];for(let n=0;n<this.data.length;n++){let d=this.data[n],h=eO({lat:d.geometry.coordinates[1],lng:d.geometry.coordinates[0]});if(this.layer.treeIdToTile.set(h,this),this.layer.userTrees.get(h)?.hidden)continue;let c=B.Z.latLngToMeters({lat:d.geometry.coordinates[1],lng:d.geometry.coordinates[0]}),u=B.Z.metersToTMS(c,eN.ZOOM_LEVEL),p=this.layer.mapView.pickElevationAtXY(c,eN.ZOOM_LEVEL),m=Math.floor(u.x%1*2),g=2*Math.floor(u.y%1*2)+m;a[g]||(a[g]=[]),l[g]||(l[g]=[]);let f=d.properties.circumference/(2*Math.PI)*e;s.x=c.x-i.x,s.y=c.y-i.y;let x=(d.properties.height+eN.STEM_UNDERGROUND)*e;for(let i of(s.z=x/2+p-eN.STEM_UNDERGROUND*e,o.set(f,x,f),t.compose(s,r,o),a[g].push({matrix:t.clone(),lat:d.geometry.coordinates[1],lng:d.geometry.coordinates[0]}),this.stems))i.setMatrixAt(n,t);let w=d.properties.diameter_crown/2*e,b=.4*x,v=b>w?b:w;o.set(w,v,w),s.z=x+p-w/2,t.compose(s,r,o),l[g].push({matrix:t.clone(),lat:d.geometry.coordinates[1],lng:d.geometry.coordinates[0]})}this.treeIdToInstance.clear();for(let e=0;e<2;e++)for(let t=0;t<2;t++){let i=2*e+t,s=a[i]??[],n=l[i]??[];if(!this.containers[i]){let e=new eI;this.containers[i]=e,this.group.add(e)}for(let e=0;e<s.length;e++)this.treeIdToInstance.set(eO(s[e]),{mesh:this.containers[i],instanceId:e});this.containers[i].setTrees(s,n)}return this.parent.add(this.group),eC.e.FINISHED}updateLOD(e,t){if(0===this.stems.length&&0===this.crowns.length)return;let i=new S.Object3D;this.group.add(i);let s=new S.Vector3;for(let n of(i.getWorldPosition(s),this.group.remove(i),s.z=this.tileCenterElevation,this.group.children)){let i=s.clone(),o=n.boundingBox.getCenter(new S.Vector3);i.x+=o.x,i.y+=o.y,i.z=o.z,n.visible=e.distanceTo(i)<t}}dispose(){for(let e of this.stems)e_(e);for(let e of this.crowns)e_(e);super.dispose()}}function e_(e){e&&(e.parent?.remove(e),e.geometry?.dispose(),e.dispose())}eN.ZOOM_LEVEL=14,eN.STEM_UNDERGROUND=.5;let eR=Object.freeze({tileUrl:new P.I(`${window.SHADOWMAP.TREE_TILE_URL}/{z}/{x}/{y}.json.ico?version=3`),layerName:"trees"});var eV=i(97008);let eB=new class{constructor(){this.pixelBuffers=new Map,this.canvas=document.createElement("canvas"),this.gl=this.canvas.getContext("webgl2",{antialias:!1,preserveDrawingBuffer:!0}),this.texture=this.gl.createTexture(),this.framebuffer=this.gl.createFramebuffer(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.framebuffer),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,this.texture,0),this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!0)}borrowPixelPackBuffer(e){this.pixelBuffers.has(e)||this.pixelBuffers.set(e,[]);let t=this.pixelBuffers.get(e);if(0===t.length){let t=this.gl.createBuffer();return this.gl.bindBuffer(this.gl.PIXEL_PACK_BUFFER,t),this.gl.bufferData(this.gl.PIXEL_PACK_BUFFER,e,this.gl.DYNAMIC_READ),this.gl.bindBuffer(this.gl.PIXEL_PACK_BUFFER,null),t}return t.shift()}returnPixelPackBuffer(e,t){this.pixelBuffers.get(e).push(t)}async decodeAsync(e,t){let i=t.resolution,s=i*i*4,n=this.borrowPixelPackBuffer(s),o=new Uint8ClampedArray(s);return this.canvas.width=i,this.canvas.height=i,this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e),this.gl.bindBuffer(this.gl.PIXEL_PACK_BUFFER,n),this.gl.readPixels(0,0,i,i,this.gl.RGBA,this.gl.UNSIGNED_BYTE,0),this.gl.bindBuffer(this.gl.PIXEL_PACK_BUFFER,null),await this.fence(),this.gl.bindBuffer(this.gl.PIXEL_PACK_BUFFER,n),this.gl.getBufferSubData(this.gl.PIXEL_PACK_BUFFER,0,o),this.gl.bindBuffer(this.gl.PIXEL_PACK_BUFFER,null),this.returnPixelPackBuffer(s,n),new ImageData(o,i,i)}async fence(){return new Promise(e=>{let t=this.gl.fenceSync(this.gl.SYNC_GPU_COMMANDS_COMPLETE,0);this.gl.flush();let i=()=>{this.gl.getSyncParameter(t,this.gl.SYNC_STATUS)==this.gl.SIGNALED?(this.gl.deleteSync(t),e()):setTimeout(i,1)};setTimeout(i,1)})}dispose(){this.gl.deleteTexture(this.texture),this.gl.deleteFramebuffer(this.framebuffer)}};class eU{constructor(e,t){this.imageData=e,this.settings=t}containsEmptyValues(){for(let e=0;e<this.height;e+=32)for(let t=0;t<this.width;t+=32){let i=(e*this.width+t)*4,s=this.data[i],n=this.data[i+1],o=this.data[i+2];if(0===s&&0===n&&0===o)return!0}return!1}getElevation(e,t){let i=Math.floor(e*this.width),s=this.height-Math.floor(t*this.height);return this.readAndDecodePixel(i,s)}getElevationBilinear(e,t){let i=e*this.width,s=this.height-t*this.height,n=Math.floor(i),o=Math.ceil(i),r=Math.floor(s),a=Math.ceil(s),l=this.readAndDecodePixel(n,r),d=this.readAndDecodePixel(n,a),h=this.readAndDecodePixel(o,r),c=this.readAndDecodePixel(o,a),u=i-n,p=1-u,m=s-r;return(l*p+h*u)*(1-m)+(d*p+c*u)*m}getApproximateMinMaxElevation(e=10){let t=1/e,i=1/0,s=-1/0;for(let n=.5;n<e;n++)for(let o=.5;o<e;o++){let e=this.getElevation(n*t,o*t);i=Math.min(i,e),s=Math.max(s,e)}return{min:i,max:s}}get width(){return this.imageData.width}get height(){return this.imageData.height}get data(){return this.imageData.data}get unpackFactors(){return this.settings.unpackFactors}get unpackOffset(){return this.settings.unpackOffset}readAndDecodePixel(e,t){e<0&&(e=0),e>=this.width&&(e=this.width-1),t<0&&(t=0),t>=this.height&&(t=this.height-1);let i=t*this.width+e,s=this.data[4*i],n=this.data[4*i+1],o=this.data[4*i+2],r=this.unpackFactors,a=this.unpackOffset,l=s*r.x+n*r.y+o*r.z+a;return Math.max(this.settings.minElevation??-1e6,l)}}class eF{async decodeBitmap(e,t){let i=t.resolution;if(e.bitmap||e.image)return new eU(await eB.decodeAsync(e.bitmap??e.image,t),t);if(e.canvas)return new eU(e.canvas.getContext("2d").getImageData(0,0,i,i),t);throw Error("Unsupported texture type")}}var eZ=i(41138),eH=i(68648);class eG{constructor(){this.tasks=[],this.activeTasks=0,this.prioritizedZoomLevel=0}addTask(e){this.tasks.push(e),this.sortTasks(),setTimeout(()=>{this.processTasks()},1)}removeTask(e){this.tasks=this.tasks.filter(t=>t!==e)}setPrioritizedZoomLevel(e){this.prioritizedZoomLevel=e,this.sortTasks()}setControlsTarget(e){this.controlsTarget=e,this.sortTasks()}sortTasks(){let e=new S.Vector3;for(let t of this.tasks){if(!this.controlsTarget){t.tempDistance=0;continue}t.object3D.getWorldPosition(e),t.tempDistance=e.distanceTo(this.controlsTarget)}this.tasks.sort((e,t)=>{let i=Math.abs(e.level-this.prioritizedZoomLevel),s=Math.abs(t.level-this.prioritizedZoomLevel);return i===s&&this.controlsTarget?e.tempDistance-t.tempDistance:i-s})}processTasks(){if(0!==this.tasks.length)for(;this.activeTasks<eG.MaxConcurrentTasks;){let e=this.tasks[0];if(void 0===e)break;let t=this.findDeepestParentId(e);this.tasks=this.tasks.filter(e=>e!==t),this.sortTasks(),this.activeTasks++,t.workload().then(()=>{this.activeTasks--,this.processTasks()})}}findDeepestParentId(e){let t=Math.floor(e.x/2),i=Math.floor(e.y/2),s=e.level-1;if(s<0)return e;let n=this.tasks.find(e=>e.x===t&&e.y===i&&e.level===s);return n?this.findDeepestParentId(n):e}}eG.MaxConcurrentTasks=4;let ez=new eG;var eW=i(71075),eX=i(48300);class eY extends eW.kW{constructor(e,t,i=eW.jU.root,s=0,n=0,o=0){super(e,t,i,s,n,o,eY.geometry,t.createTileMaterial()),this.isElevationInitialized=!1,this.colorTexture=null,this.sharedElevationTexture=null,this.boundingBox=null,this.tempHiddenByChildren=!1,this.isLoaded=!1,this.mask=new eX.P,this.meshMaterial.uniforms.verticalScale.value=this.getMercatorScale(),this.mesh.layers.enable(D.OB),this.frustumCulled=!1,this.mesh.frustumCulled=!1,this.mesh.castShadow=!0,this.mesh.receiveShadow=!0,this.matrixAutoUpdate=!1,this.updateMatrix(),this.mesh.matrixAutoUpdate=!1,this.mesh.updateMatrix(),this.initDepthMaterial()}get meshMaterial(){return this.mesh.material}get meshDepthMaterial(){return this.mesh.customDepthMaterial}disposeTextures(){this.colorTexture&&this.colorTexture.texture.dispose(),this.sharedElevationTexture&&this.sharedElevationTexture.disposeGPUResources()}restoreTextures(){if(this.sharedElevationTexture){this.sharedElevationTexture.createGPUResources();let e=this.meshMaterial.uniforms;for(let t of[e,this.meshDepthMaterial.uniforms,this.mesh.userData.normalMaterial.uniforms])t.displacementMap.value=this.sharedElevationTexture.texture}}updateMask(e){let t=!1;for(let i=0;i<e.visibility.length;i++)if(e.visibility[i]!==this.mask.visibility[i]){t=!0;break}t&&(this.mask=e,this.mesh.geometry=this.mapView.getNodeGeometry(this.level,e))}shouldBeRendered(){return this.textureLoaded&&this.isElevationInitialized}subdivide(){let e=this.mapView.maxZoom();this.subdivided||this.level>e-1||(this.createChildNodes(),this.subdivided=!0)}buildBoundingBox(){let e=this.elevationTile.getApproximateMinMaxElevation(),t=this.getMercatorScale(),i=Math.max(10,(e.max-e.min)*.1),s=(e.min-i)*t,n=(e.max+i)*t;this.boundingBox=new S.Box3(new S.Vector3(-.5,s,-.5),new S.Vector3(.5,n,.5)),this.mesh.boundingBox=this.boundingBox}getBoundingBoxRecursive(){return this.boundingBox?this.boundingBox:this.parentNode?this.parentNode.getBoundingBoxRecursive():null}initDepthMaterial(){this.mesh.customDepthMaterial=new eZ.Z,this.meshDepthMaterial.uniforms.verticalScale.value=this.getMercatorScale(),this.mesh.userData.normalMaterial=new eH.Z,this.mesh.userData.normalMaterial.uniforms.verticalScale.value=this.getMercatorScale()}async initialize(){let e={x:this.x,y:this.y,level:this.level,object3D:this,workload:async()=>{if(!this.disposed)await this.loadData(),!this.disposed&&(await this.loadHeightGeometry(),this.disposed||(this.nodeReady(),this.initTask=void 0,this.isLoaded=!0))}};ez.addTask(e),this.initTask=e}nodeReady(){super.nodeReady(),this.disposed||this.mapView.onAddTile(this)}async loadData(){if(this.level<this.mapView.provider.minZoom||this.level>this.mapView.provider.maxZoom){console.warn("Geo-Three: Loading tile outside of provider range.",this),this.meshMaterial.uniforms.map.value=eW.VT.defaultTexture;return}try{let e=this.mapView.provider.settings.tileUrl,t=await this.mapView.provider.fetchTile(this.level,this.x,this.y);if(t===this.colorTexture)return;if(this.disposed||this.mapView.provider.settings.tileUrl!==e)return void t.removeOwner(this);t.addOwner(this),this.colorTexture&&this.colorTexture.removeOwner(this),this.colorTexture=t,this.meshMaterial.uniforms.map.value=t.texture}catch(e){if(this.disposed)return;console.warn("Geo-Three: Failed to load node tile data.",e),this.meshMaterial.uniforms.map.value=eW.VT.defaultTexture}this.textureLoaded=!0}getElevationTransform(){let e=this.mapView.heightProvider.settings.maxZoom;if(this.level<=e)return{x:0,y:0,scale:1};let t=Math.pow(2,this.level-e),i=Math.floor(this.x/t),s=Math.floor(this.y/t);return{x:(this.x-i*t)/t,y:(t-1-(this.y-s*t))/t,scale:t}}getRealTileIndex(e,t,i,s){let n=e.settings.maxZoom;if(t<=n)return new eV.W(i,s,t);let o=t-n,r=Math.floor(i/2**o),a=Math.floor(s/2**o);return new eV.W(r,a,n)}async loadHeightGeometry(){if(null===this.mapView.heightProvider)throw Error("GeoThree: MapView.heightProvider provider is null.");if(this.level<this.mapView.heightProvider.minZoom||this.level>this.mapView.heightProvider.maxZoom){this.meshMaterial.uniforms.displacementMap.value=eW.VT.defaultTexture,this.isElevationInitialized=!0;return}let e=!1;for(let t of[this.mapView.heightProvider,this.mapView.enableHeightProviderFallback?this.mapView.heightProviderFallback:null])if(t)try{let i=t.settings.tileUrl;this.elevationTileIndex=this.getRealTileIndex(t,this.level,this.x,this.y);let s=await t.fetchTile(this.elevationTileIndex.zoom,this.elevationTileIndex.x,this.elevationTileIndex.y);if(s===this.sharedElevationTexture)return;if(this.disposed||t.settings.tileUrl!==i)return void s.removeOwner(this);if(this.sharedElevationTexture=s,s.addOwner(this),this.elevationTile=await this.mapView.elevationDecoder.decodeBitmap(s,t.settings),this.elevationTile.containsEmptyValues())throw s.removeOwner(this),Error("Elevation tile contains empty values.");this.buildBoundingBox();let n=s.texture,o=this.getElevationTransform(),r=this.meshMaterial.uniforms,a=this.meshDepthMaterial.uniforms,l=this.mesh.userData.normalMaterial.uniforms;for(let e of[r,a,l])e.elevationTransform.value=new S.Vector3(o.x,o.y,o.scale),e.displacementMap.value=n,e.displacementMapResolution.value=t.settings.resolution,e.displacementMapBuffer.value=t.settings.padding,e.unpackFactors.value=t.settings.unpackFactors,e.unpackOffset.value=t.settings.unpackOffset,e.minElevation.value=t.settings.minElevation??-1e6,e.skirtHeight.value=this.getSkirtSize();this.mesh.geometry=this.mapView.getNodeGeometry(this.level,this.mask),e=!0;break}catch(e){if(this.disposed)return}if(!e){let e=B.Z.metersToLatLng(B.Z.TMSToMeters(this,this.level));console.error(`Couldn't load elevation tile for ${this.level}/${this.x}/${this.y} (${e.lat}, ${e.lng}), providers: ${this.mapView.heightProvider.settings.name}, ${this.mapView.enableHeightProviderFallback?this.mapView.heightProviderFallback?.settings.name:"no fallback"}`);let t=this.meshMaterial.uniforms;t.elevationTransform.value=new S.Vector3(0,0,1),t.displacementMap.value=eY.defaultHeightTexture,t.displacementMapResolution.value=1;let i=this.meshDepthMaterial.uniforms;i.elevationTransform.value=new S.Vector3(0,0,1),i.displacementMap.value=eY.defaultHeightTexture}this.isElevationInitialized=!0}getSkirtSize(){return .05*B.Z.getTileSizeInMeters(this.level)}getMercatorScale(){let e=B.Z.TMSToMeters({x:this.x+.5,y:this.y+.5},this.level),{lat:t}=B.Z.metersToLatLng(e);return B.Z.getMercatorScaleFactor(t)}static getChildTileIndexAt(e,t){let i=-1,s={x:0,y:0};return e<.5&&t<.5?(i=0,s={x:2*e,y:2*t}):e>=.5&&t<.5?(i=1,s={x:2*e-1,y:2*t}):e<.5&&t>=.5?(i=2,s={x:2*e,y:2*t-1}):e>=.5&&t>=.5&&(i=3,s={x:2*e-1,y:2*t-1}),{index:i,position:s}}getElevationRecursive(e,t){let{index:i,position:s}=eY.getChildTileIndexAt(e,t);for(let e of this.childrenNodes)if(e.location===i&&e.isElevationInitialized&&e.level<=this.mapView.heightProvider.settings.maxZoom)return e.getElevationRecursive(s.x,s.y);if(this.elevationTile){let i=this.elevationTile.getElevationBilinear(e,t);if(null!==i)return i}return 0}getTileChainRecursive(e,t,i=[]){let{index:s,position:n}=eY.getChildTileIndexAt(e,t);for(let e of this.childrenNodes)if(e.location===s&&e.level<=this.mapView.heightProvider.settings.maxZoom)return e.isElevationInitialized&&i.push({node:e,position:n}),e.getTileChainRecursive(n.x,n.y,i);return i}getElevationFromChain(e,t){let i=this.getTileChainRecursive(e,t);i.reverse();for(let e=0;e<i.length;e++){let{node:t,position:s}=i[e];if(!t.elevationTile)continue;let n=t.elevationTile.getElevationBilinear(s.x,s.y);if(null!==n)return n}return 0}async onColorProviderChange(){await this.loadData(),this.meshMaterial.updateFromConfig(this.mapView.provider.settings)}async onHeightProviderChange(){return this.loadHeightGeometry()}dispose(){super.dispose(),this.colorTexture&&this.colorTexture.removeOwner(this),this.sharedElevationTexture&&this.sharedElevationTexture.removeOwner(this),this.mapView.removeTile(this),this.initTask&&ez.removeTask(this.initTask)}}eY.baseScale=new S.Vector3(B.Z.EPSG3857WorldSize,1,B.Z.EPSG3857WorldSize),eY.defaultHeightTexture=eW.O.createFillTexture("#000000");var e$=i(69488);class eQ extends eW.bz{constructor({root:e,provider:t,heightProvider:i,heightProviderFallback:s,enableHeightProviderFallback:n,geometryFactory:o,layer:r}){super(e,t,i),this.elevationDecoder=new eF,this.enableHeightProviderFallback=!1,this.heightProviderFallback=s,this.enableHeightProviderFallback=n;let a=this.material;a.depthWrite=!1,a.depthTest=!1,a.colorWrite=!1,this.userData.depthMaterial=a,this.userData.normalMaterial=a,this.rotation.x=Math.PI/2,this.geometryFactory=o,this.layer=r,this.layer.mapView=this,this.onBeforeRender=()=>{}}getNodeGeometry(e,t){return this.geometryFactory.getGeometry(e,t,this.heightProvider.settings)}onAddTile(e){let t=new eV.W(e.x,e.y,e.level);this.layer.getTile(t)||this.layer.addHeightTile(t,e)}removeTile(e){let t=new eV.W(e.x,e.y,e.level);this.layer.getTile(t)&&this.layer.removeTile(t)}pickElevationAtXY(e,t){return this.pickElevationAt(e.x,e.y,t)}raymarchElevation(e,t,i,s,n){let o=e.clone(),r=e.clone();for(let e=0;e<i;e++){let e=this.pickElevationAtXY(o);if(o.z<e)return n>0?this.raymarchElevation(r,t,i,.1*s,n-1):o;r.copy(o),o.x+=t.x*s,o.y+=t.y*s,o.z+=t.z*s}return null}pickElevationAt(e,t,i){let s=0;if(void 0!==i){let n=B.Z.metersToTMS({x:e,y:t},i),o=new eV.W(Math.floor(n.x),Math.floor(n.y),i),r=this.layer.getTile(o);if(r?.heightNode?.elevationTile){let o=r.heightNode.elevationTileIndex;o.zoom!==i&&(n=B.Z.metersToTMS({x:e,y:t},o.zoom));let a=n.x-Math.floor(n.x),l=n.y-Math.floor(n.y);s=r.heightNode.elevationTile.getElevationBilinear(a,l)}}else{let i=B.Z.metersToTMS({x:e,y:t},0);s=this.root.getElevationFromChain(i.x,i.y)}let{lat:n}=B.Z.metersToLatLng({x:e,y:t});return B.Z.applyMercatorScaleFactor(s,n)}async changeBasemap(e){this.provider.settings=e;let t=[];this.root.traverse(e=>{e instanceof eY&&t.push(e)}),t.sort((e,t)=>t.level-e.level);for(let e=0;e<t.length;e+=4){let i=t.slice(e,e+4);await Promise.all(i.map(e=>{let t=e.onColorProviderChange();return t.then(()=>{this.layer.onSceneUpdated()}),t}))}}async changeElevation(e,t){this.heightProvider.settings=e,t&&(this.heightProviderFallback.settings=t),this.enableHeightProviderFallback=!!t;let i=[];this.root.traverse(e=>{if(e instanceof eY){let t=e.onHeightProviderChange();t.then(()=>{this.layer.onSceneUpdated()}),i.push(t)}}),await Promise.all(i)}createTileMaterial(){let e=new e$.Z(this.provider.settings);return this.layer?this.layer.prepareMaterial(e):setTimeout(()=>{this.layer.prepareMaterial(e)},1),e}update(e,t,i){this.lod.updateLOD(this,e,t,i)}}class eq extends eC.n{constructor(e,t){super(e,t)}load(){return Promise.resolve()}dispose(){}}var eK=i(81028),eJ=i(59843);(r=m||(m={}))[r.BUILDING_TILES=0]="BUILDING_TILES",r[r.TREE_TILES=1]="TREE_TILES",r[r.TILES_3D=2]="TILES_3D",r[r.TERRAIN_COLOR=3]="TERRAIN_COLOR",r[r.TERRAIN_ELEVATION=4]="TERRAIN_ELEVATION",r[r.GOOGLE_TILES_3D=5]="GOOGLE_TILES_3D";class e1{constructor(e){this.onGlobalStateChanged=e,this.loadingStates=new Map,this.lastGlobalState=!1}set(e,t){this.loadingStates.set(e,t);let i=this.isLoading();i!==this.lastGlobalState&&(this.lastGlobalState=i,this.onGlobalStateChanged(i))}isLoading(){for(let e of this.loadingStates.values())if(e)return!0;return!1}}var e0=i(38588);class e2{constructor({bitmap:e,canvas:t,texture:i,renderTarget:s,image:n,onDisposed:o,encoding:r}){this.owners=new Set,this.textureParamsSet=!1,this.encoding=r,this.bitmap=e,this.canvas=t,this.texture=i,this.image=n,s&&(this.renderTarget=s,this.texture=s.texture),this.onDisposed=o}setTextureParams(){}addOwner(e){if(this.owners.add(e),!this.texture)if(this.bitmap)this.texture=new S.Texture(this.bitmap);else if(this.canvas)this.texture=new S.Texture(this.canvas);else throw Error("No bitmap or canvas to create elevation texture from.");this.textureParamsSet||(this.setTextureParams(),this.textureParamsSet=!0)}removeOwner(e){this.owners.delete(e),0===this.owners.size&&(this.texture&&this.texture.dispose(),this.bitmap&&this.bitmap.close(),this.renderTarget&&this.renderTarget.dispose(),this.onDisposed&&this.onDisposed())}}class e5 extends e2{setTextureParams(){this.texture.generateMipmaps=!0,this.texture.format=S.RGBAFormat,this.encoding&&(this.texture.encoding=this.encoding),this.texture.magFilter=S.LinearFilter,this.texture.minFilter=S.LinearMipmapLinearFilter,this.texture.anisotropy=16,this.texture.needsUpdate=!0}static merge4Textures(e,t,i,s,n){let o=t.bitmap?.width??t.canvas?.width??t.texture?.image.width,r=t.bitmap?.height??t.canvas?.height??t.texture?.image.height,a=new S.DataTexture(new Uint8Array(o*r*16),2*o,2*r,S.RGBAFormat,S.UnsignedByteType),l=new e5({texture:a});a.flipY=!0,l.setTextureParams(),l.textureParamsSet=!0,e.initTexture(a),a.needsUpdate=!1;let d=new S.Object3D;for(let o of[t,i,s,n])o.addOwner(d),o.texture.needsUpdate=!0,e.initTexture(o.texture);for(let l of(e.copyTextureToTexture(new S.Vector2(0,r),t.texture,a,0),e.copyTextureToTexture(new S.Vector2(0,0),i.texture,a,0),e.copyTextureToTexture(new S.Vector2(o,r),s.texture,a,0),e.copyTextureToTexture(new S.Vector2(o,0),n.texture,a,0),[t,i,s,n]))l.removeOwner(d);return l}}class e3 extends e2{constructor({renderer:e,x:t,y:i,zoom:s,settings:n,bitmap:o,canvas:r,texture:a,image:l,onDisposed:d,encoding:h,createGPUResources:c}){let u;if(c)if(a)a.generateMipmaps=!1,a.wrapT=a.wrapS=S.ClampToEdgeWrapping,a.magFilter=S.NearestFilter,a.minFilter=S.NearestFilter,a.needsUpdate=!0,u=g.createTextureWithNormal(e,a,t,i,s,n),a.dispose();else{let a=new S.Texture(o??r??l);a.generateMipmaps=!1,a.wrapT=a.wrapS=S.ClampToEdgeWrapping,a.magFilter=S.NearestFilter,a.minFilter=S.NearestFilter,a.needsUpdate=!0,u=g.createTextureWithNormal(e,a,t,i,s,n),a.dispose()}super({bitmap:o,canvas:r,texture:a,image:l,onDisposed:d,encoding:h,renderTarget:u}),this.x=t,this.y=i,this.zoom=s,this.renderer=e,this.settings=n}disposeGPUResources(){this.renderTarget&&(this.renderTarget.dispose(),this.renderTarget=void 0,this.texture=void 0)}createGPUResources(){if(this.renderTarget)return;let e=new S.Texture(this.bitmap??this.canvas??this.image);e.generateMipmaps=!1,e.wrapT=e.wrapS=S.ClampToEdgeWrapping,e.magFilter=S.NearestFilter,e.minFilter=S.NearestFilter,e.needsUpdate=!0,this.renderTarget=g.createTextureWithNormal(this.renderer,e,this.x,this.y,this.zoom,this.settings),this.texture=this.renderTarget.texture,e.dispose()}setTextureParams(){this.texture.generateMipmaps=!1,this.texture.format=S.RGBAFormat,this.texture.magFilter=S.NearestFilter,this.texture.minFilter=S.NearestFilter,this.texture.wrapT=this.texture.wrapS=S.ClampToEdgeWrapping,this.texture.needsUpdate=!0}static createTextureWithNormal(e,t,i,s,n,o){let r=new S.WebGLRenderTarget(t.image.width,t.image.height,{format:S.RGBAFormat,type:S.UnsignedByteType,depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!1,minFilter:S.NearestFilter,magFilter:S.LinearFilter}),a=B.Z.getTileSizeInMeters(n),l=B.Z.TMSToMeters({x:i,y:s},n),{lat:d}=B.Z.metersToLatLng(l),h=B.Z.getMercatorScaleFactor(d);return this.normalRTMaterial.uniforms.map.value=t,this.normalRTMaterial.uniforms.mapResolution.value=t.image.width,this.normalRTMaterial.uniforms.tileSize.value=a,this.normalRTMaterial.uniforms.verticalScale.value=h,this.normalRTMaterial.uniforms.unpackFactors.value=o.unpackFactors,this.normalRTMaterial.uniforms.unpackOffset.value=o.unpackOffset,e.setRenderTarget(r),e.render(this.normalRTMesh,this.normalRTCamera),r}}g=e3,e3.normalRTGeometry=new S.PlaneGeometry(2,2,1,1),e3.normalRTMaterial=new e0.Z,e3.normalRTMesh=new S.Mesh(g.normalRTGeometry,g.normalRTMaterial),e3.normalRTCamera=new S.OrthographicCamera(-.5,.5,.5,-.5,0,1);class e4 extends eW.Ib{constructor(e,t,i){super(),this.minZoom=2,this.maxZoom=18,this.bitmapLoader=new S.ImageBitmapLoader,this.textureLoader=new S.TextureLoader,this.activePromises=new Set,this.sharedTextures=new Map,this.shouldCreateGPUResources=!0,this.renderer=i,this.settings=e,this.loadingStateManager=t,this.bitmapLoader.setOptions({imageOrientation:"flipY"}),eJ.load({locateFile:(e,t)=>`https://www.unpkg.com/lerc@4.0.1/${e}`})}getRealTileIndex(e,t,i){let s=this.settings.maxZoom;if(e<=s)return{zoom:e,x:t,y:i};let n=e-s;return{zoom:s,x:Math.floor(t/2**n),y:Math.floor(i/2**n)}}fetchTile(e,t,i){let s,n=this.getRealTileIndex(e,t,i),o=this.settings.tileUrl.generate(n);if(this.sharedTextures.has(o))return Promise.resolve(this.sharedTextures.get(o));s="lerc"===this.settings.format?fetch(o).then(e=>e.arrayBuffer()).then(async s=>{let n,r=eJ.decode(s),a=document.createElement("canvas");a.width=r.width,a.height=r.height;let l=a.getContext("2d"),d=l.createImageData(r.width,r.width),h=r.pixels[0],c=0;for(let e=r.width-1;e>=0;e--)for(let t=0;t<r.width;t++){let i=e*r.width+t,s=e4.packHeightIntoRGB(h[i]);d.data[c++]=s[0],d.data[c++]=s[1],d.data[c++]=s[2],d.data[c++]=255}l.putImageData(d,0,0),D.xA&&(n=await createImageBitmap(a));let u=new e3({x:t,y:i,zoom:e,renderer:this.renderer,settings:this.settings,bitmap:n,canvas:a,onDisposed:this.onSharedTextureDisposed.bind(this,o),createGPUResources:this.shouldCreateGPUResources});return this.sharedTextures.set(o,u),u}):new Promise(D.xA?(s,n)=>{this.bitmapLoader.load(o,n=>{let r=new e3({x:t,y:i,zoom:e,renderer:this.renderer,settings:this.settings,bitmap:n,onDisposed:this.onSharedTextureDisposed.bind(this,o),createGPUResources:this.shouldCreateGPUResources});this.sharedTextures.set(o,r),s(r)},void 0,()=>n(Error(`Fetching elevation tile failed: ${o}`)))}:(s,n)=>{this.textureLoader.load(o,n=>{let r=new e3({x:t,y:i,zoom:e,renderer:this.renderer,settings:this.settings,image:n.image,onDisposed:this.onSharedTextureDisposed.bind(this,o),createGPUResources:this.shouldCreateGPUResources});this.sharedTextures.set(o,r),s(r)},void 0,()=>n(Error(`Fetching elevation tile failed: ${o}`)))}),this.activePromises.add(s),this.loadingStateManager.set(m.TERRAIN_ELEVATION,!0);let r=()=>{this.activePromises.delete(s),0===this.activePromises.size&&this.loadingStateManager.set(m.TERRAIN_ELEVATION,!1)};return s.then(r,r),s}onSharedTextureDisposed(e){this.sharedTextures.delete(e)}static packHeightIntoRGB(e){let t=Math.round((e+1e4)/.1),i=Math.floor(t/256)%256;return[Math.floor(t/65536)%256,i,t%256]}}let e8=["nextzen","nextzenV2","mapbox","stadia","esri"];function e9(e){return e8.includes(e)}let e7=Object.freeze({nextzen:{name:"Nextzen",tileUrl:new P.I("https://s3.amazonaws.com/elevation-tiles-prod/terrarium/{z}/{x}/{y}.png"),maxZoom:15,unpackFactors:new S.Vector3(256,1,1/256),unpackOffset:-32768,resolution:256,padding:0,minElevation:0,format:"png",attribution:j.Nextzen},nextzenV2:{name:"Nextzen V2",tileUrl:new P.I("https://s3.amazonaws.com/elevation-tiles-prod/v2/terrarium/{z}/{x}/{y}.png"),maxZoom:15,unpackFactors:new S.Vector3(256,1,1/256),unpackOffset:-32768,resolution:256,padding:0,format:"png",attribution:j.Nextzen},mapbox:{name:"Mapbox",tileUrl:new P.I(`https://api.mapbox.com/v4/mapbox.terrain-rgb/{z}/{x}/{y}.pngraw?access_token=${window.SHADOWMAP.MAPBOX_TOKEN}`),maxZoom:15,unpackFactors:new S.Vector3(65536,256,1).multiplyScalar(.1),unpackOffset:-1e4,resolution:256,padding:0,format:"png",attribution:j.Mapbox},stadia:{name:"Stadia",tileUrl:new P.I("https://tiles.stadiamaps.com/data/terrarium_516/{z}/{x}/{y}.png"),maxZoom:12,unpackFactors:new S.Vector3(256,1,1/256),unpackOffset:-32768,resolution:516,padding:2,format:"png"},esri:{name:"Esri",tileUrl:new P.I("https://elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer/tile/{z}/{y}/{x}"),maxZoom:15,unpackFactors:new S.Vector3(65536,256,1).multiplyScalar(.1),unpackOffset:-1e4,resolution:257,padding:.5,format:"lerc",attribution:j.Esri}}),e6=e=>{switch(e){case"nextzenV2":return"nextzen";case"nextzen":return"nextzenV2";default:return}},te=new S.Matrix4,tt=new S.Vector3,ti=new S.Frustum,ts=new S.Vector3;class tn extends eW.Ij{constructor(e,t=120,i=120,s=1/0){super(t,i),this.falloffFactor=s,this.controls=e}updateLOD(e,t){te.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),ti.setFromProjectionMatrix(te),t.getWorldPosition(tt),e.children[0].traverse(i=>{if(!(i instanceof eY))return;let s=i.mesh;ts.setFromMatrixPosition(s.matrixWorld);let n=i.getBoundingBoxRecursive();n&&(ts.z+=(n.min.y+n.max.y)/2,s.boundingBox=n);let o=this.calculateDistance(tt,ts,t.position,this.controls.target,i.level,e.provider.maxZoom),r=ti.intersectsObject(s);o<this.subdivideDistance&&r?i.subdivide():o>this.simplifyDistance&&i.simplify(),r||i.isLoaded||i.simplify()});let i=[];for(let t of(e.children[0].traverse(e=>{e instanceof eY&&i.push(e)}),i.sort((e,t)=>t.level-e.level),i))t.mesh.visible=!1,t.tempHiddenByChildren=!1;for(let e of i){let t=!0,i=new eX.P;for(let s of e.childrenNodes){let e=s.mesh.visible||s.tempHiddenByChildren;i.visibility[s.location]=!e,e||(t=!1)}4===e.childrenNodes.length&&t&&(e.tempHiddenByChildren=!0),e.mesh.visible=e.shouldBeRendered()&&(e.childrenNodes.length<4||!t),e.mesh.visible&&e.updateMask(i)}}getTargetZoomAtControlsTarget(e,t,i,s){let n=new S.Vector3(0,0,0),o=0,r=e.maxZoom(),a=i.worldToLocal(t.position.clone()),l=i.worldToLocal(this.controls.target.clone());for(a.z+=i.position.z;;){let i=B.Z.metersToTMS(n,o),d=new eV.W(Math.floor(i.x),Math.floor(i.y),o),h=s.getTile(d)?.heightNode,c=n;if(h&&h.boundingBox&&(c=n.clone(),c.z+=(h.boundingBox.min.y+h.boundingBox.max.y)/2),!(this.calculateDistance(a,c,t.position,this.controls.target,o,e.provider.maxZoom)<this.subdivideDistance))return o;{if(++o>=r)return r;let e=B.Z.getTileSizeInMeters(o);n.x+=e/2*Math.sign(l.x-n.x),n.y+=e/2*Math.sign(l.y-n.y)}}}calculateDistance(e,t,i,s,n,o){let r=e.distanceTo(t),a=i.distanceTo(s)*this.falloffFactor;return r>a&&(r+=(r-a)*.75),r/=Math.pow(2,o-n)}}var to=i(32401);let tr=null,ta=new Promise(e=>{new S.TextureLoader().load((0,to.Z)()?"img/grid512_dark.png":"img/grid512_white.png",t=>{t.anisotropy=16,t.wrapS=t.wrapT=S.RepeatWrapping,t.repeat.set(1e3,1e3),tr=t,e(t)})});class tl extends S.Object3D{constructor(){super(),ta.then(e=>{let t=new S.PlaneGeometry(1e3,1e3),i=new S.MeshBasicMaterial({color:0xffffff,map:tr,transparent:!0,toneMapped:!1}),s=new S.Mesh(t,i);this.add(s)})}}class td extends eW.Ib{constructor(e,t,i){super(),this.bitmapLoader=new S.ImageBitmapLoader,this.textureLoader=new S.TextureLoader,this.activePromises=new Set,this.settings=e,this.loadingStateManager=t,this.renderer=i,this.bitmapLoader.setOptions({imageOrientation:"flipY"})}async fetchTile(e,t,i){if(this.settings.is256){let[s,n,o,r]=await Promise.all([this.fetchSingleTile(e+1,2*t,2*i),this.fetchSingleTile(e+1,2*t,2*i+1),this.fetchSingleTile(e+1,2*t+1,2*i),this.fetchSingleTile(e+1,2*t+1,2*i+1)]);return e5.merge4Textures(this.renderer,s,n,o,r)}return this.fetchSingleTile(e,t,i)}async fetchSingleTile(e,t,i){let s,n=this.settings.tileUrl.generate({x:t,y:i,zoom:e});s=new Promise(D.xA?(e,t)=>{this.bitmapLoader.load(n,t=>{e(new e5({bitmap:t,encoding:this.settings.encoding}))},void 0,()=>t())}:(e,t)=>{this.textureLoader.load(n,t=>{e(new e5({texture:t,encoding:this.settings.encoding}))},void 0,()=>t())}),this.activePromises.add(s),this.loadingStateManager.set(m.TERRAIN_COLOR,!0);let o=()=>{this.activePromises.delete(s),0===this.activePromises.size&&this.loadingStateManager.set(m.TERRAIN_COLOR,!1)};return s.then(o,o),s}}class th extends eK.A{constructor({parent:e,renderer:t,camera:i,visualQualitySettings:s,basemap:n,loadingStateManager:o,controls:r,terrainType:a,onTerrainVisibilityChanged:l,prepareMaterial:d,onSceneUpdated:h}){super({parent:e,camera:i,visualQualitySettings:s}),this.isTerrainVisible=!1,this.prepareMaterial=d,this.onTerrainVisibilityChanged=l,this.onSceneUpdated=h;let c=new td(n,o,t),u=new e4(e7[a],o,t),p=e6(a),m=new e4(e7[p??"nextzen"],o,t);eQ.mapModes.set(eQ.HEIGHT_SHADER,eY);let g=new eX.Z(this.visualQualitySettings.get("TERRAIN_TILE_GEOMETRY_RESOLUTION"));this.visualQualitySettings.subscribe("TERRAIN_TILE_GEOMETRY_RESOLUTION",e=>{g.setBaseTessellation(e)}),this.mapView=new eQ({root:eQ.HEIGHT_SHADER,provider:c,heightProvider:u,enableHeightProviderFallback:!!p,heightProviderFallback:m,geometryFactory:g,layer:this}),this.mapView.cacheTiles=!1,this.parent.add(this.mapView);let f=()=>{this.mapView.lod=new tn(r,this.visualQualitySettings.get("TERRAIN_SUBDIVIDE_DISTANCE"),this.visualQualitySettings.get("TERRAIN_SIMPLIFY_DISTANCE"),this.visualQualitySettings.get("TERRAIN_FALLOFF_DISTANCE_FACTOR"))};this.visualQualitySettings.subscribe("TERRAIN_SUBDIVIDE_DISTANCE",f),this.visualQualitySettings.subscribe("TERRAIN_SIMPLIFY_DISTANCE",f),this.visualQualitySettings.subscribe("TERRAIN_FALLOFF_DISTANCE_FACTOR",f),f(),this.placeholder=new tl,this.parent.add(this.placeholder)}finalize(){}initTile(e){return new eq(e,this)}isTileExistsAt(e,t,i){let s=B.Z.metersToTMS({x:e,y:t},i),n=new eV.W(Math.floor(s.x),Math.floor(s.y),i);return this.hasTile(n)}update(e){if(!this.enabled){this.mapView.root.visible=!1,this.placeholder.visible=!1,this.isTerrainVisible||(this.onTerrainVisibilityChanged(!0),this.isTerrainVisible=!0);return}this.updateTerrainVisibility(),this.placeholder.visible&&this.updatePlaceholderPosition(e)}updateMapView(e,t,i){this.mapView.update(e,t,i)}updateTerrainVisibility(){let e=this.mapView.lod,t=e.getTargetZoomAtControlsTarget(this.mapView,this.camera,this.parent,this),i=Math.max(this.mapView.minZoom(),t-2);ez.setPrioritizedZoomLevel(i);let s=this.parent.worldToLocal(e.controls.target.clone()),n=!B.Z.isPointInEPSG3857Bounds(s)||this.isTileExistsAt(s.x,s.y,i);this.isTerrainVisible!==n&&this.onTerrainVisibilityChanged(n),this.isTerrainVisible=n,this.mapView.root.visible=this.isTerrainVisible,this.placeholder.visible=!this.isTerrainVisible}updatePlaceholderPosition(e){let t=this.mapView.lod,i=this.parent.worldToLocal(t.controls.target.clone()),s=B.Z.getTileSizeInMeters(Math.round(e)),n=Math.floor(i.x/s)*s,o=Math.floor(i.y/s)*s;this.placeholder.scale.set(s,s,1),this.placeholder.position.set(n,o,i.z)}addHeightTile(e,t){let i=this.getTile(e);i||((i=this.initTile(e)).heightNode=t,this.tiles.set(e.toString(),i),this.eventEmitter.emit("tileAdded",[i]),this.onSceneUpdated())}enable(){for(let e of(this.mapView.heightProvider.shouldCreateGPUResources=!0,this.mapView.heightProviderFallback.shouldCreateGPUResources=!0,this.tiles.values()))e.heightNode.restoreTextures();super.enable()}disable(){for(let e of(this.mapView.heightProvider.shouldCreateGPUResources=!1,this.mapView.heightProviderFallback.shouldCreateGPUResources=!1,this.tiles.values()))e.heightNode.disposeTextures();super.disable()}}class tc extends eK.A{constructor(){super(...arguments),this.loadingEnabled=!1,this.queue=[],this.isLoadingBusy=!1,this.maxDistance=1/0}addTile(e){super.addTile(e),this.queue.push(e)}sortQueue(){let e=this.camera.getWorldPosition(new S.Vector3);e.z=0;let t=new Map,i=new S.Object3D;for(let s of(this.parent.add(i),this.queue=this.queue.filter(e=>!!this.getTile(e)),this.queue)){let n=B.Z.TMSToMeters({x:s.x+.5,y:s.y+.5},s.zoom);i.position.set(n.x,n.y,0),i.updateMatrixWorld();let o=i.getWorldPosition(new S.Vector3);o.z=0;let r=o.distanceTo(e);t.set(s,r)}this.parent.remove(i),this.queue.sort((e,i)=>t.get(e)-t.get(i)),this.queue.length>200&&(this.queue=this.queue.slice(0,200));for(let e=0;e<this.queue.length;e++){let i=this.queue[e];if(t.get(i)<this.maxDistance)return this.queue.splice(e,1),i}return null}processQueue(){if(!this.loadingEnabled||this.isLoadingBusy||0===this.queue.length)return;let e=this.sortQueue();if(!e)return;let t=this.getTile(e);t&&t.state===eC.e.IDLE&&(this.isLoadingBusy=!0,this.eventEmitter.emit("tileLoadingStarted",[t]),t.load().then(()=>{this.getTile(e)||t.dispose(),this.isLoadingBusy=!1,this.eventEmitter.emit("tileLoadingFinished",[t])}))}update(){this.processQueue()}}let tu=new ey.A({x:8922,y:5672},{x:8955,y:5700},j.StadtWien),tp=[tu,new ey.A({x:8002,y:6167},{x:8047,y:6195},j.MadridCityCouncil),new ey.A({x:8258,y:5605},{x:8340,y:5656},j.MairieDeParis)];class tm extends tc{constructor({parent:e,visualQualitySettings:t,camera:i,loadingStateManager:s,prepareMaterial:n,controls:o,onSceneUpdated:r}){for(let a of(super({parent:e,camera:i,visualQualitySettings:t}),this.containers=[],this.treeIdToTile=new Map,this.controls=o,this.loadingStateManager=s,this.onSceneUpdated=r,this.visualQualitySettings.subscribe("TREE_TILE_MAX_DISTANCE",e=>{this.maxDistance=e},!0),Object.values(eS)))n(a);for(let t=0;t<tp.length;t++){let t=new S.Object3D;this.containers.push(t),e.add(t)}}finalize(){let e=this.getDependency(th);e.eventEmitter.on("tileAdded",e=>{e.index.zoom===eN.ZOOM_LEVEL&&this.addTile(e.index)}),e.eventEmitter.on("tileRemoved",e=>{e.index.zoom===eN.ZOOM_LEVEL&&(this.removeTile(e.index),this.onSceneUpdated())});let t=new Set;this.eventEmitter.on("tileLoadingStarted",e=>{t.add(e),this.loadingStateManager.set(m.TREE_TILES,!0)}),this.eventEmitter.on("tileLoadingFinished",e=>{t.delete(e),0===t.size&&this.loadingStateManager.set(m.TREE_TILES,!1),this.onSceneUpdated()})}addTile(e){tm.isOutOfBounds(e)||super.addTile(e)}initTile(e){let t;for(let i=0;i<tp.length;i++)if(tp[i].isWithinBounds(e)){t=this.containers[i];break}return new eN(e,eR,t,this)}setUserTrees(e){this.userTrees=e}getAttribution(){let e=this.tiles.values().next();if(e.value)return tm.isWithin(e.value.index)?.attribution}getTileByTreeId(e){return this.treeIdToTile.get(e)}update(){if(!this.enabled)return;this.loadingEnabled=this.getDependency(th).isTerrainVisible,this.parent.visible=this.loadingEnabled,super.update();let e=this.visualQualitySettings.get("OSM_TREE_TILE_MAX_DISTANCE");for(let t of this.tiles.values())t.updateLOD(this.controls.target,e)}get mapView(){return this.getDependency(th).mapView}refreshTiles(){for(let e of this.tiles.values())e.dispose(),e.load().then(()=>{this.getTile(e.index)||e.state===eC.e.DISPOSED||e.dispose(),this.onSceneUpdated()})}enable(){super.enable(),this.parent.visible=!0,this.loadingEnabled=!0,this.onSceneUpdated()}disable(){super.disable(),this.parent.visible=!1,this.loadingEnabled=!1,this.onSceneUpdated()}toggleAreas(e,t){this.containers[0].visible=e,this.containers[1].visible=t,this.containers[2].visible=t,this.onSceneUpdated()}static isWithin(e){for(let t of tp)if(t.isWithinBounds(e))return t}static isOutOfBounds(e){return tp.reduce((t,i)=>t&&i.isOutOfBounds(e),!0)}}var tg=i(46620),tf=i(50921);class tx extends tg.Z{constructor(e,t){super(),this.onSceneUpdated=t,this.group.name="LocationPin",this.group.visible=!1,e.add(this.group),new S.TextureLoader().load("img/location_pin.png",e=>{let i=new S.Sprite(new tf.x({map:e,toneMapped:!1,depthTest:!1,depthWrite:!1,sizeAttenuation:!1})),s=27*(e.image.width/e.image.height);i.scale.set(s,27,1),i.center.set(.5,0),i.renderOrder=10,this.group.add(i),this.sprite=i,t()})}get visible(){return this.group.visible}hide(){this.group.visible=!1,this.tween?.stop(),this.onSceneUpdated()}showOnMap(e,t,i){let s=i.pickElevationAt(e,t);this.group.position.set(e,t,s),this.group.visible=!0,this.sprite&&(this.sprite.material.opacity=1),this.onSceneUpdated()}dropAtMap(e,t,i,s){this.dropAtPos(e,t,s),this.updateElevation(i)}dropAtPos(e,t,i){this.group.position.x=e,this.group.position.y=t,this.group.visible=!0,this.sprite&&(this.sprite.material.opacity=0),this.tween?.stop(),this.tween=new C.kX({alpha:0}).to({alpha:1},400).onUpdate(({alpha:e})=>{this.sprite&&(this.sprite.material.opacity=Math.min(1,e)),this.onSceneUpdated(),i&&i()}).easing(C.oY.Quadratic.In).start()}update(e,t,i){if(this.sprite){let t=1/(window.innerHeight*(1/(2*Math.tan(S.MathUtils.degToRad(e.fov)/2))));this.group.scale.set(t,t,t)}this.updateElevation(t,i)}}class tw{}tw.DropShadow=new S.TextureLoader().load("img/round-shadow-64.png");let tb=new S.Color(2055359),tv=new S.Color(1,1,1);class ty extends tg.Z{constructor(e,t){super(),this.onSceneUpdated=t,this.cameraScaleFactor=1,this.group.name="LocationOrb",this.group.visible=!1,this.group.castShadow=!1,this.group.receiveShadow=!1,e.add(this.group);let i=new S.CylinderGeometry(3,3,1.2,128);i.rotateX(Math.PI/2),i.translate(0,0,2.6);let s=new S.MeshLambertMaterial({color:tb,emissive:tb,emissiveIntensity:.75,fog:!1,transparent:!0,opacity:.9,toneMapped:!0}),n=new S.Mesh(i,s);n.castShadow=!1,n.receiveShadow=!1,this.group.add(n);let o=new S.CylinderGeometry(3.5,3.5,1,128);o.rotateX(Math.PI/2),o.translate(0,0,2.5);let r=new S.MeshLambertMaterial({color:tv,emissive:tv,emissiveIntensity:.5,fog:!1,toneMapped:!0}),a=new S.Mesh(o,r);a.castShadow=!1,a.receiveShadow=!1,this.group.add(a);let l=new S.PlaneGeometry(10.5,10.5),d=new S.MeshBasicMaterial({color:0,alphaMap:tw.DropShadow,fog:!1,opacity:.8,depthTest:!1,toneMapped:!1,...eb.a}),h=new S.Mesh(l,d);h.castShadow=!1,h.receiveShadow=!1,this.group.add(h),h.renderOrder=1,n.renderOrder=2,a.renderOrder=3}get visible(){return this.group.visible}showOnMap(e,t,i){let{x:s,y:n}=B.Z.latLngToMeters(e);this.group.scale.setScalar(+this.cameraScaleFactor),this.group.position.x=s,this.group.position.y=n,this.group.visible=!0,this.tween?.stop(),this.tween=new C.kX({scale:1}).to({scale:1.25},1e3).repeat(1/0).yoyo(!0).onUpdate(({scale:e})=>{let t=this.cameraScaleFactor*e;this.group.scale.set(t,t,this.cameraScaleFactor),this.onSceneUpdated()}).easing(C.oY.Sinusoidal.InOut).start(),this.updateElevation(t)}hide(){this.group.visible=!1,this.tween?.stop(),this.onSceneUpdated()}scaleToCameraDistance(e,t){let i=Math.max(1.5,e*t*9e-5);return this.cameraScaleFactor=i,i}}class tC extends S.Mesh{constructor(){let e=tC.SkyShader;super(new S.BoxGeometry(1,1,1),new S.ShaderMaterial({name:"SkyShader",fragmentShader:e.fragmentShader,vertexShader:e.vertexShader,uniforms:S.UniformsUtils.clone(e.uniforms),side:S.BackSide,depthWrite:!1,toneMapped:!0})),this.isSky=!0}}tC.SkyShader={uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new S.Vector3},up:{value:new S.Vector3(0,1,0)}},vertexShader:`
		uniform vec3 sunPosition;
		uniform float rayleigh;
		uniform float turbidity;
		uniform float mieCoefficient;
		uniform vec3 up;

		varying vec3 vWorldPosition;
		varying vec3 vSunDirection;
		varying float vSunfade;
		varying vec3 vBetaR;
		varying vec3 vBetaM;
		varying float vSunE;

		// constants for atmospheric scattering
		const float e = 2.71828182845904523536028747135266249775724709369995957;
		const float pi = 3.141592653589793238462643383279502884197169;

		// wavelength of used primaries, according to preetham
		const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );
		// this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:
		// (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))
		const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );

		// mie stuff
		// K coefficient for the primaries
		const float v = 4.0;
		const vec3 K = vec3( 0.686, 0.678, 0.666 );
		// MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K
		const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );

		// earth shadow hack
		// cutoffAngle = pi / 1.95;
		const float cutoffAngle = 1.6110731556870734;
		const float steepness = 1.5;
		const float EE = 1000.0;

		float sunIntensity( float zenithAngleCos ) {
			zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );
			return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );
		}

		vec3 totalMie( float T ) {
			float c = ( 0.2 * T ) * 10E-18;
			return 0.434 * c * MieConst;
		}

		void main() {

			vec4 worldPosition = modelMatrix * vec4( position, 1.0 );
			vWorldPosition = worldPosition.xyz;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			gl_Position.z = gl_Position.w; // set z to camera.far

			vSunDirection = normalize( sunPosition );

			vSunE = sunIntensity( dot( vSunDirection, up ) );

			vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );

			float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );

			// extinction (absorbtion + out scattering)
			// rayleigh coefficients
			vBetaR = totalRayleigh * rayleighCoefficient;

			// mie coefficients
			vBetaM = totalMie( turbidity ) * mieCoefficient;

		}`,fragmentShader:`
		varying vec3 vWorldPosition;
		varying vec3 vSunDirection;
		varying float vSunfade;
		varying vec3 vBetaR;
		varying vec3 vBetaM;
		varying float vSunE;

		uniform float mieDirectionalG;
		uniform vec3 up;

		// constants for atmospheric scattering
		const float pi = 3.141592653589793238462643383279502884197169;

		const float n = 1.0003; // refractive index of air
		const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)

		// optical length at zenith for molecules
		const float rayleighZenithLength = 8.4E3;
		const float mieZenithLength = 1.25E3;
		// 66 arc seconds -> degrees, and the cosine of that
		const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;

		// 3.0 / ( 16.0 * pi )
		const float THREE_OVER_SIXTEENPI = 0.05968310365946075;
		// 1.0 / ( 4.0 * pi )
		const float ONE_OVER_FOURPI = 0.07957747154594767;

		float rayleighPhase( float cosTheta ) {
			return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );
		}

		float hgPhase( float cosTheta, float g ) {
			float g2 = pow( g, 2.0 );
			float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );
			return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );
		}

		void main() {

			vec3 direction = normalize( vWorldPosition - cameraPosition );

			// optical length
			// cutoff angle at 90 to avoid singularity in next formula.
			float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );
			float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );
			float sR = rayleighZenithLength * inverse;
			float sM = mieZenithLength * inverse;

			// combined extinction factor
			vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );

			// in scattering
			float cosTheta = dot( direction, vSunDirection );

			float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );
			vec3 betaRTheta = vBetaR * rPhase;

			float mPhase = hgPhase( cosTheta, mieDirectionalG );
			vec3 betaMTheta = vBetaM * mPhase;

			vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );
			Lin *= mix(
			    vec3( 1.0 ),
			    pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ),
			    clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 )
			);

			// nightsky
			float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]
			float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]
			vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );
			vec3 L0 = vec3( 0.1 ) * Fex;

			// composition + solar disc
			float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );
			L0 += ( vSunE * 19000.0 * Fex ) * sundisk;

			vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );

			vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );

			gl_FragColor = vec4( retColor, 1.0 );

			//#include <tonemapping_fragment>
			gl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );

			#include <encodings_fragment>

		}`};class tM{constructor(e){this.sky=new tC,this.sky.scale.setScalar(1e8),this.sky.material.uniforms.up.value=new S.Vector3(0,0,1),e.add(this.sky);let t={turbidity:10,rayleigh:3,mieCoefficient:.005,mieDirectionalG:.7},i=this.sky.material.uniforms;i.turbidity.value=t.turbidity,i.rayleigh.value=t.rayleigh,i.mieCoefficient.value=t.mieCoefficient,i.mieDirectionalG.value=t.mieDirectionalG,this.sky.updateMatrix(),this.sky.matrixAutoUpdate=!1}updatePosition(e,t){let i=this.sky.material.uniforms.sunPosition.value;i.x=Math.cos(-e-.5*Math.PI),i.y=Math.sin(-e-.5*Math.PI),i.z=Math.tan(t),i.normalize()}}var tS=i(43194),tL=i(89580),tT=i(330),tj=i(99848),tP=i(88845);let tE=new S.Vector3;function tA(e,t,i){let s=e.geometry.getAttribute("position"),n=s.array,o=e.geometry.getIndex().array,r=[],a=new S.Box3;for(let[e,s]of(a.makeEmpty(),t.getRanges(i)))for(let t=e;t<e+s;t++){let e=o[t];tE.set(n[3*e],n[3*e+1],n[3*e+2]),a.expandByPoint(tE),r.push(e)}let l=new S.BufferGeometry;return l.setAttribute("position",s),l.setIndex(new S.Uint32BufferAttribute(r,1)),l.boundingBox=a,l}var tD=i(17102);class tO extends tj.m{constructor({camera:e,parent:t,renderer:i,visualQualitySettings:s,onTileAdd:n,config:o,floorIndication:r,floorHeight:a,prepareMaterial:l,onSceneUpdated:d}){super({camera:e,parent:t,visualQualitySettings:s}),this.tilesRenderers=[],this.tileParents=new WeakMap,this.buildingMaterials=new Map,this.buildingDepthMaterial=new tL.bg,this.buildingIdToMesh=new Map,this.hiddenBuildings=new Set,this.renderer=i,this.onTileAdd=n,this.config=o,this.dracoLoader=new V._,this.dracoLoader.setDecoderConfig({type:"wasm"}),this.dracoLoader.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.6/"),this.floorIndication=r,this.floorHeight=a,this.prepareMaterial=l,this.onSceneUpdated=d,this.visualQualitySettings.subscribe("TILE_3D_MAX_DISTANCE",e=>{this.maxTileDistance=e},!0),this.setConfig(o),this.setResetTilesInterval()}resetHiddenBuildings(){for(let e of this.hiddenBuildings)this.showBuilding(e);this.hiddenBuildings.clear()}hideBuilding(e,t=!1){(!this.hiddenBuildings.has(e)||t)&&(this.hiddenBuildings.add(e),this.toggleBuildingVisibilityById(e,!1))}showBuilding(e,t=!1){(this.hiddenBuildings.has(e)||t)&&(this.hiddenBuildings.delete(e),this.toggleBuildingVisibilityById(e,!0))}toggleBuildingVisibilityById(e,t){let i=this.buildingIdToMesh.get(e);if(!i)return;let s=i.userData.batchTable,n=i.userData.batchMap,o=i.userData.tile3DSettings,r=s.header[o.idAttributeName],a=i.geometry.getAttribute("visibility"),l=a.array,d=i.geometry.getIndex().array,h=r.indexOf(e.split("/")[1]),c=255*!!t;for(let[e,t]of n.getRanges(h))for(let i=e;i<e+t;i++)l[d[i]]=c;a.needsUpdate=!0}setConfig(e){this.config=e,this.disposeTilesets(),this.createTilesets()}createTilesets(){let e=null,t=null,i=null;for(let s of this.config){let n=new tD.k(s.url);n.loadSiblings=!1,n.errorTarget=140,n.errorThreshold=1/0,n.displayActiveTiles=!0,n.setCamera(this.camera),n.setResolutionFromRenderer(this.camera,this.renderer);let o=new tS.E(n.manager);o.setDRACOLoader(this.dracoLoader),n.manager.addHandler(/path\.gltf/,o),e?(n.lruCache=e,n.downloadQueue=t,n.parseQueue=i):(n.lruCache.maxSize=400,n.lruCache.minSize=200,e=n.lruCache,t=n.downloadQueue,i=n.parseQueue),this.parent.add(n.group),this.tilesRenderers.push(n);let r=new tL.IU(s.lineColor,this.floorIndication,this.floorHeight);this.prepareMaterial(r),this.buildingMaterials.set(n,r)}this.overrideTileRendererErrorCalculation(),this.addListeners()}disposeTilesets(){for(let e of this.tilesRenderers)e.dispose();for(let e of(this.tilesRenderers.length=0,this.buildingMaterials.values()))e.dispose();this.buildingMaterials.clear()}finalize(){}setFloorIndication(e,t){for(let i of(this.floorIndication=e,this.floorHeight=t,this.buildingMaterials.values()))i.updateFloorIndication(e,t)}overrideTileRendererErrorCalculation(){for(let e of this.tilesRenderers){let t=e.calculateError;e.calculateError=i=>{t.call(e,i);let s=this.getDependency(th).isTerrainVisible?this.maxTileDistance:0;i.__distanceFromCamera<s?i.__error=1/0:i.__error=0}}}addListeners(){for(let e of this.tilesRenderers){let t,i,s=this.config[this.tilesRenderers.indexOf(e)];e.onLoadTileSet=()=>{let n=tO.getTilesetPosition(e),{lat:o,lng:r}=B.Z.EPSG4978ToLatLng(n);t=tO.computeRotationMatrixFromLatLng(o,r);let a=new S.Object3D;a.rotation.setFromRotationMatrix(t,"ZYX"),this.parent.add(a),e.group.parent&&e.group.parent.remove(e.group),a.add(e.group);let l=B.Z.getMercatorScaleFactor(o);a.scale.set(l,l,l);let d=B.Z.EPSG4978ToMeters(n);e.group.position.set(-n.x,-n.y,-n.z),a.position.x=d.x,a.position.y=d.y,a.position.z=s.offsetZ,i=s.offsetZ-d.z*l,this.onSceneUpdated()},e.onTileVisibilityChange=(e,n,o)=>{if(this.onSceneUpdated(),this.onTileVisibilityChange&&this.onTileVisibilityChange(),!o)return;if(this.tileParents.has(e)){e.parent&&e.parent.remove(e),this.tileParents.get(e).add(e);return}let r=B.Z.EPSG4978ToMeters(e.position),{lat:a}=B.Z.metersToLatLng(r),l=B.Z.getMercatorScaleFactor(a),d=new S.Object3D;e.parent&&e.parent.remove(e),d.add(e),this.tileParents.set(e,d),this.parent.add(d),e.position.set(0,0,0),d.rotation.setFromRotationMatrix(t,"ZYX"),d.scale.set(l,l,l),d.position.set(r.x,r.y,i),d.updateMatrix(),e.updateMatrix(),s.removeFeaturesOutsideArea&&e.traverse(t=>{t instanceof S.Mesh&&t.material&&this.removeFeaturesOutsideArea(t,d,e,s.regionArea)}),this.onTileAdd&&this.onTileAdd()},e.onLoadModel=(t,i)=>{let n=[];if(t.traverse(e=>{if(e instanceof S.Mesh){n.push(e);let t=e.geometry,i=t.getAttribute("position").count,o=new Uint8Array(3*i),r=new Uint8Array(i),a=e.material.color,l=s.colorScheme[a.getHex()]??a;for(let e=0;e<i;e++)o[3*e]=255*l.r,o[3*e+1]=255*l.g,o[3*e+2]=255*l.b,r[e]=255;t.setAttribute("color",new S.BufferAttribute(o,3,!0)),t.setAttribute("visibility",new S.BufferAttribute(r,1,!0)),e.material.dispose()}}),n.length>0){let o=this.buildingMaterials.get(e),r=this.mergeMeshes(n,t.children[0],o);r.customDepthMaterial=this.buildingDepthMaterial,r.userData.depthMaterial=new tL.bg,r.userData.normalMaterial=new tL.R_,r.layers.enable(D.OB),i.cached.geometry.push(r.geometry);let a=t.batchTable,l=[];for(let e=0;e<a.header[s.idAttributeName].length;e++){let t=a.header[s.idAttributeName][e],i=`${s.idPrefix}/${t}`;if(this.buildingIdToMesh.has(i)){l.push(e);continue}this.buildingIdToMesh.set(i,r)}r.geometry.addEventListener("dispose",()=>{for(let e of a.header[s.idAttributeName]){let t=`${s.idPrefix}/${e}`;this.buildingIdToMesh.delete(t)}}),r.userData.batchTable=a,r.userData.batchTableIds=a.header[s.idAttributeName];let d=r.geometry.getAttribute("_batchid").array,h=r.geometry.getIndex().array;r.userData.batchMap=new tP.Z(d,h),r.userData.tile3DSettings=s;let c=r.geometry.getAttribute("visibility").array;for(let e of l)for(let[t,i]of r.userData.batchMap.getRanges(e))for(let e=t;e<t+i;e++)c[h[e]]=0;let u=a.header[s.idAttributeName];for(let e=0;e<u.length;e++){let t=`${s.idPrefix}/${u[e]}`;this.hiddenBuildings.has(t)&&this.hideBuilding(t,!0)}}this.onSceneUpdated()}}}removeFeaturesOutsideArea(e,t,i,s){let n=t.matrix.clone().multiply(i.matrix),o=e.geometry.boundingBox.clone().applyMatrix4(n);if(s.isBoundingBoxWithinArea(o.min,o.max))return;let r=e.geometry.getAttribute("position"),a=e.geometry.getAttribute("visibility"),l=e.geometry.getAttribute("_batchid"),d=e.geometry.getIndex(),h=r.array,c=a.array,u=l.array,p=d.array,m=!1,g=u[p[0]],f=0,x=new S.Box2;x.makeEmpty();for(let e=0;e<p.length;e++){let o=p[e],r=h[3*o],a=h[3*o+1],l=h[3*o+2],d=u[o];if(e===p.length-1){let e=new S.Vector3(r,a,l).applyMatrix4(i.matrix).applyMatrix4(t.matrix);x.expandByPoint(new S.Vector2(e.x,e.y))}if(d!==g||e===p.length-1){let t=x.getCenter(new S.Vector2);if(!s.isPointWithinArea(t)){m=!0;for(let t=f;t<e;t++)c[p[t]]=0}f=e,g=d,x.makeEmpty()}let w=new S.Vector3(r,a,l).applyMatrix4(n);x.expandByPoint(new S.Vector2(w.x,w.y))}m&&(a.needsUpdate=!0)}mergeMeshes(e,t,i){let s=new S.Box3;for(let t of(s.makeEmpty(),e))t.geometry.boundingBox||t.geometry.computeBoundingBox(),s.union(t.geometry.boundingBox);let n=tT.n4(e.map(e=>e.geometry),!1);n.boundingBox=s;let o=new S.Mesh(n,i);for(let i of(o.castShadow=!0,o.receiveShadow=!0,o.layers.set(D.sv),o.userData.studioType="3dtile",t.add(o),e))i.children.length>0&&i.parent.add(...i.children),i.parent.remove(i),i.geometry.dispose();return o}getBatchIdFromVertexIndex(e,t){return 0===e.geometry.getAttribute("visibility").array[t]?-1:e.geometry.getAttribute("_batchid").array[t]}extractBatch(e,t,i){let s=e.userData.batchMap,n=tA(e,s,t);return new S.Mesh(n,i)}getBuildingName(e,t){let i=e.userData.batchTableIds;return e.userData.tile3DSettings.idPrefix+"/"+i[t]}setResetTilesInterval(){setInterval(()=>{for(let e of this.tilesRenderers)e.resetFailedTiles()},5e3)}onWindowResize(){for(let e of this.tilesRenderers)e.setResolutionFromRenderer(this.camera,this.renderer)}update(e){if(!this.enabled)return;for(let e of(this.parent.visible=this.getDependency(th).isTerrainVisible,this.tilesRenderers))e.update();let t=!1;for(let e of this.tilesRenderers){let i=e.stats;t=i.parsing>0||i.downloading>0}e.set(m.TILES_3D,t)}getAttribution(){let e=[];if(!this.camera.layers.isEnabled(D.sv))return e;for(let t=0;t<this.tilesRenderers.length;t++)this.tilesRenderers[t].stats.inFrustum>1&&e.push(...this.config[t].attributions);return e}enable(){super.enable(),this.parent.visible=!0}disable(){super.disable(),this.parent.visible=!1}static getTilesetPosition(e){let t=new S.Box3;e.getBoundingBox(t);let i=new S.Vector3;return t.getCenter(i),i}static computeRotationMatrixFromLatLng(e,t){let i=new S.Matrix4;return i.multiply(new S.Matrix4().makeRotationX(S.MathUtils.degToRad(270+e))),i.multiply(new S.Matrix4().makeRotationZ(S.MathUtils.degToRad(-t-90))),i}}var tk=i(14882),tI=i(81161),tN=i.n(tI),t_=i(67052),tR=i(87187),tV=i(88231),tB=i(83474),tU=i(85959),tF=i(19465);let tZ=(e,t)=>{let i=e.properties[t];return i?+i:null},tH=(e,t,i)=>{let s=tZ(e,"height"),n=tZ(e,"minHeight"),o=tZ(e,"levels"),r=tZ(e,"minLevel");return null===s&&null===o?o=Math.max(1,Math.round((s=i)/t)):null===s?s=o*t:null===o&&(o=Math.max(1,Math.round(s/t))),null===r&&(r=null!==n?Math.min(o-1,Math.round(n/t)):0),null===n&&(n=Math.min(r*t,s)),s-n<.1&&(s=n+.1),s};class tG extends S.InstancedMesh{constructor(e,t,i){super(e,t,i),this.instanceIdToTree=[],this.layers.enable(D.sv),this.layers.enable(D.OB),this.receiveShadow=!0,this.castShadow=!0,this.frustumCulled=!0}setTreeList(e){this.instanceIdToTree=e.slice()}getTreeByInstanceId(e){return this.instanceIdToTree[e]}getInstanceOutlineMesh(e){let t=new S.Mesh(this.geometry,tG.noColorMaterial);return t.matrixAutoUpdate=!1,this.getMatrixAt(e,t.matrix),this.add(t),t}}tG.noColorMaterial=new S.MeshBasicMaterial({color:0,colorWrite:!1,depthWrite:!1});class tz extends eL.d{constructor(e,t,i,s){super(e,t,s),this.config=i,this.localIdGlobalIdMap=new t_.Z,this.buildingFeatures=[],this.buildingFeaturesMap=new Map,this.treeChunks=[],this.treeChunkMeshes=[],this.treeIdToInstance=new Map,this.eventEmitter=new tR.Z,this.initGroup(),this.group.name=`BuildingTile ${e.x} ${e.y} ${e.zoom}`,this.treeGroup=new S.Object3D,this.group.add(this.treeGroup),this.treeGroup.visible=this.layer.showTrees}get mapView(){return this.layer.getDependency(th).mapView}refresh(e){this.vectorTile&&e&&(this.initBuildingFeatures(),this.initTreeFeatures())}async load(){if(this.state=eC.e.LOADING,this.vectorTile)return this.initBuildingFeatures(),this.processLoadedVectorTile();let e=this.config.tileUrl.generate(this.index),t=await fetch(e,{mode:"cors",cache:"force-cache"});if(200!==t.status)return;let i=await t.arrayBuffer();this.vectorTile=new tk.VectorTile(new(tN())(new Uint8Array(i))),this.initBuildingFeatures(),this.initTreeFeatures(),await this.processLoadedVectorTile(),this.layer.onSceneUpdated()}async processLoadedVectorTile(){if(this.hasBuildings=!!this.vectorTile.layers[this.config.layerName],this.processBuildingFeatures(),await this.createAllMeshes(),this.state===eC.e.ABORTED)return void this.dispose();this.state=eC.e.FINISHED}async createAllMeshes(){await this.createMesh(),this.createTreesMesh()}async createMesh(){let{lat:e}=B.Z.metersToLatLng(this.position),t=this.layer.buildingVisualSettings.getState().floorHeight,i=this.layer.defaultBuildingHeight,s=this.buildingFeatures.length,n=await q.y.convert({geoJSON:this.buildingFeatures,latitude:e,floorHeight:t,defaultHeight:i,userBuildings:this.layer.userBuildings,globalIdToLocalIdMap:this.localIdGlobalIdMap.reverseMap,excludeBottom:!0,meltIntoGround:!0});if(s!==this.buildingFeatures.length)return;for(let e=0;e<n.height.length;e++)this.buildingFeatures[e].properties.calculatedHeight=n.height[e];let o=this.group.children.length>0;this.createBuildingsMesh(n),this.parent.add(this.group),o&&this.eventEmitter.emit("meshUpdated")}createTreesMesh(){this.treeIdToInstance.clear();for(let e=0;e<this.treeChunks.length;e++)for(let[t,i]of(this.treeChunkMeshes[e]||(this.treeChunkMeshes[e]=new Map),this.treeChunks[e].entries())){if(0===i.length)continue;let s=i.filter(e=>{let t=this.layer.userTrees.get(e.key);return!(t&&t.hidden)});if(!this.treeChunkMeshes[e].get(t)){let s=new tG(tU.Z.getGeometry("needleleaved"===t,!1),f.TreeMaterial,i.length);this.treeGroup.add(s),this.treeChunkMeshes[e].set(t,s)}let n=this.treeChunkMeshes[e].get(t);for(let e=0;e<s.length;e++){let t=s[e],i=new S.Matrix4;i.makeScale(t.height,t.height,t.height),i.setPosition(t.positionX,t.positionY,t.minHeight),n.setMatrixAt(e,i),this.treeIdToInstance.set(t.key,{mesh:n,instanceId:e})}n.setTreeList(s),n.computeBoundingBox(),n.instanceMatrix.needsUpdate=!0}}getMesh(){return this.buildingsMesh}getActualBuildingId(e){let t=e.properties.outlineOsmId,i=e.properties.outlineOsmType;if(i)return"w"===i?t.toString():i+t;let s=e.properties.osmId,n=e.properties.osmType;if("w"===n)return s.toString();if("r"===n)return n+s;let o=e.properties.overtureId;return o||(console.warn("No ID found in building feature properties"),Math.random().toString())}initBuildingFeatures(){this.buildingFeatures=[];let e=this.vectorTile.layers[this.config.layerName];if(e)for(let t=0;t<e.length;t++){let i=e.feature(t);if(i.properties.hide_3d||!this.isIntersectsTile(i))continue;let s=this.getLocalFeatureCenterXY(i);if(f.isPointWithinAnyRegionArea(s))continue;let n=this.getLocalFeatureCenterElevation(s);if(void 0===n)continue;let o=i.toGeoJSON(f.WIDTH,n),r=this.getActualBuildingId(i);o.properties.globalId=r,f.tryFixGeoJSONFeature(o),this.buildingFeatures.push(o)}}isTreeVisible(e,t){let i=f.WIDTH/2;if(e<-i||e>i||t<=-i||t>=i)return!1;let s={x:this.position.x+e,y:this.position.y+t};return!this.isPointWithinRegionAreaWithTrees(s)}getTreeLatLng(e,t){let i={x:this.position.x+e,y:this.position.y+t};return B.Z.metersToLatLng(i)}initTreeFeatures(){let e=new Map;e.set("broadleaved",[]),e.set("needleleaved",[]);let t=this.vectorTile.layers.tree,i=new tF.Z(this.position.x+this.position.y),s=()=>3*i.generate()+18,n=()=>2*i.generate()+10;if(t)for(let i=0;i<t.length;i++){let s=t.feature(i).toGeoJSON(f.WIDTH,0),o=s.geometry.coordinates[0],r=s.geometry.coordinates[1];if(!this.isTreeVisible(o,r))continue;let a="needleleaved"===s.properties.leafType?"needleleaved":"broadleaved",l=s.properties.minHeight??0;e.get(a).push({key:eO(this.getTreeLatLng(o,r)),positionX:o,positionY:r,height:s.properties.height??n()+l,minHeight:l})}let o=this.vectorTile.layers.tree_row,{lat:r}=B.Z.metersToLatLng(this.position),a=B.Z.getMercatorScaleFactor(r);if(o)for(let t=0;t<o.length;t++){let i=o.feature(t).toGeoJSON(f.WIDTH,0),s=i.geometry.coordinates,r=(0,tV.Z)({positions:s,interval:10*a,randomness:0}),l="needleleaved"===i.properties.leafType?"needleleaved":"broadleaved",d=i.properties.minHeight??0,h=i.properties.height??n()+d;for(let t of r)this.isTreeVisible(t[0],t[1])&&e.get(l).push({key:eO(this.getTreeLatLng(t[0],t[1])),positionX:t[0],positionY:t[1],height:h,minHeight:d})}let l=this.vectorTile.layers.forest;if(l)for(let t=0;t<l.length;t++){let i=l.feature(t).toGeoJSON(f.WIDTH,0),n="Polygon"===i.geometry.type?[i.geometry.coordinates]:i.geometry.coordinates,o="needleleaved"===i.properties.leafType?"needleleaved":"broadleaved";for(let t of n)for(let n of(0,tB.Z)({polygon:t,resolution:Math.round(f.WIDTH/(14*a)),tileSize:f.WIDTH,seed:i.properties.osmId??999}))this.isTreeVisible(n[0],n[1])&&e.get(o).push({key:eO(this.getTreeLatLng(n[0],n[1])),positionX:n[0],positionY:n[1],height:s(),minHeight:0})}this.treeChunks=[];for(let e=0;e<2;e++)for(let e=0;e<2;e++){let e=new Map;e.set("broadleaved",[]),e.set("needleleaved",[]),this.treeChunks.push(e)}for(let[t,i]of e.entries())for(let e of i){let i=Math.floor((e.positionX+f.WIDTH/2)/f.WIDTH*2),s=Math.floor((e.positionY+f.WIDTH/2)/f.WIDTH*2);i=S.MathUtils.clamp(i,0,1),s=S.MathUtils.clamp(s,0,1);let n={x:this.position.x+e.positionX,y:this.position.y+e.positionY},o=this.mapView.pickElevationAtXY(n,f.ZOOM_LEVEL);e.minHeight+=o/a,e.height*=a,e.minHeight*=a;let r=2*s+i;this.treeChunks[r].get(t).push(e),this.layer.treeIdToTile.set(e.key,this)}}processBuildingFeatures(){if(this.buildingFeaturesMap=new Map,!this.vectorTile.layers[this.config.layerName])return;let e=new Map,t=new Map;for(let i=0;i<this.buildingFeatures.length;i++){let s=this.buildingFeatures[i],n=s.properties.globalId;if(s.properties.outlineOsmType){let t=e.get(n);t||(t=[],e.set(n,t)),t.push(s)}else t.set(n,s);this.buildingFeaturesMap.set(n,s),this.localIdGlobalIdMap.set(i,n)}let i=this.layer.buildingVisualSettings.getState().floorHeight,s=this.layer.defaultBuildingHeight;for(let[n,o]of e.entries()){let e=t.get(n),r=[...o];e&&r.push(e);let a=0;for(let e of r)a=Math.max(a,tH(e,i,s));for(let e of r)e.properties.displayHeight=a}}static isPointWithinAnyRegionArea(e){for(let t of eg.activeTiles3DAreas)if(t.isPointWithinArea(e))return!0;return!1}isPointWithinRegionAreaWithTrees(e){for(let e of[[{x:8002,y:6167},{x:8047,y:6195}],[{x:8258,y:5605},{x:8340,y:5656}]])if(this.index.x>=e[0].x&&this.index.x<=e[1].x&&this.index.y>=e[0].y&&this.index.y<=e[1].y)return!0;for(let t=0;t<eg.activeTiles3DAreas.length;t++)if(eg.activeTiles3DSettings[t].disableOSMTrees&&eg.activeTiles3DAreas[t].isPointWithinArea(e))return!0;return!1}static tryFixGeoJSONFeature(e){let t=e.geometry.coordinates;if("LineString"!==e.geometry.type)return;let i=t[0],s=t[t.length-1];i[0]===s[0]&&i[1]===s[1]&&(e.geometry={type:"Polygon",coordinates:[e.geometry.coordinates]})}getLocalFeatureCenterXY(e){let t=e.bbox(),i=[t[0]+(t[2]-t[0])/2,t[1]+(t[3]-t[1])/2];i[0]=S.MathUtils.clamp(i[0],1e-4,e.extent-1e-4),i[1]=S.MathUtils.clamp(i[1],1e-4,e.extent-1e-4);let s=f.WIDTH/e.extent;return{x:this.position.x-f.WIDTH/2+i[0]*s,y:this.position.y+f.WIDTH/2-i[1]*s}}getLocalFeatureCenterElevation(e){let t=this.mapView.pickElevationAtXY(e,f.ZOOM_LEVEL),{lat:i}=B.Z.metersToLatLng(e);return t/B.Z.getMercatorScaleFactor(i)}isIntersectsTile(e){let t=e.bbox();return t[0]<=e.extent&&t[2]>=0&&t[1]<=e.extent&&t[3]>=0}createBuildingsMesh(e){let t=new S.BufferGeometry;if(t.setAttribute("position",new S.Float32BufferAttribute(e.vertices,3)),t.setAttribute("normal",new S.Float32BufferAttribute(e.normals,3)),t.setAttribute("uv",new S.Float32BufferAttribute(e.uvs,2)),t.setAttribute("_batchid",new S.Float32BufferAttribute(e.ids,1)),t.setIndex(new S.Uint32BufferAttribute(e.indices,1)),this.buildingsMesh)this.buildingsMesh.geometry.dispose(),this.buildingsMesh.geometry=t;else{let e=f.Material;this.buildingsMesh=new S.Mesh(t,e),this.buildingsMesh.layers.enable(D.sv),this.buildingsMesh.layers.enable(D.OB),this.buildingsMesh.receiveShadow=!0,this.buildingsMesh.castShadow=!0,this.buildingsMesh.name=f.name,this.buildingsMesh.userData.studioType="osm",this.buildingsMesh.userData.tile=this,this.group.add(this.buildingsMesh)}this.buildingsMesh.userData.batchMap=new tP.Z(e.ids,e.indices)}updateLOD(e,t){if(!this.treeChunkMeshes.length)return;let i=new S.Object3D;this.group.add(i);let s=new S.Vector3;for(let n of(i.getWorldPosition(s),this.group.remove(i),this.treeChunkMeshes))for(let i of n.values()){let n=s.clone(),o=i.boundingBox.getCenter(new S.Vector3);n.x+=o.x,n.y+=o.y,n.z=o.z,i.visible=e.distanceTo(n)<t}}raycastMaxHeightAt(e,t){let{x:i,y:s}=B.Z.latLngToMeters({lat:t,lng:e}),n=new S.Raycaster(new S.Vector3(i,s,1e4),new S.Vector3(0,0,-1)),o=-1/0,r=this.mapView.pickElevationAt(i,s,f.ZOOM_LEVEL);r>o&&(o=r);let a=n.intersectObject(this.group);if(a.length>0){let e=1e4-a[0].distance;e>o&&(o=e)}return o}getBatchIdFromVertexIndex(e){let t=this.buildingsMesh;if(!t)throw Error("No mesh found");return t.geometry.getAttribute("_batchid").array[e]}extractBatch(e,t){let i=this.buildingsMesh,s=i.userData.batchMap,n=tA(i,s,e);return new S.Mesh(n,t)}getBuildingGeoJSON(e){let t=this.localIdGlobalIdMap.get(e);return this.buildingFeaturesMap.get(t)}getBatchIdByBuildingId(e){return this.localIdGlobalIdMap.getKey(e)}updateTreeVisibility(){this.treeGroup.visible=this.layer.showTrees,this.layer.onSceneUpdated()}}f=tz,tz.ZOOM_LEVEL=14,tz.WIDTH=B.Z.getTileSizeInMeters(f.ZOOM_LEVEL),tk.VectorTileFeature.prototype.toGeoJSON=function(e,t){let i=this.loadGeometry(),s=tk.VectorTileFeature.types[this.type],n=e/this.extent;function o(t){for(let i=0;i<t.length;i++){let s=t[i];t[i]=[s.x*n-e/2,-(s.y*n-e/2)]}}switch(this.type){case 1:{let e=[];for(let t=0;t<i.length;t++)e[t]=i[t][0];o(i=e);break}case 2:for(let e=0;e<i.length;e++)o(i[e]);break;case 3:i=function(e){let t,i,s=e.length;if(s<=1)return[e];let n=[];for(let o=0;o<s;o++){let s=function(e){let t,i,s=0;for(let n=0,o=e.length,r=o-1;n<o;r=n++)t=e[n],s+=((i=e[r]).x-t.x)*(t.y+i.y);return s}(e[o]);0!==s&&(void 0===i&&(i=s<0),i===s<0?(t&&n.push(t),t=[e[o]]):t.push(e[o]))}return t&&n.push(t),n}(i);for(let e=0;e<i.length;e++)for(let t=0;t<i[e].length;t++)o(i[e][t])}1===i.length?i=i[0]:s="Multi"+s;let r={type:"Feature",geometry:{type:s,coordinates:i},properties:this.properties,id:""};return r.properties.elevation=t,"id"in this&&(r.id=this.id),r};class tW extends tc{constructor({parent:e,visualQualitySettings:t,config:i,camera:s,controls:n,loadingStateManager:o,buildingVisualSettings:r,prepareMaterial:a,defaultBuildingHeight:l,showTrees:d,onSceneUpdated:h}){super({parent:e,camera:s,visualQualitySettings:t}),this.buildingIdToTiles=new Map,this.treeIdToTile=new Map,this.controls=n,this.buildingVisualSettings=r,this.defaultBuildingHeight=l,this.showTrees=d,this.onSceneUpdated=h,r.emitter.on("update",()=>{this.createBuildingMaterials(),this.refreshTiles()}),this.prepareMaterial=a,this.createBuildingMaterials(),this.createTreeMaterial(),this.config=i,this.loadingStateManager=o,this.visualQualitySettings.subscribe("BUILDING_TILE_MAX_DISTANCE",e=>{this.maxDistance=e},!0),this.eventEmitter.on("tileLoadingFinished",e=>{for(let t of e.buildingFeaturesMap.keys()){let i=this.buildingIdToTiles.get(t);i||(i=new Set,this.buildingIdToTiles.set(t,i)),i.add(e)}}),this.eventEmitter.on("tileRemoved",e=>{for(let t of e.buildingFeaturesMap.keys()){let i=this.buildingIdToTiles.get(t);i&&(i.delete(e),0===i.size&&this.buildingIdToTiles.delete(t))}})}setDefaultBuildingHeight(e){this.defaultBuildingHeight=e,this.refreshTiles()}setUserData(e,t){this.userBuildings=e,this.userTrees=t}finalize(){let e=this.getDependency(th);e.eventEmitter.on("tileAdded",e=>{e.index.zoom===tz.ZOOM_LEVEL&&this.addTile(e.index)}),e.eventEmitter.on("tileRemoved",e=>{e.index.zoom===tz.ZOOM_LEVEL&&this.removeTile(e.index)});let t=new Set;this.eventEmitter.on("tileLoadingStarted",e=>{t.add(e),this.loadingStateManager.set(m.BUILDING_TILES,!0)}),this.eventEmitter.on("tileLoadingFinished",e=>{t.delete(e),0===t.size&&this.loadingStateManager.set(m.BUILDING_TILES,!1)})}initTile(e){return new tz(e,this,this.config,this.parent)}createBuildingMaterials(){let e=this.buildingVisualSettings.getState(),t=e.floorIndication?e.lineColor:e.color;tz.Material?tz.Material.updateColors(e.color,t):(tz.Material=new tL.Um(e.color,t),this.prepareMaterial(tz.Material))}createTreeMaterial(){tz.TreeMaterial=new S.MeshPhongMaterial({vertexColors:!0,color:0xffffff,toneMapped:!0,shininess:10}),this.prepareMaterial(tz.TreeMaterial)}refreshTiles(e=!1){for(let t of this.tiles.values())t.refresh(e),t.load().then(()=>{this.getTile(t.index)||t.state===eC.e.DISPOSED||t.dispose(),this.onSceneUpdated()})}raycastMaxHeightAtMapLocation(e){let t=eV.W.fromMapLocation(e);return this.getTile(t).raycastMaxHeightAt(e.lng,e.lat)}getTilesByBuildingId(e){return this.buildingIdToTiles.get(e)}getTileByTreeId(e){return this.treeIdToTile.get(e)}toggleTrees(e){for(let t of(this.showTrees=e,this.tiles.values()))t.updateTreeVisibility()}update(){if(!this.enabled)return;this.loadingEnabled=this.getDependency(th).isTerrainVisible,this.parent.visible=this.loadingEnabled,super.update();let e=this.visualQualitySettings.get("OSM_TREE_TILE_MAX_DISTANCE");for(let t of this.tiles.values())t.updateLOD(this.controls.target,e)}enable(){super.enable(),this.parent.visible=!0}disable(){super.disable(),this.parent.visible=!1,this.loadingEnabled=!1}}var tX=i(86717),tY=i(21029);let t$=S.MathUtils.degToRad(-89),tQ=S.MathUtils.degToRad(89);class tq{constructor(e,t){this.enabled=!1,this.isPointerDown=!1,this.isJoystickDown=!1,this.joystickDirection=new S.Vector2,this.pitch=0,this.yaw=0,this.moveFast=!1,this.forwardPressed=!1,this.leftPressed=!1,this.backwardPressed=!1,this.rightPressed=!1,this.upPressed=!1,this.downPressed=!1,this.camera=e,this.cursorManager=t,window.addEventListener("keydown",e=>this.keyDown(e),!1),window.addEventListener("keyup",e=>this.keyUp(e),!1),window.addEventListener("blur",()=>this.resetKeys(),!1)}enable(e,t,i){this.canvas=e,this.joystickContainer=t,this.joystickPad=i,this.enabled=!0;let s=this.camera.getWorldDirection(new S.Vector3);this.pitch=Math.asin(s.z),this.yaw=Math.atan2(s.x,s.y),this.camera.rotation.order="ZXY",this.updateCameraDirection(),this.removeEventListeners&&this.removeEventListeners();let n=e=>this.canvasPointerDown(e),o=e=>this.canvasPointerUp(e),r=e=>this.canvasPointerMove(e),a=e=>this.joystickPointerDown(e),l=e=>this.joystickPointerUp(e),d=e=>this.joystickPointerMove(e);e.addEventListener("pointerdown",n),e.addEventListener("pointerup",o),e.addEventListener("pointermove",r),i.addEventListener("pointerdown",a),i.addEventListener("pointerup",l),i.addEventListener("pointermove",d),this.removeEventListeners=()=>{e.removeEventListener("pointerdown",n),e.removeEventListener("pointerup",o),e.removeEventListener("pointermove",r),i.removeEventListener("pointerdown",a),i.removeEventListener("pointerup",l),i.removeEventListener("pointermove",d)}}disable(){this.enabled=!1,this.isPointerDown=!1,this.resetJoystick(),this.camera.rotation.order=S.Euler.DEFAULT_ORDER,this.forwardPressed=!1,this.leftPressed=!1,this.backwardPressed=!1,this.rightPressed=!1,this.upPressed=!1,this.downPressed=!1,this.moveFast=!1}keyDown(e){switch(e.code){case"KeyW":case"ArrowUp":this.forwardPressed=!0;break;case"KeyA":case"ArrowLeft":this.leftPressed=!0;break;case"KeyS":case"ArrowDown":this.backwardPressed=!0;break;case"KeyD":case"ArrowRight":this.rightPressed=!0;break;case"KeyV":this.upPressed=!0;break;case"KeyC":this.downPressed=!0;break;case"ShiftLeft":this.moveFast=!0}}keyUp(e){switch(e.code){case"KeyW":case"ArrowUp":this.forwardPressed=!1;break;case"KeyA":case"ArrowLeft":this.leftPressed=!1;break;case"KeyS":case"ArrowDown":this.backwardPressed=!1;break;case"KeyD":case"ArrowRight":this.rightPressed=!1;break;case"KeyV":this.upPressed=!1;break;case"KeyC":this.downPressed=!1;break;case"ShiftLeft":this.moveFast=!1}}resetKeys(){this.forwardPressed=!1,this.leftPressed=!1,this.backwardPressed=!1,this.rightPressed=!1,this.upPressed=!1,this.downPressed=!1,this.moveFast=!1}canvasPointerDown(e){this.enabled&&(this.isPointerDown=!0)}canvasPointerUp(e){this.enabled&&(this.isPointerDown=!1)}canvasPointerMove(e){if(this.isPointerDown&&this.enabled)this.pitch+=-(.002*e.movementY*1),this.yaw-=-(.002*e.movementX*1),this.clampPitch(),this.updateCameraDirection()}joystickPointerDown(e){this.enabled&&(this.isJoystickDown=!0)}joystickPointerUp(e){this.enabled&&this.resetJoystick()}joystickPointerMove(e){if(!this.isJoystickDown||!this.enabled)return;let t=this.joystickContainer.getBoundingClientRect(),i=t.left+t.width/2,s=t.top+t.height/2,n=new S.Vector2(e.clientX-i,e.clientY-s),o=t.width/2,r=Math.min(n.length(),o),a=n.normalize().multiplyScalar(r);this.joystickDirection.copy(a).divideScalar(o),this.joystickPad.style.transform=`translate(${a.x}px, ${a.y}px)`}resetJoystick(){this.isJoystickDown=!1,this.joystickDirection.set(0,0),this.joystickPad.style.transform="translate(0px, 0px)"}clampPitch(){this.pitch=S.MathUtils.clamp(this.pitch,t$,tQ)}updateCameraDirection(){this.camera.rotation.z=-this.yaw,this.camera.rotation.x=this.pitch+Math.PI/2,this.camera.rotation.y=0}moveForward(e){let t=this.camera.getWorldDirection(new S.Vector3);this.camera.position.add(t.multiplyScalar(e))}moveRight(e){let t=new S.Vector3;t.crossVectors(this.camera.up,this.camera.getWorldDirection(new S.Vector3)),this.camera.position.add(t.normalize().multiplyScalar(-e))}moveUp(e){this.camera.position.z+=e}update(e){if(!this.enabled)return void this.cursorManager.setFirstPersonState(!1,!1);this.cursorManager.setFirstPersonState(!0,this.isPointerDown);let t=new S.Vector3,i=new S.Vector3;t.y=Number(this.forwardPressed)-Number(this.backwardPressed),t.x=Number(this.rightPressed)-Number(this.leftPressed),t.z=Number(this.upPressed)-Number(this.downPressed),t.normalize();let s=!1;if(0!==t.length()){let n=this.moveFast?425:8.5;t.multiplyScalar(n*e),i.sub(t),this.moveRight(-i.x),this.moveForward(-i.y),this.moveUp(-i.z),s=!0}this.isJoystickDown&&(this.moveForward(-(25.5*this.joystickDirection.y)*e),this.moveRight(25.5*this.joystickDirection.x*e),s=!0),s&&this.onChange&&this.onChange()}}let tK=new S.Raycaster,tJ=new S.Vector3,t1=new S.Vector3,t0=new S.Quaternion,t2={X:new S.Vector3(1,0,0),Y:new S.Vector3(0,1,0),Z:new S.Vector3(0,0,1)},t5={type:"change"},t3={type:"mouseDown"},t4={type:"mouseUp",mode:null},t8={type:"objectChange"};class t9 extends S.Object3D{constructor(e,t){super(),void 0===t&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),t=document),this.isTransformControls=!0,this.visible=!1,this.domElement=t,this.domElement.style.touchAction="none";let i=new iv;this._gizmo=i,this.add(i);let s=new iy;function n(e,t,n){let o=n;Object.defineProperty(e,t,{get:function(){return void 0!==o?o:n},set:function(n){o!==n&&(o=n,s[t]=n,i[t]=n,e.dispatchEvent({type:t+"-changed",value:n}),e.dispatchEvent(t5))}}),e[t]=n,s[t]=n,i[t]=n}this._plane=s,this.add(s),n(this,"camera",e),n(this,"object",void 0),n(this,"enabled",!0),n(this,"axis",null),n(this,"mode","translate"),n(this,"translationSnap",null),n(this,"rotationSnap",null),n(this,"scaleSnap",null),n(this,"space","world"),n(this,"size",1),n(this,"dragging",!1),n(this,"showX",!0),n(this,"showY",!0),n(this,"showZ",!0);let o=new S.Vector3,r=new S.Vector3,a=new S.Quaternion,l=new S.Quaternion,d=new S.Vector3,h=new S.Quaternion,c=new S.Vector3,u=new S.Vector3,p=new S.Vector3,m=new S.Vector3;n(this,"worldPosition",o),n(this,"worldPositionStart",r),n(this,"worldQuaternion",a),n(this,"worldQuaternionStart",l),n(this,"cameraPosition",d),n(this,"cameraQuaternion",h),n(this,"pointStart",c),n(this,"pointEnd",u),n(this,"rotationAxis",p),n(this,"rotationAngle",0),n(this,"eye",m),this._offset=new S.Vector3,this._startNorm=new S.Vector3,this._endNorm=new S.Vector3,this._cameraScale=new S.Vector3,this._parentPosition=new S.Vector3,this._parentQuaternion=new S.Quaternion,this._parentQuaternionInv=new S.Quaternion,this._parentScale=new S.Vector3,this._worldScaleStart=new S.Vector3,this._worldQuaternionInv=new S.Quaternion,this._worldScale=new S.Vector3,this._positionStart=new S.Vector3,this._quaternionStart=new S.Quaternion,this._scaleStart=new S.Vector3,this._getPointer=t7.bind(this),this._onPointerDown=ie.bind(this),this._onPointerHover=t6.bind(this),this._onPointerMove=it.bind(this),this._onPointerUp=ii.bind(this),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp)}updateMatrixWorld(){void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent||this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).invert(),this._worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.camera.isOrthographicCamera?this.camera.getWorldDirection(this.eye).negate():this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld(this)}pointerHover(e){if(void 0===this.object||!0===this.dragging)return;tK.setFromCamera(e,this.camera);let t=is(this._gizmo.picker[this.mode],tK);t?this.axis=t.object.name:this.axis=null}pointerDown(e){if(void 0!==this.object&&!0!==this.dragging&&0===e.button&&null!==this.axis){tK.setFromCamera(e,this.camera);let t=is(this._plane,tK,!0);t&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)),this.dragging=!0,t3.mode=this.mode,this.dispatchEvent(t3)}}pointerMove(e){let t=this.axis,i=this.mode,s=this.object,n=this.space;if("scale"===i?n="local":("E"===t||"XYZE"===t||"XYZ"===t)&&(n="world"),void 0===s||null===t||!1===this.dragging||-1!==e.button)return;tK.setFromCamera(e,this.camera);let o=is(this._plane,tK,!0);if(o){if(this.pointEnd.copy(o.point).sub(this.worldPositionStart),"translate"===i)this._offset.copy(this.pointEnd).sub(this.pointStart),"local"===n&&"XYZ"!==t&&this._offset.applyQuaternion(this._worldQuaternionInv),-1===t.indexOf("X")&&(this._offset.x=0),-1===t.indexOf("Y")&&(this._offset.y=0),-1===t.indexOf("Z")&&(this._offset.z=0),"local"===n&&"XYZ"!==t?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),s.position.copy(this._offset).add(this._positionStart),this.translationSnap&&("local"===n&&(s.position.applyQuaternion(t0.copy(this._quaternionStart).invert()),-1!==t.search("X")&&(s.position.x=Math.round(s.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(s.position.y=Math.round(s.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(s.position.z=Math.round(s.position.z/this.translationSnap)*this.translationSnap),s.position.applyQuaternion(this._quaternionStart)),"world"===n&&(s.parent&&s.position.add(tJ.setFromMatrixPosition(s.parent.matrixWorld)),-1!==t.search("X")&&(s.position.x=Math.round(s.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(s.position.y=Math.round(s.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(s.position.z=Math.round(s.position.z/this.translationSnap)*this.translationSnap),s.parent&&s.position.sub(tJ.setFromMatrixPosition(s.parent.matrixWorld))));else if("scale"===i){if(-1!==t.search("XYZ")){let e=this.pointEnd.length()/this.pointStart.length();0>this.pointEnd.dot(this.pointStart)&&(e*=-1),t1.set(e,e,e)}else tJ.copy(this.pointStart),t1.copy(this.pointEnd),tJ.applyQuaternion(this._worldQuaternionInv),t1.applyQuaternion(this._worldQuaternionInv),t1.divide(tJ),-1===t.search("X")&&(t1.x=1),-1===t.search("Y")&&(t1.y=1),-1===t.search("Z")&&(t1.z=1);-1!==t.search("X")&&(s.scale.x=this._scaleStart.x*t1.x),-1!==t.search("Y")&&(s.scale.y=this._scaleStart.y*t1.y),-1!==t.search("Z")&&(s.scale.z=this._scaleStart.z*t1.z),this.scaleSnap&&(-1!==t.search("X")&&(s.scale.x=Math.round(s.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Y")&&(s.scale.y=Math.round(s.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Z")&&(s.scale.z=Math.round(s.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===i){this._offset.copy(this.pointEnd).sub(this.pointStart);let e=20/this.worldPosition.distanceTo(tJ.setFromMatrixPosition(this.camera.matrixWorld));"E"===t?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=0>this._endNorm.cross(this._startNorm).dot(this.eye)?1:-1):"XYZE"===t?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(tJ.copy(this.rotationAxis).cross(this.eye))*e):("X"===t||"Y"===t||"Z"===t)&&(this.rotationAxis.copy(t2[t]),tJ.copy(t2[t]),"local"===n&&tJ.applyQuaternion(this.worldQuaternion),this.rotationAngle=this._offset.dot(tJ.cross(this.eye).normalize())*e),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),"local"===n&&"E"!==t&&"XYZE"!==t?(s.quaternion.copy(this._quaternionStart),s.quaternion.multiply(t0.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),s.quaternion.copy(t0.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),s.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(t5),this.dispatchEvent(t8)}}pointerUp(e){0===e.button&&(this.dragging&&null!==this.axis&&(t4.mode=this.mode,this.dispatchEvent(t4)),this.dragging=!1,this.axis=null)}dispose(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse(function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()})}attach(e){return this.object=e,this.visible=!0,this}detach(){return this.object=void 0,this.visible=!1,this.axis=null,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(t5),this.dispatchEvent(t8),this.pointStart.copy(this.pointEnd))}getRaycaster(){return tK}getMode(){return this.mode}setMode(e){this.mode=e}setTranslationSnap(e){this.translationSnap=e}setRotationSnap(e){this.rotationSnap=e}setScaleSnap(e){this.scaleSnap=e}setSize(e){this.size=e}setSpace(e){this.space=e}}function t7(e){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:e.button};{let t=this.domElement.getBoundingClientRect();return{x:(e.clientX-t.left)/t.width*2-1,y:-(e.clientY-t.top)/t.height*2+1,button:e.button}}}function t6(e){if(this.enabled)switch(e.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(e))}}function ie(e){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(e.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(e)),this._plane.updateMatrixWorld(),this.pointerDown(this._getPointer(e)))}function it(e){this.enabled&&this.pointerMove(this._getPointer(e))}function ii(e){this.enabled&&(this.domElement.releasePointerCapture(e.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(e)))}function is(e,t,i){let s=t.intersectObject(e,!0);for(let e=0;e<s.length;e++)if(s[e].object.visible||i)return s[e];return!1}let io=new S.Euler,ir=new S.Vector3(0,1,0),ia=new S.Vector3(0,0,0),il=new S.Matrix4,id=new S.Quaternion,ih=new S.Quaternion,ic=new S.Vector3,iu=new S.Matrix4,ip=new S.Vector3(1,0,0),im=new S.Vector3(0,1,0),ig=new S.Vector3(0,0,1),ix=new S.Vector3,iw=new S.Vector3,ib=new S.Vector3;class iv extends S.Object3D{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";let e=new S.MeshBasicMaterial({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),t=new S.LineBasicMaterial({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),i=e.clone();i.opacity=.15;let s=t.clone();s.opacity=.5;let n=e.clone();n.color.setHex(0xffffeb);let o=e.clone();o.color.setHex(0xffffeb);let r=e.clone();r.color.setHex(0xffffeb);let a=e.clone();a.color.setHex(0xffffeb),a.opacity=.5;let l=e.clone();l.color.setHex(0xffffeb),l.opacity=.5;let d=e.clone();d.color.setHex(0xffffeb),d.opacity=.5;let h=e.clone();h.opacity=.25;let c=e.clone();c.color.setHex(0xffffeb),c.opacity=.25,e.clone().color.setHex(0xf4f43e);let u=e.clone();u.color.setHex(7895160);let p=new S.ConeGeometry(.035,.1,12);p.translate(0,.05,0);let m=new S.BoxGeometry(.08,.08,.08);m.translate(0,.04,0);let g=new S.BufferGeometry;g.setAttribute("position",new S.Float32BufferAttribute([0,0,0,1,0,0],3));let f=new S.CylinderGeometry(.0075,.0075,.5,3);function x(e,t){let i=new S.TorusGeometry(e,.0075,3,64,t*Math.PI*2);return i.rotateY(Math.PI/2),i.rotateX(Math.PI/2),i}f.translate(0,.25,0);let w={X:[[new S.Mesh(p,n),[.5,0,0],[0,0,-Math.PI/2]],[new S.Mesh(f,n),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new S.Mesh(p,o),[0,.5,0]],[new S.Mesh(f,o)]],Z:[[new S.Mesh(p,r),[0,0,.5],[Math.PI/2,0,0]],[new S.Mesh(f,r),null,[Math.PI/2,0,0]]],XY:[[new S.Mesh(new S.BoxGeometry(.15,.15,.01),d.clone()),[.15,.15,0]]]},b={X:[[new S.Mesh(new S.CylinderGeometry(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new S.Mesh(new S.CylinderGeometry(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new S.Mesh(new S.CylinderGeometry(.2,0,.6,4),i),[0,.3,0]],[new S.Mesh(new S.CylinderGeometry(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new S.Mesh(new S.CylinderGeometry(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new S.Mesh(new S.CylinderGeometry(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new S.Mesh(new S.BoxGeometry(.2,.2,.01),i),[.15,.15,0]]]},v={START:[[new S.Mesh(new S.OctahedronGeometry(.01,2),s),null,null,null,"helper"]],END:[[new S.Mesh(new S.OctahedronGeometry(.01,2),s),null,null,null,"helper"]],DELTA:[[new S.Line(function(){let e=new S.BufferGeometry;return e.setAttribute("position",new S.Float32BufferAttribute([0,0,0,1,1,1],3)),e}(),s),null,null,null,"helper"]],X:[[new S.Line(g,s.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new S.Line(g,s.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new S.Line(g,s.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},y={XYZE:[[new S.Mesh(x(.5,1),u),null,[0,Math.PI/2,0]]],X:[[new S.Mesh(x(.5,.5),n)]],Y:[[new S.Mesh(x(.5,.5),o),null,[0,0,-Math.PI/2]]],Z:[[new S.Mesh(x(.5,.5),r),null,[0,Math.PI/2,0]],[new S.Mesh(p,r),[0,.5,0],[0,0,Math.PI/2]],[new S.Mesh(p,r),[0,-.5,0],[0,0,Math.PI/2]]],E:[[new S.Mesh(x(.75,1),c),null,[0,Math.PI/2,0]]]},C={AXIS:[[new S.Line(g,s.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},M={XYZE:[[new S.Mesh(new S.SphereGeometry(.25,10,8),i)]],X:[[new S.Mesh(new S.TorusGeometry(.5,.1,4,24),i),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new S.Mesh(new S.TorusGeometry(.5,.1,4,24),i),[0,0,0],[Math.PI/2,0,0]]],Z:[[new S.Mesh(new S.TorusGeometry(.5,.1,4,24),i),[0,0,0],[0,0,-Math.PI/2]]],E:[[new S.Mesh(new S.TorusGeometry(.75,.1,2,24),i)]]},L={X:[[new S.Mesh(m,n),[.5,0,0],[0,0,-Math.PI/2]],[new S.Mesh(f,n),[0,0,0],[0,0,-Math.PI/2]],[new S.Mesh(m,n),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new S.Mesh(m,o),[0,.5,0]],[new S.Mesh(f,o)],[new S.Mesh(m,o),[0,-.5,0],[0,0,Math.PI]]],Z:[[new S.Mesh(m,r),[0,0,.5],[Math.PI/2,0,0]],[new S.Mesh(f,r),[0,0,0],[Math.PI/2,0,0]],[new S.Mesh(m,r),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new S.Mesh(new S.BoxGeometry(.15,.15,.01),d),[.15,.15,0]]],YZ:[[new S.Mesh(new S.BoxGeometry(.15,.15,.01),a),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new S.Mesh(new S.BoxGeometry(.15,.15,.01),l),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new S.Mesh(new S.BoxGeometry(.1,.1,.1),h.clone())]]},T={X:[[new S.Mesh(m,n),[.5,0,0],[0,0,-Math.PI/2]],[new S.Mesh(f,n),[0,0,0],[0,0,-Math.PI/2]],[new S.Mesh(m,n),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new S.Mesh(m,o),[0,.5,0]],[new S.Mesh(f,o)],[new S.Mesh(m,o),[0,-.5,0],[0,0,Math.PI]]],Z:[[new S.Mesh(p,r),[0,0,.5],[Math.PI/2,0,0]],[new S.Mesh(f,r),[0,0,0],[Math.PI/2,0,0]],[new S.Mesh(p,r),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new S.Mesh(new S.BoxGeometry(.15,.15,.01),d),[.15,.15,0]]],YZ:[[new S.Mesh(new S.BoxGeometry(.15,.15,.01),a),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new S.Mesh(new S.BoxGeometry(.15,.15,.01),l),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new S.Mesh(new S.BoxGeometry(.1,.1,.1),h.clone())]]},j={X:[[new S.Mesh(new S.CylinderGeometry(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new S.Mesh(new S.CylinderGeometry(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new S.Mesh(new S.CylinderGeometry(.2,0,.6,4),i),[0,.3,0]],[new S.Mesh(new S.CylinderGeometry(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new S.Mesh(new S.CylinderGeometry(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new S.Mesh(new S.CylinderGeometry(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new S.Mesh(new S.BoxGeometry(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new S.Mesh(new S.BoxGeometry(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new S.Mesh(new S.BoxGeometry(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new S.Mesh(new S.BoxGeometry(.2,.2,.2),i),[0,0,0]]]},P={X:[[new S.Line(g,s.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new S.Line(g,s.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new S.Line(g,s.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function E(e){let t=new S.Object3D;for(let i in e)for(let s=e[i].length;s--;){let n=e[i][s][0].clone(),o=e[i][s][1],r=e[i][s][2],a=e[i][s][3],l=e[i][s][4];n.name=i,n.tag=l,o&&n.position.set(o[0],o[1],o[2]),r&&n.rotation.set(r[0],r[1],r[2]),a&&n.scale.set(a[0],a[1],a[2]),n.updateMatrix();let d=n.geometry.clone();d.applyMatrix4(n.matrix),n.geometry=d,n.renderOrder=1/0,n.position.set(0,0,0),n.rotation.set(0,0,0),n.scale.set(1,1,1),t.add(n)}return t}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=E(w)),this.add(this.gizmo.rotate=E(y)),this.add(this.gizmo.scale=E(L)),this.add(this.gizmo.scaleZ=E(T)),this.add(this.picker.translate=E(b)),this.add(this.picker.rotate=E(M)),this.add(this.picker.scale=E(j)),this.add(this.helper.translate=E(v)),this.add(this.helper.rotate=E(C)),this.add(this.helper.scale=E(P)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(e){let t="local"===("scale"===this.mode?"local":this.space)?this.worldQuaternion:ih,i=!this.showX&&!this.showY&&this.showZ;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode&&!i,this.gizmo.scaleZ.visible="scale"===this.mode&&i,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;let s="scale"===this.mode&&i?this.gizmo.scaleZ:this.gizmo[this.mode],n=[];n=(n=(n=n.concat(this.picker[this.mode].children)).concat(s.children)).concat(this.helper[this.mode].children);for(let e=0;e<n.length;e++){let i,s=n[e];if(s.visible=!0,s.rotation.set(0,0,0),s.position.copy(this.worldPosition),i=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),s.scale.set(1,1,1).multiplyScalar(i*this.size/4),"helper"===s.tag){s.visible=!1,"AXIS"===s.name?(s.visible=!!this.axis,"X"===this.axis&&(t0.setFromEuler(io.set(0,0,0)),s.quaternion.copy(t).multiply(t0),Math.abs(ir.copy(ip).applyQuaternion(t).dot(this.eye))>.9&&(s.visible=!1)),"Y"===this.axis&&(t0.setFromEuler(io.set(0,0,Math.PI/2)),s.quaternion.copy(t).multiply(t0),Math.abs(ir.copy(im).applyQuaternion(t).dot(this.eye))>.9&&(s.visible=!1)),"Z"===this.axis&&(t0.setFromEuler(io.set(0,Math.PI/2,0)),s.quaternion.copy(t).multiply(t0),Math.abs(ir.copy(ig).applyQuaternion(t).dot(this.eye))>.9&&(s.visible=!1)),"XYZE"===this.axis&&(t0.setFromEuler(io.set(0,Math.PI/2,0)),ir.copy(this.rotationAxis),s.quaternion.setFromRotationMatrix(il.lookAt(ia,ir,im)),s.quaternion.multiply(t0),s.visible=this.dragging),"E"===this.axis&&(s.visible=!1)):"START"===s.name?(s.position.copy(this.worldPositionStart),s.visible=this.dragging):"END"===s.name?(s.position.copy(this.worldPosition),s.visible=this.dragging):"DELTA"===s.name?(s.position.copy(this.worldPositionStart),s.quaternion.copy(this.worldQuaternionStart),tJ.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),tJ.applyQuaternion(this.worldQuaternionStart.clone().invert()),s.scale.copy(tJ),s.visible=this.dragging):(s.quaternion.copy(t),this.dragging?s.position.copy(this.worldPositionStart):s.position.copy(this.worldPosition),this.axis&&(s.visible=-1!==this.axis.search(s.name)));continue}s.quaternion.copy(t),"translate"===this.mode||"scale"===this.mode?("X"===s.name&&Math.abs(ir.copy(ip).applyQuaternion(t).dot(this.eye))>.99&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"Y"===s.name&&Math.abs(ir.copy(im).applyQuaternion(t).dot(this.eye))>.99&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"Z"===s.name&&Math.abs(ir.copy(ig).applyQuaternion(t).dot(this.eye))>.99&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"XY"===s.name&&.2>Math.abs(ir.copy(ig).applyQuaternion(t).dot(this.eye))&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"YZ"===s.name&&.2>Math.abs(ir.copy(ip).applyQuaternion(t).dot(this.eye))&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"XZ"===s.name&&.2>Math.abs(ir.copy(im).applyQuaternion(t).dot(this.eye))&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1)):"rotate"===this.mode&&(id.copy(t),ir.copy(this.eye).applyQuaternion(t0.copy(t).invert()),-1!==s.name.search("E")&&s.quaternion.setFromRotationMatrix(il.lookAt(this.eye,ia,im)),"X"===s.name&&(t0.setFromAxisAngle(ip,Math.atan2(-ir.y,ir.z)),t0.multiplyQuaternions(id,t0),s.quaternion.copy(t0)),"Y"===s.name&&(t0.setFromAxisAngle(im,Math.atan2(ir.x,ir.z)),t0.multiplyQuaternions(id,t0),s.quaternion.copy(t0)),"Z"===s.name&&(t0.setFromAxisAngle(ig,Math.atan2(ir.y,ir.x)),t0.multiplyQuaternions(id,t0),s.quaternion.copy(t0))),s.visible=s.visible&&(-1===s.name.indexOf("X")||this.showX),s.visible=s.visible&&(-1===s.name.indexOf("Y")||this.showY),s.visible=s.visible&&(-1===s.name.indexOf("Z")||this.showZ),s.visible=s.visible&&(-1===s.name.indexOf("E")||this.showX&&this.showY&&this.showZ),s.material._color=s.material._color||s.material.color.clone(),s.material._opacity=s.material._opacity||s.material.opacity,s.material.color.copy(s.material._color),s.material.opacity=s.material._opacity,this.enabled&&this.axis&&(s.name===this.axis?(s.material.color.setHex(0xf4f43e),s.material.opacity=1):this.axis.split("").some(function(e){return s.name===e})&&(s.material.color.setHex(0xf4f43e),s.material.opacity=1))}super.updateMatrixWorld(e)}}class iy extends S.Mesh{constructor(){super(new S.PlaneGeometry(1e5,1e5,2,2),new S.MeshBasicMaterial({visible:!1,wireframe:!0,side:S.DoubleSide,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(e){let t=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(t="local"),ix.copy(ip).applyQuaternion("local"===t?this.worldQuaternion:ih),iw.copy(im).applyQuaternion("local"===t?this.worldQuaternion:ih),ib.copy(ig).applyQuaternion("local"===t?this.worldQuaternion:ih),ir.copy(iw),this.mode){case"translate":case"scale":switch(this.axis){case"X":ir.copy(this.eye).cross(ix),ic.copy(ix).cross(ir);break;case"Y":ir.copy(this.eye).cross(iw),ic.copy(iw).cross(ir);break;case"Z":ir.copy(this.eye).cross(ib),ic.copy(ib).cross(ir);break;case"XY":ic.copy(ib);break;case"YZ":ic.copy(ix);break;case"XZ":ir.copy(ib),ic.copy(iw);break;case"XYZ":case"E":ic.set(0,0,0)}break;default:ic.set(0,0,0)}0===ic.length()?this.quaternion.copy(this.cameraQuaternion):(iu.lookAt(tJ.set(0,0,0),ic,ir),this.quaternion.setFromRotationMatrix(iu)),super.updateMatrixWorld(e)}}var iC=i(50390),iM=i(16559),iS=i(94242);let iL=new S.TextureLoader().load("img/studio_shape_point.png");iL.anisotropy=16,iL.generateMipmaps=!0;class iT extends S.Object3D{constructor(e){super(),this.points=[],this.pointMeshes=[],this.cursorPoint=null,this.cursorPointMesh=null,this.line=null,this.container=new S.Object3D,this.enabled=!1,this.isClosed=!1,this.drawBufferSize=new S.Vector2,this.camera=e,this.add(this.container),iT.lineMaterial.onBeforeCompile=e=>{e.uniforms.resolution.value=this.drawBufferSize,e.vertexShader=e.vertexShader.replace("offset /= resolution.y;","")}}enable(){this.container.visible=!0,this.enabled=!0}disable(){this.container.visible=!1,this.enabled=!1}init(){this.line&&(this.line.geometry.dispose(),this.line=null),this.container.clear(),this.points.length=0,this.pointMeshes.length=0,this.cursorPoint=null,this.cursorPointMesh=null}setCursor(e){this.cursorPointMesh||(this.cursorPointMesh=new S.Sprite(iT.pointMaterial),this.container.add(this.cursorPointMesh),this.preparePointSprite(this.cursorPointMesh,!0)),this.cursorPointMesh.position.copy(e),this.cursorPoint=e,this.updateLine()}addPoint(e){this.points.push(e);let t=this.points[0].z,i=new S.Sprite(iT.pointMaterial);i.position.set(e.x,e.y,t),this.container.add(i),this.pointMeshes.push(i),this.preparePointSprite(i,!1),this.updateLine()}preparePointSprite(e,t){e.renderOrder=10;let i=new S.Vector2;e.onBeforeRender=(s,n,o)=>{s.getSize(i),i.y/=s.getPixelRatio();let r=e.getWorldPosition(new S.Vector3),a=r.clone().project(o);a.y+=(t?16:32)/i.y;let l=a.clone().unproject(o),d=r.distanceTo(l);e.scale.set(d,d,d),e.updateMatrix()}}updateLine(){if(0===this.points.length){this.line&&(this.line.visible=!1);return}this.line||(this.line=new iS.w(new iM.L,iT.lineMaterial),this.line.renderOrder=5,this.container.add(this.line),this.line.onBeforeRender=e=>{e.getSize(this.drawBufferSize)});let e=[],t=this.points[0];for(let i=0;i<this.points.length;i++){let s=this.points[i],n=this.points[i+1]??this.cursorPoint;n&&e.push(s.x-t.x,s.y-t.y,0,n.x-t.x,n.y-t.y,0)}this.line.position.copy(t),this.line.visible=!0,this.line.geometry.setPositions(e),this.line.geometry._maxInstanceCount=e.length/3-1}close(){this.points.length>2&&(this.addPoint(this.points[0].clone()),this.isClosed=!0)}getDistanceToFirstPoint(e,t,i){if(this.points.length<3)return 1/0;let s=new S.Vector2((e.x+1)/2*t.x,(1-(e.y+1)/2)*t.y),n=this.pointMeshes[0].getWorldPosition(new S.Vector3).project(i);n.x=(n.x+1)/2,n.y=1-(n.y+1)/2;let o=new S.Vector2(n.x*t.x,n.y*t.y);return s.distanceTo(o)}convertPointToScreenPosition(e,t){let i=this.container.localToWorld(e.clone()).project(this.camera);return i.x=(i.x+1)/2,i.y=1-(i.y+1)/2,new S.Vector2(i.x*t.x,i.y*t.y)}}iT.pointMaterial=new S.SpriteMaterial({map:iL,depthTest:!1,depthWrite:!1,transparent:!0,sizeAttenuation:!1,toneMapped:!1}),iT.lineMaterial=new iC.Y({color:new S.Color("#33404D").toJSON(),linewidth:.005,vertexColors:!1,transparent:!0,depthTest:!1,depthWrite:!1,toneMapped:!1});var ij=i(88050);class iP{static prepareMaterials(e){e(this.treeMaterial),e(this.commonMaterial)}static getPrefabModel(e){switch(e){case"cuboid":return iP.getCuboid();case"cylinder":return iP.getCylinder();case"broadleaved":return iP.getBroadleavedTree();case"needleleaved":return iP.getNeedleleavedTree();case"bush":return iP.getBush();case"gabled":return iP.getGabledRoof();case"pyramid":return iP.getPyramidRoof();case"hipped":return iP.getHippedRoof();default:return new S.Object3D}}static getCuboid(){return this.cuboidGeometry||(this.cuboidGeometry=new S.BoxGeometry(1,1,1)),new S.Mesh(this.cuboidGeometry,this.commonMaterial)}static getCylinder(){return this.cylinderGeometry||(this.cylinderGeometry=new S.CylinderGeometry(.5,.5,1,24,1),this.cylinderGeometry.rotateX(Math.PI/2)),new S.Mesh(this.cylinderGeometry,this.commonMaterial)}static getBroadleavedTree(){return this.broadleavedTreeGeometry||(this.broadleavedTreeGeometry=tU.Z.createGeometry(!1,!1,!1)),new S.Mesh(this.broadleavedTreeGeometry,this.treeMaterial)}static getNeedleleavedTree(){return this.needleleavedTreeGeometry||(this.needleleavedTreeGeometry=tU.Z.createGeometry(!0,!1,!1)),new S.Mesh(this.needleleavedTreeGeometry,this.treeMaterial)}static getBush(){if(!this.bushGeometry){let e=new S.SphereGeometry(.5,28,20);e.scale(.85,.85,1),e.translate(0,0,.45);let t=new ij.WT(3*e.attributes.position.count,3,!0),i=new S.Color(5605427);for(let s=0;s<e.attributes.position.count;s++)t.setXYZ(s,i.r,i.g,i.b);e.setAttribute("color",t),this.bushGeometry=e}return new S.Mesh(this.bushGeometry,this.treeMaterial)}static getGabledRoof(){if(!this.gabledRoofGeometry){let e=new S.BufferGeometry;e.setAttribute("position",new ij.a$([-.75,-.5,0,.75,-.5,0,.75,.5,0,-.75,.5,0,-.75,0,.5,.75,0,.5],3)),e.setIndex([0,2,1,0,3,2,3,0,4,1,2,5,0,1,4,1,5,4,2,3,5,3,4,5]);let t=e.toNonIndexed();t.computeVertexNormals(),this.gabledRoofGeometry=t}return new S.Mesh(this.gabledRoofGeometry,this.commonMaterial)}static getPyramidRoof(){if(!this.pyramidRoofGeometry){let e=new S.BufferGeometry;e.setAttribute("position",new ij.a$([-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0,0,0,.5],3)),e.setIndex([0,2,1,0,3,2,0,1,4,1,2,4,2,3,4,3,0,4]);let t=e.toNonIndexed();t.computeVertexNormals(),this.pyramidRoofGeometry=t}return new S.Mesh(this.pyramidRoofGeometry,this.commonMaterial)}static getHippedRoof(){if(!this.hippedRoofGeometry){let e=new S.BufferGeometry;e.setAttribute("position",new ij.a$([-.75,-.5,0,.75,-.5,0,.75,.5,0,-.75,.5,0,-.25,0,.5,.25,0,.5],3)),e.setIndex([0,2,1,0,3,2,3,0,4,1,2,5,0,1,4,1,5,4,2,3,5,3,4,5]);let t=e.toNonIndexed();t.computeVertexNormals(),this.hippedRoofGeometry=t}return new S.Mesh(this.hippedRoofGeometry,this.commonMaterial)}}iP.treeMaterial=new S.MeshPhongMaterial({vertexColors:!0,color:0xffffff,toneMapped:!0}),iP.commonMaterial=new S.MeshPhongMaterial({color:0xffffff,toneMapped:!0});var iE=i(56972);let iA=[{iconURL:"./img/prefabs/custom.png",category:"volumes",name:"userShape",controls:"full",isHomeOnly:!0},{iconURL:"./img/prefabs/cuboid.png",category:"volumes",name:"cuboid",controls:"full",initialHeight:10,initialOffsetFromGround:5},{iconURL:"./img/prefabs/cylinder.png",category:"volumes",name:"cylinder",controls:"full",initialHeight:10,initialOffsetFromGround:5},{iconURL:"./img/prefabs/a-frame.png",category:"roofs",name:"gabled",controls:"full",dimensions:new S.Vector3(1.5,1,.5),initialHeight:5,isHomeOnly:!0},{iconURL:"./img/prefabs/hip.png",category:"roofs",name:"hipped",controls:"full",dimensions:new S.Vector3(1.5,1,.5),initialHeight:5,isHomeOnly:!0},{iconURL:"./img/prefabs/pyramid-hip.png",category:"roofs",name:"pyramid",controls:"full",dimensions:new S.Vector3(1,1,.5),initialHeight:5,isHomeOnly:!0},{iconURL:"./img/prefabs/broadleaved.png",category:"trees",name:"broadleaved",controls:"tree",dimensions:new S.Vector3(.595,.595,1),initialHeight:6.5},{iconURL:"./img/prefabs/needleleaved.png",category:"trees",name:"needleleaved",controls:"tree",dimensions:new S.Vector3(.5,.5,1),initialHeight:6.5,isHomeOnly:!0},{iconURL:"./img/prefabs/bush.png",category:"trees",name:"bush",controls:"tree",dimensions:new S.Vector3(.85,.85,.95),initialHeight:2,isHomeOnly:!0}],iD={};for(let e of iA)iD[e.category]||(iD[e.category]=[]),iD[e.category].push(e);class iO{constructor(e,t,i,s,n){this.shapes=new Map,this.shapeParent=new S.Object3D,this.terrainLayer=e,this.prepareMaterial=i,this.buildingVisualSettings=s,this.onSceneChange=n,this.createShapeMaterial(),s.emitter.on("update",()=>{this.createShapeMaterial()}),t.add(this.shapeParent)}createShapeMaterial(){let e=this.buildingVisualSettings.getState();iO.ShapeMaterial?iO.ShapeMaterial.updateColors(e.color,e.color):(iO.ShapeMaterial=new tL.Um(e.color,e.color),this.prepareMaterial(iO.ShapeMaterial))}setUserShapes(e){let t=new Set(e.map(e=>e.id));for(let t of e){let e=this.shapes.get(t.id);if(e)e.data=t;else{let i=new S.BufferGeometry,s=new S.Mesh(i,iO.ShapeMaterial);this.shapeParent.add(s),s.receiveShadow=!0,s.castShadow=!0,s.layers.enable(D.sv),s.layers.enable(D.OB),s.name=t.id,e={object3D:s,data:t},this.shapes.set(t.id,e)}let i=e.object3D;i.userData={type:x.Shape,userShape:t},this.getBuildingModelDataResult(t).then(e=>{this.setGeometryAttributes(i.geometry,e)}),this.positionShape(i,t),this.onSceneChange()}for(let[e,i]of this.shapes)t.has(e)||(this.shapeParent.remove(i.object3D),this.shapes.delete(e),this.onSceneChange())}getMesh(e){let t=this.shapes.get(e.id);if(t)return t.object3D}async getBuildingModelDataResult(e){let t={type:"Feature",geometry:{type:"Polygon",coordinates:[e.polygon.map(e=>[e[0],e[1]])]},properties:{height:e.height,elevation:0},id:1};return await q.y.convert({geoJSON:[t],latitude:e.lat,floorHeight:1,excludeBottom:!1,meltIntoGround:!1})}setGeometryAttributes(e,t){e.setAttribute("position",new S.Float32BufferAttribute(t.vertices,3)),e.setAttribute("normal",new S.Float32BufferAttribute(t.normals,3)),e.setAttribute("uv",new S.Float32BufferAttribute(t.uvs,2)),e.setIndex(new S.Uint32BufferAttribute(t.indices,1)),e.getAttribute("position").needsUpdate=!0,e.getAttribute("normal").needsUpdate=!0,e.getAttribute("uv").needsUpdate=!0,e.getIndex().needsUpdate=!0,e.computeBoundingSphere(),e.computeBoundingBox()}positionShape(e,t){let{lat:i,lng:s}=t,{x:n,y:o}=B.Z.latLngToMeters({lat:i,lng:s}),r=this.terrainLayer.mapView.pickElevationAtXY({x:n,y:o});if(void 0===r)return;let a=B.Z.getMercatorScaleFactor(i);e.position.set(n,o,r+t.offsetInMeters*a),t.scale||(t.scale=1),e.scale.set(1,1,t.scale*a),e.rotation.z=t.rotationZ*(Math.PI/180),e.rotation.y=t.rotationY*(Math.PI/180),e.rotation.x=t.rotationX*(Math.PI/180),e.visible=!t.hidden,e.userData.userShape=t}updateElevation(){for(let e of this.shapes.values())this.positionShape(e.object3D,e.data)}}var ik=i(4150),iI=i(20270);class iN extends ik.w2{constructor(e,t,i){super(),this.accumRenderTargets=[],this.activeAccumRenderTargetIndex=0,this.emitter=new tR.Z,this.upAccum=0,this.avgDirAccum=0,this.avgLightDirection=new S.Vector3(1,1,1),this.surfaceNormal=new S.Vector3(0,0,1),this.surfaceNormalAccum=0,this.floatTextureBlendingSupported=!!e.getContext().getExtension("EXT_float_blend");let s={fragmentShader:"precision highp sampler2D;\n\n#define SHADOWMAP_TYPE_PCF_SOFT\n\nvarying vec2 vUv;\n\nuniform sampler2D depthMap;\nuniform sampler2D normalMap;\nuniform sampler2D shadowMap;\n#if PING_PONG == 1\nuniform sampler2D accumMap;\n#endif\nuniform mat4 projectionMatrixInv;\nuniform mat4 cameraViewMatrix;\nuniform mat4 shadowViewMatrixInverse;\nuniform mat4 shadowProjectionMatrix;\nuniform float accumFactor;\nuniform float accumFactorDirect;\nuniform float normalBiasScale;\nuniform vec3 normalDirection;\nuniform vec2 shadowMapResolution;\nuniform vec3 lightDirection;\n\nvec3 getWorldPos(float depth, vec2 coord) {\n    vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, depth * 2.0 - 1.0, 1.0);\n    vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;\n    viewSpacePosition /= viewSpacePosition.w;\n    vec4 worldSpacePosition = cameraViewMatrix * vec4(viewSpacePosition.xyz, 1.0);\n    return worldSpacePosition.xyz;\n}\n\nfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n    return step( compare, texture2D( depths, uv ).r );\n}\n\nfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n    float shadow = 1.0;\n    shadowCoord.xy /= shadowCoord.w;\n    shadowCoord.xy = shadowCoord.xy * 0.5 + 0.5;\n    //shadowCoord.z += shadowBias;\n    bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\n    shadowCoord.z = shadowCoord.z * 0.5 + 0.5 - shadowBias;\n\n    if ( inFrustum || all(lessThanEqual(shadowMapSize, vec2(1, 1))) ) {\n        #if defined( SHADOWMAP_TYPE_PCF )\n        vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n        float dx0 = - texelSize.x * shadowRadius;\n        float dy0 = - texelSize.y * shadowRadius;\n        float dx1 = + texelSize.x * shadowRadius;\n        float dy1 = + texelSize.y * shadowRadius;\n        float dx2 = dx0 / 2.0;\n        float dy2 = dy0 / 2.0;\n        float dx3 = dx1 / 2.0;\n        float dy3 = dy1 / 2.0;\n        shadow = (\n        texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n        texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n        texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n        texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n        texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n        texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n        texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n        texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n        texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n        texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n        texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n        texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n        texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n        texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n        texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n        texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n        texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n        ) * ( 1.0 / 17.0 );\n        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n        vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n        float dx = texelSize.x;\n        float dy = texelSize.y;\n        vec2 uv = shadowCoord.xy;\n        vec2 f = fract( uv * shadowMapSize + 0.5 );\n        uv -= f * texelSize;\n        shadow = (\n        texture2DCompare( shadowMap, uv, shadowCoord.z ) +\n        texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n        texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n        texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n        mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ), f.x ) +\n        mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ), f.x ) +\n        mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ), f.y ) +\n        mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ), f.y ) +\n        mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ), f.x ), mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ), f.x ), f.y )\n        ) * ( 1.0 / 9.0 );\n        #elif defined( SHADOWMAP_TYPE_VSM )\n        shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n        #else\n        shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n        #endif\n    }\n    return shadow;\n}\n\nvoid main() {\n    float screenDepth = texture2D(depthMap, vUv).r;\n    vec3 worldPos = getWorldPos(screenDepth, vUv);\n\n    vec3 cameraSpaceNormal = texture(normalMap, vUv).rgb * 2. - 1.;\n    vec3 worldSpaceNormal = vec3(cameraViewMatrix * vec4(cameraSpaceNormal, 0.0));\n\n    #if IS_PLANAR == 1\n    worldPos += normalDirection * normalBiasScale;\n    #else\n    worldPos += worldSpaceNormal * normalBiasScale;\n    #endif\n\n    vec4 lightSpacePos = shadowProjectionMatrix * shadowViewMatrixInverse * vec4(worldPos, 1.0);\n\n    float shadow = getShadow(shadowMap, shadowMapResolution, 0., 1., lightSpacePos);\n\n    #if IS_PLANAR == 1\n    vec3 normal = normalDirection;\n    #else\n    vec3 normal = worldSpaceNormal;\n    #endif\n\n    float dotToLight = dot(-lightDirection, normal);\n\n    float factorToAddPhysical = shadow * max(0., dotToLight) * accumFactor;\n    float factorToAddTemporal = shadow * step(0., dotToLight) * accumFactorDirect;\n\n    #if PING_PONG == 1\n    vec2 accum = texture2D(accumMap, vUv).rg;\n    gl_FragColor = vec4(accum.r + factorToAddPhysical, accum.g + factorToAddTemporal, 0, 1);\n    #else\n    gl_FragColor = vec4(factorToAddPhysical, factorToAddTemporal, 0, 1);\n    #endif\n}\n",vertexShader:"varying vec2 vUv;\n\nvoid main() {\n    vUv = position.xy * 0.5 + 0.5;\n    gl_Position = vec4(position, 1);\n}\n",uniforms:{depthMap:{value:null},normalMap:{value:null},shadowMap:{value:null},accumMap:{value:null},projectionMatrixInv:{value:t.projectionMatrixInverse},cameraViewMatrix:{value:t.matrixWorld},shadowProjectionMatrix:{value:null},shadowViewMatrixInverse:{value:null},accumFactor:{value:1},accumFactorDirect:{value:1},normalBiasScale:{value:1},normalDirection:{value:new S.Vector3(0,0,1)},shadowMapResolution:{value:new S.Vector2(1,1)},lightDirection:{value:new S.Vector3}},defines:{PING_PONG:+!this.floatTextureBlendingSupported,IS_PLANAR:+!!i}};this.floatTextureBlendingSupported&&(s.blending=iI.WMw),this.accumMaterial=new S.ShaderMaterial(s),this.fullscreenMaterial=this.accumMaterial;let n=this.floatTextureBlendingSupported?1:2;for(let e=0;e<n;e++)this.accumRenderTargets.push(new S.WebGLRenderTarget(1,1,{minFilter:S.NearestFilter,magFilter:S.NearestFilter,format:S.RGFormat,type:S.FloatType,depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!1}))}getFinalRenderTarget(){return this.accumRenderTargets[this.activeAccumRenderTargetIndex]}resetAccumulation(e){for(let t of this.accumRenderTargets)e.setRenderTarget(t),e.clear(!0,!0);this.upAccum=0,this.avgDirAccum=0,this.surfaceNormalAccum=0,this.emitter.emit("update")}getNextRenderTarget(){return this.activeAccumRenderTargetIndex=(this.activeAccumRenderTargetIndex+1)%this.accumRenderTargets.length,this.accumRenderTargets[this.activeAccumRenderTargetIndex]}setNormalDirection(e){this.accumMaterial.uniforms.normalDirection.value.copy(e)}addToAccumulation(e,t,i,s,n,o,r,a=0){this.floatTextureBlendingSupported||(this.accumMaterial.uniforms.accumMap.value=this.getFinalRenderTarget().texture),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),t.updateMatrix(),t.updateMatrixWorld(),e.setRenderTarget(this.getNextRenderTarget());let l=t.getWorldDirection(new S.Vector3);this.accumMaterial.uniforms.depthMap.value=i,this.accumMaterial.uniforms.normalMap.value=s,this.accumMaterial.uniforms.shadowMap.value=n,this.accumMaterial.uniforms.shadowProjectionMatrix.value=t.projectionMatrix,this.accumMaterial.uniforms.shadowViewMatrixInverse.value=t.matrixWorldInverse,this.accumMaterial.uniforms.accumFactor.value=o,this.accumMaterial.uniforms.accumFactorDirect.value=r,this.accumMaterial.uniforms.normalBiasScale.value=.001*a,this.accumMaterial.uniforms.shadowMapResolution.value.set(n.image.width,n.image.height),this.accumMaterial.uniforms.lightDirection.value.copy(l),e.render(this.scene,this.camera),this.emitter.emit("update"),this.upAccum+=Math.max(0,-l.dot(new S.Vector3(0,0,1)))*o,this.avgDirAccum+=Math.max(0,-l.dot(this.avgLightDirection))*o,this.surfaceNormalAccum+=Math.max(0,-l.dot(this.surfaceNormal))*o}setSize(e,t){for(let i of this.accumRenderTargets)i.setSize(e,t)}}class i_ extends ik.w2{constructor(){super(),this.material=new S.ShaderMaterial({fragmentShader:"precision highp sampler2D;\n\nvarying vec2 vUv;\n\nuniform sampler2D accumMap;\nuniform sampler2D shadowLUT;\nuniform float accumProgress;\n\nvoid main() {\n    float accumValue = texture2D(accumMap, vUv).r / accumProgress;\n    vec3 lutColor = texture2D(shadowLUT, vec2(accumValue, 0.5)).rgb;\n\n    gl_FragColor = vec4(lutColor, 1.0);\n}\n",vertexShader:"varying vec2 vUv;\n\nvoid main() {\n    vUv = position.xy * 0.5 + 0.5;\n    gl_Position = vec4(position, 1);\n}\n",uniforms:{accumMap:{value:null},shadowLUT:{value:null},accumProgress:{value:0}}}),this.fullscreenMaterial=this.material,this.renderTarget=new S.WebGLRenderTarget(1,1,{minFilter:S.NearestFilter,magFilter:S.LinearFilter,format:S.RGBAFormat,type:S.UnsignedByteType,depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!1})}setLUT(e){this.material.uniforms.shadowLUT.value=e}getTexture(){return this.renderTarget.texture}compute(e,t,i){e.setRenderTarget(this.renderTarget),this.material.uniforms.accumMap.value=t,this.material.uniforms.accumProgress.value=i,e.render(this.scene,this.camera)}setSize(e,t){this.renderTarget.setSize(e,t)}}var iR=i(13848);let iV=new S.MeshBasicMaterial({map:new S.TextureLoader().load("img/solar_panel.jpg"),depthTest:!0,depthWrite:!0,side:S.DoubleSide});iV.onBeforeCompile=e=>{e.fragmentShader=e.fragmentShader.replace("#include <map_fragment>",`
                #include <map_fragment>
                float outline = 0.0;
                // Calculate width based on screen derivatives
                float outlineWidthX = length(vec2(dFdx(vMapUv.x), dFdy(vMapUv.x))) * 4.;
                float outlineWidthY = length(vec2(dFdx(vMapUv.y), dFdy(vMapUv.y))) * 4.;
                if (gl_FrontFacing == false || vMapUv.x < outlineWidthX || vMapUv.x > 1. - outlineWidthX || vMapUv.y < outlineWidthY || vMapUv.y > 1. - outlineWidthY) {
                    outline = 1.0;
                }
                diffuseColor.rgb = mix(diffuseColor.rgb, vec3(0.0), outline);
                `)};let iB=new S.PlaneGeometry(1,1);class iU{constructor({renderer:e,defaultModeParent:t,analyticsModeParent:i,cameraParent:s,descriptor:n,terrainLayer:o}){this.totalWeight=0,this.power=0,this.visualizerNeedsUpdate=!1,this.rtWidth=1,this.rtHeight=1,this.renderer=e,this.defaultModeParent=t,this.analyticsModeParent=i,this.descriptor=n,this.terrainLayer=o,this.camera=new S.OrthographicCamera(-1,1,1,-1,-.001,.001),s.add(this.camera),this.accumPass=new iN(e,this.camera,!0),this.visualizerPass=new i_,this.textureReaderPixel=new iR.Z(e,4),this.accumPass.emitter.on("update",()=>{this.visualizerNeedsUpdate=!0}),this.initVisualizer(),this.updateCamera(),this.updateResolution()}initVisualizer(){let e=new S.MeshBasicMaterial({side:S.DoubleSide,map:this.visualizerPass.getTexture(),toneMapped:!1});this.visualizer=new S.Mesh(iB,e),this.visualizer.userData={id:this.descriptor.id,type:x.SolarPanel},this.visualizer.layers.enable(D.sv),e.onBeforeCompile=e=>{e.fragmentShader=e.fragmentShader.replace("#include <map_fragment>",`
                #include <map_fragment>

                float outlineWidthX = length(vec2(dFdx(vMapUv.x), dFdy(vMapUv.x))) * 4.;
                float outlineWidthY = length(vec2(dFdx(vMapUv.y), dFdy(vMapUv.y))) * 4.;

                if (gl_FrontFacing == false) {
                    diffuseColor.rgb = vec3(0);
                }

                if (vMapUv.x < outlineWidthX || vMapUv.x > 1. - outlineWidthX || vMapUv.y < outlineWidthY || vMapUv.y > 1. - outlineWidthY) {
                    diffuseColor.rgb = vec3(1);
                }
                `)},this.visualizerMaterial=e,this.defaultModeParent.add(this.visualizer),this.updateMeshTransformFromDescriptor()}setTotalWeight(e){this.totalWeight=e}setPower(e){this.power=e}updateMeshTransformFromDescriptor(){let e=this.getMercatorScale();this.visualizer.scale.set(this.descriptor.sizeX*e,this.descriptor.sizeY*e,1);let t=B.Z.latLngToMeters(this.descriptor),i=this.terrainLayer.mapView.pickElevationAt(t.x,t.y);this.visualizer.position.set(t.x,t.y,this.descriptor.offsetFromGround*e+i),this.visualizer.rotation.set(S.MathUtils.degToRad(this.descriptor.rotationX),S.MathUtils.degToRad(this.descriptor.rotationY),S.MathUtils.degToRad(this.descriptor.rotationZ)),this.visualizerNeedsUpdate=!0,this.updateCamera(),this.updateNormalDirection(),this.updateResolution()}setDescriptor(e){this.descriptor=e,this.updateMeshTransformFromDescriptor()}getMercatorScale(){return B.Z.getMercatorScaleFactor(this.descriptor.lat)}updateCamera(){let e=this.getMercatorScale();this.camera.left=-this.descriptor.sizeX/2*e,this.camera.right=this.descriptor.sizeX/2*e,this.camera.top=this.descriptor.sizeY/2*e,this.camera.bottom=-this.descriptor.sizeY/2*e,this.camera.updateProjectionMatrix(),this.camera.position.copy(this.visualizer.position),this.camera.rotation.set(this.visualizer.rotation.x,this.visualizer.rotation.y,this.visualizer.rotation.z),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.updateNormalDirection()}updateNormalDirection(){let e=new S.Vector3(0,0,1).applyEuler(this.camera.rotation);this.accumPass.setNormalDirection(e)}setLUT(e){this.visualizerPass.setLUT(e),this.visualizerNeedsUpdate=!0}async sampleShadowMapAsync(e,t){let i=this.accumPass.getFinalRenderTarget(),s=Math.floor(i.width*e),n=Math.floor(i.height*t);return(await this.textureReaderPixel.readColorAttachmentRect(i,"RED","FLOAT",s,n,1,1)).float32Array[0]}async getTotalValueAsync(){let e=this.accumPass.getFinalRenderTarget(),t=await this.textureReaderGlobal.readColorAttachmentRect(e,"RG","FLOAT",0,0,e.width,e.height),i=0;for(let e=0;e<t.float32Array.length;e+=2)i+=t.float32Array[e];return{total:i/36,average:i/(e.width*e.height)}}updateRenderMode(e){e?(this.analyticsModeParent.add(this.visualizer),this.visualizer.material=this.visualizerMaterial):(this.defaultModeParent.add(this.visualizer),this.visualizer.material=iV)}update(e){let t=this.getMercatorScale();this.visualizer.scale.set(this.descriptor.sizeX*t,this.descriptor.sizeY*t,1),this.visualizerNeedsUpdate&&(this.visualizerPass.compute(e,this.accumPass.getFinalRenderTarget().texture,this.accumPass.avgDirAccum),this.visualizerNeedsUpdate=!1)}updateResolution(){let e=this.rtWidth,t=this.rtHeight;this.rtWidth=Math.round(6*this.descriptor.sizeX),this.rtHeight=Math.round(6*this.descriptor.sizeY),this.rtWidth=S.MathUtils.clamp(this.rtWidth,1,2048),this.rtHeight=S.MathUtils.clamp(this.rtHeight,1,2048),(this.rtWidth!==e||this.rtHeight!==t)&&(this.accumPass.setSize(this.rtWidth,this.rtHeight),this.visualizerPass.setSize(this.rtWidth,this.rtHeight),this.textureReaderGlobal&&this.textureReaderGlobal.destroy(),this.textureReaderGlobal=new iR.Z(this.renderer,this.rtWidth*this.rtHeight*8))}async getInfo(){let e=await this.getTotalValueAsync(),t=this.accumPass.upAccum/this.totalWeight;return{total:e.total/this.totalWeight/t*this.power,average:e.average/this.totalWeight/t*this.power}}dispose(){this.accumPass.dispose(),this.visualizer&&(this.visualizer.geometry.dispose(),this.visualizer.parent?.remove(this.visualizer))}}(a=x||(x={}))[a.Model=0]="Model",a[a.Shape=1]="Shape",a[a.Prefab=2]="Prefab",a[a.SolarPanel=3]="SolarPanel";let iF=new S.MeshBasicMaterial({opacity:0,depthWrite:!1,colorWrite:!1});class iZ{constructor(e,t,i,s,n,o,r,a,l,d,h,c,u,p,m,g){this.selectedBuilding=null,this.selectedMesh=null,this.selectedMeshSource=null,this.selectedMeshSourceUnsubscribe=null,this.analyticsEnabled=!1,this.studioModeEnabled=!1,this.google3DTilesEnabled=!1,this.selectedTree=null,this.userBuildings=new Map,this.userTrees=new Map,this.userSolarPanels=new Map,this.isActive=!1,this.raycaster=new S.Raycaster,this.layers=new S.Layers,this.prefabGroup=new S.Object3D,this.userPrefabs=new Map,this.camera=e,this.outlineEffect=t,this.tile3DLayer=i,this.buildingLayer=s,this.treeLayer=n,this.terrainLayer=o,this.originGroup=r,this.overlayOriginGroup=a,this.onDrawingToggle=l,this.onSceneChange=d,this.onDrawingLabelChange=h,this.prepareMaterial=c,this.onTransformControlsVisibilityChange=u,this.buildingVisualSettings=p,this.renderer=m,this.analyticsPass=g,this.initializePrivateProperties()}initializePrivateProperties(){this.drawing=new iT(this.camera),this.originGroup.add(this.drawing),this.layers.disableAll(),this.layers.enable(D.sv),this.raycaster.layers=this.layers,this.originGroup.add(this.prefabGroup),this.shapeManager=new iO(this.terrainLayer,this.originGroup,this.prepareMaterial,this.buildingVisualSettings,()=>this.onSceneChange(!0))}setUserBuildings(e){let t=new Set;for(let e of this.userBuildings.keys()){let i=this.buildingLayer.getTilesByBuildingId(e);if(i)for(let e of i)t.add(e)}for(let[t,i]of(this.userBuildings.clear(),this.tile3DLayer.resetHiddenBuildings(),e))this.userBuildings.set(t,i),"3dtile"===i.type&&i.hidden&&this.tile3DLayer.hideBuilding(t),this.selectedBuilding&&this.selectedBuilding.buildingId===t&&i.hidden&&this.clearSelected();for(let e of this.userBuildings.keys()){let i=this.buildingLayer.getTilesByBuildingId(e);if(i)for(let e of i)t.add(e)}for(let e of t)e.createMesh().then(()=>{this.onSceneChange(!0)});this.onSceneChange(!0)}setUserTrees(e){let t=new Set,i=new Set;for(let e of this.userTrees.values()){let s=eO(e),n=this.buildingLayer.getTileByTreeId(s),o=this.treeLayer.getTileByTreeId(s);n&&t.add(n),o&&i.add(o)}for(let s of(this.userTrees.clear(),e)){let e=eO(s);this.userTrees.set(e,s);let n=this.buildingLayer.getTileByTreeId(e),o=this.treeLayer.getTileByTreeId(e);n&&t.add(n),o&&i.add(o),this.selectedTree&&eO(this.selectedTree)===e&&s.hidden&&this.clearSelected()}for(let e of t)e.createTreesMesh();for(let e of i)e.doLoad().then(()=>{this.onSceneChange(!0)});this.onSceneChange(!0)}setUserPrefabs(e){for(let t of e){if(this.userPrefabs.has(t.id)){this.userPrefabs.get(t.id).data=t;continue}let e=iP.getPrefabModel(t.type);e&&(this.userPrefabs.set(t.id,{data:t,model:e}),this.prefabGroup.add(e),e.userData={type:x.Prefab,id:t.id},e.layers.enable(D.sv),e.layers.enable(D.OB),e.castShadow=!0,e.receiveShadow=!0)}let t=new Set(e.map(e=>e.id));for(let[e,{model:i}]of this.userPrefabs.entries())t.has(e)||(i.parent.remove(i),this.userPrefabs.delete(e));for(let{data:e,model:t}of this.userPrefabs.values()){let i=B.Z.latLngToMeters(e),s=this.terrainLayer.mapView.pickElevationAt(i.x,i.y),n=B.Z.getMercatorScaleFactor(e.lat);t.position.set(i.x,i.y,s+e.offsetFromGround*n),t.rotation.set(S.MathUtils.degToRad(e.rotationX),S.MathUtils.degToRad(e.rotationY),S.MathUtils.degToRad(e.rotationZ)),this.setPrefabScale(e.type,t,{x:e.scaleX*n,y:e.scaleY*n,z:e.scaleZ*n}),t.visible=!e.hidden}this.onSceneChange(!0)}setUserShapes(e){this.shapeManager.setUserShapes(e)}setUserSolarPanels(e){for(let t of e){if(this.userSolarPanels.has(t.id)){this.userSolarPanels.get(t.id).setDescriptor(t);continue}let e=new iU({renderer:this.renderer,defaultModeParent:this.originGroup,analyticsModeParent:this.overlayOriginGroup,cameraParent:this.originGroup,descriptor:t,terrainLayer:this.terrainLayer});this.userSolarPanels.set(t.id,e)}let t=new Set(e.map(e=>e.id));for(let[e,i]of this.userSolarPanels.entries())t.has(e)||(i.dispose(),this.userSolarPanels.delete(e));this.analyticsPass&&this.analyticsPass.setTargetPlanes(Array.from(this.userSolarPanels.values()))}raycastTerrain(e,t){t.userData.isOrthographicCamera?(this.raycaster.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.raycaster.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld)):(this.raycaster.ray.origin.setFromMatrixPosition(t.matrixWorld),this.raycaster.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.raycaster.ray.origin).normalize()),this.raycaster.camera=t;let i=this.originGroup.worldToLocal(this.raycaster.ray.origin);return this.terrainLayer.mapView.raymarchElevation(i,this.raycaster.ray.direction,2e3,5,2)}emitDrawnShape(){let e=new S.Box3;for(let t of(e.makeEmpty(),this.drawing.points))e.expandByPoint(t);let t=e.getCenter(new S.Vector3),{lat:i,lng:s}=B.Z.metersToLatLng(t),n=[];for(let e of this.drawing.points){let i=e.x-t.x,s=e.y-t.y;n.push([i,s])}let o={id:(0,iE.Z)(),lat:i,lng:s,polygon:n,height:10,rotationX:0,rotationY:0,rotationZ:0,scale:1,offsetInMeters:0,hidden:!1};this.addCustomShape(o)}onMove(e,t){if(!this.isActive||!this.drawing.enabled)return;let i=this.raycastTerrain(e,t);if(!i)return;let s=new S.Vector2(window.innerWidth,window.innerHeight),n=16>this.drawing.getDistanceToFirstPoint(e,s,t)?this.drawing.points[0]:i;if(this.drawing.setCursor(n),0===this.drawing.points.length)this.onDrawingLabelChange({isVisible:!1});else{let e=this.drawing.points[this.drawing.points.length-1],t=this.drawing.convertPointToScreenPosition(e,s),i=this.drawing.convertPointToScreenPosition(n,s),o=t.distanceTo(i),r=e.distanceTo(n);this.onDrawingLabelChange({isVisible:r>0&&o>20,distance:r,position:t.lerp(i,.5)})}}tryHighlightInitialBuilding(e){this.originGroup.updateMatrix(),this.originGroup.updateMatrixWorld();let t=this.originGroup.localToWorld(new S.Vector3(e.x,e.y,0));return this.raycaster.ray.origin.set(t.x,t.y,1e4),this.raycaster.ray.direction.set(0,0,-1),this.raycast(this.originGroup,!0)}onClick(e,t,i,s){if(this.isActive){if(this.drawing.enabled){this.clearSelected();let i=this.raycastTerrain(e,t);if(!i)return;let s=new S.Vector2(window.innerWidth,window.innerHeight);16>this.drawing.getDistanceToFirstPoint(e,s,t)?(this.drawing.close(),this.drawing.isClosed?(this.emitDrawnShape(),this.setShapeDrawingMode(!1)):this.drawing.addPoint(i)):this.drawing.addPoint(i);return}this.raycaster.setFromCamera(e,t),this.raycast(this.isActive?i:s)||this.clearSelected()}}raycast(e,t=!1){for(let i of this.raycaster.intersectObjects(e.children)){let e=i.object;if(e.userData.type===x.SolarPanel)return this.clearSelected(),this.setSelectedSolarPanel(this.userSolarPanels.get(e.userData.id).descriptor),!0;if(!this.isActive&&!t){this.clearSelected();break}if(!e.parent.visible)continue;if(e instanceof tG&&!t){let t=i.instanceId,s=e.getTreeByInstanceId(t),{lat:n,lng:o}=function(e){let[t,i]=e.split("_").map(parseFloat);return{lat:t,lng:i}}(s.key);if(this.selectedTree?.lat===n&&this.selectedTree?.lng===o)return this.clearSelected(),!1;let r=e.getInstanceOutlineMesh(t);return this.setSelected({selection:r,id:s.key,type:"tree",tree:this.userTrees.get(s.key)??{lat:n,lng:o,hidden:!1}}),!0}if(e instanceof ek&&!t){let t=i.instanceId,s=e.parent.getTreeByInstanceId(t),n=eO(s),o=e.parent.getInstanceOutlineMesh(t);if(this.selectedTree?.lat===s.lat&&this.selectedTree?.lng===s.lng)return this.clearSelected(),!1;return this.setSelected({selection:o,id:n,type:"tree",tree:this.userTrees.get(n)??{lat:s.lat,lng:s.lng,hidden:!1}}),!0}if(e.userData.type===x.Shape&&!t){if(!e.visible)continue;return this.setSelected({selection:e,id:e.userData.id,type:"shape"}),!0}if(e.userData.type===x.Prefab&&!t){if(!e.visible)continue;return this.setSelected({selection:e,id:e.userData.id,type:"shape"}),this.setSelectedPrefab(this.userPrefabs.get(e.userData.id).data),!0}if(e.userData.type===x.SolarPanel){if(!e.visible)continue;if(this.selectedMesh===e)return this.clearSelected(),!1;this.setSelected({selection:e,id:e.userData.id,type:"shape"}),this.setSelectedSolarPanel(this.userSolarPanels.get(e.userData.id).descriptor);return}let s=e.userData.studioType;if("3dtile"===s){let t=this.tile3DLayer.getBatchIdFromVertexIndex(e,i.face.a);if(-1===t)continue;let s=this.tile3DLayer.getBuildingName(e,t);if(this.selectedMeshSource===e&&this.selectedBuilding?.buildingId===s)return this.clearSelected(),!1;let n=this.tile3DLayer.extractBatch(e,t,iF);return e.add(n),this.clearSelected(),this.setSelectedMeshSource(e),this.setSelected({selection:n,id:s,buildingType:"3dtile",type:"building"}),!0}if("osm"===s){let t=e.userData.tile,s=i.face,n=t.getBatchIdFromVertexIndex(s.a);if(this.selectedMeshSource===e&&this.selectedBuilding?.buildingId===t.localIdGlobalIdMap.get(n).toString())return this.clearSelected(),!1;return this.selectOSMBuilding(t,n),!0}if(this.getUserModelRoot(e)&&!t)return this.setSelected({selection:e,type:"model"}),!0}return!1}selectOSMBuilding(e,t){this.clearSelected();let i=()=>{let i=e.extractBatch(t,iF),s=e.getMesh();s.add(i),this.setSelectedMeshSource(s);let n=e.localIdGlobalIdMap.get(t),o=e.getBuildingGeoJSON(t);this.selectedMesh&&this.dehighlightMesh(this.selectedMesh),this.setSelected({selection:i,id:n.toString(),buildingType:"osm",type:"building",height:o.properties.calculatedHeight,lastUpdateDate:o.properties.updateTime,noClear:!0})};i(),e.eventEmitter.on("meshUpdated",i),this.selectedMeshSourceUnsubscribe=()=>{e.eventEmitter.off("meshUpdated",i)}}highlightMesh(e){e.traverse(e=>this.outlineEffect.selection.add(e)),setTimeout(()=>{this.onSceneChange(!1)},0)}dehighlightMesh(e){e.traverse(e=>this.outlineEffect.selection.delete(e)),this.onSceneChange(!1)}setSelected({selection:e,id:t,type:i,buildingType:s,height:n,noClear:o,tree:r,lastUpdateDate:a}){if(null===e)return void this.clearSelected();switch(!o&&this.selectedMesh&&this.clearSelected(),i){case"building":this.selectBuilding(e,t,s,n,a);return;case"shape":this.selectShape(e);return;case"model":this.getUserModelRoot(e)&&this.selectUserModel(e);return;case"tree":this.selectTree(e,r);return}this.clearSelected()}setSelectedPrefab(e){let t=this.userPrefabs.get(e.id);if(!t)return;let{model:i}=t;this.clearSelected(),this.selectedMesh=i,this.transformControls.attach(i),this.onTransformControlsVisibilityChange(!0),this.highlightMesh(i),this.selectedPrefabChanged(e)}setSelectedShape(e){let t=this.shapeManager.getMesh(e);t&&(this.clearSelected(),this.selectedMesh=t,this.transformControls.attach(t),this.highlightMesh(t),this.selectedShapeChanged(e))}setSelectedSolarPanel(e){let t=this.userSolarPanels.get(e.id);if(!t)return;this.clearSelected();let i=t.visualizer;this.selectedMesh=i,this.transformControls.attach(i),this.highlightMesh(i),this.selectedSolarPanelChanged(t.descriptor)}selectBuilding(e,t,i,s,n){e&&this.highlightMesh(e),this.selectedMesh=e;let o=this.userBuildings.get(t);if(!o){e.updateMatrixWorld();let r=e.geometry.boundingBox.getCenter(new S.Vector3).applyMatrix4(e.matrixWorld),a=this.originGroup.worldToLocal(r),l=B.Z.metersToLatLng(a);o={buildingId:t.toString(),type:i,height:s,hidden:!1,lat:l.lat,lng:l.lng,lastUpdateDate:n}}this.setSelectedBuilding(o)}selectShape(e){if(this.selectedMesh=e,this.selectedMesh){this.transformControls.attach(this.selectedMesh);let e=this.selectedMesh.userData.userShape;this.selectedShapeChanged&&this.selectedShapeChanged(e),this.highlightMesh(this.selectedMesh)}else this.clearSelected()}selectTree(e,t){this.selectedMesh=e,this.selectedTree=t,this.highlightMesh(e)}selectUserModel(e){if(this.selectedMesh=this.getUserModelRoot(e),this.selectedMesh){this.transformControls.attach(this.selectedMesh);let e=this.selectedMesh.userData.userModel;this.selectedModelChanged(e),this.highlightMesh(this.selectedMesh)}else this.clearSelected()}getUserModelRoot(e){if(e.userData.userModelRoot)return e;let t=e.parent;return t?this.getUserModelRoot(t):null}clearSelected(){this.transformControls.detach(),this.onTransformControlsVisibilityChange(!1),this.onSceneChange(!1),this.selectedMesh&&(this.dehighlightMesh(this.selectedMesh),this.selectedMeshSource&&(this.selectedMesh.parent&&this.selectedMesh.parent.remove(this.selectedMesh),this.selectedMesh.geometry.dispose(),this.setSelectedMeshSource(null)),this.selectedMesh=null,this.selectedTree=null,this.selectedModelChanged(null),this.setSelectedBuilding(null),this.selectedPrefabChanged(null),this.selectedShapeChanged(null))}setSelectedMeshSource(e){this.selectedMeshSource!==e&&(this.selectedMeshSource&&this.selectedMeshSourceUnsubscribe&&this.selectedMeshSourceUnsubscribe(),this.selectedMeshSource=e)}setStudioMode(e){this.studioModeEnabled=e,this.updateIsActive()}setAnalytics(e){this.analyticsEnabled=e,this.updateIsActive()}setMapMode(e){this.google3DTilesEnabled=e===D.M$.GOOGLE,this.updateIsActive()}updateIsActive(){this.isActive=this.studioModeEnabled&&!this.analyticsEnabled&&!this.google3DTilesEnabled,(!this.isActive||this.drawing.enabled||this.google3DTilesEnabled)&&this.clearSelected(),!this.isActive&&this.drawing.enabled&&this.setShapeDrawingMode(!1)}setTransformAxis(e){switch(e){case"translate":case"rotate":case"scale":this.transformControls.showX=!0,this.transformControls.showY=!0,this.transformControls.showZ=!0;break;case"xyRotate":case"zScale":this.transformControls.showX=!1,this.transformControls.showY=!1,this.transformControls.showZ=!0}}initTransformControls(e,t,i,s,n){this.transformControls=new t9(t,i),this.transformControls.setSpace("local"),this.setTransformAxis("translate");let o=0;this.transformControls.addEventListener("dragging-changed",e=>{s.enabled=!e.value,e.value&&(o=this.transformControls.object.position.z)}),this.transformControls.addEventListener("change",e=>{let t=e.target.object;t&&(t?.userData?.userModelRoot,t.userData.elevation=n(t.position.x,t.position.y),this.onSceneChange(!1))});let r=e=>{let t=e.userData;if(t.type===x.Model){t.elevation=n(e.position.x,e.position.y);let i=B.Z.getMercatorScaleFactor(t.userModel.lat);if(o!==e.position.z){o=e.position.z;let s=e.position.z-t.elevation;e.position.z=t.elevation+s,t.userModel.offsetInMeters=s/i}else e.position.z=t.elevation+t.userModel.offsetInMeters*i;let s=this.updateSelectedModelAttributes(t.userModel);this.selectedModelChanged(s)}else if(t.type===x.Shape){t.elevation=n(e.position.x,e.position.y);let i=B.Z.getMercatorScaleFactor(t.userShape.lat);if(o!==e.position.z){o=e.position.z;let s=e.position.z-t.elevation;e.position.z=t.elevation+s,t.userShape.offsetInMeters=s/i}else e.position.z=t.elevation+t.userShape.offsetInMeters*i;let s=this.updateSelectedShapeAttributes(t.userShape);this.selectedShapeChanged(s)}else if(t.type===x.Prefab){t.elevation=n(e.position.x,e.position.y);let i=this.userPrefabs.get(t.id).data,s=B.Z.getMercatorScaleFactor(i.lat);if(o!==e.position.z){o=e.position.z;let i=e.position.z-t.elevation;e.position.z=t.elevation+i,t.offsetInMeters=i/s}else e.position.z=t.elevation+i.offsetFromGround*s;let r=this.updateSelectedPrefabAttributes(i);this.selectedPrefabChanged(r)}else if(t.type===x.SolarPanel){let e=this.userSolarPanels.get(t.id),i=this.updateSelectedSolarPanelAttributes(e.descriptor);this.selectedSolarPanelChanged(i)}};this.transformControls.addEventListener("objectChange",e=>{r(e.target.object)}),e.add(this.transformControls)}simplifyTransformControlsMode(e){switch(e){case"xyRotate":return"rotate";case"zScale":return"scale";default:return e}}setTransformControlsMode(e,t){this.transformControls.setMode(this.simplifyTransformControlsMode(e)),this.transformControls.setSpace(t),this.setTransformAxis(e)}setSelectedModelAttributes(e,t){e&&this.selectedMesh&&t(this.selectedMesh,e)}onSelectedModelChanged(e){this.selectedModelChanged=e}onSelectedShapeChanged(e){this.selectedShapeChanged=e}onSelectedBuildingChanged(e){this.selectedBuildingChanged=e}onSelectedPrefabChanged(e){this.selectedPrefabChanged=e}onSelectedTreeChanged(e){this.selectedTreeChanged=e}onSelectedSolarPanelChanged(e){this.selectedSolarPanelChanged=e}addCustomShapeCallback(e){this.addCustomShape=e}setSelectedBuilding(e){this.isActive&&(this.selectedBuilding=e,this.selectedBuildingChanged(e))}updateSelectedModelAttributes(e){let t=this.selectedMesh.userData,{lng:i,lat:s}=B.Z.metersToLatLng({x:this.selectedMesh.position.x,y:this.selectedMesh.position.y}),n=B.Z.getMercatorScaleFactor(s),o=this.selectedMesh.scale.z/n,r=(this.selectedMesh.position.z-t.elevation)/n,a=this.selectedMesh.rotation.z*(180/Math.PI),l={...e,lat:s,lng:i,scale:o,offsetInMeters:r,rotation:a};return t.userModel=l,l}updateSelectedShapeAttributes(e){let t=this.selectedMesh.userData,{lng:i,lat:s}=B.Z.metersToLatLng({x:this.selectedMesh.position.x,y:this.selectedMesh.position.y}),n=B.Z.getMercatorScaleFactor(s),o=this.selectedMesh.scale.z/n,r=(this.selectedMesh.position.z-t.elevation)/n,a=this.selectedMesh.rotation.x*(180/Math.PI),l=this.selectedMesh.rotation.y*(180/Math.PI),d=this.selectedMesh.rotation.z*(180/Math.PI),h={...e,lat:s,lng:i,scale:o,offsetInMeters:r,rotationX:a,rotationY:l,rotationZ:d};return t.userShape=h,h}setPrefabScale(e,t,i){let s=iA.find(t=>t.name===e).dimensions??new S.Vector3(1,1,1);void 0!==i.x&&(t.scale.x=i.x/s.x),void 0!==i.y&&(t.scale.y=i.y/s.y),void 0!==i.z&&(t.scale.z=i.z/s.z)}getRealPrefabScale(e,t){let i=iA.find(t=>t.name===e).dimensions??new S.Vector3(1,1,1);return new S.Vector3(t.scale.x*i.x,t.scale.y*i.y,t.scale.z*i.z)}updateSelectedPrefabAttributes(e){let{lng:t,lat:i}=B.Z.metersToLatLng({x:this.selectedMesh.position.x,y:this.selectedMesh.position.y}),s=B.Z.getMercatorScaleFactor(i),n=this.getRealPrefabScale(e.type,this.selectedMesh),o=n.x/s,r=n.y/s,a=n.z/s;if("tree"===iA.find(t=>t.name===e.type).controls){let t=Math.abs(o-e.scaleX)>1e-4,i=Math.abs(r-e.scaleY)>1e-4;t&&i?o=r=(o+r)/2:t&&!i?r=o:o=r;let n=o*s;this.setPrefabScale(e.type,this.selectedMesh,{x:n,y:n})}let l=S.MathUtils.radToDeg(this.selectedMesh.rotation.x),d=S.MathUtils.radToDeg(this.selectedMesh.rotation.y),h=S.MathUtils.radToDeg(this.selectedMesh.rotation.z),c=(this.selectedMesh.position.z-this.selectedMesh.userData.elevation)/s;return{...e,lat:i,lng:t,scaleX:o,scaleY:r,scaleZ:a,rotationX:l,rotationY:d,rotationZ:h,offsetFromGround:c}}updateSelectedSolarPanelAttributes(e){let t=this.userSolarPanels.get(e.id);if(!t)return;let i=t.visualizer.userData,{lng:s,lat:n}=B.Z.metersToLatLng({x:t.visualizer.position.x,y:t.visualizer.position.y}),o=B.Z.getMercatorScaleFactor(n),r=t.visualizer.scale.x/o,a=t.visualizer.scale.y/o,l=(t.visualizer.position.z-i.elevation)/o,d=S.MathUtils.radToDeg(t.visualizer.rotation.x),h=S.MathUtils.radToDeg(t.visualizer.rotation.y),c=S.MathUtils.radToDeg(t.visualizer.rotation.z);return{...e,lat:n,lng:s,sizeX:r,sizeY:a,offsetFromGround:l,rotationX:d,rotationY:h,rotationZ:c}}setShapeDrawingMode(e){this.drawing.enabled!==e&&(e?(this.drawing.init(),this.drawing.enable(),this.updateIsActive(),this.onDrawingToggle(!0)):(this.drawing.disable(),this.onDrawingLabelChange({isVisible:!1}),this.onDrawingToggle(!1)))}updateElevation(){for(let{data:e,model:t}of this.userPrefabs.values()){let i=this.terrainLayer.mapView.pickElevationAt(t.position.x,t.position.y),s=B.Z.getMercatorScaleFactor(e.lat);t.position.z=i+e.offsetFromGround*s}for(let e of this.userSolarPanels.values()){let t=this.terrainLayer.mapView.pickElevationAt(e.visualizer.position.x,e.visualizer.position.y),i=B.Z.getMercatorScaleFactor(e.descriptor.lat);e.visualizer.position.z=t+e.descriptor.offsetFromGround*i}this.shapeManager.updateElevation()}onSolarPanelAnalyticsChanged(e){this.analyticsPass&&(this.analyticsPass.onPlaneUpdated=t=>{e(t)})}getSelectedMesh(){return this.selectedMesh}getSelectedBuilding(){return this.selectedBuilding}getSelectedTree(){return this.selectedTree}}var iH=i(60247),iG=i(17031),iz=i(92218),iW=i(33392),iX=i(67256),iY=i(33690);(l=w||(w={})).OBJ="OBJ",l.GLB="GLB",l.DAE="DAE",l.FBX="FBX",l.IFC="IFC";class i${constructor({overlayGroup:e,elevationFunction:t,prepareMaterial:i,onSceneUpdated:s}){this.inactive=!1,this.loadingIndicatorParent=e,this.daeLoader=new iG.G,this.fbxLoader=new iz.y,this.objLoader=new iH.L,this.glbLoader=new tS.E,this.dracoLoader=new V._,this.dracoLoader.setDecoderPath("../draco/1.4.1/"),this.glbLoader.setDRACOLoader(this.dracoLoader),this.initIFCLoader(),this.usermodelGroup=new S.Group,this.usermodelGroup.name=i$.GROUP_NAME,this.usermodelGroup.layers.enable(D.sv),this.elevationFunction=t,this.prepareMaterial=i,this.onSceneUpdated=s,this.mixers=[],this.initLoadingIndicator()}initIFCLoader(){let e=new iW.z8,t=document.createElement("canvas");e.scene=new iW.OZ(e),e.renderer=new iW.MN(e,t),e.camera=new iW.bl(e),e.raycaster=new iW.Mh(e),e.init(),this.ifcLoader=new iW.vL(e),this.ifcLoader.settings.wasm={path:"https://unpkg.com/web-ifc@0.0.43/",absolute:!0},this.ifcLoader.settings.webIfc.COORDINATE_TO_ORIGIN=!0,this.ifcLoader.settings.webIfc.OPTIMIZE_PROFILES=!0,this.ifcLoader.settings.optionalCategories=[]}initLoadingIndicator(){let e=new iY.u().parse(iX.Y),t=new S.MeshLambertMaterial({side:S.DoubleSide,transparent:!0,opacity:.5}),i=[];e.paths.forEach(e=>{iY.u.createShapes(e).forEach(e=>{i.push(new S.ExtrudeGeometry(e,{depth:5,bevelEnabled:!1}))})});let s=(0,tT.n4)(i);s.center(),this.loadingIndicator=new S.Mesh(s,t),this.loadingIndicator.castShadow=!0,this.loadingIndicator.receiveShadow=!0,this.loadingIndicator.scale.set(.5,-.5,.5),this.loadingIndicator.rotateX(Math.PI/2)}async loadModel(e,t){switch(t){case w.OBJ:return this.objLoader.loadAsync(e);case w.GLB:{let t=await this.glbLoader.loadAsync(e),i=t.scene||t.scenes[0],s=t.animations||[],n=new S.AnimationMixer(i);return s.forEach(e=>{n.clipAction(e).play()}),this.mixers.push(n),i}case w.DAE:return(await this.daeLoader.loadAsync(e)).scene;case w.FBX:return await this.fbxLoader.loadAsync(e);case w.IFC:{let t=await fetch(e),i=new Uint8Array(await t.arrayBuffer());return await this.ifcLoader.load(i,"model")}default:throw Error("Unsupported file type")}}async loadUserModel(e,t){let i;e.status="loading";let{lat:s,lng:n,type:o,zUp:r,needsHeightCheck:a}=e,l=this.elevationFunction(s,n),{x:d,y:h}=B.Z.latLngToMeters({lat:s,lng:n}),c=this.loadingIndicator.clone();c.userData.loadingIndicator=!0,c.userData.lat=s,c.userData.lng=n;let u=l+B.Z.applyMercatorScaleFactor(10,s);c.position.set(d,h,u),new C.kX(c.material).to({opacity:1},500).start().onUpdate(()=>{this.onSceneUpdated()});let p=new C.kX(c.rotation).to({y:2*Math.PI},4e3).repeat(1/0).start().onUpdate(()=>{this.onSceneUpdated()});this.loadingIndicatorParent.add(c);let m=await this.loadModel(t,o);i$.removeLightsAndCameras(m).traverse(e=>{if(!(e instanceof S.Mesh))return;let t=[];Array.isArray(e.material)?t.push(...e.material):t.push(e.material);let i=t[0],s=i.transparent&&i.opacity<.9;if(e.castShadow=!s,e.receiveShadow=!0,e.layers.enable(D.sv),e.userData.usermodel=!0,s||e.layers.enable(D.OB),e.onBeforeRender=e=>{e.toneMappingExposure=3},e.onAfterRender=e=>{e.toneMappingExposure=1},!e.geometry.getAttribute("normal"))for(let e of t)e.flatShading=!0;for(let e of t)e instanceof S.MeshPhongMaterial&&e.map&&(e.color=new S.Color(0xffffff),e.map.encoding=S.LinearEncoding),this.prepareMaterial(e)});let g=new S.Group;g.name=e.id,g.add(m),e.originalBoundingBox=new S.Box3().setFromObject(m),g.userData={type:x.Model,userModelRoot:!0,userModel:e,elevation:l,offsetInMeters:e.offsetInMeters},e.originalHeightInModelUnits=this.getModelHeightInModelUnits(m),g.layers.set(D.sv);let f=this.usermodelGroup.getObjectByName(e.id);if(null!==f&&this.usermodelGroup.remove(f),new C.kX(c.material).to({opacity:0,scale:{x:0,y:0,z:0},position:{z:0}},800).onComplete(()=>{c.parent?.remove(c),p.stop(),this.onSceneUpdated()}).start(),this.usermodelGroup.add(g),a&&e.originalHeightInModelUnits){let t=r?e.originalHeightInModelUnits.z:e.originalHeightInModelUnits.y;t>100&&(i=t,e.scale=10/t)}this.positionModel(g,e);let w=g.scale.x;return g.scale.setScalar(.001*w),new C.kX(g.scale).to({x:w,y:w,z:w},800).easing(C.oY.Quadratic.Out).start().onUpdate(()=>{this.onSceneUpdated()}),this.onSceneUpdated(),{model:g,changedHeight:i}}getLoadedModel(e){let t=null;return this.usermodelGroup.getObjectByName(e.id)?.traverse(e=>{if(!0===e.userData.userModelRoot){t=e;return}}),t}remove(e){let t=this.usermodelGroup.getObjectByName(e.id);t&&this.usermodelGroup.remove(t)}positionModel(e,t){if(e?.userData?.userModelRoot!==!0)throw Error("positionModel: Object is not a usermodel root");let{lat:i,lng:s,offsetInMeters:n,rotation:o,zUp:r,hidden:a,reCentered:l,originalBoundingBox:d}=t,h=this.elevationFunction(i,s);if(void 0===h)return;let{x:c,y:u}=B.Z.latLngToMeters({lat:i,lng:s}),p=B.Z.getMercatorScaleFactor(i);e.position.set(c,u,h+n*p),t.scale||(t.scale=1);let m=t.scale*p;if(e.scale.set(m,m,m),e.rotation.z=Math.PI/180*o,e.children[0].rotation.x=r?0:Math.PI/2,l){let t=new S.Vector3;d.getCenter(t).negate(),r||t.applyAxisAngle(new S.Vector3(1,0,0),Math.PI/2),t.setZ(r?-d.min.z:-d.min.y),e.children[0].position.copy(t)}else e.children[0].position.set(0,0,0);e.visible=!a,e.userData.userModel=t}getModelHeightInModelUnits(e){let t=new S.Box3().setFromObject(e);return{y:t.max.y-t.min.y,z:t.max.z-t.min.z}}setTime(e){this.mixers.forEach(t=>{t.setTime(e)})}static updateElevation(e,t){for(let i of e.children)if(!0===i.userData.userModelRoot){let{lat:e,lng:s,offsetInMeters:n}=i.userData.userModel,o=t(e,s)+n*B.Z.getMercatorScaleFactor(e);i.position.z=o}else if(!0===i.userData.loadingIndicator){let{lat:e,lng:s}=i.userData,n=t(e,s)+B.Z.applyMercatorScaleFactor(10,e);i.position.z=n}}static removeLightsAndCameras(e){let t=[];for(let i of(e.traverse(e=>{(e instanceof S.Light||e instanceof S.Camera)&&t.push(e)}),t))e.remove(i);return e}}i$.GROUP_NAME="UsermodelGroup";var iQ=i(1613),iq=i(40332),iK="varying vec2 vUv;\n\nvoid main() {\n    vUv = position.xy * 0.5 + 0.5;\n    gl_Position = vec4(position, 1);\n}\n";class iJ extends ik.w2{constructor(e,t){super();let i=new S.TextureLoader().load("./img/analytics_magnifier.png");i.minFilter=S.LinearFilter,i.magFilter=S.LinearFilter,this.screenMaterial=new S.ShaderMaterial({fragmentShader:"precision highp sampler2D;\n\n#define MAGNIFIER_DISTORION_RADIUS 86. / 2.\n#define MAGNIFIER_OVERLAY_RADIUS 90. / 2.\n\nvarying vec2 vUv;\n\nuniform sampler2D accumMap;\nuniform sampler2D colorMap;\nuniform sampler2D depthMap;\nuniform sampler2D shadowLUT;\nuniform mat4 projectionMatrixInv;\nuniform float cutOffDistance;\nuniform float accumProgress;\nuniform vec4 magnifierPosition; // magnification x, magnification y, is enabled, magnifierMap vertical offset\nuniform float screenDRP;\nuniform sampler2D magnifierMap;\nuniform vec4 sphere; // x, y, z, r\nuniform mat4 cameraViewMatrix;\n\nvec3 getViewSpacePos(float depth, vec2 coord) {\n    vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, depth * 2.0 - 1.0, 1.0);\n    vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;\n    viewSpacePosition /= viewSpacePosition.w;\n    return viewSpacePosition.xyz;\n}\n\nvoid main() {\n    vec2 uv = vUv;\n\n    float magnifierDistortionRadius = MAGNIFIER_DISTORION_RADIUS * screenDRP;\n    vec2 colorMapSize = vec2(textureSize(colorMap, 0));\n    vec2 magnifierOffsetNorm = vec2(0, magnifierPosition.w * screenDRP / colorMapSize.y);\n    float dstToMagnifier = distance(vUv * colorMapSize, (magnifierPosition.xy - magnifierOffsetNorm) * colorMapSize);\n\n    if (magnifierPosition.z > 0. && dstToMagnifier < magnifierDistortionRadius) {\n        uv += magnifierOffsetNorm;\n        uv += (magnifierPosition.xy - uv) * 0.75;\n    }\n\n    vec3 colorValue = texture2D(colorMap, uv).rgb;\n    float accumValue = texture2D(accumMap, uv).r / accumProgress;\n\n    float screenDepth = texture2D(depthMap, uv).r;\n    vec3 position = getViewSpacePos(screenDepth, uv);\n    vec3 spherePosition = (cameraViewMatrix * vec4(position, 1.0)).xyz - sphere.xyz;\n\n    vec3 lutColor = texture2D(shadowLUT, vec2(accumValue, 0.5)).rgb;\n\n    float mixFactorLowIrradiance = smoothstep(-0.5, 0.25, accumValue);\n    float mixFactorDistance = smoothstep(cutOffDistance, cutOffDistance * 0.9, length(position));\n    float mixFactorSphere = smoothstep(sphere.w * 1.3, sphere.w, length(spherePosition));\n    float mixFactor = mixFactorLowIrradiance * mixFactorDistance * mixFactorSphere;\n\n    gl_FragColor = vec4(mix(colorValue, lutColor, mixFactor), 1.0);\n\n    if (magnifierPosition.z > 0.) {\n        float magnifierOverlayRadius = MAGNIFIER_OVERLAY_RADIUS * screenDRP;\n        vec2 magnifierUV = (vUv - magnifierPosition.xy + magnifierOffsetNorm) * colorMapSize / magnifierOverlayRadius * 0.5 + 0.5;\n\n        if (magnifierUV.x >= 0. && magnifierUV.x <= 1. && magnifierUV.y >= 0. && magnifierUV.y <= 1.) {\n            vec4 magnifierSample = texture2D(magnifierMap, magnifierUV);\n            gl_FragColor.rgb = mix(gl_FragColor.rgb, magnifierSample.rgb, magnifierSample.a);\n        }\n    }\n}\n",vertexShader:iK,uniforms:{accumMap:{value:null},colorMap:{value:null},depthMap:{value:null},shadowLUT:{value:null},projectionMatrixInv:{value:t.projectionMatrixInverse},cutOffDistance:{value:0},accumProgress:{value:0},magnifierPosition:{value:new S.Vector4(0,0,0,0)},screenDRP:{value:e.getPixelRatio()},magnifierMap:{value:i},sphere:{value:new S.Vector4(0,0,0,1)},cameraViewMatrix:{value:t.matrixWorld}},depthTest:!1,depthWrite:!1});let s=()=>{this.screenMaterial.uniforms.screenDRP.value=e.getPixelRatio()};e.domElement.addEventListener("touchmove",()=>s(),!1),e.domElement.addEventListener("touchstart",()=>s(),!1),this.fullscreenMaterial=this.screenMaterial}setLUT(e){this.screenMaterial.uniforms.shadowLUT.value=e}compute(e,t,i,s,n,o,r,a,l,d,h){e.setRenderTarget(h),this.screenMaterial.uniforms.colorMap.value=t,this.screenMaterial.uniforms.depthMap.value=i,this.screenMaterial.uniforms.accumMap.value=s,this.screenMaterial.uniforms.cutOffDistance.value=o,this.screenMaterial.uniforms.accumProgress.value=n,this.screenMaterial.uniforms.sphere.value=new S.Vector4(a.x,a.y,a.z,r),this.screenMaterial.uniforms.magnifierPosition.value.set(l?.x??0,l?.y??0,+!!l,d),e.render(this.scene,this.camera)}}let i1=[new S.Plane(new S.Vector3(0,0,1),100),new S.Plane(new S.Vector3(0,0,1),0),new S.Plane(new S.Vector3(0,0,1),-100)],i0=[new S.Vector3(-1,-1,-1),new S.Vector3(1,-1,-1),new S.Vector3(1,1,-1),new S.Vector3(-1,1,-1),new S.Vector3(-1,-1,1),new S.Vector3(1,-1,1),new S.Vector3(1,1,1),new S.Vector3(-1,1,1)];var i2=i(18783);class i5 extends ik.w2{constructor(e,t,i){super(),this.normalMaterial=new S.MeshNormalMaterial,this.scene3D=t,this.camera3D=e,this.normalPlusDepthRenderPass=new ik.CD(t,e),this.normalPlusDepthRenderPass.skipShadowMapUpdate=!0,this.normalPlusDepthRenderPass.ignoreBackground=!0,this.normalRenderTarget=new S.WebGLRenderTarget(1,1,{minFilter:S.NearestFilter,magFilter:S.NearestFilter,depthBuffer:!0,depthTexture:new S.DepthTexture(1,1,S.FloatType)}),this.depthRenderTarget=new S.WebGLRenderTarget(1,1,{minFilter:S.NearestFilter,magFilter:S.NearestFilter,depthBuffer:!1,format:S.RedFormat,type:S.FloatType}),this.normalReader=new iR.Z(i,4),this.depthReader=new iR.Z(i,4),this.fullscreenMaterial=new S.ShaderMaterial({fragmentShader:"precision highp sampler2D;\n\nvarying vec2 vUv;\n\nuniform sampler2D depthMap;\n\nvoid main() {\n    float depthValue = texture2D(depthMap, vUv).r;\n    gl_FragColor = vec4(depthValue, 0, 0, 1);\n}\n",vertexShader:"varying vec2 vUv;\n\nvoid main() {\n    vUv = position.xy * 0.5 + 0.5;\n    gl_Position = vec4(position, 1);\n}\n",uniforms:{depthMap:{value:this.normalRenderTarget.depthTexture}}})}getNormalTexture(){return this.normalRenderTarget.texture}getDepthTexture(){return this.normalRenderTarget.depthTexture}compute(e){this.camera3D.layers.set(D.OB);let t=this.setSceneMaterialsToNormalMaterial();this.scene3D.matrixWorldAutoUpdate=!1,this.normalPlusDepthRenderPass.render(e,this.normalRenderTarget,null),this.restoreSceneMaterials(t),this.scene3D.matrixWorldAutoUpdate=!0,this.camera3D.layers.enableAll(),e.setRenderTarget(this.depthRenderTarget),e.clear(),e.render(this.scene,this.camera)}async getNormalAt(e,t){let i=this.normalRenderTarget.width,s=this.normalRenderTarget.height,n=Math.floor(e*i),o=Math.floor(t*s),r=await this.normalReader.readColorAttachmentRect(this.normalRenderTarget,"RGBA","UNSIGNED_BYTE",n,o,1,1),a=r.uint8Array[0]/255*2-1,l=r.uint8Array[1]/255*2-1,d=r.uint8Array[2]/255*2-1;return new S.Vector3(a,l,d).normalize()}async getPositionAt(e,t){let i=this.depthRenderTarget.width,s=this.depthRenderTarget.height,n=Math.floor(e*i),o=Math.floor(t*s);this.camera3D.updateProjectionMatrix();let r=this.camera3D.projectionMatrix.clone().invert(),a=(await this.depthReader.readColorAttachmentRect(this.depthRenderTarget,"RED","FLOAT",n,o,1,1)).float32Array[0],l=function(e,t,i,s,n,o){let r=new S.Vector4((e+.5)/s*2-1,-((t+.5)/n*2)+1,2*i-1,1);return r.applyMatrix4(o),r.multiplyScalar(1/r.w),new S.Vector3(r.x,r.y,r.z)}(n,o,a,this.depthRenderTarget.width,this.depthRenderTarget.height,r);return l.applyMatrix4(this.camera3D.matrixWorld),l}setSceneMaterialsToNormalMaterial(){let e=new Map;return this.scene3D.traverse(t=>{t instanceof S.Mesh&&(t.userData.normalMaterial?(e.set(t,t.material),t.material=t.userData.normalMaterial):(e.set(t,t.material),t.material=this.normalMaterial))}),e}restoreSceneMaterials(e){for(let[t,i]of e.entries())t.material=i}setSize(e,t){this.normalRenderTarget.setSize(e,t),this.depthRenderTarget.setSize(e,t)}}var i3=i(86848),i4=i(63116);class i8 extends ik.w2{constructor(e,t){super(),this.textureReaderTarget=new Uint8Array(4),this.camera=t,this.textureReader=new iR.Z(e,4),this.renderTarget=new S.WebGLRenderTarget(1,1,{format:S.RGBAFormat,type:S.UnsignedByteType,minFilter:S.NearestFilter,magFilter:S.NearestFilter,depthBuffer:!1}),this.material=new S.ShaderMaterial({fragmentShader:"precision highp sampler2D;\n\nvarying vec2 vUv;\n\nuniform sampler2D depthMap;\nuniform mat4 projectionMatrixInv;\nuniform mat4 cameraViewMatrix;\nuniform vec4 sphere; // x, y, z, r\n\nvec3 getViewSpacePos(float depth, vec2 coord) {\n    vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, depth * 2.0 - 1.0, 1.0);\n    vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;\n    viewSpacePosition /= viewSpacePosition.w;\n    return viewSpacePosition.xyz;\n}\n\nvoid main() {\n    float screenDepth = texture2D(depthMap, vUv).r;\n    vec3 position = getViewSpacePos(screenDepth, vUv);\n    vec3 spherePosition = (cameraViewMatrix * vec4(position, 1.0)).xyz - sphere.xyz;\n\n    float mixFactorSphere = step(length(spherePosition), sphere.w * 1.15);\n\n    gl_FragColor = vec4(mixFactorSphere, 0, 0, 1);\n}\n",vertexShader:iK,uniforms:{depthMap:{value:null},projectionMatrixInv:{value:t.projectionMatrixInverse},cameraViewMatrix:{value:t.matrixWorld},sphere:{value:new S.Vector4(0,0,0,0)}}}),this.fullscreenMaterial=this.material}compute(e,t,i,s){e.setRenderTarget(this.renderTarget),this.material.uniforms.depthMap.value=t,this.material.uniforms.sphere.value.set(s.x,s.y,s.z,i),e.render(this.scene,this.camera)}async sampleValue(e,t){let i=Math.floor(this.renderTarget.width*e),s=Math.floor(this.renderTarget.height*t);return(await this.textureReader.readColorAttachmentRect(this.renderTarget,"RGBA","UNSIGNED_BYTE",i,s,1,1)).uint8Array[0]/255}setSize(e,t){this.renderTarget.setSize(e,t)}}var i9=i(60179);let i7=new Uint32Array(1);(d=b||(b={}))[d.InMovement=0]="InMovement",d[d.MovementStopped=1]="MovementStopped",d[d.Static=2]="Static",(h=v||(v={}))[h.Camera=0]="Camera",h[h.Fixed=1]="Fixed";class i6 extends ik.w2{constructor(e,t,i,s,n,o,r,a){super("SunlightAnalyticsPass"),this.width=0,this.height=0,this.state=b.InMovement,this.movementStoppedTimestamp=0,this.directionBucketManagerCache=new iq.Z,this.calculatedTime=0,this.timeRangeFrom=0,this.timeRangeTo=0,this.cameraDistance=0,this.shadowCutOffDistance=0,this.isHighQuality=!1,this.highQualityAccumulationProgressWeight=0,this.highQualityAccumulationProgressIteration=0,this.highQualityAccumulationProgressNormalized=1,this.budgetPerFrame=8,this.totalAccumulationTime=0,this.totalWeight=0,this.totalDirectWeight=0,this.groundPlaneIntersectionPoints=[],this.targetPlanes=[],this.irradianceSampler=new i4.Z,this.isInitialized=!1,this.powerForCurrentRange=0,this.centerMode=v.Camera,this.centerModeFixedPosition=new S.Vector2,this.accumMagnifierPosition=new S.Vector2(0,0),this.accumMagnifierVisible=!1,this.emitter=new tR.Z,this.monthlyRenderProgress={id:0,position:new S.Vector2,stage:"done",month:0,monthProgress:0,normal:new S.Vector3,results:[],onUpdate:()=>{}},this.irradianceSampler.onLoadPromise.then(()=>{this.isInitialized=!0}),this.scene=t,this.originOffset=n,this.sourceCamera=i,this.sceneOriginGroup=s,this.terrainLayer=r,this.controls=o,this.isPoint=a,this.needsSwap=!a,this.shadowCamera=new S.OrthographicCamera,s.add(this.shadowCamera),this.shadowCamera.layers.disableAll(),this.shadowCamera.layers.enable(D.OB),this.shadowMappingPass=new i3.Z(t,this.shadowCamera,a?1:2048),this.normalDepthPass=new i5(i,t,e),this.accumPass=new iN(e,i,!1),this.screenPass=new iJ(e,i),this.radiusCoveragePass=new i8(e,i),this.textureReader=new iR.Z(e,8),(async e=>{let t=new S.TextureLoader,i=await t.loadAsync(`img/colormaps/${e}.png`);for(let e of(i.magFilter=S.LinearFilter,i.minFilter=S.LinearFilter,i.generateMipmaps=!1,i.needsUpdate=!0,this.screenPass.setLUT(i),this.targetPlanes))e.setLUT(i);this.lut=i})("magma")}setTargetPlanes(e){for(let t of(this.targetPlanes=e,this.targetPlanes))t.setLUT(this.lut)}updatePlanesRenderMode(e){for(let t of this.targetPlanes)t.updateRenderMode(e)}setCenterMode(e,t){t&&this.centerModeFixedPosition.set(t.x,t.y),this.centerMode!==e&&(this.centerMode=e,this.state=b.InMovement)}raycastTerrain(e,t){let i=new S.Raycaster;t.userData.isOrthographicCamera?(i.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),i.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld)):(i.ray.origin.setFromMatrixPosition(t.matrixWorld),i.ray.direction.set(e.x,e.y,.5).unproject(t).sub(i.ray.origin).normalize()),i.camera=t;let s=this.sceneOriginGroup.worldToLocal(i.ray.origin);return this.terrainLayer.mapView.raymarchElevation(s,i.ray.direction,2e3,5,2)}registerCameraMovement(){this.state=b.InMovement}setRange(e,t){(this.timeRangeFrom!==e||this.timeRangeTo!==t)&&(this.timeRangeFrom=e,this.timeRangeTo=t,this.state=b.InMovement,this.directionBucketManagerCache.reset())}onSceneChange(){this.state=b.InMovement}getCenterPositionWorld(){if(this.centerMode===v.Camera)return{position:this.controls.target,radius:1e12};let{lat:e}=B.Z.metersToLatLng(this.centerModeFixedPosition),t=this.terrainLayer.mapView.pickElevationAtXY(this.centerModeFixedPosition),i=B.Z.getMercatorScaleFactor(e);return{position:this.sceneOriginGroup.localToWorld(new S.Vector3(this.centerModeFixedPosition.x,this.centerModeFixedPosition.y,t)),radius:250*i}}shouldRenderNextFrame(){return this.state!==b.Static||!this.isHighQuality}render(e,t,i){if(this.isInitialized){if(this.isPoint)return void this.renderOnce(e);switch(e.shadowMap.enabled=!1,this.state===b.MovementStopped&&performance.now()-this.movementStoppedTimestamp>300&&(this.state=b.Static,this.highQualityAccumulationProgressWeight=0,this.highQualityAccumulationProgressIteration=0,this.highQualityAccumulationProgressNormalized=0),this.state){case b.InMovement:this.shadowCutOffDistance=Math.max(500,2*this.cameraDistance),this.groundPlaneIntersectionPoints=function(e,t){let i=e.near,s=e.far;e.near=1,e.far=t,e.updateProjectionMatrix();let n=i0.map(t=>t.clone().unproject(e));e.near=i,e.far=s,e.updateProjectionMatrix();let o=[[n[0],n[1]],[n[1],n[2]],[n[2],n[3]],[n[3],n[0]],[n[4],n[5]],[n[5],n[6]],[n[6],n[7]],[n[7],n[4]],[n[0],n[4]],[n[1],n[5]],[n[2],n[6]],[n[3],n[7]]],r=[];for(let e of o){let t=e[0],i=e[1],s=t.distanceTo(i),n=i.clone().sub(t).normalize(),o=new S.Ray(t,n);for(let e of i1){let t=o.distanceToPlane(e);if(null!==t&&t<=s){let e=o.at(t,new S.Vector3);r.push(e)}}}return r}(this.sourceCamera,this.shadowCutOffDistance),this.setIsHighQuality(!1),this.updateAccumulatedShadows(e,!0);break;case b.MovementStopped:break;case b.Static:this.isHighQuality||this.updateAccumulatedShadows(e,!1)}{let s=this.getCenterPositionWorld();this.screenPass.compute(e,t.texture,this.normalDepthPass.getDepthTexture(),this.accumPass.getFinalRenderTarget().texture,this.accumPass.avgDirAccum,this.shadowCutOffDistance,s.radius,s.position,this.accumMagnifierVisible&&this.isHighQuality?this.accumMagnifierPosition:void 0,sa,i)}for(let t of(e.shadowMap.enabled=!0,this.state===b.InMovement&&(this.state=b.MovementStopped,this.movementStoppedTimestamp=performance.now()),this.targetPlanes))t.update(e)}}renderOnce(e){if("done"===this.monthlyRenderProgress.stage)return void console.log("Already done");if("normalRequested"===this.monthlyRenderProgress.stage)return;"requested"===this.monthlyRenderProgress.stage&&(this.shadowCutOffDistance=Math.max(500,2*this.cameraDistance));let t=this.monthlyRenderProgress.id,i=this.sourceCamera,s=this.monthlyRenderProgress.position.x,n=1-this.monthlyRenderProgress.position.y,o=window.innerWidth,r=window.innerHeight,a={...i.view},l=()=>{i.setViewOffset(a.fullWidth,a.fullHeight,a.offsetX,a.offsetY,a.width,a.height),e.shadowMap.enabled=!0};if(i.setViewOffset(o,r,Math.floor(s*o)+a.offsetX,Math.floor(n*r)+a.offsetY,1,1),e.shadowMap.enabled=!1,"requested"===this.monthlyRenderProgress.stage){this.normalDepthPass.compute(e),this.monthlyRenderProgress.stage="normalRequested",Promise.all([this.normalDepthPass.getNormalAt(0,0),this.normalDepthPass.getPositionAt(0,0)]).then(([e,i])=>{if(this.monthlyRenderProgress.id!==t)return;let s=e.clone().transformDirection(this.sourceCamera.matrixWorld);this.monthlyRenderProgress.stage="normalDone",this.monthlyRenderProgress.month=0,this.monthlyRenderProgress.normal.copy(s),this.groundPlaneIntersectionPoints=[i.clone().add(s.clone().multiplyScalar(.001))]}),l();return}"normalDone"===this.monthlyRenderProgress.stage&&(this.monthlyRenderProgress.stage="nthMonthDone",this.monthlyRenderProgress.month=0,this.monthlyRenderProgress.monthProgress=0);let d=this.monthlyRenderProgress.month;if(0===this.monthlyRenderProgress.monthProgress){let e=new Date(2025,d,1).getTime(),t=new Date(2025,d+1,1).getTime();this.setRange(e,t)}this.normalDepthPass.compute(e),0===this.monthlyRenderProgress.monthProgress&&(this.state=b.Static,this.highQualityAccumulationProgressWeight=0,this.highQualityAccumulationProgressIteration=0,this.highQualityAccumulationProgressNormalized=0,this.accumPass.surfaceNormal.copy(this.monthlyRenderProgress.normal),this.isHighQuality=!1),this.updateAccumulatedShadows(e,!1),this.monthlyRenderProgress.monthProgress=this.highQualityAccumulationProgressNormalized,this.isHighQuality&&(this.sampleTexture(0,0).then(e=>{this.monthlyRenderProgress.id===t&&(this.monthlyRenderProgress.results[d]=e,this.monthlyRenderProgress.onUpdate(this.monthlyRenderProgress.results))}),this.monthlyRenderProgress.month>=11?this.monthlyRenderProgress.stage="done":(this.monthlyRenderProgress.month++,this.monthlyRenderProgress.monthProgress=0)),l()}async sampleShadowMapAsync(e,t){let i=this.accumPass.getFinalRenderTarget(),s=Math.floor(i.width*e),n=Math.floor(i.height*t),o=await this.textureReader.readColorAttachmentRect(i,"RG","FLOAT",s,n,1,1);return[o.float32Array[0],o.float32Array[1]]}async sampleTexture(e,t){if(this.targetPlanes.length>0){let i=this.targetPlanes[0].visualizer.parent,s=new S.Raycaster;if(s.setFromCamera(new S.Vector2(2*e-1,2*t-1),this.sourceCamera),s.intersectObjects(i.children).length>0)return{isAccessible:!1,isReady:!1,energy:0,maxEnergy:0,maxEnergyAtNormal:0,time:0,maxTime:0,timeInDaylightFraction:0}}let i=this.totalWeight,s=this.isHighQuality,n=this.powerForCurrentRange,o=this.totalDirectWeight,r=this.calculatedTime,a=this.accumPass.avgDirAccum/i,l=this.accumPass.upAccum/i,d=this.accumPass.surfaceNormalAccum/i,[h,c]=await this.sampleShadowMapAsync(e,t),u=await this.radiusCoveragePass.sampleValue(e,t);return 0===i?{isAccessible:u>.5,isReady:s,energy:0,maxEnergy:0,maxEnergyAtNormal:0,time:0,maxTime:0,timeInDaylightFraction:0}:{isAccessible:u>.5,isReady:s,energy:h/i/l*n,maxEnergy:a/l*n,maxEnergyAtNormal:d/l*n,time:c/o*r,maxTime:r,timeInDaylightFraction:c/o}}getAvgLightDirection(e){let t=new S.Vector3;for(let i=0;i<e.bucketCount;i++){let{altitude:s,azimuth:n,weight:o}=e.getNthBucket(i),r=new S.Vector3(Math.cos(-n-.5*Math.PI),Math.sin(-n-.5*Math.PI),Math.tan(s)).normalize();t.addScaledVector(r,o)}return t.normalize(),t}calculateBucketShadow(e,t,i,s,n){.01>Math.abs(t-Math.PI/2)&&(t-=.01);let o=new S.Vector3(Math.cos(-i-.5*Math.PI),Math.sin(-i-.5*Math.PI),Math.tan(t)).normalize().multiplyScalar(-1);for(let t of((0,i2.Z)(this.shadowCamera,o,this.groundPlaneIntersectionPoints),this.shadowMappingPass.compute(e),this.accumPass.addToAccumulation(e,this.shadowCamera,this.normalDepthPass.getDepthTexture(),this.normalDepthPass.getNormalTexture(),this.shadowMappingPass.getDepthTexture(),s,n,(this.shadowCamera.top-this.shadowCamera.bottom)*(this.isPoint?2048:1)),this.targetPlanes))t.accumPass.addToAccumulation(e,this.shadowCamera,null,null,this.shadowMappingPass.getDepthTexture(),s,n)}setIsHighQuality(e){this.isHighQuality!==e&&(this.isHighQuality=e,this.emitter.emit("qualityChanged",[e]))}fillBuckets(e,t,i){let{directions:s,calculatedTime:n}=function(e,t,i,s){let n=[],o=Math.floor(t/864e5)-Math.floor(e/864e5)+1,r=0,a=0,l=864e5*Math.floor(e/864e5-1),d=[];for(let n=0;n<o+2;n++){let n=ef.getTimes(new Date(l),i,s),o=n.sunriseEnd.getTime(),r=n.sunsetStart.getTime();l+=864e5,r<=e||o>=t||d.push({risingUnix:o,settingUnix:r})}if(0===d.length)return console.log("no transits",t-e),{directions:n,calculatedTime:0,skippedTime:t-e};a+=Math.max(0,d[0].risingUnix-e),a+=Math.max(0,t-d[d.length-1].settingUnix);for(let o=0;o<d.length;o++){let{risingUnix:l,settingUnix:h}=d[o],c=Math.max(e,l),u=Math.min(t,h);r+=u-c,o<d.length-1&&(a+=d[o+1].risingUnix-h);let p=c;for(;p<=u;){let e=ef.getPosition(new Date(p),i,s);p+=6e4,n.push({altitude:e.altitude,azimuth:e.azimuth,timestamp:p})}}return{directions:n,calculatedTime:isNaN(r)?0:r,skippedTime:isNaN(a)?0:a}}(this.timeRangeFrom,this.timeRangeTo,t,i);this.calculatedTime=n;let o=Math.max(Math.pow(Math.min(1,Math.max(n,1)/0x3b4f03dd8)*(this.isPoint?1200:400),.25),.1);e.setStepSize(S.MathUtils.degToRad(o));let r=0;for(let n of s){let{irradiance:s,diffuseToGlobalRatio:o}=this.irradianceSampler.getMonthlyIrradiancePerDay(t,i,n.timestamp);if(s>0){let t=Math.max(0,new S.Vector3(Math.cos(-n.azimuth-.5*Math.PI),Math.sin(-n.azimuth-.5*Math.PI),Math.tan(n.altitude)).normalize().dot(new S.Vector3(0,0,1)))*s,i=1-o;r+=t/i*o,e.insert({altitude:n.altitude,azimuth:n.azimuth,weight:s,directWeight:s*i})}}let a=[],l=0,d=0;if(r>0){for(let e=0;e<64;e++){let[t,i]=function(e,t){return[.5*Math.PI-Math.acos(1-e),2*t*Math.PI]}(...function(e,t){return[e/64,(i7[0]=e,i7[0]=(i7[0]<<16|i7[0]>>16)>>>0,i7[0]=(0x55555555&i7[0])<<1|(0xaaaaaaaa&i7[0])>>>1>>>0,i7[0]=(0x33333333&i7[0])<<2|(0xcccccccc&i7[0])>>>2>>>0,i7[0]=(0xf0f0f0f&i7[0])<<4|(0xf0f0f0f0&i7[0])>>>4>>>0,i7[0]=(0xff00ff&i7[0])<<8|(0xff00ff00&i7[0])>>>8>>>0,23283064365386963e-26*i7[0])]}(e,0)),s=+(1+2*Math.sin(t)),n=new S.Vector3(Math.cos(-i-.5*Math.PI),Math.sin(-i-.5*Math.PI),Math.tan(t)).normalize();a.push([t,i,s]),l+=s,d+=Math.max(0,n.dot(new S.Vector3(0,0,1)))*s}for(let[t,i,s]of a){let n=l/d;e.insert({altitude:t,azimuth:i,weight:s/l*r*n,directWeight:0})}}e.sort(),e.shuffle()}updateAccumulatedShadows(e,t){let i=performance.now(),{lat:s,lng:n}=B.Z.metersToLatLng(this.originOffset),{instance:o,isNew:r}=this.directionBucketManagerCache.getInstance(s,n);if(r){this.fillBuckets(o,s,n);let e=this.getAvgLightDirection(o);for(let t of(this.accumPass.avgLightDirection=e,this.targetPlanes))t.accumPass.avgLightDirection=e;this.powerForCurrentRange=this.irradianceSampler.getMonthlyIrradianceFromTo(s,n,this.timeRangeFrom,this.timeRangeTo)}for(let e of this.targetPlanes)e.accumPass.avgLightDirection=this.accumPass.avgLightDirection;this.normalDepthPass.compute(e);let a=this.getCenterPositionWorld();if(this.radiusCoveragePass.compute(e,this.normalDepthPass.getDepthTexture(),a.radius,a.position),this.shadowMappingPass.initMaterialOverrides(),this.sourceCamera.layers.enableAll(),t){for(let t of(this.accumPass.resetAccumulation(e),this.targetPlanes))t.accumPass.resetAccumulation(e);let t=Math.min(12,o.bucketCount),i=1/t,s=S.MathUtils.degToRad(15);for(let n=0;n<t;n++){let r=Math.floor(o.bucketCount/t*(n+.5)),{altitude:a,azimuth:l}=o.getNthBucket(r),d=Math.max(a,s);this.calculateBucketShadow(e,d,l,i,i)}this.highQualityAccumulationProgressNormalized=1}else{this.totalWeight=o.totalBucketWeight,this.totalDirectWeight=o.totalDirectBucketWeight;let t=this.highQualityAccumulationProgressIteration;if(0===t)for(let t of(this.totalAccumulationTime=0,this.accumPass.resetAccumulation(e),this.targetPlanes))t.setTotalWeight(this.totalWeight),t.setPower(this.powerForCurrentRange),t.accumPass.resetAccumulation(e);if(0===o.bucketCount)this.setIsHighQuality(!0),this.highQualityAccumulationProgressNormalized=1;else{for(let s=t;s<o.bucketCount;s++){let{altitude:t,azimuth:n,weight:r,directWeight:a}=o.getNthShuffledBucket(s);if(this.calculateBucketShadow(e,t,n,r,a),this.highQualityAccumulationProgressIteration++,this.highQualityAccumulationProgressWeight+=r,performance.now()-i>this.budgetPerFrame)break}this.setIsHighQuality(this.highQualityAccumulationProgressIteration===o.bucketCount),this.highQualityAccumulationProgressNormalized=this.highQualityAccumulationProgressWeight/o.totalBucketWeight}}this.shadowMappingPass.resetMaterialOverrides(),t?this.onShadowRecalculated&&this.onShadowRecalculated(performance.now()-i):(this.totalAccumulationTime+=performance.now()-i,this.onShadowRecalculated&&this.highQualityAccumulationProgressIteration===o.bucketCount&&this.onShadowRecalculated(this.totalAccumulationTime),this.onPlaneUpdated&&Promise.all(this.targetPlanes.map(e=>e.getInfo())).then(e=>{let t=0,i=0;for(let s of e)t+=s.total/this.highQualityAccumulationProgressNormalized,i+=s.average/this.highQualityAccumulationProgressNormalized;this.onPlaneUpdated({total:t,average:i})}))}setSize(e,t){(0,i9.Z)()&&window.devicePixelRatio>=2&&(e=Math.floor(e/2),t=Math.floor(t/2)),this.isPoint&&(e=1,t=1),(e!==this.width||t!==this.height)&&(this.width=e,this.height=t,this.shadowMappingPass.setSize(e,t),this.normalDepthPass.setSize(e,t),this.accumPass.setSize(e,t),this.screenPass.setSize(e,t),this.radiusCoveragePass.setSize(e,t),this.state=b.InMovement)}}(c=y||(y={}))[c.Main=0]="Main",c[c.Overlay=1]="Overlay",c[c.LocationOrb=2]="LocationOrb";class se{constructor(){this.scene=new S.Scene,this.main=new S.Object3D,this.overlay=new S.Object3D,this.locationOrb=new S.Object3D,this.lighting=new S.Object3D,this.main.name="mainScene",this.overlay.name="overlayScene",this.locationOrb.name="locationOrbScene",this.lighting.name="lightingScene",this.scene.add(this.main,this.overlay,this.locationOrb,this.lighting)}setVisibility(e){switch(e){case y.Main:this.main.visible=!0,this.overlay.visible=!1,this.locationOrb.visible=!1;break;case y.Overlay:this.main.visible=!1,this.overlay.visible=!0,this.locationOrb.visible=!1;break;case y.LocationOrb:this.main.visible=!1,this.overlay.visible=!1,this.locationOrb.visible=!0}}}class st extends ik.w2{constructor(e,t){super(),this.needsSwap=!1,this.worldScene=e,this.visibilityMode=t}render(e){e.shadowMap.needsUpdate=this.visibilityMode===y.Main,this.worldScene.setVisibility(this.visibilityMode)}}var si=i(78775),ss=i(18975);class sn extends S.ShaderMaterial{constructor(e=null,t){super({name:"DepthComparisonMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new S.Uniform(null),cameraNear:new S.Uniform(.3),cameraFar:new S.Uniform(1e3)},blending:S.NoBlending,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:"#include <packing>\n#include <clipping_planes_pars_fragment>\n\n#ifdef GL_FRAGMENT_PRECISION_HIGH\n\n	uniform highp sampler2D depthBuffer;\n\n#else\n\n	uniform mediump sampler2D depthBuffer;\n\n#endif\n\nuniform float cameraNear;\nuniform float cameraFar;\n\ncentroid varying float vViewZ;\ncentroid varying vec4 vProjTexCoord;\n\nvoid main() {\n\n	#include <clipping_planes_fragment>\n\n	// Transform into Cartesian coordinates (not mirrored).\n	vec2 projTexCoord = (vProjTexCoord.xy / vProjTexCoord.w) * 0.5 + 0.5;\n	projTexCoord = clamp(projTexCoord, 0.002, 0.998);\n\n	float fragCoordZ = texture2D(depthBuffer, projTexCoord).r;\n\n	float viewZ = perspectiveDepthToViewZ(fragCoordZ, cameraNear, cameraFar);\n\n	float depthTest = (-vViewZ - -viewZ > 0.05) ? 1.0 : 0.0;\n\n	gl_FragColor.rg = vec2(0.0, depthTest);\n\n}\n",vertexShader:"#include <common>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvarying float vViewZ;\nvarying vec4 vProjTexCoord;\n\nvoid main() {\n\n	#include <skinbase_vertex>\n\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n\n	vViewZ = mvPosition.z;\n	vProjTexCoord = gl_Position;\n\n	#include <clipping_planes_vertex>\n\n}\n"}),this.depthBuffer=e,this.depthPacking=S.RGBADepthPacking,this.copyCameraSettings(t),this.depthTest=!0,this.depthWrite=!0}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=S.RGBADepthPacking){this.depthBuffer=e,this.depthPacking=t}adoptCameraSettings(e){this.copyCameraSettings(e)}copyCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof S.PerspectiveCamera?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}}class so extends ik.Qm{constructor(e,t,{blendFunction:i=ik.YQ.SCREEN,patternTexture:s=null,patternScale:n=1,edgeStrength:o=1,pulseSpeed:r=0,visibleEdgeColor:a=0xffffff,hiddenEdgeColor:l=2230538,fillColor:d=0xffe434,kernelSize:h=ik.DD.VERY_SMALL,blur:c=!1,xRay:u=!0,multisampling:p=0,resolutionScale:m=.5,width:g=ik.GV.AUTO_SIZE,height:f=ik.GV.AUTO_SIZE,resolutionX:x=g,resolutionY:w=f}={}){super("OutlineEffect","uniform lowp sampler2D edgeTexture;\nuniform lowp sampler2D maskTexture;\n\nuniform vec3 visibleEdgeColor;\nuniform vec3 hiddenEdgeColor;\nuniform vec3 fillColor;\nuniform float pulse;\nuniform float edgeStrength;\n\n#ifdef USE_PATTERN\n\n	uniform lowp sampler2D patternTexture;\n	varying vec2 vUvPattern;\n\n#endif\n\nvec4 overlayBlend(vec4 bottom, vec4 top) {\n	// Calculate overlay blend for each RGB component:\n	vec3 overlay;\n	overlay.r = (bottom.r < 0.5) ? (2.0 * bottom.r * top.r)\n	: (1.0 - 2.0 * (1.0 - bottom.r) * (1.0 - top.r));\n	overlay.g = (bottom.g < 0.5) ? (2.0 * bottom.g * top.g)\n	: (1.0 - 2.0 * (1.0 - bottom.g) * (1.0 - top.g));\n	overlay.b = (bottom.b < 0.5) ? (2.0 * bottom.b * top.b)\n	: (1.0 - 2.0 * (1.0 - bottom.b) * (1.0 - top.b));\n\n	// Mix the overlay result with the original bottom color according to the top alpha:\n	vec3 resultRGB = mix(bottom.rgb, overlay, top.a);\n\n	// Return the new color with full opacity.\n	return vec4(resultRGB, 1.0);\n}\n\nvoid mainImage(const in vec4 inputColor, const in vec2 uv, out vec4 outputColor) {\n\n	vec2 edge = texture2D(edgeTexture, uv).rg;\n	vec2 mask = texture2D(maskTexture, uv).rg;\n\n	#ifndef X_RAY\n\n		edge.y = 0.0;\n\n	#endif\n\n	edge *= (edgeStrength * mask.x * pulse);\n	vec3 color = edge.x * visibleEdgeColor + edge.y * hiddenEdgeColor;\n\n    if (mask.x < 0.5) {\n        color = vec3(1, 0, 1);\n    }\n\n	float visibilityFactor = 0.0;\n\n	#ifdef USE_PATTERN\n\n		vec4 patternColor = texture2D(patternTexture, vUvPattern);\n\n		#ifdef X_RAY\n\n			float hiddenFactor = 0.5;\n\n		#else\n\n			float hiddenFactor = 0.0;\n\n		#endif\n\n		visibilityFactor = (1.0 - mask.y > 0.0) ? 1.0 : hiddenFactor;\n		visibilityFactor *= (1.0 - mask.x) * patternColor.a;\n		color += visibilityFactor * patternColor.rgb;\n\n	#endif\n\n	float alpha = max(max(edge.x, edge.y), visibilityFactor);\n\n	if (alpha < 0.01 && mask.y < 0.5) {\n		vec4 blended = overlayBlend(inputColor, vec4(fillColor, 0.5));\n\n		color = blended.rgb;\n		alpha = blended.a;\n	}\n\n	#ifdef ALPHA\n\n		// Alpha blending already accounts for input alpha.\n		outputColor = vec4(color, alpha);\n\n	#else\n\n		// Preserve input alpha.\n        outputColor = vec4(color, max(alpha, inputColor.a));\n\n	#endif\n}\n",{uniforms:new Map([["maskTexture",new S.Uniform(null)],["edgeTexture",new S.Uniform(null)],["edgeStrength",new S.Uniform(o)],["visibleEdgeColor",new S.Uniform(new S.Color(a))],["hiddenEdgeColor",new S.Uniform(new S.Color(l))],["fillColor",new S.Uniform(new S.Color(d))],["pulse",new S.Uniform(1)],["patternScale",new S.Uniform(n)],["patternTexture",new S.Uniform(null)]])}),this.time=0,this.forceUpdate=!0,this.selection=new ik.Y1,this.selection.layer=10,this.blendMode.addEventListener("change",()=>{this.blendMode.blendFunction===ik.YQ.ALPHA?this.defines.set("ALPHA","1"):this.defines.delete("ALPHA"),this.setChanged()}),this.blendMode.blendFunction=i,this.patternTexture=s,this.xRay=u,this.scene=e,this.camera=t,this.renderTargetMask=new S.WebGLRenderTarget(1,1),this.renderTargetMask.samples=p,this.renderTargetMask.texture.name="Outline.Mask",this.uniforms.get("maskTexture").value=this.renderTargetMask.texture,this.renderTargetOutline=new S.WebGLRenderTarget(1,1,{depthBuffer:!1}),this.renderTargetOutline.texture.name="Outline.Edges",this.uniforms.get("edgeTexture").value=this.renderTargetOutline.texture,this.clearPass=new ik.$p,this.clearPass.overrideClearColor=new S.Color(0),this.clearPass.overrideClearAlpha=1,this.maskPass=new ik.CD(e,t,new sn(new S.Texture,t));let b=this.maskPass.clearPass;b.overrideClearColor=new S.Color(0xffffff),b.overrideClearAlpha=1,this.blurPass=new ik.ki({resolutionScale:m,resolutionX:x,resolutionY:w,kernelSize:h}),this.blurPass.enabled=c,this.blurPass.resolution.addEventListener("change",()=>this.setSize(this.blurPass.resolution.baseWidth,this.blurPass.resolution.baseHeight)),this.outlinePass=new ik.Cw(new ik.eh),this.outlinePass.fullscreenMaterial.inputBuffer=this.renderTargetMask.texture,this.pulseSpeed=r}set mainScene(e){this.scene=e,this.maskPass.mainScene=e}set mainCamera(e){this.camera=e,this.maskPass.mainCamera=e,this.maskPass.overrideMaterial.copyCameraSettings(e)}get resolution(){return this.blurPass.resolution}getResolution(){return this.blurPass.getResolution()}get multisampling(){return this.renderTargetMask.samples}set multisampling(e){this.renderTargetMask.samples=e,this.renderTargetMask.dispose()}get patternScale(){return this.uniforms.get("patternScale").value}set patternScale(e){this.uniforms.get("patternScale").value=e}get edgeStrength(){return this.uniforms.get("edgeStrength").value}set edgeStrength(e){this.uniforms.get("edgeStrength").value=e}get visibleEdgeColor(){return this.uniforms.get("visibleEdgeColor").value}set visibleEdgeColor(e){this.uniforms.get("visibleEdgeColor").value=e}get hiddenEdgeColor(){return this.uniforms.get("hiddenEdgeColor").value}set hiddenEdgeColor(e){this.uniforms.get("hiddenEdgeColor").value=e}getBlurPass(){return this.blurPass}getSelection(){return this.selection}getPulseSpeed(){return this.pulseSpeed}setPulseSpeed(e){this.pulseSpeed=e}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get selectionLayer(){return this.selection.layer}set selectionLayer(e){this.selection.layer=e}get dithering(){return this.blurPass.dithering}set dithering(e){this.blurPass.dithering=e}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(e){this.blurPass.kernelSize=e}get blur(){return this.blurPass.enabled}set blur(e){this.blurPass.enabled=e}get xRay(){return this.defines.has("X_RAY")}set xRay(e){this.xRay!==e&&(e?this.defines.set("X_RAY","1"):this.defines.delete("X_RAY"),this.setChanged())}isXRayEnabled(){return this.xRay}setXRayEnabled(e){this.xRay=e}get patternTexture(){return this.uniforms.get("patternTexture").value}set patternTexture(e){null!==e?(e.wrapS=e.wrapT=S.RepeatWrapping,this.defines.set("USE_PATTERN","1"),this.setVertexShader("uniform float patternScale;\n\nvarying vec2 vUvPattern;\n\nvoid mainSupport(const in vec2 uv) {\n\n	vUvPattern = uv * vec2(aspect, 1.0) * patternScale;\n\n}\n")):(this.defines.delete("USE_PATTERN"),this.setVertexShader(null)),this.uniforms.get("patternTexture").value=e,this.setChanged()}setPatternTexture(e){this.patternTexture=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}setSelection(e){return this.selection.set(e),this}clearSelection(){return this.selection.clear(),this}selectObject(e){return this.selection.add(e),this}deselectObject(e){return this.selection.delete(e),this}update(e,t,i){this.maskPass.overrideMaterial.setDepthBuffer(t.depthTexture),this.maskPass.overrideMaterial.copyCameraSettings(this.camera);let s=this.scene,n=this.camera,o=this.selection,r=this.uniforms.get("pulse"),a=s.background,l=n.layers.mask;this.forceUpdate||o.size>0?(s.background=null,r.value=1,this.pulseSpeed>0&&(r.value=.375*Math.cos(this.time*this.pulseSpeed*10)+.625),this.time+=i,o.setVisible(!1),o.setVisible(!0),n.layers.set(o.layer),this.maskPass.render(e,this.renderTargetMask,null),n.layers.mask=l,s.background=a,this.outlinePass.render(e,null,this.renderTargetOutline),this.blurPass.enabled&&this.blurPass.render(e,this.renderTargetOutline,this.renderTargetOutline)):(e.setRenderTarget(this.renderTargetMask),e.setClearColor(new S.Color(0xffffff),1),e.clear(!0,!0,!0),e.setClearColor(new S.Color(0),1)),this.forceUpdate=o.size>0}setSize(e,t){this.blurPass.setSize(e,t),this.renderTargetMask.setSize(e,t);let i=this.resolution;i.setBaseSize(e,t);let s=i.width,n=i.height;this.renderTargetOutline.setSize(s,n),this.outlinePass.fullscreenMaterial.setSize(s,n)}initialize(e,t,i){this.blurPass.initialize(e,t,S.UnsignedByteType),void 0!==i&&(this.maskPass.initialize(e,t,i),this.outlinePass.initialize(e,t,i))}}var sr=i(62303);let sa=-64;class sl{constructor(e,t,i,s,n,o,r,a,l,d,h,c){this.aaQuality="disabled",this.enableOutline=!1,this.ssaoEnabled=!1,this.enableShadowAccumulation=!1,this.enableStudioDrawingMode=!1,this.renderer=e,this.worldScene=i,this.onSceneUpdated=h,this.composer=new ik.xC(e),this.scenePass=new ik.CD(i.scene,t),this.scenePass.clearPass.enabled=!1,this.scenePass.clear=!0,this.scenePass.needsSwap=!1,this.overlayScenePass=new ik.CD(i.scene,t),this.overlayScenePass.clearPass.enabled=!1,this.overlayScenePass.clear=!1,this.overlayScenePass.needsSwap=!1,this.locationOrbScenePass=new ik.CD(i.scene,t),this.locationOrbScenePass.clearPass.enabled=!1,this.locationOrbScenePass.clear=!1,this.locationOrbScenePass.needsSwap=!1,this.copyPass=new ik.KM,this.outlineEffect=new so(i.scene,t,{blendFunction:ik.YQ.ALPHA,visibleEdgeColor:0xd5d520,hiddenEdgeColor:0xd5d520,fillColor:0xffe434,edgeStrength:20}),this.outlinePass=new ik.H5(t,this.outlineEffect),this.fxaaPass=new ik.H5(t,new ik.Ln),this.smaaPass=new ik.H5(t,new ik.fY),d&&(this.screenAnalyticsPass=new i6(e,i.scene,t,r,s,n,o,!1),this.pointAnalyticsPass=new i6(e,i.scene,t,r,s,n,o,!0),this.analyticsSampling=new ss.Z({cursorManager:l,renderer:e,controls:n,analyticsPass:this.screenAnalyticsPass,calculateAnalyticsMonths:(e,t,i)=>{this.startRenderAnalyticsPoint(e,t,i)},stopAnalyticsMonths:()=>{this.finishRenderAnalyticsPoint()},onSceneUpdated:this.onSceneUpdated,onCrosshairChange:c})),this.n8aoPass=new iQ.A(i.scene,t),this.n8aoPass.configuration.gammaCorrection=!1,this.n8aoPass.configuration.aoRadius=10,this.n8aoPass.configuration.intensity=1.15,this.n8aoPass.configuration.halfRes=!0,this.n8aoPass.setQualityMode("Low")}setAAQuality(e){this.aaQuality=e,this.updateChain()}setOutlineEnabled(e){this.enableOutline=!0,this.updateChain()}setShadowAccumulation(e){this.enableShadowAccumulation=e,this.analyticsSampling&&this.analyticsSampling.onAnalyticsToggle(e),this.updateChain()}setStudioDrawingMode(e){this.enableStudioDrawingMode=e,this.updateChain()}setSSAO(e){this.ssaoEnabled=e,this.updateChain()}startRenderAnalyticsPoint(e,t,i){++this.pointAnalyticsPass.monthlyRenderProgress.id,this.pointAnalyticsPass.monthlyRenderProgress.stage="requested",this.pointAnalyticsPass.monthlyRenderProgress.results=[],this.pointAnalyticsPass.monthlyRenderProgress.position.set(e,t),this.pointAnalyticsPass.monthlyRenderProgress.onUpdate=i,this.updateChain()}finishRenderAnalyticsPoint(){"done"!==this.pointAnalyticsPass.monthlyRenderProgress.stage&&(this.pointAnalyticsPass.monthlyRenderProgress.stage="done",this.updateChain())}updateChain(){let e=8*("msaa"===this.aaQuality),t=this.renderer.capabilities.maxSamples;this.composer.multisampling=Math.min(e,t),this.composer.inputBuffer.depthTexture||(this.composer.inputBuffer.depthTexture=new S.DepthTexture(1,1,S.FloatType)),this.composer.passes=[];let i=this.enableShadowAccumulation&&!this.enableStudioDrawingMode;for(let e of(this.screenAnalyticsPass&&this.composer.addPass(new sr.Z(()=>{this.screenAnalyticsPass.updatePlanesRenderMode(i)})),this.composer.addPass(new st(this.worldScene,y.Main)),this.composer.addPass(this.scenePass),this.ssaoEnabled&&i&&this.composer.addPass(this.n8aoPass),i&&(this.composer.addPass(this.screenAnalyticsPass),"done"!==this.pointAnalyticsPass.monthlyRenderProgress.stage&&this.composer.addPass(this.pointAnalyticsPass)),this.composer.addPass(this.outlinePass),this.composer.addPass(new st(this.worldScene,y.Overlay)),this.composer.addPass(this.overlayScenePass),this.ssaoEnabled&&!i&&this.composer.addPass(this.n8aoPass),this.composer.addPass(new si.Z),this.composer.addPass(new st(this.worldScene,y.LocationOrb)),this.composer.addPass(this.locationOrbScenePass),"fxaa"!==this.aaQuality&&"smaa"!==this.aaQuality&&this.composer.addPass(this.copyPass),"fxaa"===this.aaQuality&&this.composer.addPass(this.fxaaPass),"smaa"===this.aaQuality&&this.composer.addPass(this.smaaPass),this.composer.passes))e.renderToScreen=!1;let s=this.composer.passes[this.composer.passes.length-1];s.renderToScreen=!0,s===this.locationOrbScenePass&&(this.overlayScenePass.renderToScreen=!0,this.scenePass.renderToScreen=!0)}render(e){this.composer.render(e),this.pointAnalyticsPass&&"done"===this.pointAnalyticsPass.monthlyRenderProgress.stage&&this.finishRenderAnalyticsPoint()}update(){this.analyticsSampling&&this.analyticsSampling.onRender()}setSize(e,t){this.composer.setSize(e,t)}shouldRenderNextFrameForAnalytics(){return!!this.screenAnalyticsPass&&!!this.pointAnalyticsPass&&(this.composer.passes.includes(this.screenAnalyticsPass)&&this.screenAnalyticsPass.shouldRenderNextFrame()||"done"!==this.pointAnalyticsPass.monthlyRenderProgress.stage)}}var sd=i(73089),sh=i(59218),sc=i(16967),su=i(91941),sp=i(69775),sm=i(77469);class sg extends tj.m{constructor({parent:e,camera:t,renderer:s,prepareMaterial:n,visualQualitySettings:o,onSceneUpdated:r,loadingStateManager:a}){super({camera:t,parent:e,visualQualitySettings:o}),this.numTilesLoading=0,this.compressor=new su.Z,this.basicShadingMode=!1,this.renderer=s,this.loadingStateManager=a,this.onSceneUpdated=r,this.prepareMaterial=n,this.initTilesRenderer(),this.tree3D=new sp.Z,this.patcher=new Worker(new URL(i.p+i.u(871),i.b))}getAttribution(){return this.tilesRenderer.getCreditsString()}async patchGeometryNormals(e,t){let i=e.getAttribute("position"),s=e.getAttribute("uv"),n=e.getIndex();if(!s)return e.dispose(),Promise.resolve({geometry:new S.BufferGeometry,is3DTile:!1});let o=i.array,r=s.array,a=n.array,l=Math.random();return this.patcher.postMessage({taskId:l,positionArray:o,uvArray:r,indexArray:a,groundNormal:t},[o.buffer,r.buffer,a.buffer]),new Promise(t=>{let i=s=>{if(s.data.taskId!==l)return;this.patcher.removeEventListener("message",i),e.dispose();let n=new S.BufferGeometry;n.setAttribute("position",new S.BufferAttribute(s.data.positionArray,3)),n.setAttribute("uv",new S.BufferAttribute(s.data.uvArray,2)),n.setAttribute("normal",new S.BufferAttribute(s.data.normalArray,3)),t({geometry:n,is3DTile:s.data.is3DTile})};this.patcher.addEventListener("message",i)})}finalize(){}onTileLoadingStarted(){this.numTilesLoading++,this.numTilesLoading>0&&this.loadingStateManager.set(m.GOOGLE_TILES_3D,!0)}onTileLoadingFinished(){this.numTilesLoading--,0===this.numTilesLoading&&this.loadingStateManager.set(m.GOOGLE_TILES_3D,!1)}initTilesRenderer(){this.dracoLoader=new V._,this.dracoLoader.setDecoderConfig({type:"wasm"}),this.dracoLoader.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.6/");let e=this;class t extends sh.i{async parseTile(t,i,s){e.onTileLoadingStarted();try{await super.parseTile(t,i,s),await e.prepareTileModel(i.cached,[i.boundingVolume.box[0],i.boundingVolume.box[1],i.boundingVolume.box[2]],i.__depthFromRenderedParent),e.onSceneUpdated()}finally{e.onTileLoadingFinished()}}}this.tilesRenderer=new t(window.SHADOWMAP.GOOGLE_TILES_API_KEY),this.tilesRenderer.setCamera(this.camera),this.tilesRenderer.setResolutionFromRenderer(this.camera,this.renderer),this.tilesRenderer.errorTarget=50,this.tilesRenderer.displayActiveTiles=!0,this.tilesRenderer.autoDisableRendererCulling=!1;let i=()=>{this.tilesRenderer.errorTarget=this.visualQualitySettings.get("TILE_3D_GOOGLE_ERROR_TARGET"),this.tilesRenderer.lruCache.minSize=this.visualQualitySettings.get("TILE_3D_GOOGLE_CACHE_MIN_SIZE"),this.tilesRenderer.lruCache.maxSize=this.visualQualitySettings.get("TILE_3D_GOOGLE_CACHE_MAX_SIZE"),setTimeout(()=>this.onWindowResize(),0)};this.visualQualitySettings.subscribe("TILE_3D_GOOGLE_ERROR_TARGET",i,!0),this.visualQualitySettings.subscribe("MAX_PIXEL_RATIO",i);let s=new tS.E(this.tilesRenderer.manager);s.setDRACOLoader(this.dracoLoader),this.tilesRenderer.manager.addHandler(/path\.gltf/,s);let n=new S.Object3D;n.add(this.tilesRenderer.group),this.parent.add(n);let o=B.Z.latLngToMeters({lat:40.71984155208661,lng:-74.00013243531752}),r=B.Z.getMercatorScaleFactor(40.71984155208661);this.tilesRenderer.setLatLonToYUp(S.MathUtils.degToRad(40.71984155208661),S.MathUtils.degToRad(-74.00013243531752)),n.rotation.z=Math.PI/2,n.rotation.y=Math.PI/2,n.position.set(o.x,o.y,0),n.scale.set(r,r,r),setInterval(()=>{this.tilesRenderer.resetFailedTiles()},5e3),this.tilesRenderer.onTileVisibilityChange=(e,t,i)=>{let s=e.userData.is3DTile;if(void 0===s)return;let n=t.boundingVolume.box,{lat:o,lng:r}=B.Z.EPSG4978ToLatLng({x:n[0],y:n[1],z:n[2]});if(i){let t={minX:r-1e-5,minY:o-1e-5,maxX:r+1e-5,maxY:o+1e-5,value:s};this.tree3D.insert(t),e.userData.treeNode=t}else e.userData.treeNode&&this.tree3D.remove(e.userData.treeNode)}}isNear3DTiles(e){let{lat:t,lng:i}=B.Z.metersToLatLng(e);return(0,sm.Z)(this.tree3D,i,t,4).filter(e=>e.value).length>=2}async compressTexture(e){if(!su.Z.isCompressionSupported(this.renderer))return e.encoding=iI.knz,e.generateMipmaps=!1,e.needsUpdate=!0,e;let t=await this.compressor.compress({bitmap:e.image});return e.dispose(),t.encoding=iI.knz,t.generateMipmaps=!1,t.needsUpdate=!0,t}async prepareTileModel(e,t,i){let{scene:s}=e,n=[];return s.traverse(s=>{if(s instanceof S.Mesh){s.castShadow=!0,s.receiveShadow=!0;let o=s.material;s.material=new S.MeshBasicMaterial;let r=i>=15?new S.Vector3(t[0],t[1],t[2]).normalize():void 0,a=this.patchGeometryNormals(s.geometry,r),l=o.map?this.compressTexture(o.map):Promise.resolve(null);n.push(Promise.all([a,l]).then(([{geometry:t,is3DTile:i},n])=>{if(o.dispose(),s.material.dispose(),o.map?.dispose(),!e.geometry){t.dispose(),n&&n.dispose();return}s.geometry=t;let r=new S.MeshStandardMaterial({map:n,color:0xffffff,roughness:.9,metalness:0,toneMapped:!0}),a=new S.MeshBasicMaterial({map:n,color:0xffffff,toneMapped:!0});s.material=this.basicShadingMode?a:r,s.userData.materials={standard:r,basic:a},this.prepareMaterial(s.material),s.layers.enable(D.OB),e.geometry.push(t),e.materials.push(a,r),n&&e.textures.push(n)}))}}),Promise.all(n)}async initGeoid(){let e=await fetch("/google-3d-tiles/egm96.tif").then(e=>e.arrayBuffer()),t=await (0,sc.go)(e),i=await t.getImage();this.geoidData=await i.readRasters(),this.onSceneUpdated()}sampleGeoid(e,t){if(!this.geoidData)return 0;let{width:i,height:s}=this.geoidData,n=this.geoidData[0],o=Math.floor((t+180)/360*i);return n[Math.floor((-e+90)/180*s)*i+o]}onWindowResize(){this.tilesRenderer.setResolutionFromRenderer(this.camera,this.renderer)}update(e){if(!this.enabled)return;let{lat:t,lng:i}=B.Z.metersToLatLng(e);this.tilesRenderer.setLatLonToYUp(S.MathUtils.degToRad(t),S.MathUtils.degToRad(i));let s=B.Z.latLngToMeters({lat:t,lng:i}),n=B.Z.getMercatorScaleFactor(t),o=this.tilesRenderer.group.parent,r=this.sampleGeoid(t,i);o.rotation.z=Math.PI/2,o.rotation.y=Math.PI/2,o.position.set(s.x,s.y,-r*n),o.scale.set(n,n,n),this.tilesRenderer.update()}toggleBasicShadingMode(e){this.basicShadingMode=e,this.tilesRenderer.group.traverse(e=>{e instanceof S.Mesh&&e.userData.materials&&(e.material=this.basicShadingMode?e.userData.materials.basic:e.userData.materials.standard)})}enable(){super.enable(),this.geoidData||this.initGeoid(),this.tilesRenderer.group.visible=!0}disable(){super.disable(),this.tilesRenderer.group.visible=!1,(0,i9.g)()&&this.tilesRenderer.dispose()}}var sf=i(15337),sx=i(9625);let sw=new S.SphereGeometry(6,24,24,0,2*Math.PI,.5*Math.PI);sw.rotateX(-Math.PI/2);let sb=new S.CircleGeometry(6,24),sv=tT.n4([sw,sb]);sv.clearGroups(),sv.addGroup(0,1/0,0),sv.addGroup(0,1/0,1);let sy="#f8f991";class sC extends S.Object3D{constructor(e){super(),this.hoverTargetValue=0,this.hoverCurrentValue=0,this.needsRender=!1,this.textGenerator=e,this.hemisphere=new S.Mesh(sv,[sC.hemisphereMaterialColor,sC.hemisphereMaterialDepth]),this.add(this.hemisphere);let t=e.createBillboardMaterial(0);t.color=new S.Color(3358797),this.text=new S.Mesh(e.createGeometry("00:00"),t),this.text.scale.set(3,3,3),this.text.position.z+=2,this.add(this.text),this.subtextTemp=new S.Mesh(e.createGeometry("AM"),t)}setRenderOrder(e){this.hemisphere.renderOrder=10*e+1,this.text.renderOrder=10*e+2}setTime(e){eD(this.textGenerator,e,this.text,this.subtextTemp)}checkIntersection(e){return e.intersectObject(this.hemisphere).length>0}toggleHoverState(e){let t=+!!e;this.hoverTargetValue!==t&&(this.hoverTargetValue=t,this.hoverTween&&this.hoverTween.stop(),this.hoverTween=new C.kX({factor:this.hoverCurrentValue}).to({factor:t},250).easing(C.oY.Cubic.Out).onUpdate(({factor:e})=>{sC.hemisphereMaterialColor.color.set(new S.Color(sy).lerp(new S.Color("#ffffb4"),e)),this.hemisphere.scale.setScalar(S.MathUtils.lerp(1,1.2,e)),this.hoverCurrentValue=e,this.needsRender=!0}).start())}}sC.hemisphereMaterialColor=new S.MeshBasicMaterial({color:new S.Color(sy),depthTest:!1,depthWrite:!1,toneMapped:!1}),sC.hemisphereMaterialDepth=new S.MeshBasicMaterial({depthTest:!0,depthWrite:!0,colorWrite:!1});let sM="#f8f991";class sS extends S.Object3D{constructor(e,t){super(),this.hoverTargetValue=0,this.hoverCurrentValue=0,this.needsRender=!1,this.textGeneratorDay=e,this.textGeneratorNight=t,this.activeTextGenerator=e,sS.sphereMaterialColor.onBeforeCompile=e=>{e.fragmentShader=`varying vec3 vViewNormal;
varying vec3 vViewDir;
varying vec3 vWorldPosition;
`+e.fragmentShader,e.vertexShader=`varying vec3 vViewNormal;
varying vec3 vViewDir;
varying vec3 vWorldPosition;
`+e.vertexShader,e.fragmentShader=e.fragmentShader.replace("#include <map_fragment>",`
                vec3 colorInner = vec3(0.2, 0.25, 0.3); // #33404D
                vec3 colorOuter = vec3(0.42745098039215684, 0.7529411764705882, 0.7372549019607844); // #6DC0BC
                vec3 colorDay = diffuse;
                float normalDot = dot(vViewNormal, vViewDir);
                normalDot = smoothstep(0.45, 0.5, normalDot);
                diffuseColor = vec4(mix(colorOuter, colorInner, normalDot), 1.0);

                if (vWorldPosition.z > 0.) diffuseColor.rgb = colorDay;
                `),e.vertexShader=e.vertexShader.replace("#include <project_vertex>",`
                #include <project_vertex>
                vViewNormal = normalize(vec3(modelViewMatrix * vec4(normal, 0.0)));
                vViewDir = normalize(-(modelViewMatrix * vec4(position, 1.0)).xyz);
                vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;
                `)},this.sphere=new S.Mesh(new S.IcosahedronGeometry(6,4),[sS.sphereMaterialColor,sS.sphereMaterialDepth]),this.add(this.sphere),this.sphere.geometry.clearGroups(),this.sphere.geometry.addGroup(0,1/0,0),this.sphere.geometry.addGroup(0,1/0,1),this.flare=new S.Sprite(new S.SpriteMaterial({map:new S.TextureLoader().load("/sun-flare.png"),transparent:!1,depthTest:!1,depthWrite:!1,toneMapped:!1,...eb.a})),this.flare.scale.set(40,40,1),this.add(this.flare),this.flare.material.onBeforeCompile=e=>{e.uniforms.hoverFactor={value:0},e.fragmentShader=`uniform float hoverFactor;
`+e.fragmentShader,e.fragmentShader=e.fragmentShader.replace("#include <map_fragment>",`diffuseColor *= texture2D( map, vMapUv );
                diffuseColor.a = clamp(diffuseColor.a * (1. + hoverFactor * 0.2), 0.0, 1.0);`),this.flareShader=e};let i=this.activeTextGenerator.createBillboardMaterial(0);i.color=new S.Color(3358797),this.text=new S.Mesh(this.activeTextGenerator.createGeometry("00:00"),i),this.text.scale.set(3.5,3.5,3.5),this.add(this.text),this.subtextTemp=new S.Mesh(this.activeTextGenerator.createGeometry("AM"),i)}setRenderOrder(e){this.flare.renderOrder=10*e,this.sphere.renderOrder=10*e+1,this.text.renderOrder=10*e+2}setTime(e){this.lastTime=e,eD(this.activeTextGenerator,e,this.text,this.subtextTemp)}onPositionUpdate(){let e=this.position.z>=0?this.textGeneratorDay:this.textGeneratorNight;this.activeTextGenerator!==e&&(this.activeTextGenerator=e,this.text.material=this.activeTextGenerator.createBillboardMaterial(0)),this.text.material.setColor(this.position.z<0?7192764:3358797),this.flare.material.opacity=S.MathUtils.clamp(.25*this.position.z,0,1)}checkIntersection(e){return e.intersectObject(this.sphere).length>0}getPositionScreenSpace(e){let t=this.sphere.position.clone();return t.applyMatrix4(this.sphere.matrixWorld),t.project(e),new S.Vector2((t.x+1)/2*window.innerWidth,(-t.y+1)/2*window.innerHeight)}getRadiusScreenSpace(e){return function(e,t,i){let s=new S.Vector3;e.matrixWorld.decompose(new S.Vector3,new S.Quaternion,s),e.geometry.boundingSphere||e.geometry.computeBoundingSphere();let n=e.geometry.boundingSphere.radius*Math.max(s.x,s.y,s.z),o=e.position.clone();o.applyMatrix4(e.matrixWorld);let r=Math.abs(o.applyMatrix4(t.matrixWorldInverse).z);return i/2*Math.atan(n/r)/Math.tan(S.MathUtils.degToRad(t.fov)/2)}(this.sphere,e,window.innerHeight)}toggleHoverState(e){let t=+!!e;this.hoverTargetValue!==t&&(this.hoverTargetValue=t,this.hoverTween&&this.hoverTween.stop(),this.hoverTween=new C.kX({factor:this.hoverCurrentValue}).to({factor:t},250).easing(C.oY.Cubic.Out).onUpdate(({factor:e})=>{sS.sphereMaterialColor.color.set(new S.Color(sM).lerp(new S.Color("#ffffb4"),e)),this.sphere.scale.setScalar(S.MathUtils.lerp(1,1.2,e)),this.flareShader&&(this.flareShader.uniforms.hoverFactor.value=e),this.hoverCurrentValue=e,this.needsRender=!0}).start())}}sS.sphereMaterialColor=new S.MeshBasicMaterial({color:new S.Color(sM),depthTest:!1,depthWrite:!1,toneMapped:!1}),sS.sphereMaterialDepth=new S.MeshBasicMaterial({depthTest:!0,depthWrite:!0,colorWrite:!1});var sL=i(61845),sT=i(49994);class sj extends S.Object3D{constructor({color:e,radius:t,isDashed:i,dashSize:s,lineWidth:n,clampZ:o}){super(),this.isLineValid=!1,this.plane=new S.Plane,this.radius=t,this.isDashed=i,this.dashSize=s,this.clampZ=o;let r=new iC.Y({color:e,linewidth:n,vertexColors:!1,depthTest:!1,depthWrite:!1,toneMapped:!1,colorWrite:!0}),a=new iC.Y({color:e,linewidth:n,vertexColors:!1,depthTest:!0,depthWrite:!0,toneMapped:!1,colorWrite:!1});i?(this.lineColor=new sL.w(new sT.z,r),this.lineDepth=new sL.w(this.lineColor.geometry,a)):(this.lineColor=new iS.w(new iM.L,r),this.lineDepth=new iS.w(this.lineColor.geometry,a)),this.add(this.lineColor,this.lineDepth),this.lineColor.renderOrder=10,this.lineDepth.renderOrder=10}setRenderOrder(e){this.lineColor.renderOrder=10+.1*e,this.lineDepth.renderOrder=10+.1*e}updatePath(e,t,i,s){if(this.isDashed){this.lineColor.geometry.dispose(),this.lineColor.geometry=this.lineDepth.geometry=new sT.z;let n=eE(e,t,64,this.radius,i,s,this.clampZ);if(n.length<6){this.isLineValid=!1;return}let o=eE(e,t,2*Math.round((e=>{let t=0;for(let i=0;i<e.length-3;i+=3)t+=new S.Vector3(e[i],e[i+1],e[i+2]).distanceTo(new S.Vector3(e[i+3],e[i+4],e[i+5]));return t})(n)/this.dashSize/2),this.radius,i,s,this.clampZ);if(o.length<9){this.isLineValid=!1;return}o.length%6!=0&&(o=o.slice(0,o.length-o.length%6)),this.lineColor.geometry.setPositions(o),this.lineColor.computeLineDistances(),this.lineDepth.computeLineDistances(),this.positions=o}else{this.lineColor.geometry.dispose(),this.lineColor.geometry=this.lineDepth.geometry=new iM.L;let n=eE(e,t,64,this.radius,i,s,this.clampZ);if(n.length<9){this.isLineValid=!1;return}this.lineColor.geometry.setPositions(n),this.positions=n}this.isLineValid=!0,this.updatePlane()}updatePlane(){let e=new S.Vector3(this.positions[0],this.positions[1],this.positions[2]),t=new S.Vector3(this.positions[3],this.positions[4],this.positions[5]),i=new S.Vector3(this.positions[6],this.positions[7],this.positions[8]);e.applyMatrix4(this.matrixWorld),t.applyMatrix4(this.matrixWorld),i.applyMatrix4(this.matrixWorld);let s=(e=>{let t=new S.Vector3(0,0,0);for(let i=0;i<e.length;i++){let s=e[i],n=e[(i+1)%e.length];t.x+=(s.y-n.y)*(s.z+n.z),t.y+=(s.z-n.z)*(s.x+n.x),t.z+=(s.x-n.x)*(s.y+n.y)}return t.normalize(),t})([e,t,i]);this.plane.setFromNormalAndCoplanarPoint(s,e)}getDistanceFromCamera(e){if(!this.isLineValid)return null;let t=new S.Vector3;return(e.intersectPlane(this.plane,t),t)?t.distanceTo(e.origin):null}getStartPosition(){return this.isLineValid?new S.Vector3(this.positions[0],this.positions[1],this.positions[2]):null}getEndPosition(){return this.isLineValid?new S.Vector3(this.positions[this.positions.length-3],this.positions[this.positions.length-2],this.positions[this.positions.length-1]):null}checkHover(e,t,i,s){if(!this.positions||!this.isLineValid)return!1;let n=[];for(let t=0;t<this.positions.length;t+=3){let s=new S.Vector3(this.positions[t],this.positions[t+1],this.positions[t+2]);s.applyMatrix4(this.matrixWorld),s.project(e),s.x=(s.x+1)*i.x/2,s.y=(-s.y+1)*i.y/2,s.z=0,n.push(s)}let o=new S.Line3,r=new S.Vector3,a=new S.Vector3(t.x,t.y,0);for(let e=1;e<n.length;e++)if(o.start=n[e-1],o.end=n[e],o.closestPointToPoint(a,!0,r),r.distanceTo(a)<s)return!0;return!1}onResize(e,t){this.lineColor.material.resolution.set(e,t),this.lineDepth.material.resolution.set(e,t)}setVisibility(e){let t=this.visible!==e;return this.visible=e,t}findClosestPointOnPath(e){if(!this.isLineValid)return null;let t=new S.Vector3().copy(e.ray.origin).add(e.ray.direction);t.project(e.camera),t.z=0;let i=[];for(let t=0;t<this.positions.length;t+=3){let s=new S.Vector3(this.positions[t],this.positions[t+1],this.positions[t+2]);s.applyMatrix4(this.matrixWorld),s.project(e.camera),s.z=0,i.push(s)}let s=new S.CatmullRomCurve3(i),n=function(e,t,i,s){let n=0,o=1/0,r=0,a=1;for(let i=0;i<3;i++){let i=(a-r)/49,s=r,l=1/0;for(let n=0;n<50;n++){let o=r+n*i,a=e.getPoint(o).distanceToSquared(t);a<l&&(l=a,s=o)}l<o&&(o=l,n=s);let d=(a-r)*i;r=Math.max(0,s-d/2),a=Math.min(1,s+d/2)}return n}(s,t,0,50),o=s.getPoint(n).distanceTo(t);return{progress:n,distance:o}}}let sP=(e,t="en")=>{switch(e){case"N":return{angle:0,label:"N"};case"NE":return{angle:45,label:"de"===t?"NO":"NE"};case"E":return{angle:90,label:"de"===t?"O":"E"};case"SE":return{angle:135,label:"de"===t?"SO":"SE"};case"S":return{angle:180,label:"S"};case"SW":return{angle:225,label:"SW"};case"W":return{angle:270,label:"W"};case"NW":return{angle:315,label:"NW"};default:return null}};class sE extends S.Object3D{constructor({radius:e,width:t,textGenerator:i,iconGenerator:s,lang:n,arrowDirection:o}){super(),this.radius=e,this.width=t;let r=new iS.w(new iM.L,sE.lineMaterial);r.geometry.setPositions(((e,t)=>{let i=Array(3*t);for(let s=0;s<t+1;s++){let n=s/t*Math.PI*2;i[3*s]=Math.cos(n)*e,i[3*s+1]=Math.sin(n)*e,i[3*s+2]=0}return i})(e,80)),this.add(r);let a=new S.Mesh(new S.RingGeometry(e,e+t,80),sE.ringMaterial);this.add(a);let l=sE.createText(e+.5*t,i,t/10,n);this.add(l);let d=new S.Mesh(sE.createNotchesGeometry(e+.5*t,.6,.4*t),sE.notchMaterial);this.add(d);let h=new S.Mesh(new S.CircleGeometry(5.25,24),sE.centerPointOuterMaterial);this.add(h),this.centerPoint=new S.Mesh(new S.CircleGeometry(3,24),sE.centerPointMaterialDynamic),this.centerPoint.geometry.clearGroups(),this.centerPoint.geometry.addGroup(0,1/0,0),this.centerPoint.geometry.addGroup(0,1/0,1),this.centerPoint.receiveShadow=!0,this.add(this.centerPoint),this.sunAzimuthLine=new iS.w(new iM.L,sE.azimuthLineMaterial),this.sunAzimuthLine.geometry.setPositions([0,0,0,e,0,0]),this.add(this.sunAzimuthLine),this.sunAzimuthDot=new S.Mesh(new S.CircleGeometry(2,24),sE.azimuthDotMaterial),this.add(this.sunAzimuthDot),this.sunAzimuthDotOuter=new S.Mesh(new S.CircleGeometry(3,24),sE.centerPointOuterMaterial),this.add(this.sunAzimuthDotOuter);let c=sP(o,n);if(c){this.arrowDirectionAngle=c.angle;let n=e+t,o=new S.PlaneGeometry(11,n);o.translate(0,n/2,0);let r=new S.CircleGeometry(5.5,24,Math.PI,2*Math.PI),a=new S.BufferGeometry,l=new Float32Array([-5.5,0,0,5.5,0,0,0,5.5,0]);a.setAttribute("position",new S.BufferAttribute(l,3)),a.setAttribute("normal",new S.BufferAttribute(new Float32Array([0,0,1,0,0,1,0,0,1]),3)),a.setAttribute("uv",new S.BufferAttribute(new Float32Array([0,0,1,0,.5,1]),2)),a.setIndex(new S.BufferAttribute(new Uint16Array([0,1,2]),1)),a.translate(0,n,0);let d=tT.n4([o,r,a]),h=new S.MeshBasicMaterial({color:0xffe434,opacity:.9,depthTest:!1,depthWrite:!1,toneMapped:!1,...eb.a}),u=new S.Mesh(d,h);this.add(u),u.rotation.z=S.MathUtils.degToRad(-c.angle);let p=sE.createArrowText(e+.5*t,c.angle,c.label,i,t/10);this.add(p),u.renderOrder=7.5,p.renderOrder=7.6;let m=s.createGeometry("@");m.scale(8,8,8);let g=s.createMaterial();g.color=new S.Color(1118481);let f=new S.Mesh(m,g);f.renderOrder=10,f.position.set(.8*n*Math.cos(S.MathUtils.degToRad(-c.angle+90)),.8*n*Math.sin(S.MathUtils.degToRad(-c.angle+90)),0),f.rotation.z=S.MathUtils.degToRad(-c.angle+180),this.add(f)}a.renderOrder=1,r.renderOrder=2,d.renderOrder=3,l.renderOrder=4,this.sunAzimuthLine.renderOrder=5,this.sunAzimuthDotOuter.renderOrder=6,this.sunAzimuthDot.renderOrder=7,h.renderOrder=8,this.centerPoint.renderOrder=9,sE.centerPointMaterialDynamic.onBeforeCompile=e=>{let t=new S.Color(sE.centerPointMaterial.color),i=new S.Color(sE.centerPointMaterialInShadow.color);e.fragmentShader=`uniform vec3 color;
            uniform float opacity;
            #include <common>
            #include <packing>
            #include <fog_pars_fragment>
            #include <bsdfs>
            #include <lights_pars_begin>
            #include <logdepthbuf_pars_fragment>
            #include <shadowmap_pars_fragment>
            #include <shadowmask_pars_fragment>
            void main() {
              #include <logdepthbuf_fragment>
              gl_FragColor = mix(
                vec4(${i.r}, ${i.g}, ${i.b}, 1),
                vec4(${t.r}, ${t.g}, ${t.b}, 1),
                getShadowMask()
              );
              #include <tonemapping_fragment>
              #include <encodings_fragment>
              #include <fog_fragment>
            }`}}setAzimuthVector(e,t){this.sunAzimuthLine.geometry.setPositions([0,0,0,e*this.radius,t*this.radius,0]),this.sunAzimuthDot.position.set(e*this.radius,t*this.radius,0),this.sunAzimuthDotOuter.position.copy(this.sunAzimuthDot.position)}toggleAzimuthVector(e){this.centerPoint.material=e?sE.centerPointMaterialDynamic:sE.centerPointMaterialInShadow}static createText(e,t,i,s){let n=[];for(let[o,{label:r,size:a}]of Object.entries({0:{label:"N",size:8},30:{label:"30",size:4.5},60:{label:"60",size:4.5},90:{label:"de"===s?"O":"E",size:8},120:{label:"120",size:4.5},150:{label:"150",size:4.5},180:{label:"S",size:8},210:{label:"210",size:4.5},240:{label:"240",size:4.5},270:{label:"W",size:8},300:{label:"300",size:4.5},330:{label:"330",size:4.5}})){let s=-(o/180*Math.PI)+Math.PI/2,l=e*Math.cos(s),d=e*Math.sin(s),h=t.createGeometry(r);h.scale(a*i,a*i,a*i),h.rotateZ(s-Math.PI/2),h.translate(l,d,0),n.push(h)}let o=t.createMaterial();return o.color=new S.Color(1118481),new S.Mesh(tT.n4(n),o)}static createArrowText(e,t,i,s,n){let o=S.MathUtils.degToRad(-(t-90)),r=e*Math.cos(o),a=e*Math.sin(o),l=i.length>1?6:8,d=s.createGeometry(i);d.scale(l*n,l*n,l*n),d.rotateZ(o+Math.PI/2),d.translate(r,a,0);let h=s.createMaterial();return h.color=new S.Color(1118481),new S.Mesh(d,h)}static createNotchesGeometry(e,t,i){let s=new S.PlaneGeometry(i,.6),n=[];for(let t=0;t<72;t++){if(t%6==0)continue;let i=t/72*Math.PI*2,o=s.clone();o.translate(e,0,0),o.rotateZ(i),n.push(o)}return tT.n4(n)}static onResize(e,t){sE.lineMaterial.resolution.set(e,t),sE.azimuthLineMaterial.resolution.set(e,t)}}sE.lineMaterial=new iC.Y({color:0xd4d4d4,linewidth:2.5,vertexColors:!1,depthTest:!1,depthWrite:!1,toneMapped:!1}),sE.ringMaterial=new S.MeshBasicMaterial({color:0xffffff,opacity:.4,depthTest:!1,depthWrite:!1,...eb.a}),sE.notchMaterial=new S.MeshBasicMaterial({color:0xaaaaaa,depthTest:!1,depthWrite:!1}),sE.centerPointMaterial=new S.MeshBasicMaterial({color:0xe3e8ed,depthTest:!1,depthWrite:!1,toneMapped:!1}),sE.centerPointMaterialInShadow=new S.MeshBasicMaterial({color:2174523,depthTest:!1,depthWrite:!1,toneMapped:!1}),sE.centerPointMaterialDynamic=new S.ShadowMaterial({depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!1}),sE.centerPointOuterMaterial=new S.MeshBasicMaterial({color:0xe3e8ed,opacity:.3,depthTest:!1,depthWrite:!1,toneMapped:!1,...eb.a}),sE.azimuthDotMaterial=new S.MeshBasicMaterial({color:0xf5f76e,depthTest:!1,depthWrite:!1,toneMapped:!1}),sE.azimuthLineMaterial=new iC.Y({color:0xf5f7fa,opacity:.5,linewidth:3,vertexColors:!1,depthTest:!1,depthWrite:!1,toneMapped:!1,...eb.a});var sA=i(81445),sD=i(33868);let sO=new sx.Z("/sdf-fonts/SoleilBold.json","/sdf-fonts/SoleilBold.png",8),sk=new sx.Z("/sdf-fonts/SoleilRegular.json","/sdf-fonts/SoleilRegular.png",8),sI=new sx.Z("/sdf-fonts/IconFont.json","/sdf-fonts/IconFont.png",16),sN=Promise.all([sO.init(),sk.init(),sI.init()]);class s_ extends S.Object3D{constructor({renderer:e,camera:t,controls:i,cursorManager:s,lang:n,onSceneChange:o,compassArrowDirection:r}){super(),this.isInitialized=!1,this.isLocked=!1,this.isSummerSolsticeValid=!1,this.isWinterSolsticeValid=!1,this.isPointerDownOnSunNow=!1,this.pointerDownOffsetFromSunNowCenter=new S.Vector2,this.aspectRatioFactor=1,this.screenWidth=1,this.screenHeight=1,this.pointerPosition=new S.Vector2,this.hoverEnabled=new sA.Z({isTouchFresh:!0,isNotPanning:!0}),this.pointerDownPosition=null,this.isInteractivityEnabled=!0,this.externalSunNowActive=!1,this.isPointerOverObject=!1,this.isSolsticeInteractive=!0,this.renderer=e,this.camera=t,this.controls=i,this.cursorManager=s,this.lang=n,this.onSceneChange=o,this.raycaster=new S.Raycaster,this.compassArrowDirection=r,this.textGeneratorBold=sO,this.textGeneratorRegular=sk,this.textGeneratorIcons=sI,sN.then(()=>{this.init(),this.isInitialized=!0,this.onSceneChange()}),e.domElement.addEventListener("mousemove",e=>{0===e.button&&(this.pointerPosition.set(e.clientX,e.clientY),this.pointerDownPosition&&(this.hoverEnabled.set("isNotPanning",!1),this.isPointerDownOnSunNow&&(this.raycaster.setFromCamera(new S.Vector2((e.clientX-this.pointerDownOffsetFromSunNowCenter.x)/this.screenWidth*2-1,-(2*((e.clientY-this.pointerDownOffsetFromSunNowCenter.y)/this.screenHeight))+1),this.camera),this.processGrabbingSunNow())))}),e.domElement.addEventListener("mousedown",e=>{if(0===e.button&&(this.pointerDownPosition=new S.Vector2(e.clientX,e.clientY),this.pointerPosition.set(e.clientX,e.clientY),this.raycaster.setFromCamera(new S.Vector2(e.clientX/this.screenWidth*2-1,-(2*(e.clientY/this.screenHeight))+1),this.camera),this.isPointerDownOnSunNow=this.sunNow.checkIntersection(this.raycaster),this.isPointerDownOnSunNow)){let e=this.sunNow.getPositionScreenSpace(this.camera);this.pointerDownOffsetFromSunNowCenter.copy(this.pointerDownPosition.clone().sub(e))}}),e.domElement.addEventListener("mouseup",e=>{if(0!==e.button||(this.endGrabbingSunNow(),this.isPointerDownOnSunNow=!1,!this.pointerDownPosition))return;let t=new S.Vector2(e.clientX,e.clientY);this.hoverEnabled.set("isNotPanning",!0),this.visible&&this.pointerDownPosition&&2>=this.pointerDownPosition.distanceTo(t)&&this.updatePathInteraction({isClick:!0}),this.pointerDownPosition=null}),e.domElement.addEventListener("touchstart",e=>{if(1===e.touches.length&&this.visible&&(this.pointerDownPosition=new S.Vector2(e.touches[0].clientX,e.touches[0].clientY),this.pointerPosition.set(e.touches[0].clientX,e.touches[0].clientY),this.hoverEnabled.set("isNotPanning",!0),this.hoverEnabled.set("isTouchFresh",!0),this.raycaster.setFromCamera(new S.Vector2(e.touches[0].clientX/this.screenWidth*2-1,-(2*(e.touches[0].clientY/this.screenHeight))+1),this.camera),this.isPointerDownOnSunNow=this.sunNow.checkIntersection(this.raycaster),this.isPointerDownOnSunNow)){let e=this.sunNow.getPositionScreenSpace(this.camera);this.pointerDownOffsetFromSunNowCenter.copy(this.pointerDownPosition.clone().sub(e))}}),e.domElement.addEventListener("touchmove",e=>{1===e.touches.length&&(this.pointerPosition.set(e.touches[0].clientX,e.touches[0].clientY),this.pointerDownPosition&&this.pointerDownPosition.distanceTo(this.pointerPosition)>2&&this.hoverEnabled.set("isNotPanning",!1),this.pointerDownPosition&&(this.hoverEnabled.set("isNotPanning",!1),this.isPointerDownOnSunNow&&(this.raycaster.setFromCamera(new S.Vector2((e.touches[0].clientX-this.pointerDownOffsetFromSunNowCenter.x)/this.screenWidth*2-1,-(2*((e.touches[0].clientY-this.pointerDownOffsetFromSunNowCenter.y)/this.screenHeight))+1),this.camera),this.processGrabbingSunNow())))});let a=(0,sD.debounce)(()=>{this.hoverEnabled.set("isTouchFresh",!1)},1500);e.domElement.addEventListener("touchend",e=>{if(0!==e.touches.length)return;this.endGrabbingSunNow(),this.isPointerDownOnSunNow=!1;let t=new S.Vector2(e.changedTouches[0].clientX,e.changedTouches[0].clientY);this.visible&&this.pointerDownPosition&&2>=this.pointerDownPosition.distanceTo(t)&&this.updatePathInteraction({isClick:!0}),this.pointerDownPosition=null,a()})}init(){this.sunNow=new sS(this.textGeneratorBold,this.textGeneratorRegular),this.add(this.sunNow),this.sunTodaySunrise=new sC(this.textGeneratorRegular),this.add(this.sunTodaySunrise),this.sunTodaySunset=new sC(this.textGeneratorRegular),this.add(this.sunTodaySunset),this.compass=new sE({radius:100,width:10,lang:this.lang,textGenerator:this.textGeneratorBold,iconGenerator:this.textGeneratorIcons,arrowDirection:this.compassArrowDirection}),this.add(this.compass),this.sunTodayPath=new sj({color:0xf8f9ae,radius:100,isDashed:!1,lineWidth:3,clampZ:!0}),this.sunTodayPath.onResize(this.screenWidth,this.screenHeight),this.add(this.sunTodayPath),this.sunTodayPathNight=new sj({color:7192764,radius:100,isDashed:!1,lineWidth:3,clampZ:!1}),this.sunTodayPathNight.lineColor.renderOrder=-1,this.sunTodayPathNight.lineDepth.renderOrder=-1,this.sunTodayPathNight.onResize(this.screenWidth,this.screenHeight),this.add(this.sunTodayPathNight),this.summerSolsticePath=new sj({color:0xd4d4d4,radius:100,isDashed:!0,dashSize:2,lineWidth:2,clampZ:!0}),this.summerSolsticePath.onResize(this.screenWidth,this.screenHeight),this.add(this.summerSolsticePath),this.summerSolsticeHoverPath=new sj({color:0xd4d4d4,radius:100,isDashed:!1,lineWidth:3,clampZ:!0}),this.summerSolsticeHoverPath.onResize(this.screenWidth,this.screenHeight),this.add(this.summerSolsticeHoverPath),this.winterSolsticePath=new sj({color:0xd4d4d4,radius:100,isDashed:!0,dashSize:2,lineWidth:2,clampZ:!0}),this.winterSolsticePath.onResize(this.screenWidth,this.screenHeight),this.add(this.winterSolsticePath),this.winterSolsticeHoverPath=new sj({color:0xd4d4d4,radius:100,isDashed:!1,lineWidth:3,clampZ:!0}),this.winterSolsticeHoverPath.onResize(this.screenWidth,this.screenHeight),this.add(this.winterSolsticeHoverPath)}setLock(e,t,i){this.isLocked=e,this.position.x=t,this.position.y=i}setTime(e){this.time=e}updateSunLabels(){if(!this.sunNow.visible){this.onSunLabelChange("azimuth",!1),this.onSunLabelChange("altitude",!1);return}let e=this.sunNow.position.clone().normalize(),t=new S.Vector3(e.x,e.y).normalize(),i=this.isMobile?65:80,s=new S.Vector3(80*t.x,80*t.y,0),n=e.clone().multiplyScalar(i),o=s.applyMatrix4(this.compass.matrixWorld),r=n.applyMatrix4(this.compass.matrixWorld),a=o.project(this.camera),l=r.project(this.camera);this.onSunLabelChange("azimuth",!0,(.5*a.x+.5)*this.screenWidth,(-.5*a.y+.5)*this.screenHeight,S.MathUtils.radToDeg(this.sunNowAzimuth)+180),e.z>0?this.onSunLabelChange("altitude",!0,(.5*l.x+.5)*this.screenWidth,(-.5*l.y+.5)*this.screenHeight,S.MathUtils.radToDeg(this.sunNowAltitude)):this.onSunLabelChange("altitude",!1)}processGrabbingSunNow(){if(!this.isInteractivityEnabled||!this.visible)return;this.onSunInteraction(),this.sunNow.toggleHoverState(!0),this.cursorManager.setSunHUDGrabbing(!0),this.controls.enabled=!1;let e=this.sunTodayPath.findClosestPointOnPath(this.raycaster),t=this.sunTodayPathNight&&this.sunTodayPathNight.findClosestPointOnPath(this.raycaster);if(!t||e.distance<t.distance){let t=+this.lastTodayInfo.sunriseEnd,i=+this.lastTodayInfo.sunsetStart,s=new Date(S.MathUtils.lerp(t,i,e.progress));this.setDateTime(s,!1)}else if(t){let e=+this.lastTodayInfo.sunsetStart,i=+this.lastTomorrowInfo.sunriseEnd,s=eA(this.position,this.lastLocation.zoom,this.time)-this.time,n=new Date(S.MathUtils.lerp(e,i,t.progress)+s),o=new Date(+this.time+s);n.setUTCDate(o.getUTCDate()),n.setUTCMonth(o.getUTCMonth()),n.setUTCFullYear(o.getUTCFullYear()),this.setDateTime(new Date(n-s),!1)}}endGrabbingSunNow(){this.isInteractivityEnabled&&(this.sunNow.toggleHoverState(!1),this.cursorManager.setSunHUDGrabbing(!1),this.controls.enabled=!0)}updatePathInteraction({isClick:e=!1}={}){if(!this.isInteractivityEnabled)return;let t=!1,i=!1,s=!1,n=!1,o=!1,r=!1;this.isSummerSolsticeValid?(t=this.isSolsticeInteractive&&this.hoverEnabled.allTrue()&&this.summerSolsticePath.checkHover(this.camera,this.pointerPosition,new S.Vector2(this.screenWidth,this.screenHeight),8),r||(r=this.summerSolsticePath.setVisibility(!t)),r||(r=this.summerSolsticeHoverPath.setVisibility(t))):(r||(r=this.summerSolsticePath.setVisibility(!1)),r||(r=this.summerSolsticeHoverPath.setVisibility(!1))),this.isWinterSolsticeValid?(i=this.isSolsticeInteractive&&this.hoverEnabled.allTrue()&&this.winterSolsticePath.checkHover(this.camera,this.pointerPosition,new S.Vector2(this.screenWidth,this.screenHeight),8),r||(r=this.winterSolsticePath.setVisibility(!i)),r||(r=this.winterSolsticeHoverPath.setVisibility(i))):(r||(r=this.winterSolsticePath.setVisibility(!1)),r||(r=this.winterSolsticeHoverPath.setVisibility(!1)));let a=this.renderer.domElement.getBoundingClientRect(),l=new S.Vector2((this.pointerPosition.x-a.left)/a.width*2-1,-(this.pointerPosition.y-a.top)/a.height*2+1);this.raycaster.setFromCamera(l,this.camera),this.sunNow&&(s=!(navigator.maxTouchPoints>0)&&this.sunNow.checkIntersection(this.raycaster)||this.externalSunNowActive||this.isPointerDownOnSunNow,this.onSunSphereStateChange(s||this.isPointerDownOnSunNow)),this.sunTodaySunrise&&!s&&(n=this.sunTodaySunrise.checkIntersection(this.raycaster)),this.sunTodaySunset&&!s&&(o=this.sunTodaySunset.checkIntersection(this.raycaster)),this.cursorManager.setSunHUDPointer(t||i||n||o),this.cursorManager.setSunHUDGrab(s),this.sunNow.toggleHoverState(s),this.sunTodaySunrise.toggleHoverState(!(navigator.maxTouchPoints>0)&&n),this.sunTodaySunset.toggleHoverState(!(navigator.maxTouchPoints>0)&&o),r&&this.onSceneChange(),this.isPointerOverObject=t||i||s||n||o,n&&e?(this.setDateTime(new Date(+this.lastTodayInfo.sunriseEnd),!0),this.onSunInteraction()):o&&e?(this.setDateTime(new Date(+this.lastTodayInfo.sunsetStart),!0),this.onSunInteraction()):t?(this.onPathHover(!0,"summerSolstice",this.pointerPosition.x,this.pointerPosition.y),e&&this.onPathClick("summerSolstice")):i?(this.onPathHover(!0,"winterSolstice",this.pointerPosition.x,this.pointerPosition.y),e&&this.onPathClick("winterSolstice")):this.onPathHover(!1,"",0,0)}get isMobile(){return this.renderer.domElement.clientWidth<768}updateSunPosition(){this.sunNow.updateMatrixWorld(!0);let e=this.sunNow.getPositionScreenSpace(this.camera),t=this.sunNow.getRadiusScreenSpace(this.camera);this.onSunPositionChange(e.x,e.y,t)}updateResponsiveObjects(){let e=this.isMobile?1.75:1;this.sunNow.scale.set(e,e,e),this.sunTodaySunset.scale.set(e,e,e),this.sunTodaySunrise.scale.set(e,e,e);let t=this.isMobile?15:10;if(this.compass.width!==t){this.remove(this.compass),this.compass=new sE({radius:100,width:t,lang:this.lang,textGenerator:this.textGeneratorBold,iconGenerator:this.textGeneratorIcons,arrowDirection:this.compassArrowDirection}),this.add(this.compass);let e=new S.Vector3(this.sunNow.position.x,this.sunNow.position.y).normalize();this.compass.setAzimuthVector(e.x,e.y),this.compass.toggleAzimuthVector(this.sunNow.position.z>=0)}}update(e,t,i,s,n,o){if(!this.isInitialized)return;if(!this.visible){this.cursorManager.setSunHUDPointer(!1),this.cursorManager.setSunHUDGrab(!1),this.onSunLabelChange("azimuth",!1),this.onSunLabelChange("altitude",!1);return}(this.sunNow.needsRender||this.sunTodaySunrise.needsRender||this.sunTodaySunset.needsRender)&&(this.onSceneChange(),this.sunNow.needsRender=this.sunTodaySunrise.needsRender=this.sunTodaySunset.needsRender=!1),this.isLocked?this.position.z=s(this.position.x,this.position.y):this.position.set(t.x,t.y,i);let r=2*Math.tan(S.MathUtils.degToRad(e)/2),a=.0036*n*this.aspectRatioFactor*r;this.scale.set(a,a,a),this.updateMatrixWorld(),this.updateResponsiveObjects();let{lat:l,lng:d}=B.Z.metersToLatLng(this.position);if(this.lastUpdateTime===+this.time&&this.lastUpdateLat===l&&this.lastUpdateLon===d){this.updateSunLabels(),this.updatePathInteraction(),this.updateSunPosition();return}this.lastUpdateTime=+this.time,this.lastUpdateLat=l,this.lastUpdateLon=d;let h=ef.getTimes(this.time,l,d);if(this.lastTodayInfo=h,this.lastLocation=o,isNaN(+h.sunriseEnd)||isNaN(+h.sunsetStart))this.sunNow.visible=!1,this.sunTodaySunrise.visible=!1,this.sunTodaySunset.visible=!1,this.sunTodayPath.visible=!1,this.sunTodayPathNight.visible=!1;else{let e=ef.getPosition(this.time,l,d),t=ej(e.azimuth,e.altitude),i=new S.Vector3(t.x,t.y).normalize();this.sunNow.position.set(100*t.x,100*t.y,100*t.z),this.sunNow.onPositionUpdate(),this.sunNow.setTime(eA(this.position,o.zoom,this.time)),this.sunNowAltitude=e.altitude,this.sunNowAzimuth=e.azimuth,this.compass.setAzimuthVector(i.x,i.y),this.compass.toggleAzimuthVector(this.sunNow.position.z>=0),this.sunTodayPath.updatePath(+h.sunriseEnd,+h.sunsetStart,l,d);let s=ef.getTimes(new Date(+this.time+864e5),l,d);this.lastTomorrowInfo=s,this.sunNow.position.z<0&&!isNaN(+s.sunriseEnd)?(this.sunTodayPathNight.updatePath(+h.sunsetStart,+s.sunriseEnd,l,d),this.sunTodayPathNight.visible=!0):this.sunTodayPathNight.visible=!1;let n=this.sunTodayPath.getStartPosition(),r=this.sunTodayPath.getEndPosition();n&&this.sunTodaySunrise.position.copy(n),r&&this.sunTodaySunset.position.copy(r),this.sunTodaySunrise.setTime(eA(this.position,o.zoom,h.sunriseEnd)),this.sunTodaySunset.setTime(eA(this.position,o.zoom,h.sunsetStart)),this.sunNow.visible=!0,this.sunTodaySunrise.visible=!!n,this.sunTodaySunset.visible=!!r,this.sunTodayPath.visible=!0,this.sunTodayPathNight.visible=this.sunNow.position.z<0}let c=new sf(this.time.getFullYear().toString()),u=ef.getTimes(c.summer,l,d),p=ef.getTimes(c.winter,l,d),m=864e6>Math.abs(this.time-c.summer),g=864e6>Math.abs(this.time-c.winter);isNaN(+u.sunriseEnd)||m?(this.summerSolsticePath.visible=!1,this.isSummerSolsticeValid=!1):(this.summerSolsticePath.updatePath(+u.sunriseEnd,+u.sunsetStart,l,d),this.summerSolsticeHoverPath.updatePath(+u.sunriseEnd,+u.sunsetStart,l,d),this.summerSolsticePath.visible=!0,this.isSummerSolsticeValid=!0),isNaN(+p.sunriseEnd)||g?(this.winterSolsticePath.visible=!1,this.isWinterSolsticeValid=!1):(this.winterSolsticePath.updatePath(+p.sunriseEnd,+p.sunsetStart,l,d),this.winterSolsticeHoverPath.updatePath(+p.sunriseEnd,+p.sunsetStart,l,d),this.winterSolsticePath.visible=!0,this.isWinterSolsticeValid=!0),this.updateSunLabels(),this.updatePathInteraction(),this.updateSunPosition()}updateRenderOrder(e){if(!this.isInitialized||!this.visible)return;let t=[[this.sunNow,e.position.distanceTo(this.sunNow.position)],[this.sunTodaySunrise,e.position.distanceTo(this.sunTodaySunrise.position)],[this.sunTodaySunset,e.position.distanceTo(this.sunTodaySunset.position)]];t.sort((e,t)=>e[1]-t[1]);for(let e=0;e<t.length;e++)t[e][0].setRenderOrder(t.length-e+10);let i=new S.Ray(e.position,e.getWorldDirection(new S.Vector3)),s=[[this.summerSolsticePath,-1/0],[this.summerSolsticeHoverPath,-1/0],[this.winterSolsticePath,-1/0],[this.winterSolsticeHoverPath,-1/0],[this.sunTodayPath,-1/0],[this.sunTodayPathNight,-1/0]];for(let e=0;e<s.length;e++){let t=s[e][0].getDistanceFromCamera(i);null!==t&&(s[e][1]=t)}s.sort((e,t)=>t[1]-e[1]);for(let e=0;e<s.length;e++)s[e][0].setRenderOrder(e)}onResize(e,t){this.screenWidth=e,this.screenHeight=t;let i=e/t;this.aspectRatioFactor=Math.min(1,i),sE.onResize(e,t),this.isInitialized&&(this.summerSolsticePath.onResize(e,t),this.summerSolsticeHoverPath.onResize(e,t),this.winterSolsticePath.onResize(e,t),this.winterSolsticeHoverPath.onResize(e,t),this.sunTodayPath.onResize(e,t),this.sunTodayPathNight.onResize(e,t))}toggleInteractivity(e){this.isInteractivityEnabled=e}setExternalSphereState(e){this.isInitialized&&(this.externalSunNowActive=e,this.updatePathInteraction())}setSolsticeInteractivity(e){this.isSolsticeInteractive=e}}var sR=i(52264),sV=i(42505),sB=i.n(sV);class sU extends S.Object3D{constructor(e){super();let t=[];"Polygon"===e.type?t.push(e.coordinates):"MultiPolygon"===e.type&&t.push(...e.coordinates);let i=[],s=[],n=[],o=0;for(let e of t)for(let t of e){let e=t.map(([e,t])=>({x:e,y:t})),r=sB()(e,5e3,!1);for(let e=0;e<r.length;e++){let t=r[e].x,a=r[e].y;i.push(t,a,0),i.push(t,a,1),s.push(0,0),s.push(0,1),e<r.length-1&&(n.push(o,o+1,o+2),n.push(o+2,o+1,o+3)),o+=2}}let r=new S.BufferGeometry;r.setAttribute("position",new S.BufferAttribute(new Float32Array(i),3)),r.setAttribute("uv",new S.BufferAttribute(new Float32Array(s),2)),r.setIndex(new S.BufferAttribute(new Uint32Array(n),1));let a=new S.MeshBasicMaterial({color:0xffcd00,side:S.DoubleSide,blending:iI.WMw,transparent:!0,depthWrite:!1,depthTest:!0,fog:!0,toneMapped:!1});a.onBeforeCompile=e=>{e.fragmentShader=e.fragmentShader.replace("#include <uv_pars_fragment>",`varying vec2 vUv;
                varying vec3 cameraSpacePosition;`),e.vertexShader=e.vertexShader.replace("#include <uv_pars_vertex>",`varying vec2 vUv;
                varying vec3 cameraSpacePosition;`),e.vertexShader=e.vertexShader.replace("#include <uv_vertex>","vUv = vec3( uv, 1 ).xy;"),e.vertexShader=e.vertexShader.replace("#include <fog_vertex>",`#include <fog_vertex>
                cameraSpacePosition = mvPosition.xyz;`),e.fragmentShader=e.fragmentShader.replace("vec4 diffuseColor = vec4( diffuse, opacity );",`float height = vUv.y;
                float opacity = smoothstep(1., 0., height);
                vec3 fdx = dFdx( cameraSpacePosition );
                vec3 fdy = dFdy( cameraSpacePosition );
                float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
                vec3 normal = normalize( cross( fdx, fdy ) ) * faceDirection;
                float directionalOpacity = dot(normal, vec3(0, 0, 1)) + 0.2;
                vec4 diffuseColor = vec4(diffuse * 0.3 * opacity * directionalOpacity, 1);`),e.fragmentShader=e.fragmentShader.replace("#include <fog_fragment>",`float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
                gl_FragColor.rgb *= 1. - fogFactor;`)};let l=new S.Mesh(r,a);this.add(l)}scaleToCameraDistance(e,t){let i=Math.max(1.5,e*t*8e-4);return this.scale.set(1,1,100+i),i}}var sF=i(51975),sZ=i.n(sF),sH=i(3220),sG=i(22958);let sz=[{elevationModel:"esri",regionArea:ep.Tokyo},{elevationModel:"esri",regionArea:ep.SaudiArabia},{elevationModel:"esri",regionArea:ep.UAE},{elevationModel:"esri",regionArea:ep.Australia}];var sW=i(10948),sX=i(56549);(0,tX.Z)();let sY=({rendererContainer:e,basemap:t,terrain:i,initialLocation:n,initialDate:o,visualQuality:r,showSunVector:a,activateKeyboardControls:l,isPanningEnabled:d,panWithLeftMouseButton:h,buildingPlaceholderBlueprint:c,debugMode:p,showPro3DTiles:m,focalLength:g,floorIndication:f,floorHeight:x,antiAliasing:w,ssao:b,limitCameraPositionToRadius:v,lang:y,initialAutoRotation:P,onAttributionChanged:O,onAzimuthalAngleChanged:k,onLoadingChanged:I,onTerrainVisibilityChanged:N,onLocationChanged:_,onFrameRateTooLow:V,onShowGastronomy:F,onHideGastronomy:Z,onShowBuildingOverlayMenu:z,onHideBuildingOverlayMenu:W,onShowTreeOverlayMenu:X,onHideTreeOverlayMenu:Y,onStudioDrawingLabelChange:$,onSunHUDPathHover:q,onSunHUDPathClick:K,onSunHUDLabelChange:J,onSunHUDPositionChange:et,onSunHUDInteraction:ei,onSunHUDSphereStateChange:es,onDateChanged:en,onGoogle3DDataAvailability:er,defaultBuildingHeight:ea,showGlobalTrees:el,showHQTreesFree:ed,showHQTreesPaid:eh,highlightBuilding:ec,compassArrowDirection:eu,canUseAnalytics:ef})=>{let ex,eb,ey,eC,eM,eS,eL,eT,ej,eP,eE,eA,eD,ek,eI,eN,e_,eR,eV,eB,eU,eF,eZ,eH,eG,eW,eX,eY,e$,eQ,eq,eK,eJ,e0,e2,e5,e3,e4,e8,e9,te,tt,ti,ts,tn,to=new S.Matrix4,tr=new S.Matrix4,ta=0,tl=new S.Matrix4,td=!1,tc=!0;fetch("./demo/demo_region_chile_cells_32.geojson").then(e=>e.json()).then(e=>{(eL=new eo({cells:e,resolution:32})).init(),setInterval(()=>{if(eT){let e=eL.isPointWithinArea(eg.originOffset);eT(e&&tv.decimalZoom>7)}},1e3)}),fetch("./demo/demo_region_chile.geojson").then(e=>e.json()).then(e=>{(ej=new sU(e.features[0].geometry)).visible=tc,eF.add(ej)}),setInterval(()=>{if(eP){let e=function(e){for(let t=0;t<eg.activeTiles3DAreas.length;t++)if(eg.activeTiles3DSettings[t].disableOSMTrees&&eg.activeTiles3DAreas[t].isPointWithinArea(e))return!0;return!1}(eg.originOffset);eP(e)}},1e3);let tu=p,tp=D.y7,tg=new Date(o.getTime());tg.setHours(tg.getHours()+1);let tf=new S.Group,tw=new S.Group,tb=!1;H.setQuality(r);let tv=n,tC=new S.Frustum,tS=D.Q8,tL=!0,tT=new S.Matrix4,tj=new S.Matrix4,tP=1/0,tE=0,tA=()=>{tL=!0,eE&&eE.screenAnalyticsPass&&(eE.screenAnalyticsPass.registerCameraMovement(),eE.analyticsSampling.resetMonthly())},tD={position:new S.Vector3},tk=new S.Vector3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),tI=new S.Vector3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),tN=!0,t_=new S.Mesh(new S.CylinderGeometry(.05,.05,.05,64),new S.MeshLambertMaterial({color:0x66660000}));t_.rotateX(Math.PI/2);let tR=D.M$.DEFAULT,tV=new S.Group;tV.name="tiles3DGroup";let tB=null,tU=new S.Group;tU.name="googleTilesGroup";let tF=new S.Group;tF.name="buildingsGroup";let tZ=new S.Group;tZ.name="treesGroup";let tH=i,tG=new S.Group,tz=[],tX=!1,t$=!1,tQ=!1,tK=null,tJ=!1,t1=new S.Vector3,t0=!0,t2=o,t5=!1,t3=!1,t4=!1,t8=!1,t9=new S.Clock,t7=0,t6=!1,ie=new e1(I),it=!0,ii=!1,is=[],io=sP(eu),ir={x:0,y:0,visible:!1},ia=null;function il(e,t,i){let s=e.elements,n=t.elements,o=0;for(let e=0;e<s.length;e++)o+=Math.abs(s[e]-n[e]);return o<i}function id(e){let t=performance.now();if(tP<1/0&&t-tE<1e3/tP)return void requestAnimationFrame(id);tE=t,tu&&eI.begin();let i=t9.getDelta();(function(e){let t=H.quality===u.DESKTOP_LOW||H.quality===u.MOBILE_LOW;t6||t||!it||tb||(e>.1?t7++:t7=0,t7>10&&(V(H.quality),t6=!0))})(i),ta>0&&iU(),1===ta&&ey.setPolarAngle(0),tK&&(e8.onMove(tK,eb),tK=null),eC.update(i),eK.update(),eJ.update(),e$.update(ie),eQ.update(eg.originOffset),e9&&(e9.group.visible=e2.isTerrainVisible);let s=e2.isTerrainVisible?void 0:-eF.position.z;tt.update(eb,e2.mapView,s),te.updateElevation(e2.mapView,s),eC.enabled||ey.update(),C.Vx(e),ih(),eM.csm.update(),ts.updateScale(eb);let o=e2.isTerrainVisible;e2.update(iR(eR)),e2.mapView.update(eb,ek,ex.scene),function(e=!1){if(!eC.enabled){if(e)return ib(e);eW?(ey.target.distanceTo(eW)>D.Cx&&ic(),Date.now()-eX>D.Li&&(eX=Date.now(),ib())):(ic(),ib())}}(!o&&e2.isTerrainVisible),e2.updateMapView(eb,ek,ex.scene);let r=!il(eb.matrix,tT,.01),a=!il(eF.matrix,tj,.01);if(tj.copy(eF.matrix),(r||a)&&tA(),eE.shouldRenderNextFrameForAnalytics()&&(tL=!0),ti&&(ti.updateRenderOrder(eb),ti.update(eb.fov,eg.originOffset,-eF.position.z,iN,eb.position.distanceTo(ey.target),tv)),tL){tL=!1,tT.copy(eb.matrix),ek.info.reset(),eb.updateMatrixWorld();let t=eF.matrixWorld.clone().invert().multiply(eb.matrixWorld);eE.screenAnalyticsPass&&(eE.screenAnalyticsPass.cameraDistance=ey.target.distanceTo(eb.position),eE.pointAnalyticsPass.cameraDistance=ey.target.distanceTo(eb.position)),tl.copy(t),eE.render(e),td&&e2.isTerrainVisible&&(function(){let{polar:e,azimuth:t}=n;P&&(ey.setDisableAutoRotateOnInteraction(!1===ey.autoRotate),ey.autoRotate=!0);let i=t||ey.getAzimuthalAngle();io&&(i=S.MathUtils.degToRad(-io.angle+180)),ey.tweenAnglesTo(e||Math.PI/4,i,2500,void 0,()=>{iw()})}(),td=!1),function(){let{x:e,y:t}=B.Z.latLngToMeters({lat:tv.lat,lng:tv.lng}),i=new S.Vector2(e,t);for(let{elevationModel:e,regionArea:t}of sz)if(t.isPointInBufferedBounds(i)&&t.isPointWithinArea(i)&&tB!==t&&(tB=t,tH!==e)){iv(e),e0&&e0(e);break}}(),function(){if(!tu)return;document.getElementById("debug-lat").innerText=tv.lat.toFixed(5),document.getElementById("debug-lng").innerText=tv.lng.toFixed(5),document.getElementById("debug-zoom").innerText=tv.decimalZoom.toString(),document.getElementById("debug-azimuth").innerText=tv.azimuth.toFixed(5),document.getElementById("debug-polar").innerText=tv.polar.toFixed(5),document.getElementById("debug-x").innerText=eg.originOffset.x.toString(),document.getElementById("debug-y").innerText=eg.originOffset.y.toString(),document.getElementById("debug-tile-width").innerText=eU.toString(),document.getElementById("debug-camera-distance").innerText=eR?.toFixed(2);let e="<hr />Terrain tiles: <b>"+e2.getTileCount()+"</b><br />";e+="OSM building tiles: <b>"+eK.getTileCount()+"</b><br />"+("HQ tree tiles: <b>"+eJ.getTileCount())+"</b><br />"+("Triangle count: <b>"+ek.info.render.triangles)+"</b><br />"+("Render calls: <b>"+ek.info.render.calls)+"</b><br />"+("Shaders programs: <b>"+ek.info.programs.length)+"</b><br />"+("Memory Geo: <b>"+ek.info.memory.geometries)+"</b><br />"+("Memory Tex: <b>"+ek.info.memory.textures)+"</b><br />",document.getElementById("debug-txt").innerHTML=e}()}if(eE.update(),ii){ii=!1;let e=ek.domElement.toDataURL("image/png");for(;is.length>0;)is.pop()(e)}(function(){let e=e8.getSelectedMesh(),t=e8.getSelectedTree();if(e&&t){let i;e.traverse(e=>{e instanceof S.Mesh&&(e.geometry.boundingBox||e.geometry.computeBoundingBox(),i?i.union(e.geometry.boundingBox.clone().applyMatrix4(e.matrixWorld)):i=e.geometry.boundingBox.clone().applyMatrix4(e.matrixWorld))});let s=new S.Vector3;i.getCenter(s),s.z=Math.min(s.z,i.min.z+100);let n=new S.Vector3;n.copy(s),n.project(eb),X(t,(n.x+1)*window.innerWidth/2,-(n.y-1)*window.innerHeight/2)}else Y()})(),i_(),tu&&eI.end(),requestAnimationFrame(id)}function ih(){if(void 0!==v){let e=B.Z.latLngToMeters(n),t=B.Z.applyMercatorScaleFactor(v,n.lat),i=eg.originOffset.x+ey.target.x,s=eg.originOffset.y+ey.target.y;if(Math.hypot(e.x-i,e.y-s)>t){let n=Math.atan2(e.y-s,e.x-i);ey.target.x=e.x-Math.cos(n)*t-eg.originOffset.x,ey.target.y=e.y-Math.sin(n)*t-eg.originOffset.y}}eC.enabled||(eg.originOffset.x+=ey.target.x,eg.originOffset.y+=ey.target.y,eb.position.x-=ey.target.x,eb.position.y-=ey.target.y,ey.target.x=0,ey.target.y=0),void 0!==v&&ey.restoreCameraPosition(),eC.enabled?(tf.position.x=Math.round((eb.position.x+eg.originOffset.x)/D.Ex)*D.Ex,tf.position.y=Math.round((eb.position.y+eg.originOffset.y)/D.Ex)*D.Ex):(tf.position.x=Math.round(eg.originOffset.x/D.RS)*D.RS,tf.position.y=Math.round(eg.originOffset.y/D.RS)*D.RS),eF.position.x=-eg.originOffset.x,eF.position.y=-eg.originOffset.y,eF.updateMatrix(),eF.updateWorldMatrix(!1,!1),eZ.position.copy(eF.position),eZ.updateWorldMatrix(!1,!1),eH.position.copy(eF.position),eH.updateWorldMatrix(!1,!1),eG.position.copy(eF.position),eG.updateWorldMatrix(!1,!1),eb.updateWorldMatrix(!1,!1),tC.setFromProjectionMatrix(new S.Matrix4().multiplyMatrices(eb.projectionMatrix,eb.matrixWorldInverse)),e3.updateCenter(ti&&tJ?eH.localToWorld(ti.position.clone()):ey.target)}function ic(){eW=ey.target.clone(),eX=Date.now()}function iu(e){let t=eb.position.clone().sub(ey.target).normalize().multiplyScalar(e);eb.position.copy(ey.target).add(t)}function ip(e,t){if(!e)return void tt.hide();tt.showOnMap(eg.originOffset.x,eg.originOffset.y,e2.mapView)}function im(){let{lat:e,lng:t}=B.Z.metersToLatLng({x:ey.target.x+eg.originOffset.x,y:ey.target.y+eg.originOffset.y});t<-180&&(t=360+t),t>180&&(t=-360+t),e<-85.0511&&(e=-85.0511),e>85.0511&&(e=85.0511),_(tv=tv.setLng(t).setLat(e))}function ig(){if(tJ){let{lat:e,lng:t}=B.Z.metersToLatLng(t1);eM.setGeolocation(e,t)}else eM.setGeolocation(tv.lat,tv.lng)}function ix(){var e;let t;ey.target.distanceTo(tk)>90&&(tk.copy(ey.target),tf.position.x=ey.target.x+eg.originOffset.x,tf.position.y=ey.target.y+eg.originOffset.y,ig(),iD(),Q(eM),tN=!0),k(ey.getAzimuthalAngle()),t=eC.enabled?Math.max(60,(eF.worldToLocal(eb.position.clone()).z-e2.mapView.pickElevationAtXY({x:eg.originOffset.x+eb.position.x,y:eg.originOffset.y+eb.position.y}))*2):ey.target.distanceTo(eb.position);let i=eb.getEffectiveFOV();if(te.scaleToCameraDistance(t,i),ej&&ej.scaleToCameraDistance(t,i),tv=(tv=tv.setAzimuth(ey.getAzimuthalAngle())).setPolar(ey.getPolarAngle()),e=t,s.near=Math.max(3*e,1e5),s.far=Math.max(5*(e+300),s.near+15e4),Math.abs(t-eR)>1&&iF(eR),Math.abs(t-eR)>30){let e=iR(eR=t),i=tv.zoom;_(tv=tv.setZoom(e)),tv.zoom!==i&&(eb.layers.disable(i),eb.layers.enable(tv.zoom),iF(eR),eU=B.Z.getTileSizeInMeters(tv.zoom),function(){if(tv.zoom<D.Ds)return eb.layers.disable(D.sv);eb.layers.enable(D.sv)}(),tN=!0,tS&&iw())}_(tv);let n=new S.Vector3;eb.getWorldDirection(n),Math.abs(n.angleTo(tI))>.15&&(tI.copy(n),tN=!0),e3.update(eb.position,tJ?eF.localToWorld(t1.clone()):ey.target,eM.getSunDirection())}async function iw(){tN&&(ih(),tN=!1)}function ib(e=!1){let t=e2.mapView.pickElevationAtXY(eg.originOffset);if(t_.position.set(eg.originOffset.x,eg.originOffset.y,t),tf.position.z=t,e){eV?.stop(),eF.position.z=-t,eH.position.z=-t,eG.position.z=-t;return}eV?.stop(),eV=new C.kX({z:eF.position.z}).to({z:-t},500).onUpdate(({z:e})=>{eF.position.z=e,eH.position.z=e,eG.position.z=e}).easing(C.oY.Sinusoidal.InOut).start()}function iv(e){let t=e7[e];tH=e;let i=e7[e6(e)];e2.mapView.changeElevation(t,i).then(()=>{eK.refreshTiles(!0),eJ.refreshTiles()})}function iy(){eb.aspect=window.innerWidth/window.innerHeight,iU(),ek.setSize(window.innerWidth,window.innerHeight);let e=H.get("MAX_PIXEL_RATIO");ek.setPixelRatio(Math.min(window.devicePixelRatio,e)),e$.onWindowResize(),eQ.onWindowResize(),eE.setSize(window.innerWidth,window.innerHeight),eM.csm.updateFrustums(),ti&&ti.onResize(window.innerWidth,window.innerHeight),tS&&iw()}function iC(e){iL(e.pageX,e.pageY)}function iM(e){let t=e.pageX,i=e.pageY;tK=new S.Vector2(t/window.innerWidth*2-1,-(2*(i/window.innerHeight))+1)}function iS(e){e.touches.length>0&&(iL(e.touches[0].pageX,e.touches[0].pageY),eD.x=e.touches[0].pageX,eD.y=e.touches[0].pageY)}function iL(t,i){e.focus({preventScroll:!0}),eA.x=t,eA.y=i}function iT(e){e.preventDefault(),e.touches.length>0&&(eD.x=e.touches[0].pageX,eD.y=e.touches[0].pageY)}function ij(e){iA(e.pageX,e.pageY)}function iE(){iA(eD.x,eD.y)}function iA(e,t){if(ti&&ti.visible&&ti.isPointerOverObject)return;tS&&iw();let i=Math.abs(e-eA.x),s=Math.abs(t-eA.y);if(i<3&&s<3){let i=new S.Vector2(e/window.innerWidth*2-1,-(2*(t/window.innerHeight))+1);e8.onClick(i,eb,eF,eH)}}function iD(){if(!e_||!eM)return;eN.color.setHex(eM.color.getHex()),e_.updatePosition(eM.sunPosition.azimuth,eM.sunPosition.altitude);let e=eM.maxAltitude/(.5*Math.PI);eN.intensity=S.MathUtils.lerp(.2,.1,S.MathUtils.clamp(1-Math.pow(1-eM.altitudeRatio/e,6),0,1))}function iO(e,t,i){return i.indexOf(e)===t}function ik(e,t){let{x:i,y:s}=B.Z.latLngToMeters({lat:e,lng:t});return e2.mapView.pickElevationAtXY({x:i,y:s})}function iN(e,t){return e2.mapView.pickElevationAt(e,t)}function i_(){let e=e8.getSelectedMesh(),t=e8.getSelectedBuilding();if(e&&e instanceof S.Mesh&&t&&!1===t.hidden){let i=e.geometry;i.boundingBox||i.computeBoundingBox();let s=new S.Vector3;i.boundingBox.getCenter(s),s.z=Math.min(s.z,i.boundingBox.min.z+100),s.applyMatrix4(e.matrixWorld);let n=new S.Vector3;n.copy(s),n.project(eb),z(t,(n.x+1)*window.innerWidth/2,-(n.y-1)*window.innerHeight/2)}else W()}function iR(e){return D.FT-Math.log2(e/B.Z.EPSG3857WorldSize)}function iV(e){return Math.pow(2,D.FT-e)*B.Z.EPSG3857WorldSize}function iB(e){let t=getComputedStyle(document.documentElement).getPropertyValue(e);return t.endsWith("px")?+t.slice(0,-2):+t||0}function iU(){!function(){let e=window.innerWidth,t=window.innerHeight,i=e<640,s=235*!!i,n=65*!!i;s+=iB("--safe-area-inset-top"),n+=iB("--safe-area-inset-bottom");let o=0;i&&ir.visible&&ir.y<310&&(o+=310-ir.y),eb.setViewOffset(e,t,0,-s/2+n/2-o,e,t)}(),eb.updateProjectionMatrix(),to.copy(eb.projectionMatrix);let e=eb.position.distanceTo(ey.target),t=Math.tan(S.MathUtils.degToRad(eb.fov/2))*e,i=t*eb.aspect;tr.makeOrthographic(-i,i,t,-t,eb.near,eb.far);var s=ta,n=eb.projectionMatrix;for(let e=0;e<n.elements.length;e++)n.elements[e]=S.MathUtils.lerp(to.elements[e],tr.elements[e],(1-1e6**-s)/(1-1/1e6));eb.projectionMatrixInverse.copy(eb.projectionMatrix).invert(),eb.userData.isOrthographicCamera=ta>.5,eb.userData.orthographicCamera=new S.OrthographicCamera(-i,i,t,-t,eb.near,eb.far),eb.userData.orthographicCamera.matrix.copy(eb.matrix),eb.userData.orthographicCamera.matrixWorld.copy(eb.matrixWorld),eb.userData.orthographicCamera.matrixWorldInverse.copy(eb.matrixWorldInverse),tA()}function iF(e){eC.enabled?(eb.near=.1,eb.far=1e4):(eb.near=Math.max(D.YX,e*D.Fn),eb.far=Math.max(D.d8,e*D.cQ)),iU();let t=H.get("SHADOW_DISTANCE_FACTOR"),i=Math.max(H.get("SHADOW_DISTANCE_MIN"),e);eM.csm.maxFar=i*t,eM.csm.lightMargin=100*Math.max(400,i),eM.csm.updateFrustums(),tA()}function iH(e){return()=>{e.visible=e2.isTerrainVisible,i$.updateElevation(e,ik),e8.updateElevation()}}function iG(){let e=!tX&&!t$&&!tQ;e3.setVisible(e),tA()}function iz(){ti&&(ti.visible=!t5&&!t3&&!t4&&!t8)}return!function(t,i,r){eg.originOffset=B.Z.latLngToMeters(tv),eU=B.Z.getTileSizeInMeters(tv.zoom),(ek=new S.WebGLRenderer({antialias:!1,stencil:!1,depth:!0,powerPreference:"high-performance",precision:"highp",preserveDrawingBuffer:!0})).setSize(window.innerWidth,window.innerHeight),ek.shadowMap.enabled=!0,ek.shadowMap.type=S.PCFSoftShadowMap,ek.shadowMap.autoUpdate=!1,ek.toneMapping=S.CustomToneMapping,ek.autoClear=!1,ek.info.autoReset=!1,S.ShaderChunk.tonemapping_pars_fragment=S.ShaderChunk.tonemapping_pars_fragment.replace("vec3 CustomToneMapping( vec3 color ) { return color; }","vec3 CustomToneMapping( vec3 color ) { return pow( color, vec3( 1.0 / 2.2 ) ); }"),e.appendChild(ek.domElement),e.focus({preventScroll:!0}),eY=new sR.Z(ek.domElement);let d=(0,tY.f)(g);(eb=new S.PerspectiveCamera(d,window.innerWidth/window.innerHeight,D.YX,D.d8)).position.z=iV(tv.decimalZoom),eb.up=new S.Vector3(0,0,1),eb.layers.enable(D.sv),eb.layers.enable(tv.zoom),S.Object3D.DEFAULT_UP=new S.Vector3(0,0,1),ex=new se,eF=new S.Group,ex.main.add(eF),eF.position.x=-eg.originOffset.x,eF.position.y=-eg.originOffset.y,eF.updateMatrixWorld(),eH=new S.Group,ex.overlay.add(eH),eH.position.copy(eF.position),eH.updateMatrixWorld(),eG=new S.Group,ex.locationOrb.add(eG),eG.position.copy(eF.position),eG.updateMatrixWorld(),(eZ=new S.Group).name="lightingOriginGroup",ex.lighting.add(eZ),eZ.position.x=-eg.originOffset.x,eZ.position.y=-eg.originOffset.y,eZ.updateMatrixWorld(),(ey=i?R.createControlsWithPanning(eb,ek.domElement,r):R.createControlsNoPanning(eb,ek.domElement)).maxDistance=iV(3),io&&(ey.setAzimuthAngle(S.MathUtils.degToRad(-io.angle+90)),ey.update()),ez.setControlsTarget(ey.target),(eC=new tq(eb,eY)).onChange=()=>{ix()},eR=ey.target.distanceTo(eb.position);let h=new S.Fog(0xffffff,2.5*eR,5*eR);ex.scene.fog=h,s=h,eA=new S.Vector2,eD=new S.Vector2,eF.add(tf),eH.add(tw),eM=new ew(o,tg,tv.lat,tv.lng,eZ,H,ek.capabilities.maxTextureSize,eb),iF(eR),eS=e=>{eM.csm.setupMaterial(e)},iP.prepareMaterials(eS),eN=new S.HemisphereLight(eM.color,3355443,.35),eZ.add(eN);let u=B.Z.EPSG3857WorldHalfSize;for(let e of(eN.position.set(-u,u,0),eF.add(tV),tV.updateMatrixWorld(),e$=new tO({camera:eb,parent:tV,renderer:ek,visualQualitySettings:H,onTileAdd:()=>{tA()},config:em.filter(e=>!e.requiresPro||m),floorIndication:f,floorHeight:x,prepareMaterial:eS,onSceneUpdated:tA}),eF.add(tU),tU.updateMatrixWorld(),eQ=new sg({camera:eb,parent:tU,renderer:ek,visualQualitySettings:H,prepareMaterial:eS,onSceneUpdated:tA,loadingStateManager:ie}),eq=new sd.Z({color:t.buildingsColor,lineColor:t.buildingsLineColor,floorIndication:f,floorHeight:x}),eF.add(tF),tF.updateMatrixWorld(),eK=new tW({parent:tF,visualQualitySettings:H,config:E.overture,camera:eb,controls:ey,loadingStateManager:ie,buildingVisualSettings:eq,prepareMaterial:eS,defaultBuildingHeight:ea,showTrees:el,onSceneUpdated:tA}),eF.add(tZ),tZ.updateMatrixWorld(),eJ=new tm({parent:tZ,visualQualitySettings:H,camera:eb,loadingStateManager:ie,prepareMaterial:eS,controls:ey,onSceneUpdated:tA}),ed||eh||eJ.disable(),eJ.toggleAreas(ed,eh),e2=new th({parent:eF,renderer:ek,camera:eb,visualQualitySettings:H,basemap:t,loadingStateManager:ie,controls:ey,terrainType:tH,onTerrainVisibilityChanged:N,prepareMaterial:eS,onSceneUpdated:tA}),(eE=new sl(ek,eb,ex,eg.originOffset,ey,e2,eF,eH,eY,ef,()=>{tL=!0},(e,t,i)=>{ir.x=e,ir.y=t,ir.visible=i,iU()})).setAAQuality(w),eE.setSSAO(b),eE.setOutlineEnabled(!1),H.subscribe("MAX_PIXEL_RATIO",e=>{ek.setPixelRatio(Math.min(window.devicePixelRatio,e)),eE.setSize(window.innerWidth,window.innerHeight)},!0),(e8=new iZ(eb,eE.outlineEffect,e$,eK,eJ,e2,eF,eH,e=>{var t;t=e,eB?.stop(),eB=new C.kX({factor:ta,polar:ey.getPolarAngle()}).to({factor:+!!t,polar:t?0:Math.PI/4},300).onUpdate(({factor:e,polar:t})=>{ey.setPolarAngle(t),ta=e,iU()}).easing(C.oY.Linear.None).start(),eE.setStudioDrawingMode(e)},e=>{tA()},$,eS,e=>{t8=e,iz()},eq,ek,eE.screenAnalyticsPass)).initTransformControls(ex.overlay,eb,ek.domElement,ey,iN),ec&&(ia=B.Z.latLngToMeters(n)),tn=(0,sD.throttle)(()=>{if(!ia)return;let e=e8.tryHighlightInitialBuilding(ia);(function(e,t,i){if(!e)return tt.hide();tt.showOnMap(i.x,i.y,e2.mapView)})(!e,0,ia),eE.setOutlineEnabled(e)},500,{leading:!1,trailing:!0}),eK.eventEmitter.on("tileLoadingFinished",tn),eK.eventEmitter.on("tileRemoved",tn),e$.onTileVisibilityChange=tn,eK.setUserData(e8.userBuildings,e8.userTrees),eJ.setUserTrees(e8.userTrees),eK.addDependency(e2),eJ.addDependency(e2),e$.addDependency(e2),eK.finalize(),eJ.finalize(),e$.finalize(),eQ.finalize(),e3=new ev(a,eb.position,ey.target,eM.getSunDirection()),eH.add(e3.getMesh()),te=new ty(eG,tA),tt=new tx(eG,tA),c&&(e4=new T.G(c,ey.target),ex.main.add(e4.getBuilding())),Z&&F&&(e9=ee(ek.domElement,eb,F,Z),eF.add(e9.group)),(ts=new sG.Z).visible=!1,ex.overlay.add(ts),Object.values(ep)))e.init();if(eg.switchPro3DTiles(m),iw(),eF.add(tG),(e5=new U(tG)).loadPOIs().catch(e=>G.T.exception("There was an error loading custom models",e)),e_=new tM(ex.main),iD(),(eI=new M.Z).showPanel(0),tu&&(eF.add(t_),document.body.appendChild(eI.dom),document.getElementById("debugPanel").style.display="block"),window.addEventListener("resize",iy,!1),window.addEventListener("orientationchange",iy,!1),e.addEventListener("mousedown",iC,!1),e.addEventListener("mousemove",iM,!1),e.addEventListener("touchstart",iS,!1),e.addEventListener("touchmove",iT,!1),e.addEventListener("mouseup",ij,!1),e.addEventListener("touchend",iE,!1),document.addEventListener("visibilitychange",()=>{it="visible"===document.visibilityState}),l&&e.addEventListener("keydown",function(e){if(!eC.enabled)switch(e.key){case"a":tS=!tS,console.log(`autoUpdate: ${tS}`);break;case"c":ih();break;case"d":tu=!tu,document.getElementById("debugPanel").style.display=tu?"block":"none",tu?(eF.add(t_),document.body.appendChild(eI.dom)):(eF.remove(t_),document.body.removeChild(eI.dom),tZ.visible=!0,tF.visible=!0,tV.visible=!0);break;case"f":tp=!tp,document.querySelector("#side-panel").style.display=tp?"block":"none",document.querySelector("#bottom-panel").style.display=tp?"block":"none",document.querySelector("#logo").style.display=tp?"block":"none",document.querySelector("#attribution").style.display=tp?"block":"none";break;case"u":iw();break;case"r":ey.autoRotate=!ey.autoRotate,console.log(`controls.autoRotate: ${ey.autoRotate}`);break;case"l":ix(),tt.visible?tt.hide():tt.dropAtMap(eg.originOffset.x,eg.originOffset.y,e2.mapView,()=>{});break;case"g":ix(),te.visible?te.hide():te.showOnMap(tv,e2.mapView,1);break;case"x":tu&&(e2.mapView.root.visible=!e2.mapView.root.visible);break;case"y":tu&&(tZ.visible=!tZ.visible);break;case"z":tu&&(tF.visible=!tF.visible,tV.visible=tF.visible);break;case"h":{let e=new S.CameraHelper(eb.clone());ex.main.add(e);break}case"\\":{let e=ek.domElement.toDataURL("image/png"),t=document.createElement("a");t.download="screenshot.png",t.href=e,t.click();break}case"q":(async()=>{sZ()().then(async e=>{console.log("API ready",e);let t=await (0,sH.Z)("https://tiles.stadiamaps.com/styles/alidade_bright/16/35747/22722@2x.png"),i=performance.now(),s=document.createElement("canvas"),n=s.getContext("2d");s.width=+t.width,s.height=+t.height,n.drawImage(t,0,0,t.width,t.height,0,0,s.width,s.height);let o=n.getImageData(0,0,s.width,s.height);console.log(o);let r=e._malloc(o.data.length+64);r+=64-r%64,e.HEAPU8.set(o.data,r);let a=e._compress_etc1(r,o.width,o.height),l=e.HEAPU8;console.log("Result pointer",a);let d=Math.floor(o.width/4),h=Math.floor(o.height/4),c={data:l.subarray(a,a+d*h*8),width:o.width,height:o.height,colorSpace:"srgb"};console.log("Time",performance.now()-i);let u=new S.CompressedTexture([c],o.width,o.height,S.RGB_ETC1_Format,S.UnsignedByteType,void 0,iI.uWy,iI.uWy,S.LinearFilter,S.NearestFilter,void 0,void 0);u.encoding=iI.knz,u.flipY=!1,u.needsUpdate=!0;let p=new S.Mesh(new S.BoxGeometry(100,100,100),new S.MeshBasicMaterial({map:u,toneMapped:!1}));p.position.set(0,0,300),ex.main.add(p)})})()}},!1),ey.addEventListener("change",()=>(im(),ix(),!1)),L.Z.isWebGLAvailable())requestAnimationFrame(id);else{let t=L.Z.getWebGLErrorMessage();e.appendChild(t)}setInterval(()=>{let e;switch(tR){case D.M$.DEFAULT:e=[j.Self,j.OpenStreetMap,...eK.config.attributions,e2.mapView.heightProvider.settings.attribution,...e2.mapView.provider.settings.attributions,eJ.getAttribution(),...e$.getAttribution()];break;case D.M$.GOOGLE:e=[j.Self,eQ.getAttribution(),e2.mapView.heightProvider.settings.attribution]}O(e.filter(Boolean).filter(iO))},1e3),td=!0}(A[t],d,h),{rendererCapabilities:{maxTextureSize:ek.capabilities.maxTextureSize.toString(),maxAnisotropy:ek.capabilities.getMaxAnisotropy().toString(),precision:ek.capabilities.precision,supportedWebGLExtensions:ek.getContext().getSupportedExtensions()},resetNorth:function(){ey.tweenAnglesTo(Math.max(ey.getPolarAngle(),.01),0,500,void 0,()=>{iw()})},changeBasemap:function(e){let t=A[e];e2.mapView.changeBasemap(t),eq.update({color:t.buildingsColor,lineColor:t.buildingsLineColor})},changeTerrain:iv,onTerrainChanged:e=>{e0=e},setLocation:function({lng:e,lat:t,zoom:i=13,azimuth:s,polar:n,dropPin:o,animateRotation:r=!0,animatePosition:a=!0,animateZoom:l=!0,onlyZoomIn:d=!1,positionThreshold:h=0,resetRotation:c=!1,duration:u=1500,easing:p=C.oY.Sinusoidal.InOut}){let{x:m,y:g}=B.Z.latLngToMeters({lng:e,lat:t}),f=B.Z.getMercatorScaleFactor(t),x=new S.Vector2(m,g).distanceTo(new S.Vector2(eg.originOffset.x,eg.originOffset.y))<h*f,w=ey.target.distanceTo(eb.position),b=iV(i),v=d?Math.min(w,b):b,y=new C.kX({distance:w,x:eg.originOffset.x,y:eg.originOffset.y,polar:c?0:ey.getPolarAngle(),azimuth:ey.getAzimuthalAngle()}).to({distance:v,x:m,y:g,polar:n??Math.PI/4,azimuth:s??ey.getAzimuthalAngle()},u).easing(p).onUpdate(({distance:e,x:t,y:i,polar:s,azimuth:n})=>{if(a&&!x){let e=t-eg.originOffset.x,s=i-eg.originOffset.y;eb.position.x+=e,eb.position.y+=s,ey.target.x+=e,ey.target.y+=s,tk.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)}l&&iu(e),r&&(ey.setPolarAngle(s),ey.setAzimuthAngle(n)),ey.update()});if(y.onComplete(()=>{ih(),a&&o&&ip(!0,!0)}),!a&&!x){let e=m-eg.originOffset.x,t=g-eg.originOffset.y;eb.position.x+=e,eb.position.y+=t,ey.target.x+=e,ey.target.y+=t,tk.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)}l||iu(v),r||(ey.setPolarAngle(n??Math.PI/4),ey.setAzimuthAngle(s??ey.getAzimuthalAngle())),!a&&o&&(ih(),ip(!0,!0)),y.start(),ey.addEventListener("interaction",()=>{y.stop()}),im(),ix(),tS&&iw()},showLocationPin:ip,updateLocationOrb:function(e,t,i){if(!e)return void te.hide();te.showOnMap(t,e2.mapView,i)},toggleFirstPersonView:function(e,t,i){eC.enabled!==e&&(ey.enabled=!e,e?(tD.position.copy(eb.position),eC.enable(ek.domElement,t,i)):(eC.disable(),eb.position.copy(tD.position),ey.resetSphericalDelta()),iF(eR),ti&&ti.toggleInteractivity(!e),tA())},zoomIn:(e=1.4)=>{ey.zoomToCursor=!1,ey.dollyIn(e),ey.zoomToCursor=!0,tS&&iw()},zoomOut:(e=1.4)=>{ey.zoomToCursor=!1,ey.dollyOut(e),ey.zoomToCursor=!0,tS&&iw()},autoRotate:e=>{ey.autoRotate=e},showSunVector:e=>{tX=!e,iG()},setMaxPolarAngle:e=>{ey.maxPolarAngle=e},setDate:e=>{tg.setTime(e.getTime()),tg.setHours(tg.getHours()+1),eM&&eM.setDates(e,tg),e3.updateSunDirection(eM.getSunDirection()),iD(),Q(eM),t2=e,ti&&ti.setTime(e),tA()},setGastronomies:e=>{if(!e9)return void G.T.message("Cannot load gastronomies if gastronomy was not initialized");e9.load(e)},setShowPro3DTiles:e=>{eg.switchPro3DTiles(e),e$.setConfig(em.filter(t=>!t.requiresPro||e)),eK.refreshTiles()},setFocalLength:e=>{eb.fov=(0,tY.f)(e),iU(),eM.csm.updateFrustums()},setUserBuildings:e=>{e8.setUserBuildings(e)},setUserPrefabs:e=>{e8.setUserPrefabs(e)},setUserTrees:e=>{e8.setUserTrees(e)},setUserShapes:e=>{e8.setUserShapes(e)},setUserSolarPanels:e=>{e8.setUserSolarPanels(e)},setStudioMode:e=>{eE.setOutlineEnabled(e),e8.setStudioMode(e)},createUsermodelManager:()=>{let e=new i$({overlayGroup:eH,elevationFunction:ik,prepareMaterial:eS,onSceneUpdated:tA});return tz.push(e),e},setUsermodelGroup:e=>{let t=eF.getObjectByName(i$.GROUP_NAME);t&&(e2.eventEmitter.off("tileAdded",iH(t)),e2.eventEmitter.off("tileRemoved",iH(t)),eF.remove(t)),e2.eventEmitter.on("tileAdded",iH(e)),e2.eventEmitter.on("tileRemoved",iH(e)),eF.add(e)},setStudioTransformControlsMode:(e,t)=>{e8.setTransformControlsMode(e,t)},setSelectedModelAttributes:(e,t)=>{e8.setSelectedModelAttributes(e,t)},onSelectedModelChanged:e=>{e8.onSelectedModelChanged(e)},onSelectedShapeChanged:e=>{e8.onSelectedShapeChanged(e)},onSelectedPrefabChanged:e=>{e8.onSelectedPrefabChanged(e)},onSelectedTreeChanged:e=>{e8.onSelectedTreeChanged(e)},onSelectedSolarPanelChanged:e=>{e8.onSelectedSolarPanelChanged(e)},setStudioSelectedModel:e=>{e8.setSelected({selection:e,type:"model"})},setStudioSelectedShape:e=>{e8.setSelectedShape(e)},setStudioSelectedPrefab:e=>{e8.setSelectedPrefab(e)},setStudioSelectedSolarPanel:e=>{e8.setSelectedSolarPanel(e)},studioClearSelected:()=>{e8.clearSelected()},isLocationVisible:(e,t)=>{let{x:i,y:s}=B.Z.latLngToMeters({lat:t,lng:e}),n=e2.mapView.pickElevationAt(i,s),o=eF.localToWorld(new S.Vector3(i,s,n)),r=new S.Frustum;return r.setFromProjectionMatrix(new S.Matrix4().multiplyMatrices(eb.projectionMatrix,eb.matrixWorldInverse)),r.containsPoint(o)},onSelectedBuildingChanged:e=>{e8.onSelectedBuildingChanged(t=>{e(t),t?i_():W()})},addCustomShapeCallback:e=>{e8.addCustomShapeCallback(e)},selectBuilding:async e=>{if(e8.setSelected({selection:null}),"osm"===e.type&&eK.getTilesByBuildingId(e.buildingId))for(let t of eK.getTilesByBuildingId(e.buildingId)){let i=t.getBatchIdByBuildingId(e.buildingId);i&&e8.selectOSMBuilding(t,i)}},selectTree:async e=>{e8.setSelected({selection:null});let t=eO(e),i=eK.getTileByTreeId(t),s=eJ.getTileByTreeId(t);if(i){let s=i.treeIdToInstance.get(t);if(!s)return;let n=s.mesh.getInstanceOutlineMesh(s.instanceId);e8.setSelected({selection:n,id:t,type:"tree",tree:e})}else if(s){let i=s.treeIdToInstance.get(t);if(!i)return;let n=i.mesh.getInstanceOutlineMesh(i.instanceId);e8.setSelected({selection:n,id:t,type:"tree",tree:e})}},setFloorIndication:(e,t)=>{let i=eq.getState();(i.floorIndication!==e||i.floorHeight!==t)&&(eq.update({floorIndication:e,floorHeight:t}),e$.setFloorIndication(e,t),tA())},setVisualQuality(e){H.setQuality(e),iF(eR),tA()},setAntiAliasing(e){eE.setAAQuality(e),tA()},setSSAO(e){eE.setSSAO(e),tA()},setShapeDrawingMode(e){e8.setShapeDrawingMode(e)},toggleAccumulatedShadows(e){t$=e,t3=e,iG(),iz(),ey.maxDistance=iV(e?15:3),eM.toggleLighting(!e),eE.setShadowAccumulation(e),tb=e,e8.setAnalytics(e)},attachAnalyticsToLatLon(e,t){B.Z.latLngToMeters({lat:e,lng:t})},attachAnalyticsToCamera(){},onAccumulatedShadowsClick(e){eE.analyticsSampling?.emitter.on("pointerSampled",e)},onMonthlyAnalyticsUpdate(e){eE.analyticsSampling?.emitter.on("monthlyPointerSampled",e)},onAnalyticsMagnifierVisible(e){eE.analyticsSampling?.emitter.on("magnifierVisible",e)},setShadowAccumulationRange(e,t){eE.screenAnalyticsPass&&eE.screenAnalyticsPass.setRange(e,t)},onAccumulatedShadowsRecalculated(e){eE.screenAnalyticsPass&&(eE.screenAnalyticsPass.onShadowRecalculated=e)},requestScreenshot:e=>{ii=!0,is.push(e)},setMapMode(e){switch(tR=e,e){case D.M$.DEFAULT:eQ.disable(),e2.enable(),eK.enable(),e$.enable(),eJ.enable();break;case D.M$.GOOGLE:eQ.enable(),e2.disable(),eK.disable(),e$.disable(),eJ.disable()}e5.onMapModeChange(tR),e8.setMapMode(e),tA()},toggleGoogle3DPreviewMode:e=>{eQ.toggleBasicShadingMode(e),e?(eQ.enable(),e2.disable(),eK.disable(),e$.disable(),eJ.disable()):tR!==D.M$.GOOGLE&&(eQ.disable(),e2.enable(),eK.enable(),e$.enable(),eJ.enable()),t4=e,iz(),tQ=e,iG(),e8.setMapMode(e?D.M$.GOOGLE:D.M$.DEFAULT),eM.toggleShadows(!e),tA()},toggleSunHUD:function(e){e&&(ti||((ti=new s_({renderer:ek,camera:eb,controls:ey,cursorManager:eY,lang:y,onSceneChange:tA,compassArrowDirection:eu})).setTime(t2),ti.setLock(tJ,t1.x,t1.y),ti.setSolsticeInteractivity(t0),eH.add(ti),ti.onResize(window.innerWidth,window.innerHeight),ti.onPathHover=q,ti.onPathClick=K,ti.setDateTime=(e,t)=>{en(e,t)},ti.onSunLabelChange=J,ti.onSunPositionChange=et,ti.onSunInteraction=ei,ti.onSunSphereStateChange=es,iz())),t5=!e,iz(),e3.toggleDepthTest(!e),tA()},toggleSunHUDLock:(e,t,i)=>{if(e!==tJ||t!==t1.x||i!==t1.y){if(tJ=e,t&&i){let e=B.Z.latLngToMeters({lat:t,lng:i});t1.set(e.x,e.y,0)}else t1.copy(eF.worldToLocal(ey.target.clone()));ti&&(ti.setLock(e,t1.x,t1.y),ig(),ix(),tA())}},onDemoRegionStatusChanged:e=>{eT=e},onTreeRegionStatusChanged:e=>{eP=e},toggleDemoRegionBorder:e=>{tc=e,ej&&(ej.visible=tc),tA()},setDefaultBuildingHeight:e=>{eK.setDefaultBuildingHeight(e)},toggleGlobalTrees:e=>{eK.toggleTrees(e)},toggleHQTrees:(e,t)=>{(e||t)&&tR!==D.M$.GOOGLE?eJ.enable():eJ.disable(),eJ.toggleAreas(e,t)},toggleCrosshair:e=>{ts.visible=e,tA()},setSunHUDSphereState:e=>{ti&&ti.setExternalSphereState(e)},onSolarPanelAnalyticsChanged:e=>{e8.onSolarPanelAnalyticsChanged(e)},updateHighlightedBuilding:(e,t)=>{ia=B.Z.latLngToMeters({lat:e,lng:t}),tn()},resetHighlightedBuilding:()=>{ia=null,e8.clearSelected(),tt.hide()},setSunHUDSolsticeInteractivity:e=>{ti?.setSolsticeInteractivity(e),t0=e}}},s$=Promise.all([ta,sN])},48300:function(e,t,i){i.d(t,{P:function(){return n},Z:function(){return o}});var s=i(71075);class n{constructor(){this.visibility=[!0,!0,!0,!0]}encode(){let e=0;for(let t=0;t<4;t++)e|=!!this.visibility[t]<<t;return e}isVisible(e,t){return this.visibility[e+2*t]}}class o{constructor(e){this.cache=new Map,this.baseTessellation=e}setBaseTessellation(e){this.baseTessellation=e}getGeometry(e,t,i){let n=this.getSegments(e,i),o=t.encode()<<12|n;if(this.cache.has(o))return this.cache.get(o);let r=new s.JO(1,1,n,n,!0,1,t);return this.cache.set(o,r),r}getSegments(e,t){let i=(t.resolution-2*t.padding)/Math.pow(2,Math.max(0,e-t.maxZoom));if(i>=this.baseTessellation)return this.baseTessellation;let s=Math.log2(this.baseTessellation/i);return this.baseTessellation/Math.pow(2,s)}}},71075:function(e,t,i){i.d(t,{Ij:function(){return a.I},kW:function(){return n.k},VT:function(){return h.V},JO:function(){return d.J},Ib:function(){return l.I},bz:function(){return r},jU:function(){return h.j},O:function(){return c.O}});var s=i(38005),n=i(93860),o=i(76444);class r extends s.Mesh{constructor(e=r.PLANAR,t=null,i=null){super(void 0,new s.MeshBasicMaterial({transparent:!0,opacity:0,depthWrite:!1,colorWrite:!1})),this.lod=null,this.provider=null,this.heightProvider=null,this.root=null,this.cacheTiles=!1,this.onBeforeRender=(e,t,i,s,n,o)=>{this.lod.updateLOD(this,i,e,t)},this.lod=new o.x,this.provider=t,this.heightProvider=i,this.setRoot(e),this.preSubdivide()}setRoot(e){if("number"==typeof e){if(!r.mapModes.has(e))throw Error("Map mode "+e+" does is not registered.");e=new(r.mapModes.get(e))(null,this)}null!==this.root&&(this.remove(this.root),this.root=null),this.root=e,null!==this.root&&(this.geometry=this.root.constructor.baseGeometry,this.scale.copy(this.root.constructor.baseScale),this.root.mapView=this,this.add(this.root),this.root.initialize())}preSubdivide(){let e=Math.max(this.provider.minZoom,this.heightProvider?.minZoom??-1/0);e>0&&function e(t,i){if(!(i<=0))for(let s of(t.subdivide(),t.childrenNodes))e(s,i-1)}(this.root,e)}setProvider(e){e!==this.provider&&(this.provider=e,this.clear())}setHeightProvider(e){e!==this.heightProvider&&(this.heightProvider=e,this.clear())}clear(){return this.traverse(function(e){e.childrenCache&&(e.childrenCache=null),e.initialize&&e.initialize()}),this}minZoom(){return Math.max(this.provider.minZoom,this.heightProvider?.minZoom??-1/0)}maxZoom(){return Math.min(this.provider.maxZoom,this.heightProvider?.maxZoom??1/0)}getMetaData(){this.provider.getMetaData()}raycast(e,t){return!1}}r.PLANAR=200,r.SPHERICAL=201,r.HEIGHT=202,r.HEIGHT_SHADER=203,r.MARTINI=204,r.mapModes=new Map([[r.HEIGHT,n.k]]);var a=i(24472);i(77890);var l=i(1138),d=i(37397);i(43515);var h=i(19960);i(79441),i(47003);var c=i(53070)},91941:function(e,t,i){i.d(t,{Z:function(){return o}});var s=i(38005),n=i(20270);class o{constructor(){this.worker=new Worker(new URL(i.p+i.u(668),i.b))}async compress({bitmap:e}){e instanceof HTMLImageElement&&(e=await createImageBitmap(e));let t=Math.random();return this.worker.postMessage({taskId:t,bitmap:e},[e]),new Promise(e=>{let i=o=>{if(o.data.taskId!==t)return;this.worker.removeEventListener("message",i);let r=o.data.imageData;e(new s.CompressedTexture([r],r.width,r.height,s.RGB_ETC2_Format,s.UnsignedByteType,void 0,n.uWy,n.uWy,s.LinearFilter,s.NearestFilter,void 0,s.LinearEncoding))};this.worker.addEventListener("message",i)})}static isCompressionSupported(e){return e.extensions.has("WEBGL_compressed_texture_etc")&&"createImageBitmap"in window&&"OffscreenCanvas"in window}}},81445:function(e,t,i){i.d(t,{Z:function(){return s}});class s{constructor(e){this.state=e}set(e,t){this.state[e]=t}get(e){return this.state[e]}allTrue(){return Object.values(this.state).every(e=>e)}allFalse(){return Object.values(this.state).every(e=>!e)}}},60179:function(e,t,i){function s(){return navigator.userAgentData?navigator.userAgentData.mobile:/iphone|android/.test(navigator.userAgent.toLowerCase())}function n(){return/iphone/.test(navigator.userAgent.toLowerCase())}i.d(t,{Z:function(){return s},g:function(){return n}})},3220:function(e,t,i){i.d(t,{Z:function(){return s}});async function s(e){return new Promise((t,i)=>{let s=new Image;s.onload=()=>{t(s)},s.onerror=i,s.crossOrigin="Anonymous",s.src=e})}},21029:function(e,t,i){i.d(t,{f:function(){return s}});function s(e){return 2*Math.atan(24/(2*e))*180/Math.PI}},50844:function(e,t,i){i.d(t,{a:function(){return n}});var s=i(38005);let n={blending:s.CustomBlending,blendEquation:s.AddEquation,blendDst:s.OneMinusSrcAlphaFactor,blendDstAlpha:s.OneMinusSrcAlphaFactor,blendSrc:s.SrcAlphaFactor,blendSrcAlpha:s.OneFactor}}},l={};function d(e){var t=l[e];if(void 0!==t)return t.exports;var i=l[e]={id:e,loaded:!1,exports:{}};return a[e].call(i.exports,i,i.exports,d),i.loaded=!0,i.exports}d.m=a,d.amdO={},e=[],d.O=function(t,i,s,n){if(i){n=n||0;for(var o=e.length;o>0&&e[o-1][2]>n;o--)e[o]=e[o-1];e[o]=[i,s,n];return}for(var r=1/0,o=0;o<e.length;o++){for(var i=e[o][0],s=e[o][1],n=e[o][2],a=!0,l=0;l<i.length;l++)(!1&n||r>=n)&&Object.keys(d.O).every(function(e){return d.O[e](i[l])})?i.splice(l--,1):(a=!1,n<r&&(r=n));if(a){e.splice(o--,1);var h=s();void 0!==h&&(t=h)}}return t},d.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return d.d(t,{a:t}),t},i=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__},d.t=function(e,s){if(1&s&&(e=this(e)),8&s||"object"==typeof e&&e&&(4&s&&e.__esModule||16&s&&"function"==typeof e.then))return e;var n=Object.create(null);d.r(n);var o={};t=t||[null,i({}),i([]),i(i)];for(var r=2&s&&e;"object"==typeof r&&!~t.indexOf(r);r=i(r))Object.getOwnPropertyNames(r).forEach(function(t){o[t]=function(){return e[t]}});return o.default=function(){return e},d.d(n,o),n},d.d=function(e,t){for(var i in t)d.o(t,i)&&!d.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},d.f={},d.e=function(e){return Promise.all(Object.keys(d.f).reduce(function(t,i){return d.f[i](e,t),t},[]))},d.u=function(e){return"webpack/"+e+"."+({239:"453fd30d653c66562178",304:"318e8e0255e0011e4abb",357:"9639d265fb434f3fd679",465:"8ffbb675a26e2c919f42",581:"d2c20e7d2996be2e3f65",668:"c3ce9a429a41df65906a",692:"2d0d2f03329bd5014365",856:"cfbe71218a1e523dab5e",871:"a1c20f113bee34d03e21",878:"98baa416e60f05187691",885:"55335d827c1a14195888",935:"c8ce7a30440ed2bee77e"})[e]+".js"},d.miniCssF=function(e){},d.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(e){if("object"==typeof window)return window}}(),d.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s={},d.l=function(e,t,i,n){if(s[e])return void s[e].push(t);if(void 0!==i)for(var o,r,a=document.getElementsByTagName("script"),l=0;l<a.length;l++){var h=a[l];if(h.getAttribute("src")==e||h.getAttribute("data-webpack")=="shadowmap:"+i){o=h;break}}o||(r=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,d.nc&&o.setAttribute("nonce",d.nc),o.setAttribute("data-webpack","shadowmap:"+i),o.src=e),s[e]=[t];var c=function(t,i){o.onerror=o.onload=null,clearTimeout(u);var n=s[e];if(delete s[e],o.parentNode&&o.parentNode.removeChild(o),n&&n.forEach(function(e){return e(i)}),t)return t(i)},u=setTimeout(c.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=c.bind(null,o.onerror),o.onload=c.bind(null,o.onload),r&&document.head.appendChild(o)},d.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},d.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},d.p="/",d.b=document.baseURI||self.location.href,n={143:0,108:0},d.f.j=function(e,t){var i=d.o(n,e)?n[e]:void 0;if(0!==i)if(i)t.push(i[2]);else if(108!=e){var s=new Promise(function(t,s){i=n[e]=[t,s]});t.push(i[2]=s);var o=d.p+d.u(e),r=Error();d.l(o,function(t){if(d.o(n,e)&&(0!==(i=n[e])&&(n[e]=void 0),i)){var s=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;r.message="Loading chunk "+e+" failed.\n("+s+": "+o+")",r.name="ChunkLoadError",r.type=s,r.request=o,i[1](r)}},"chunk-"+e,e)}else n[e]=0},d.O.j=function(e){return 0===n[e]},o=function(e,t){var i,s,o=t[0],r=t[1],a=t[2],l=0;if(o.some(function(e){return 0!==n[e]})){for(i in r)d.o(r,i)&&(d.m[i]=r[i]);if(a)var h=a(d)}for(e&&e(t);l<o.length;l++)s=o[l],d.o(n,s)&&n[s]&&n[s][0](),n[s]=0;return d.O(h)},(r=self.webpackChunkshadowmap=self.webpackChunkshadowmap||[]).forEach(o.bind(null,0)),r.push=o.bind(null,r.push.bind(r));var h=d.O(void 0,[108,234,868,383,737,975],function(){return d(31089)});d.O(h)}();